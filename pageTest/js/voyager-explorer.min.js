/*! For license information please see voyager-explorer.min.js.LICENSE.txt */
(()=>{var t={0:(t,e,i)=>{"use strict";i.d(e,{gK:()=>l});var n=i(946);const s={xyzw:["X","Y","Z","W"],rgba:["R","G","B","A"]},r=function(t){return void 0===t||"object"==typeof t&&!Array.isArray(t)?t:{preset:t}},o=function(t,e,i){return{path:e,schema:(i=r(i))?Object.assign({},t,i):t}},a={Number:{preset:0},Integer:{preset:0,step:1,speed:.34,precision:0},Natural:{preset:0,step:1,speed:.34,precision:0,min:0},Unit:{preset:0,min:0,max:1,bar:!0},Percent:{preset:0,min:0,max:1,bar:!0,percent:!0},Vector2:{preset:[0,0]},Vector3:{preset:[0,0,0]},Vector4:{preset:[0,0,0,0]},Matrix2:{preset:[1,0,0,1]},Matrix3:{preset:[1,0,0,0,1,0,0,0,1]},Matrix4:{preset:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Scale:{preset:1},Scale2:{preset:[1,1]},Scale3:{preset:[1,1,1]},IntVec2:{preset:[0,0],step:1,speed:.34,precision:0},IntVec3:{preset:[0,0,0],step:1,speed:.34,precision:0},ColorRGB:{preset:[1,1,1],semantic:"color",labels:s.rgba,min:0,max:1,bar:!0},ColorRGBA:{preset:[1,1,1,1],semantic:"color",labels:s.rgba,min:0,max:1,bar:!0},Boolean:{preset:!1},String:{preset:""},AssetPath:{preset:"",semantic:"asset-path"},Object:{preset:null,objectType:Object},Event:{preset:0,event:!0}},l={Property:(t,e)=>o(void 0,t,e),Number:(t,e)=>o(a.Number,t,e),Integer:(t,e)=>o(a.Integer,t,e),Natural:(t,e)=>o(a.Natural,t,e),Unit:(t,e)=>o(a.Unit,t,e),Percent:(t,e)=>o(a.Percent,t,e),Vector2:(t,e)=>o(a.Vector2,t,e),Vector3:(t,e)=>o(a.Vector3,t,e),Vector4:(t,e)=>o(a.Vector4,t,e),IntVec2:(t,e)=>o(a.IntVec2,t,e),IntVec3:(t,e)=>o(a.IntVec3,t,e),Matrix2:(t,e)=>o(a.Matrix2,t,e),Matrix3:(t,e)=>o(a.Matrix3,t,e),Matrix4:(t,e)=>o(a.Matrix4,t,e),Scale:(t,e)=>o(a.Scale,t,e),Scale2:(t,e)=>o(a.Scale2,t,e),Scale3:(t,e)=>o(a.Scale3,t,e),ColorRGB:(t,e)=>o(a.ColorRGB,t,e),ColorRGBA:(t,e)=>o(a.ColorRGBA,t,e),Boolean:(t,e)=>o(a.Boolean,t,e),String:(t,e)=>o(a.String,t,e),AssetPath:(t,e)=>o(a.AssetPath,t,e),Enum:(t,e,i)=>function(t,e,i){i=r(i);const s={enum:t,options:(0,n.e)(t),preset:0};return{path:e,schema:i?Object.assign({},s,i):s}}(e,t,i),Option:(t,e,i)=>function(t,e,i){const n={options:t,preset:0};return{path:e,schema:(i=r(i))?Object.assign({},n,i):n}}(e,t,i),Object:(t,e,i)=>function(t,e,i){const n={preset:null,objectType:t};return{path:e,schema:(i=r(i))?Object.assign({},n,i):n}}(e,t,i),Event:(t,e)=>o(a.Event,t,e)}},20:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.DomUtils=e.parseFeed=e.getFeed=e.ElementType=e.Tokenizer=e.createDomStream=e.parseDOM=e.parseDocument=e.DefaultHandler=e.DomHandler=e.Parser=void 0;var a=i(9185),l=i(9185);Object.defineProperty(e,"Parser",{enumerable:!0,get:function(){return l.Parser}});var c=i(5724),h=i(5724);function u(t,e){var i=new c.DomHandler(void 0,e);return new a.Parser(i,e).end(t),i.root}function d(t,e){return u(t,e).children}Object.defineProperty(e,"DomHandler",{enumerable:!0,get:function(){return h.DomHandler}}),Object.defineProperty(e,"DefaultHandler",{enumerable:!0,get:function(){return h.DomHandler}}),e.parseDocument=u,e.parseDOM=d,e.createDomStream=function(t,e,i){var n=new c.DomHandler(t,e,i);return new a.Parser(n,e)};var p=i(3745);Object.defineProperty(e,"Tokenizer",{enumerable:!0,get:function(){return o(p).default}}),e.ElementType=r(i(2177));var f=i(1881),g=i(1881);Object.defineProperty(e,"getFeed",{enumerable:!0,get:function(){return g.getFeed}});var m={xmlMode:!0};e.parseFeed=function(t,e){return void 0===e&&(e=m),(0,f.getFeed)(d(t,e))},e.DomUtils=r(i(1881))},25:(t,e)=>{"use strict";function i(t){const e=t.length;let i,n=0,s=0;for(;s<e;)n++,i=t.charCodeAt(s++),i>=55296&&i<=56319&&s<e&&(i=t.charCodeAt(s),56320==(64512&i)&&s++);return n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i,i.code='require("ajv/dist/runtime/ucs2length").default'},50:(t,e,i)=>{"use strict";let n=i(9493),s=i(3215);class r extends Error{constructor(t,e,i,n,s,o){super(t),this.name="CssSyntaxError",this.reason=t,s&&(this.file=s),n&&(this.source=n),o&&(this.plugin=o),void 0!==e&&void 0!==i&&("number"==typeof e?(this.line=e,this.column=i):(this.line=e.line,this.column=e.column,this.endLine=i.line,this.endColumn=i.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,r)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",void 0!==this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(t){if(!this.source)return"";let e=this.source;null==t&&(t=n.isColorSupported);let i=t=>t,r=t=>t,o=t=>t;if(t){let{bold:t,gray:e,red:a}=n.createColors(!0);r=e=>t(a(e)),i=t=>e(t),s&&(o=t=>s(t))}let a=e.split(/\r?\n/),l=Math.max(this.line-3,0),c=Math.min(this.line+2,a.length),h=String(c).length;return a.slice(l,c).map((t,e)=>{let n=l+1+e,s=" "+(" "+n).slice(-h)+" | ";if(n===this.line){if(t.length>160){let e=20,n=Math.max(0,this.column-e),a=Math.max(this.column+e,this.endColumn+e),l=t.slice(n,a),c=i(s.replace(/\d/g," "))+t.slice(0,Math.min(this.column-1,e-1)).replace(/[^\t]/g," ");return r(">")+i(s)+o(l)+"\n "+c+r("^")}let e=i(s.replace(/\d/g," "))+t.slice(0,this.column-1).replace(/[^\t]/g," ");return r(">")+i(s)+o(t)+"\n "+e+r("^")}return" "+i(s)+o(t)}).join("\n")}toString(){let t=this.showSourceCode();return t&&(t="\n\n"+t+"\n"),this.name+": "+this.message+t}}t.exports=r,r.default=r},66:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>I});var n=i(3074),s=i(9616),r=i(3423),o=i(7297),a=i(3889),l=i(4640),c=i(6351),h=i(3715);const u={[o.a9.High]:16777216,[o.a9.Medium]:4194304,[o.a9.Low]:1048576,[o.a9.Thumb]:262144},d=2*u[o.a9.High];function p(t,e){var i;const n=t.derivatives.select(o.UH.Web3D,e),s=n.findAsset(o.iO.Model);return(null===(i=null==s?void 0:s.data)||void 0===i?void 0:i.imageSize)?Math.pow(s.data.imageSize,2):u[n.data.quality]}const f=[[.04,o.a9.Thumb],[.1,o.a9.Low],[.4,o.a9.Medium]];const g=new l.NRn,m=new l.Pq0,A=new l.Pq0,v=new l.Pq0,y=new l.YHV,b=new l.Pq0,_=new l.YHV,x=new l.PTz,w=new l.kn4,E=(new l.PTz).setFromEuler(new l.O9p(0,0,Math.PI/2)),C=E.clone().conjugate();class S{constructor(t,e){this._prev=0,this._cursor=0,this._buf=new Array(t),"number"==typeof e&&this.reset(e)}push(t,e){return this._buf[this._cursor]=e/(t-this._prev),this._prev=t,this._cursor=(this._cursor+1)%this._buf.length,this.get()}get(){return this._buf.reduce((t,e)=>t+e,0)/this._buf.length}reset(t){for(let e=0;e<this._buf.length;e++)this._buf[e]=t}}class I extends r.Ay{threshold(t){return this._budget-2*u[t]}get settingProperties(){return[this.ins.enabled]}get renderer(){return this.getMainComponent(a.A)}get activeScene(){var t;return null===(t=this.renderer)||void 0===t?void 0:t.activeSceneComponent}constructor(t,e){super(t,e),this._fps=new S(10,60),this._budget=2*u[o.a9.High],this._last_updated=0,this._should_update=!1,this.ins=this.addInputs(I.ins),this.setTextureBudget=()=>{let t=Math.pow(this.renderer.outs.maxTextureSize.value/2,2),e=[];"number"==typeof navigator.hardwareConcurrency&&navigator.hardwareConcurrency<4&&(e.push("low CPU"),t/=2),h.yS&&(e.push("mobile device"),t/=2),"number"==typeof navigator.deviceMemory&&navigator.deviceMemory<8&&(e.push("low RAM"),t=Math.min(t,4*u[o.a9.High])),this._budget=Math.max(d,t),e.length&&console.debug(`Lowered Performance budget: ${Math.sqrt(this._budget)} (${e.join(", ")})`)},this._scene=this.activeScene,this.renderer.outs.maxTextureSize.on("value",this.setTextureBudget)}tock(t){var e;const i=null===(e=this._scene)||void 0===e?void 0:e.activeCameraComponent;if(!this.ins.enabled.value||!i)return!1;if(!t.tickUpdated&&!t.tockUpdated&&!this._should_update)return!1;if(t.secondsElapsed<this._last_updated+.5)return this._should_update=!0,!1;this._should_update=!1,this._last_updated=t.secondsElapsed;let n=0;const r=new l.PTz;i.camera.getWorldQuaternion(r),m.set(1,0,0).applyQuaternion(r);const a=r.clone().conjugate();A.set(0,1,0).applyQuaternion(r),E.setFromEuler(new l.O9p(0,0,Math.PI/2));const h=new l.Pq0;let u=this.getGraphComponents(s.A).map(t=>{var e;let u=[],d=[],p=[],E=[];const S=new l.PTz,I=new l.PTz,M=t.outs.unitScale.value;let T=t.transform;for(g.copy(t.localBoundingBox),v.fromArray(t.ins.position.value).multiplyScalar(M),c.DI(t.ins.rotation.value,s.A.rotationOrder,x),b.setScalar(M),w.compose(v,x,b),g.applyMatrix4(w);T;)w.fromArray(T.outs.matrix.value),g.applyMatrix4(w),T=T.parent;let B=new l.Pq0;i.camera.getWorldPosition(B),[[g.min.x,g.min.y,g.min.z],[g.max.x,g.min.y,g.min.z],[g.max.x,g.max.y,g.min.z],[g.max.x,g.max.y,g.max.z],[g.min.x,g.max.y,g.max.z],[g.min.x,g.min.y,g.max.z],[g.max.x,g.min.y,g.max.z],[g.min.x,g.max.y,g.min.z]].map((t,e)=>{v.set(...t).sub(B),i.camera.getWorldQuaternion(r),v.applyQuaternion(a),y.setFromVector3(v),u.push(y.clone());const n=v.clone().applyQuaternion(C);_.setFromVector3(n),d.push(_.clone()),g.getCenter(b),b.sub(B),b.applyQuaternion(a),h.copy(b),S.setFromUnitVectors(h.clone().normalize(),new l.Pq0(0,0,-1)),I.copy(S).conjugate();const s=v.clone().applyQuaternion(S);_.setFromVector3(s),p.push(_.clone());const o=s.clone().applyQuaternion(C);_.setFromVector3(o),E.push(_.clone())}),i.camera.getWorldPosition(v);const R=g.distanceToPoint(v)/i.camera.far;let P=(2*Math.PI)**2,L=0;if(R>0){let t=Math.max(...u.map(t=>t.theta)),e=Math.min(...u.map(t=>t.theta)),i=Math.PI-Math.max(Math.abs(t),Math.abs(e));const n=new l.Pq0(g.min.x,g.min.y,g.min.z);n.sub(B).applyQuaternion(a);g.intersectsPlane(new l.Zcv(m,-m.dot(B)))&&n.z<0&&(i=0);let s=Math.max(...d.map(t=>t.theta)),r=Math.min(...d.map(t=>t.theta)),o=Math.PI-Math.max(Math.abs(s),Math.abs(r));g.intersectsPlane(new l.Zcv(A,-A.dot(B)))&&n.z<0&&(o=0),g.getCenter(v),v.sub(B),v.applyQuaternion(a);const c=Math.max(...p.filter(t=>t.theta<0).map(t=>t.theta)),h=Math.min(...p.filter(t=>t.theta>0).map(t=>t.theta)),f=2*Math.PI-h+c,y=Math.max(...E.filter(t=>t.theta<0).map(t=>t.theta)),b=Math.min(...E.filter(t=>t.theta>0).map(t=>t.theta)),_=2*Math.PI-b+y;P=Math.abs(f*_),L=new l.I9Y(i,o).length()}const D=2*Math.max(1-R,.1)*P*(1-Math.abs(L/Math.sqrt(Math.PI**2+Math.PI**2)));let N=null===(e=t.derivatives.select(o.UH.Web3D,function(t,e){var i,n;return null!==(n=null===(i=f.find(([i,n])=>(t<=n&&(i+=.02),e<i)))||void 0===i?void 0:i[1])&&void 0!==n?n:o.a9.High}(t.ins.quality.value,P)))||void 0===e?void 0:e.data.quality;return t.isLoading()&&n++,{model:t,clipped:!0,weight:D,qualityRequest:N}}).sort((t,e)=>t.weight-e.weight),d=new Map,S=new Map,I=new Array,M=0,T=0,B=[];for(let t of u){let e=t.model.ins.quality.value;t.model.isLoading()&&e!=t.qualityRequest&&t.model.activeDerivative&&t.qualityRequest<e&&(t.model.ins.quality.setValue(t.model.activeDerivative.data.quality),e=t.model.activeDerivative.data.quality,n--),T+=p(t.model,e),e<t.qualityRequest?(S.set(t.model,t.qualityRequest),I.push([t.model,t.weight]),e=t.qualityRequest):t.qualityRequest<t.model.ins.quality.value&&B.push(t),M+=p(t.model,e)}M<this._budget&&u.filter(t=>t.model.isLoading()&&t.model.ins.quality.value!=t.qualityRequest&&t.model.activeDerivative).forEach(t=>{t.model.ins.quality.setValue(t.model.activeDerivative.data.quality),n--,M+=p(t.model,t.qualityRequest)-p(t.model,t.model.ins.quality.value),T+=p(t.model,t.qualityRequest)-p(t.model,t.model.ins.quality.value)});for(let t of B){if(M<this._budget/2&&2<d.size+S.size+n)break;(t.clipped||t.qualityRequest<t.model.ins.quality.value+1)&&(d.set(t.model,t.qualityRequest),M+=p(t.model,t.qualityRequest)-p(t.model,t.model.ins.quality.value),T+=p(t.model,t.qualityRequest)-p(t.model,t.model.ins.quality.value))}let R=d.size;for(let t of B){if(M<this._budget)break;d.has(t.model)||(d.set(t.model,t.qualityRequest),M+=p(t.model,t.qualityRequest)-p(t.model,t.model.ins.quality.value),T+=p(t.model,t.qualityRequest)-p(t.model,t.model.ins.quality.value))}let P=d.size-R;I.reverse();for(let[t,e]of I){if(M<this._budget)break;const i=S.get(t);let n=new Map,s=T+p(t,i)-p(t,t.ins.quality.value);const r=u.filter(t=>!t.model.ins.quality.changed&&t.model.ins.quality.value>=i&&1.25*t.weight<e&&!d.has(t.model));let a=0;for(;a<r.length&&!(s<this._budget);){const t=r[a].model.derivatives.select(o.UH.Web3D,Math.max(r[a].qualityRequest-1,0)).data.quality;t<r[a].model.ins.quality.value&&(n.set(r[a].model,t),s+=p(r[a].model,t)-p(r[a].model,r[a].model.ins.quality.value)),a++}if(s<this._budget){for(const[e,i]of n)d.set(e,i),M+=p(e,i)-p(t,t.ins.quality.value);T=s}else S.delete(t),M+=p(t,t.ins.quality.value)-p(t,i)}d.size;for(let[t,e]of[...d.entries(),...[...S.entries()].reverse()]){if(6<n)break;const i=t.ins.quality.value;if(e===i)continue;const s=t.derivatives.select(o.UH.Web3D,e);s&&s.data.quality!=i&&(t.ins.quality.setValue(s.data.quality),n++)}return 0<d.size+S.size}fromData(t){t=t||{},this.ins.copyValues({enabled:!!t.enabled})}toData(){const t=this.ins,e={};return e.enabled=t.enabled.value,e}}I.typeName="CVDerivativesController",I.isSystemSingleton=!0,I.text="Derivatives Selection",I.icon="",I.ins={enabled:n.gK.Boolean("LOD.Enabled",!1)}},101:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s=i(3151),r={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:t})=>n._`{propertyName: ${t.propertyName}}`},code(t){const{gen:e,schema:i,data:r,it:o}=t;if((0,s.alwaysValidSchema)(o,i))return;const a=e.name("valid");e.forIn("key",r,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},a),e.if((0,n.not)(a),()=>{t.error(!0),o.allErrors||e.break()})}),t.ok(a)}};e.default=r},161:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var n=i(4640),s=i(3423);class r extends s.Ay{constructor(){super(...arguments),this.ins=this.addInputs(r.ins),this.outs=this.addOutputs(r.outs),this._loadingManager=new o(this),this._baseUrl=window.location.href,this._initialLoad=!1}get loadingManager(){return this._loadingManager}get baseUrl(){return this._baseUrl}set baseUrl(t){this._baseUrl=new URL(t,window.location.href).href}get initialLoad(){return this._initialLoad}set initialLoad(t){this._initialLoad=t}getAssetName(t){return t.split("/").pop()}getAssetUrl(t){const e=new URL(t,this._baseUrl).href;return this.loadingManager.resolveURL(e)}getAssetPath(t){const e=this._baseUrl,i=t.indexOf(e);return i>=0?t.substr(i+e.length):t}getAssetBasePath(t){const e=this.getAssetPath(t).split("/");e.pop();const i=e.join("/");return i?i+"/":i}getRelativeAssetPath(t,e){const i=this.getAssetUrl(t),n=this.getAssetUrl(e),s=i.indexOf(n);return s>=0?i.substr(s+n.length):this.getAssetPath(i)}create(){super.create()}update(){const{ins:t,outs:e}=this;if(t.busy.changed){const i=t.busy.value||this._loadingManager.isBusy;e.busy.setValue(i),i||e.completed.set()}return!0}}r.typeName="CVAssetManager",r.text="AssetManager",r.icon="",r.isSystemSingleton=!0,r.ins={busy:s.gK.Boolean("State.Busy"),baseUrlValid:s.gK.Boolean("Settings.BaseURLValid")},r.outs={busy:s.gK.Boolean("State.Busy"),completed:s.gK.Event("State.Completed")};class o extends n.KPJ{get isBusy(){return this._isBusy}constructor(t){super(),this._manager=t,this._isBusy=!1,this.onStart=this.onLoadingStart.bind(this),this.onProgress=this.onLoadingProgress.bind(this),this.onLoad=this.onLoadingCompleted.bind(this),this.onError=this.onLoadingError.bind(this)}onLoadingStart(){this._isBusy=!0,this._manager.ins.busy.set()}onLoadingProgress(t,e,i){0}onLoadingCompleted(){this._isBusy=!1,this._manager.ins.busy.set()}onLoadingError(){0}}},272:function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.innerText=e.textContent=e.getText=e.getInnerHTML=e.getOuterHTML=void 0;var s=i(5724),r=n(i(4483)),o=i(2177);function a(t,e){return(0,r.default)(t,e)}e.getOuterHTML=a,e.getInnerHTML=function(t,e){return(0,s.hasChildren)(t)?t.children.map(function(t){return a(t,e)}).join(""):""},e.getText=function t(e){return Array.isArray(e)?e.map(t).join(""):(0,s.isTag)(e)?"br"===e.name?"\n":t(e.children):(0,s.isCDATA)(e)?t(e.children):(0,s.isText)(e)?e.data:""},e.textContent=function t(e){return Array.isArray(e)?e.map(t).join(""):(0,s.hasChildren)(e)&&!(0,s.isComment)(e)?t(e.children):(0,s.isText)(e)?e.data:""},e.innerText=function t(e){return Array.isArray(e)?e.map(t).join(""):(0,s.hasChildren)(e)&&(e.type===o.ElementType.Tag||(0,s.isCDATA)(e))?t(e.children):(0,s.isText)(e)?e.data:""}},301:(t,e,i)=>{"use strict";let n,s,r=i(6613);class o extends r{constructor(t){super({type:"document",...t}),this.nodes||(this.nodes=[])}toResult(t={}){return new n(new s,this,t).stringify()}}o.registerLazyResult=t=>{n=t},o.registerProcessor=t=>{s=t},t.exports=o,o.default=o},319:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var n=i(3423);class s extends n.Ay{get fullscreenElement(){return this._fullscreenElement}set fullscreenElement(t){t!==this._fullscreenElement&&(this._fullscreenElement&&this._fullscreenElement.removeEventListener("fullscreenchange",this.onFullscreenChange),this._fullscreenElement=t,t&&t.addEventListener("fullscreenchange",this.onFullscreenChange))}constructor(t,e){super(t,e),this.ins=this.addInputs(s.ins),this.outs=this.addOutputs(s.outs),this._fullscreenElement=null,this.onFullscreenChange=this.onFullscreenChange.bind(this);const i=document.documentElement,n=i.requestFullscreen||i.mozRequestFullScreen||i.webkitRequestFullscreen;this.outs.fullscreenAvailable.setValue(!!n),this.ins.toggle.on("value",this.toggle,this)}update(t){return!0}toggle(){const t=this.outs,e=this._fullscreenElement;if(e){const i=t.fullscreenActive.value;if(!i&&t.fullscreenAvailable.value)e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);else if(i){const t=document;t.exitFullscreen?t.exitFullscreen():t.cancelFullScreen?t.cancelFullScreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitCancelFullScreen&&t.webkitCancelFullScreen()}}}onFullscreenChange(t){const e=document,i=e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement;this.outs.fullscreenActive.setValue(!!i)}}s.typeName="CFullscreen",s.ins={toggle:n.gK.Event("Fullscreen.Toggle")},s.outs={fullscreenAvailable:n.gK.Boolean("Fullscreen.Available",!1),fullscreenActive:n.gK.Boolean("Fullscreen.Active",!1)}},323:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};e.default=i},423:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s=i(3151),r=i(7430),o={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:t})=>n._`{allowedValues: ${t}}`},code(t){const{gen:e,data:i,$data:o,schema:a,schemaCode:l,it:c}=t;if(!o&&0===a.length)throw new Error("enum must have non-empty array");const h=a.length>=c.opts.loopEnum,u=(0,s.useFunc)(e,r.default);let d;if(h||o)d=e.let("valid"),t.block$data(d,function(){e.assign(d,!1),e.forOf("v",l,t=>e.if(n._`${u}(${i}, ${t})`,()=>e.assign(d,!0).break()))});else{if(!Array.isArray(a))throw new Error("ajv implementation error");const t=e.const("vSchema",l);d=(0,n.or)(...a.map((e,s)=>function(t,e){const s=a[e];return"object"==typeof s&&null!==s?n._`${u}(${i}, ${t}[${e}])`:n._`${i} === ${s}`}(t,s)))}t.pass(d)}};e.default=o},425:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.callRef=e.getValidate=void 0;const n=i(4507),s=i(6241),r=i(5265),o=i(2363),a=i(6719),l=i(3151),c={keyword:"$ref",schemaType:"string",code(t){const{gen:e,schema:i,it:s}=t,{baseId:o,schemaEnv:l,validateName:c,opts:d,self:p}=s,{root:f}=l;if(("#"===i||"#/"===i)&&o===f.baseId)return function(){if(l===f)return u(t,c,l,l.$async);const i=e.scopeValue("root",{ref:f});return u(t,r._`${i}.validate`,f,f.$async)}();const g=a.resolveRef.call(p,f,o,i);if(void 0===g)throw new n.default(o,i);return g instanceof a.SchemaEnv?function(e){const i=h(t,e);u(t,i,e,e.$async)}(g):function(n){const s=e.scopeValue("schema",!0===d.code.source?{ref:n,code:(0,r.stringify)(n)}:{ref:n}),o=e.name("valid"),a=t.subschema({schema:n,dataTypes:[],schemaPath:r.nil,topSchemaRef:s,errSchemaPath:i},o);t.mergeEvaluated(a),t.ok(o)}(g)}};function h(t,e){const{gen:i}=t;return e.validate?i.scopeValue("validate",{ref:e.validate}):r._`${i.scopeValue("wrapper",{ref:e})}.validate`}function u(t,e,i,n){const{gen:a,it:c}=t,{allErrors:h,schemaEnv:u,opts:d}=c,p=d.passContext?o.default.this:r.nil;function f(t){const e=r._`${t}.errors`;a.assign(o.default.vErrors,r._`${o.default.vErrors} === null ? ${e} : ${o.default.vErrors}.concat(${e})`),a.assign(o.default.errors,r._`${o.default.vErrors}.length`)}function g(t){var e;if(!c.opts.unevaluated)return;const n=null===(e=null==i?void 0:i.validate)||void 0===e?void 0:e.evaluated;if(!0!==c.props)if(n&&!n.dynamicProps)void 0!==n.props&&(c.props=l.mergeEvaluated.props(a,n.props,c.props));else{const e=a.var("props",r._`${t}.evaluated.props`);c.props=l.mergeEvaluated.props(a,e,c.props,r.Name)}if(!0!==c.items)if(n&&!n.dynamicItems)void 0!==n.items&&(c.items=l.mergeEvaluated.items(a,n.items,c.items));else{const e=a.var("items",r._`${t}.evaluated.items`);c.items=l.mergeEvaluated.items(a,e,c.items,r.Name)}}n?function(){if(!u.$async)throw new Error("async schema referenced by sync schema");const i=a.let("valid");a.try(()=>{a.code(r._`await ${(0,s.callValidateCode)(t,e,p)}`),g(e),h||a.assign(i,!0)},t=>{a.if(r._`!(${t} instanceof ${c.ValidationError})`,()=>a.throw(t)),f(t),h||a.assign(i,!1)}),t.ok(i)}():t.result((0,s.callValidateCode)(t,e,p),()=>g(e),()=>f(e))}e.getValidate=h,e.callRef=u,e.default=c},444:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const n=i(1168),s=i(3211),r=i(6280),o=i(5265),a=i(3151);var l;function c(t){const e=Array.isArray(t)?t:t?[t]:[];if(e.every(n.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}!function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"}(l=e.DataType||(e.DataType={})),e.getSchemaTypes=function(t){const e=c(t.type);if(e.includes("null")){if(!1===t.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&void 0!==t.nullable)throw new Error('"nullable" cannot be used without "type"');!0===t.nullable&&e.push("null")}return e},e.getJSONTypes=c,e.coerceAndCheckDataType=function(t,e){const{gen:i,data:n,opts:r}=t,a=function(t,e){return e?t.filter(t=>h.has(t)||"array"===e&&"array"===t):[]}(e,r.coerceTypes),c=e.length>0&&!(0===a.length&&1===e.length&&(0,s.schemaHasRulesForType)(t,e[0]));if(c){const s=d(e,n,r.strictNumbers,l.Wrong);i.if(s,()=>{a.length?function(t,e,i){const{gen:n,data:s,opts:r}=t,a=n.let("dataType",o._`typeof ${s}`),l=n.let("coerced",o._`undefined`);"array"===r.coerceTypes&&n.if(o._`${a} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,o._`${s}[0]`).assign(a,o._`typeof ${s}`).if(d(e,s,r.strictNumbers),()=>n.assign(l,s)));n.if(o._`${l} !== undefined`);for(const t of i)(h.has(t)||"array"===t&&"array"===r.coerceTypes)&&c(t);function c(t){switch(t){case"string":return void n.elseIf(o._`${a} == "number" || ${a} == "boolean"`).assign(l,o._`"" + ${s}`).elseIf(o._`${s} === null`).assign(l,o._`""`);case"number":return void n.elseIf(o._`${a} == "boolean" || ${s} === null
              || (${a} == "string" && ${s} && ${s} == +${s})`).assign(l,o._`+${s}`);case"integer":return void n.elseIf(o._`${a} === "boolean" || ${s} === null
              || (${a} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(l,o._`+${s}`);case"boolean":return void n.elseIf(o._`${s} === "false" || ${s} === 0 || ${s} === null`).assign(l,!1).elseIf(o._`${s} === "true" || ${s} === 1`).assign(l,!0);case"null":return n.elseIf(o._`${s} === "" || ${s} === 0 || ${s} === false`),void n.assign(l,null);case"array":n.elseIf(o._`${a} === "string" || ${a} === "number"
              || ${a} === "boolean" || ${s} === null`).assign(l,o._`[${s}]`)}}n.else(),f(t),n.endIf(),n.if(o._`${l} !== undefined`,()=>{n.assign(s,l),function({gen:t,parentData:e,parentDataProperty:i},n){t.if(o._`${e} !== undefined`,()=>t.assign(o._`${e}[${i}]`,n))}(t,l)})}(t,e,a):f(t)})}return c};const h=new Set(["string","number","integer","boolean","null"]);function u(t,e,i,n=l.Correct){const s=n===l.Correct?o.operators.EQ:o.operators.NEQ;let r;switch(t){case"null":return o._`${e} ${s} null`;case"array":r=o._`Array.isArray(${e})`;break;case"object":r=o._`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":r=a(o._`!(${e} % 1) && !isNaN(${e})`);break;case"number":r=a();break;default:return o._`typeof ${e} ${s} ${t}`}return n===l.Correct?r:(0,o.not)(r);function a(t=o.nil){return(0,o.and)(o._`typeof ${e} == "number"`,t,i?o._`isFinite(${e})`:o.nil)}}function d(t,e,i,n){if(1===t.length)return u(t[0],e,i,n);let s;const r=(0,a.toHash)(t);if(r.array&&r.object){const t=o._`typeof ${e} != "object"`;s=r.null?t:o._`!${e} || ${t}`,delete r.null,delete r.array,delete r.object}else s=o.nil;r.number&&delete r.integer;for(const t in r)s=(0,o.and)(s,u(t,e,i,n));return s}e.checkDataType=u,e.checkDataTypes=d;const p={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>"string"==typeof t?o._`{type: ${t}}`:o._`{type: ${e}}`};function f(t){const e=function(t){const{gen:e,data:i,schema:n}=t,s=(0,a.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:i,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:t}}(t);(0,r.reportError)(e,p)}e.reportTypeError=f},449:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});let n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function s(t,e){let i;t&&"number"==typeof t||(t=12);do{i="";for(let e=0;e<t;++e)i+=n[62*Math.random()|0]}while(e&&e[i]);return i}},482:t=>{"use strict";class e{constructor(t,e={}){if(this.type="warning",this.text=t,e.node&&e.node.source){let t=e.node.rangeBy(e);this.line=t.start.line,this.column=t.start.column,this.endLine=t.end.line,this.endColumn=t.end.column}for(let t in e)this[t]=e[t]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}}t.exports=e,e.default=e},546:(t,e,i)=>{var n=i(9052),s=i(7926);t.exports=function(t){return s(t)&&"[object Arguments]"==n(t)}},564:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.uniqueSort=e.compareDocumentPosition=e.DocumentPosition=e.removeSubsets=void 0;var n,s=i(5724);function r(t,e){var i=[],r=[];if(t===e)return 0;for(var o=(0,s.hasChildren)(t)?t:t.parent;o;)i.unshift(o),o=o.parent;for(o=(0,s.hasChildren)(e)?e:e.parent;o;)r.unshift(o),o=o.parent;for(var a=Math.min(i.length,r.length),l=0;l<a&&i[l]===r[l];)l++;if(0===l)return n.DISCONNECTED;var c=i[l-1],h=c.children,u=i[l],d=r[l];return h.indexOf(u)>h.indexOf(d)?c===e?n.FOLLOWING|n.CONTAINED_BY:n.FOLLOWING:c===t?n.PRECEDING|n.CONTAINS:n.PRECEDING}e.removeSubsets=function(t){for(var e=t.length;--e>=0;){var i=t[e];if(e>0&&t.lastIndexOf(i,e-1)>=0)t.splice(e,1);else for(var n=i.parent;n;n=n.parent)if(t.includes(n)){t.splice(e,1);break}}return t},function(t){t[t.DISCONNECTED=1]="DISCONNECTED",t[t.PRECEDING=2]="PRECEDING",t[t.FOLLOWING=4]="FOLLOWING",t[t.CONTAINS=8]="CONTAINS",t[t.CONTAINED_BY=16]="CONTAINED_BY"}(n=e.DocumentPosition||(e.DocumentPosition={})),e.compareDocumentPosition=r,e.uniqueSort=function(t){return(t=t.filter(function(t,e,i){return!i.includes(t,e+1)})).sort(function(t,e){var i=r(t,e);return i&n.PRECEDING?-1:i&n.FOLLOWING?1:0}),t}},587:(t,e,i)=>{"use strict";let n=i(1024),s=i(9623),r=i(6613),o=i(50),a=i(8290),l=i(301),c=i(3210),h=i(8262),u=i(2610),d=i(6748),p=i(3172),f=i(8093),g=i(6578),m=i(7129),A=i(6216),v=i(7114),y=i(8227),b=i(482);function _(...t){return 1===t.length&&Array.isArray(t[0])&&(t=t[0]),new g(t)}_.plugin=function(t,e){let i,n=!1;function s(...i){console&&console.warn&&!n&&(n=!0,console.warn(t+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),process.env.LANG&&process.env.LANG.startsWith("cn")&&console.warn(t+": 里面 postcss.plugin 被弃用. 迁移指南:\nhttps://www.w3ctech.com/topic/2226"));let s=e(...i);return s.postcssPlugin=t,s.postcssVersion=(new g).version,s}return Object.defineProperty(s,"postcss",{get:()=>(i||(i=s()),i)}),s.process=function(t,e,i){return _([s(i)]).process(t,e)},s},_.stringify=y,_.parse=f,_.fromJSON=c,_.list=d,_.comment=t=>new s(t),_.atRule=t=>new n(t),_.decl=t=>new a(t),_.rule=t=>new v(t),_.root=t=>new A(t),_.document=t=>new l(t),_.CssSyntaxError=o,_.Declaration=a,_.Container=r,_.Processor=g,_.Document=l,_.Comment=s,_.Warning=b,_.AtRule=n,_.Result=m,_.Input=h,_.Rule=v,_.Root=A,_.Node=p,u.registerPostcss(_),t.exports=_,_.default=_},588:()=>{},624:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(6241),s=i(5265),r=i(2363),o=i(3151),a={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:t})=>s._`{additionalProperty: ${t.additionalProperty}}`},code(t){const{gen:e,schema:i,parentSchema:a,data:l,errsCount:c,it:h}=t;if(!c)throw new Error("ajv implementation error");const{allErrors:u,opts:d}=h;if(h.props=!0,"all"!==d.removeAdditional&&(0,o.alwaysValidSchema)(h,i))return;const p=(0,n.allSchemaProperties)(a.properties),f=(0,n.allSchemaProperties)(a.patternProperties);function g(t){e.code(s._`delete ${l}[${t}]`)}function m(n){if("all"===d.removeAdditional||d.removeAdditional&&!1===i)g(n);else{if(!1===i)return t.setParams({additionalProperty:n}),t.error(),void(u||e.break());if("object"==typeof i&&!(0,o.alwaysValidSchema)(h,i)){const i=e.name("valid");"failing"===d.removeAdditional?(A(n,i,!1),e.if((0,s.not)(i),()=>{t.reset(),g(n)})):(A(n,i),u||e.if((0,s.not)(i),()=>e.break()))}}}function A(e,i,n){const s={keyword:"additionalProperties",dataProp:e,dataPropType:o.Type.Str};!1===n&&Object.assign(s,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(s,i)}e.forIn("key",l,i=>{p.length||f.length?e.if(function(i){let r;if(p.length>8){const t=(0,o.schemaRefOrVal)(h,a.properties,"properties");r=(0,n.isOwnProperty)(e,t,i)}else r=p.length?(0,s.or)(...p.map(t=>s._`${i} === ${t}`)):s.nil;return f.length&&(r=(0,s.or)(r,...f.map(e=>s._`${(0,n.usePattern)(t,e)}.test(${i})`))),(0,s.not)(r)}(i),()=>m(i)):m(i)}),t.ok(s._`${c} === ${r.default.errors}`)}};e.default=a},637:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(444),s=i(5265),r=i(3151),o=i(7430),a={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:t,j:e}})=>s.str`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>s._`{i: ${t}, j: ${e}}`},code(t){const{gen:e,data:i,$data:a,schema:l,parentSchema:c,schemaCode:h,it:u}=t;if(!a&&!l)return;const d=e.let("valid"),p=c.items?(0,n.getSchemaTypes)(c.items):[];function f(r,o){const a=e.name("item"),l=(0,n.checkDataTypes)(p,a,u.opts.strictNumbers,n.DataType.Wrong),c=e.const("indices",s._`{}`);e.for(s._`;${r}--;`,()=>{e.let(a,s._`${i}[${r}]`),e.if(l,s._`continue`),p.length>1&&e.if(s._`typeof ${a} == "string"`,s._`${a} += "_"`),e.if(s._`typeof ${c}[${a}] == "number"`,()=>{e.assign(o,s._`${c}[${a}]`),t.error(),e.assign(d,!1).break()}).code(s._`${c}[${a}] = ${r}`)})}function g(n,a){const l=(0,r.useFunc)(e,o.default),c=e.name("outer");e.label(c).for(s._`;${n}--;`,()=>e.for(s._`${a} = ${n}; ${a}--;`,()=>e.if(s._`${l}(${i}[${n}], ${i}[${a}])`,()=>{t.error(),e.assign(d,!1).break(c)})))}t.block$data(d,function(){const n=e.let("i",s._`${i}.length`),r=e.let("j");t.setParams({i:n,j:r}),e.assign(d,!0),e.if(s._`${n} > 1`,()=>(p.length>0&&!p.some(t=>"object"===t||"array"===t)?f:g)(n,r))},s._`${h} === false`),t.ok(d)}};e.default=a},812:(t,e,i)=>{"use strict";var n=i(6763),s=(i(9498),i(4019)),r=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let o=class extends s.A{constructor(){super(...arguments),this.type="boolean"}firstConnected(){super.firstConnected(),this.classList.add("sv-property-boolean")}update(t){if(t.has("property")){const e=t.get("property");e&&e.off("value",this.onUpdate,this),this.property&&this.property.on("value",this.onUpdate,this)}super.update(t)}render(){const t=this.property,e=this.name||t.name,i=e.replace(/\s/g,""),s=this.text,r=this.language;let o=t.value?Array.isArray(s)?s[1]:s||"On":Array.isArray(s)?s[0]:s||"Off";return n.qy`<label id="${i}-label" class="ff-label ff-off">${e}</label>
        <div title="${e}"><ff-button role="switch" aria-labelledby="${i}-label" aria-checked=${t.value} .text=${r?r.getLocalizedString(o):o} ?disabled=${"true"===this.ariaDisabled} ?selected=${t.value} @click=${this.onButtonClick}></ff-button></div>`}onButtonClick(t){this.property.setValue(!this.property.value)}};o=r([(0,n.EM)("sv-property-boolean")],o)},920:(t,e,i)=>{"use strict";i.d(e,{A:()=>Di});var n=i(5624),s=i(6773),r=i(9085),o=i(6687),a=i(1071),l=i(6233),c=(i(9498),i(3769),i(1308),i(2654)),h=i(1160),u=i(1721),d=i(2997),p=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class f extends h.Ay{get enabled(){return this.getSystemComponent(u.A).navigation.ins.mode.value===d.Kd.Orbit}createView(){return new g(this)}}f.typeName="CVViewTool",f.text="View",f.icon="eye";let g=class extends h.iv{firstConnected(){super.firstConnected(),this.classList.add("sv-view-tool-view")}render(){const t=this.activeDocument;if(!t)return h.qy``;const e=this.tool,i=t.setup.navigation,n=t.setup.language,s=i.ins.projection,r=i.ins.preset,o=i.ins.zoomExtents,a=[c.Gz.Front,c.Gz.Back,c.Gz.Left,c.Gz.Right,c.Gz.Top,c.Gz.Bottom];return e.enabled?h.qy`<div role="toolbar" aria-label="View tool" class="sv-section"><ff-button class="sv-section-lead" title=${n.getLocalizedString("Close Tool")} @click=${this.onClose} transparent icon="close"></ff-button>
            <div class="sv-tool-controls">
                <sv-property-options .property=${s} .language=${n} name=${n.getLocalizedString("Projection")}></sv-property-options>
                <sv-property-options .property=${r} .language=${n} name=${n.getLocalizedString("View")} .indexMap=${a}></sv-property-options>
                <sv-property-event .property=${o} name=${n.getLocalizedString("Center")} icon="zoom"></sv-property-event>
            </div>
        </div>`:null}onActiveDocument(t,e){this.requestUpdate()}async setFocus(){await this.updateComplete;const t=this.getElementsByTagName("sv-property-options")[0];t&&t.focus()}onClose(t){this.parentElement.dispatchEvent(new CustomEvent("close")),t.stopPropagation()}};g=p([(0,h.EM)("sv-view-tool-view")],g);var m=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class A extends h.Ay{createView(){return new v(this)}}A.typeName="CVRenderTool",A.text="Material",A.icon="palette";let v=class extends h.iv{constructor(){super(...arguments),this.viewer=null}firstConnected(){super.firstConnected(),this.classList.add("sv-group","sv-render-tool-view")}render(){this.tool;const t=this.activeDocument,e=this.viewer;if(!e)return h.qy``;const i=e.ins.shader,n=e.ins.variant,s=t.setup.language;return h.qy`<div class="sv-section"><ff-button class="sv-section-lead" title=${s.getLocalizedString("Close Tool")} @click=${this.onClose} transparent icon="close"></ff-button>
            <div class="sv-tool-controls">
                <sv-property-options .property=${i} .language=${s} name=${s.getLocalizedString("Material")}></sv-property-options>
                ${n.schema.options.length>0?h.qy`<sv-property-options .property=${n} .language=${s} name=${s.getLocalizedString("Variant")}></sv-property-options>`:null}
            </div>
        </div>`}onActiveDocument(t,e){this.viewer&&(this.viewer.ins.shader.off("value",this.onUpdate,this),this.viewer.ins.variant.off("value",this.onUpdate,this),this.viewer=null),e&&(this.viewer=e.setup.viewer,this.viewer.ins.variant.on("value",this.onUpdate,this),this.viewer.ins.shader.on("value",this.onUpdate,this))}async setFocus(){await this.updateComplete;this.getElementsByTagName("sv-property-options")[0].focus()}onClose(t){this.parentElement.dispatchEvent(new CustomEvent("close")),t.stopPropagation()}};v=m([(0,h.EM)("sv-render-tool-view")],v);var y=i(9660),b=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class _ extends h.Ay{createView(){return new x(this)}}_.typeName="CVEnvironmentTool",_.text="Environment",_.icon="environment";let x=class extends h.iv{firstConnected(){super.firstConnected(),this.classList.add("sv-group","sv-environment-tool-view")}render(){this.tool;if(!this.activeDocument)return h.qy`No active document`;const t=this.activeDocument.setup,e=t.grid,i=t.floor,n=t.background,s=n.ins.style.getValidatedValue()===y.z.Solid,r=t.environment,o=t.language;return h.qy`<div class="sv-section"><ff-button class="sv-section-lead" title=${o.getLocalizedString("Close Tool")} @click=${this.onClose} transparent icon="close"></ff-button>
            <div class="sv-tool-controls">
                <sv-property-options .property=${n.ins.style} .language=${o} .options=${["Solid","Linear","Radial"]} name=${o.getLocalizedString("Background")}></sv-property-options>
                <sv-property-color title="Background Color 1" .compact=${!0} .floating=${!1} class="sv-nogap" .property=${n.ins.color0} name=" "></sv-property-color>
                ${s?null:h.qy`<sv-property-color title="Background Color 2" .compact=${!0} .floating=${!1} class="sv-nogap" .property=${n.ins.color1} name=" "></sv-property-color>`}
                <sv-property-boolean .property=${e.ins.visible} .language=${o} name=${o.getLocalizedString("Grid")}></sv-property-boolean>
                <sv-property-color title="Grid Color" .compact=${!0} .floating=${!1} class="sv-nogap" .property=${e.ins.color} name=" "></sv-property-color>
                <sv-property-boolean .property=${i.ins.visible} .language=${o} name=${o.getLocalizedString("Floor")}></sv-property-boolean>
                <sv-property-color title="Floor Color" .compact=${!0} .floating=${!1} class="sv-nogap" .property=${i.ins.color} name=" "></sv-property-color>
                <sv-property-options .property=${r.ins.imageIndex} name="Env Map"></sv-property-options>
            </div>
        </div>`}onActiveDocument(t,e){if(t){t.setup.background.ins.style.off("value",this.onUpdate,this)}if(e){e.setup.background.ins.style.on("value",this.onUpdate,this)}this.requestUpdate()}async setFocus(){await this.updateComplete;this.getElementsByTagName("sv-property-options")[0].focus()}onClose(t){this.parentElement.dispatchEvent(new CustomEvent("close")),t.stopPropagation()}};x=b([(0,h.EM)("sv-environment-tool-view")],x);var w=i(2464),E=(i(812),i(3751),i(6943),i(5623)),C=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class S extends h.Ay{constructor(){super(...arguments),this.lights=[],this.ins=this.addInputs(S.ins),this.outs=this.addOutputs(S.outs)}update(t){return this.outs.light.setValue(this.lights[this.ins.light.getValidatedValue()]),!0}createView(){return new I(this)}onActiveDocument(t,e){var i;this.lights=e?e.getInnerComponents(w.A).filter(t=>t.ins.enabled.value):[],this.ins.light.setOptions(this.lights.map(t=>t.ins.name.value)),this.outs.light.setValue(null!==(i=this.lights[0])&&void 0!==i?i:null),super.onActiveDocument(t,e)}}S.typeName="CVLightTool",S.text="Lights",S.icon="bulb",S.ins={light:h.gK.Option("Tool.Light",[])},S.outs={light:h.gK.Object("Tool.SelectedLight",w.A)};let I=class extends h.iv{constructor(){super(...arguments),this.lights=null}firstConnected(){super.firstConnected(),this.classList.add("sv-group","sv-light-tool-view")}connected(){super.connected(),this.tool.outs.light.on("value",this.onUpdate,this)}disconnected(){this.tool.outs.light.off("value",this.onUpdate,this),super.disconnected()}render(){const t=this.tool,e=t.lights,i=this.activeDocument;if(!e||!i||0==e.length)return h.qy`<div class="sv-section sv-centered">No editable lights in this scene.</div>`;const n=t.outs.light.value,s=i.setup.navigation,r=i.setup.language,o=h.qy`<sv-property-color .property=${n.ins.color} .compact=${!0} .floating=${!1} name=${r.getLocalizedString("Color")}></sv-property-color>`,a=n?h.qy`<div class="sv-section">
            <ff-button class="sv-section-lead" transparent tabbingIndex="-1" icon="cog"></ff-button>
            <div class="sv-tool-controls">
                <!-- <sv-property-boolean .property=${n.ins.visible} name="Switch"></sv-property-boolean> -->
                <sv-property-slider .property=${n.ins.intensity} name=${r.getLocalizedString("Intensity")} min="0" max="2"></sv-property-slider>
                ${n.is(E.A)?null:o}
            </div>
        </div>`:null;return h.qy`${a}<div class="sv-section"><ff-button class="sv-section-lead" title=${r.getLocalizedString("Close Tool")} @click=${this.onClose} transparent icon="close"></ff-button>
            <div class="sv-tool-controls">
                <!-- <sv-property-boolean .property=${s.ins.lightsFollowCamera} name="Follow Camera"></sv-property-boolean> -->
                <sv-property-options .property=${t.ins.light} .language=${r} name=${r.getLocalizedString("Select Scene Light")}></sv-property-options>
            </div>
        </div>`}onActiveDocument(t,e){t&&t.setup.navigation.ins.lightsFollowCamera.off("value",this.onUpdate,this),e&&e.setup.navigation.ins.lightsFollowCamera.on("value",this.onUpdate,this),this.requestUpdate()}onActiveNode(t,e){t&&t.light&&(t.light.ins.name.off("value",this.refreshLightList,this),t.light.ins.enabled.off("value",this.refreshLights,this)),e&&e.light&&(e.light.ins.enabled.on("value",this.refreshLights,this),e.light.ins.name.on("value",this.refreshLightList,this))}refreshLights(){this.tool.lights=this.activeDocument.getInnerComponents(w.A).filter(t=>t.ins.enabled.value),this.refreshLightList()}refreshLightList(){this.tool.ins.light.setOptions(this.tool.lights.map(t=>t.ins.name.value))}async setFocus(){await this.updateComplete;const t=this.getElementsByTagName("sv-property-options")[0];null==t||t.focus()}onClose(t){this.parentElement.dispatchEvent(new CustomEvent("close")),t.stopPropagation()}};I=C([(0,h.EM)("sv-light-tool-view")],I);i(9851);var M=i(4340),T=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class B extends h.Ay{createView(){return new R(this)}}B.typeName="CVTapeTool",B.text="Measure",B.icon="tape";let R=class extends h.iv{constructor(){super(...arguments),this.firstRender=!0,this.statusMsg=""}firstConnected(){super.firstConnected(),this.classList.add("sv-group","sv-tape-tool-view")}render(){const t=this.activeDocument;if(!t)return h.qy``;this.tool;const e=t.setup.tape,i=e.ins.enabled,n=e.outs.state.value,s=e.outs.distance.value,r=t.setup.language;let o;if(i.value)if(0===s)o=r.getLocalizedString("Tap on model to set start of tape")+".";else if(n===M.j.SetStart){const e=t.root.scene.ins.units.getOptionText();o=`${s.toFixed(2)} ${e}`}else o=r.getLocalizedString("Tap on model to set end of tape")+".";else o=r.getLocalizedString("Switch on to take measurements")+".";return this.statusMsg=o,h.qy`<div class="sv-section"><ff-button class="sv-section-lead" title=${r.getLocalizedString("Close Tool")} @click=${this.onClose} transparent icon="close"></ff-button>
            <div class="sv-tool-controls">
                <sv-property-boolean .property=${i} .language=${r} name=${r.getLocalizedString("Tape Tool")}></sv-property-boolean>
                <div class="sv-property-view"><label class="ff-label ff-off">${r.getLocalizedString("Measured Distance")}</label>
                <div class="ff-string" aria-live="polite" aria-atomic="true"></div></div>
            </div></div>`}updated(t){super.updated(t);const e=this.getElementsByClassName("ff-string").item(0);e&&(e.innerHTML=this.statusMsg,this.firstRender&&(setTimeout(()=>{e.innerHTML=`<div>${this.statusMsg}</div>`},200),this.firstRender=!1))}onActiveDocument(t,e){t&&t.setup.tape.off("update",this.onUpdate,this),e&&e.setup.tape.on("update",this.onUpdate,this),this.requestUpdate()}async setFocus(){await this.updateComplete;this.getElementsByTagName("ff-button")[1].focus()}onClose(t){this.parentElement.dispatchEvent(new CustomEvent("close")),t.stopPropagation()}};R=T([(0,h.EM)("sv-tape-tool-view")],R);var P=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class L extends h.Ay{createView(){return new D(this)}}L.typeName="CVSliceTool",L.text="Slice",L.icon="knife";let D=class extends h.iv{firstConnected(){super.firstConnected(),this.classList.add("sv-group","sv-slice-tool-view")}render(){const t=this.activeDocument;if(!t)return h.qy``;this.tool;const e=t.setup.slicer,i=e.ins.enabled,n=e.ins.axis,s=e.ins.position,r=t.setup.language;return h.qy`<div class="sv-section"><ff-button class="sv-section-lead" title=${r.getLocalizedString("Close Tool")} @click=${this.onClose} transparent icon="close"></ff-button>
            <div class="sv-tool-controls">
                <sv-property-boolean .property=${i} .language=${r} name=${r.getLocalizedString("Slice Tool")}></sv-property-boolean>
                <sv-property-options .property=${n} .language=${r} name=${r.getLocalizedString("Axis")}></sv-property-options>
                <sv-property-slider .property=${s} name=${r.getLocalizedString("Position")}></sv-property-slider>
            </div>
        </div>`}onActiveDocument(t,e){this.requestUpdate()}async setFocus(){await this.updateComplete;this.getElementsByTagName("ff-button")[1].focus()}onClose(t){this.parentElement.dispatchEvent(new CustomEvent("close")),t.stopPropagation()}};D=P([(0,h.EM)("sv-slice-tool-view")],D);var N=i(1860);class O extends N.A{get toolProvider(){return this.getComponent(l.A)}createComponents(){this.createComponent(l.A),this.createComponent(f),this.createComponent(A),this.createComponent(_),this.createComponent(S),this.createComponent(B),this.createComponent(L)}}O.typeName="NVTools";const k=[a.A,l.A,f,A,_,S,B,L,O];var U,F=i(8466),z=i(2902),V=i(161),Q=i(3600),j=i(8604),G=i(7504),H=i(2154),q=i(9683),$=i(7297),W=i(2791),K=i(5007),X=i(3889),Y=i(5717),J=i(8172),Z=i(3350),tt=i(3675),et=function(){function t(t){this.__jsonld=t,this.context=this.getProperty("context"),this.id=this.getProperty("id")}return t.prototype.getProperty=function(t){var e=null;return this.__jsonld&&((e=this.__jsonld[t])||(e=this.__jsonld["@"+t])),e},t.prototype.getPropertyAsObject=function(t){var e=this.getProperty(t);return"string"==typeof e?{id:e,isIRI:!0}:e===Object(e)?e:null},t}(),it=(U=function(t,e){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},U(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}U(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),nt=function(t){function e(e){var i=t.call(this,e)||this;return i.isTransform=!0,i.isTransform=!0,i}return it(e,t),e}(et),st=i(9929),rt=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ot=function(t){function e(e,i){var n=t.call(this,e)||this;return n.options=i,n}return rt(e,t),e.prototype.getIIIFResourceType=function(){return Me.normaliseType(this.getProperty("type"))},e.prototype.getLabel=function(){var t=this.getProperty("label");return t?Re.parse(t,this.options.locale):new Re([],this.options.locale)},e.prototype.getSummary=function(){var t=this.getProperty("summary");return t?Re.parse(t,this.options.locale):new Re([],this.options.locale)},e.prototype.getDefaultLabel=function(){return this.getLabel().getValue(this.options.locale)},e.prototype.getMetadata=function(){var t=this.getProperty("metadata"),e=[];if(!t)return e;for(var i=0;i<t.length;i++){var n=t[i],s=new we(this.options.locale);s.parse(n),e.push(s)}return e},e.prototype.getRendering=function(t){for(var e=this.getRenderings(),i=0;i<e.length;i++){var n=e[i];if(n.getFormat()===t)return n}return null},e.prototype.getRenderings=function(){var t,e=[];if(!(t=this.__jsonld?this.__jsonld.rendering:this.rendering))return e;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];e.push(new ze(n,this.options))}return e},e.prototype.getRequiredStatement=function(){var t=null,e=this.getProperty("requiredStatement");return e&&(t=new we(this.options.locale)).parse(e),t},e.prototype.getService=function(t){return Me.getService(this,t)},e.prototype.getServices=function(){return Me.getServices(this)},e.prototype.getThumbnail=function(){var t=this.getProperty("thumbnail");return Array.isArray(t)&&(t=t[0]),t?new Je(t,this.options):null},e.prototype.isAnnotation=function(){return this.getIIIFResourceType()===st.es.ANNOTATION},e.prototype.isCanvas=function(){return this.getIIIFResourceType()===st.es.CANVAS},e.prototype.isCollection=function(){return this.getIIIFResourceType()===st.es.COLLECTION},e.prototype.isManifest=function(){return this.getIIIFResourceType()===st.es.MANIFEST},e.prototype.isRange=function(){return this.getIIIFResourceType()===st.es.RANGE},e.prototype.isScene=function(){return this.getIIIFResourceType()===Me.normaliseType("Scene")},e.prototype.isSequence=function(){return this.getIIIFResourceType()===st.es.SEQUENCE},e}(et),at=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),lt=function(t){function e(e,i){return t.call(this,e,i)||this}return at(e,t),e.prototype.getFormat=function(){var t=this.getProperty("format");return t?t.toLowerCase():null},e.prototype.getResources=function(){var t=[];if(!this.__jsonld.resources)return t;for(var e=0;e<this.__jsonld.resources.length;e++){var i=this.__jsonld.resources[e],n=new ce(i,this.options);t.push(n)}return t},e.prototype.getType=function(){var t=this.getProperty("type");return t?Me.normaliseType(t):null},e.prototype.getWidth=function(){return this.getProperty("width")},e.prototype.getHeight=function(){return this.getProperty("height")},e.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},e.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},e}(ot),ct=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ht=function(t){function e(e,i){var n=t.call(this,e,i)||this;n.index=-1,n.isLoaded=!1;var s={defaultLabel:"-",locale:"en-GB",resource:n,pessimisticAccessControl:!1};return n.options=Object.assign(s,i),n}return ct(e,t),e.prototype.getAttribution=function(){var t=this.getProperty("attribution");return t?Re.parse(t,this.options.locale):new Re([],this.options.locale)},e.prototype.getDescription=function(){var t=this.getProperty("description");return t?Re.parse(t,this.options.locale):new Re([],this.options.locale)},e.prototype.getHomepage=function(){var t=this.getProperty("homepage");return t?"string"==typeof t?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||t.id):null},e.prototype.getIIIFResourceType=function(){return Me.normaliseType(this.getProperty("type"))},e.prototype.getLogo=function(){var t=this.getProperty("logo");if(!t){var e=this.getProperty("provider");if(!e)return null;var i=e.find(function(t){return void 0!==t.logo});t=i&&void 0!==i.logo?i.logo:null}return t?"string"==typeof t?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||(null==t?void 0:t.id)):null},e.prototype.getLicense=function(){return Me.getLocalisedValue(this.getProperty("license"),this.options.locale)},e.prototype.getRights=function(){var t=this.getProperty("rights");return t?"string"==typeof t?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||t.id):null},e.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},e.prototype.getRelated=function(){return this.getProperty("related")},e.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},e.prototype.getTrackingLabel=function(){var t=this.getService(st.bB.TRACKING_EXTENSIONS);return t?t.getProperty("trackingLabel"):""},e.prototype.getDefaultTree=function(){return this.defaultTree=new ii("root"),this.defaultTree.data=this,this.defaultTree},e.prototype.getRequiredStatement=function(){var t=null,e=this.getProperty("requiredStatement");if(e)(t=new we(this.options.locale)).parse(e);else{var i=this.getAttribution();i&&i.length&&((t=new we(this.options.locale)).value=i)}return t},e.prototype.isCollection=function(){return this.getIIIFResourceType()===st.es.COLLECTION},e.prototype.isManifest=function(){return this.getIIIFResourceType()===st.es.MANIFEST},e.prototype.load=function(){var t=this;return new Promise(function(e){if(t.isLoaded)e(t);else{var i=t.options;i.navDate=t.getNavDate();var n=t.__jsonld.id;n||(n=t.__jsonld["@id"]),Me.loadManifest(n).then(function(n){t.parentLabel=t.getLabel().getValue(i.locale);var s=He.parse(n,i);(t=Object.assign(t,s)).index=i.index,e(t)})}})},e}(ot),ut=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),dt=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.isAnnotationBody=!1,n.isSpecificResource=!0,n.isSpecificResource=!0,n}return ut(e,t),e.prototype.getScope=function(){var t=this.getPropertyAsObject("scope");if(null==t?void 0:t.isIRI)return t;if(t){var e=[].concat(t)[0];if(e&&"Annotation"===e.type)return new ce(e,this.options)}return null},e.prototype.getSource=function(){var t=this.getPropertyAsObject("source");if(t.isIRI)return t;if(t){var e=[].concat(t)[0];if(["Scene","Canvas"].includes(e.type))return e}if(t){var i=[].concat(t)[0];if(i)return Et.BuildFromJson(i,this.options)}throw new Error("cannot resolve Source "+JSON.stringify(t))},Object.defineProperty(e.prototype,"Source",{get:function(){return this.getSource()},enumerable:!1,configurable:!0}),e.prototype.getSelector=function(){var t=this.getProperty("selector");if(t){var e=[].concat(t)[0];if(e&&"PointSelector"===e.type)return new Oe(e);throw new Error("unable to resolve SpecificResource selector "+JSON.stringify(this.__jsonld))}return null},Object.defineProperty(e.prototype,"Selector",{get:function(){return this.getSelector()},enumerable:!1,configurable:!0}),e.prototype.getTransform=function(){for(var t=[],e=this.getProperty("transform"),i=0;i<e.length;++i){var n=e[i];t.push(ei.BuildFromJson(n))}return t},Object.defineProperty(e.prototype,"Transform",{get:function(){return this.getTransform()},enumerable:!1,configurable:!0}),e}(ot),pt=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ft=function(t){function e(e,i){return t.call(this,e,i)||this}return pt(e,t),e.prototype.getResourceID=function(){if(this.isSpecificResource()){var t=this.getSource();return t instanceof e?t.id:t||this.id}return this.id},e.prototype.getFormat=function(){var t=this.getPropertyFromSelfOrSource("format");return t?Me.getMediaType(t):null},e.prototype.getType=function(){var t=this.getPropertyFromSelfOrSource("type");return t?Me.normaliseType(t):null},e.prototype.getWidth=function(){return this.getProperty("width")},e.prototype.getHeight=function(){return this.getProperty("height")},e.prototype.getTransform=function(){return this.getProperty("transform")?this.getProperty("transform").map(function(t){return ei.BuildFromJson(t)}):null},e.prototype.getTransformMatrix=function(){var t=this.getTransform();return t&&t.length?function(t){for(var e=new Xt,i=0,n=t;i<n.length;i++){var s=n[i],r=new Xt;if(s.isTranslateTransform){var o=s.getTranslation();r.makeTranslation(o.x,o.y,o.z)}else if(s.isRotateTransform){var a=ci(s);r.makeRotationFromEuler(a)}else if(s.isScaleTransform){var l=s.getScale();r.makeScale(l.x,l.y,l.z)}e.premultiply(r)}return e}(t):null},e.prototype.getTransformSet=function(){var t=this.getTransform();return t&&t.length?function(t){for(var e=new Ot,i=new oe,n=new Ot(1,1,1),s=0,r=t;s<r.length;s++){var o=r[s];if(o.isTranslateTransform){var a=o.getTranslation();e.add(new Ot(a.x,a.y,a.z))}else if(o.isRotateTransform){var l=ci(o),c=(new Nt).setFromEuler(i),h=(new Nt).setFromEuler(l);c.premultiply(h),i.setFromQuaternion(c,"XYZ"),e.applyEuler(l)}else if(o.isScaleTransform){var u=o.getScale(),d=new Ot(u.x,u.y,u.z);n.multiply(d),e.multiply(d)}}return{translation:e,rotation:i,scale:n}}(t):null},e.prototype.getPropertyFromSelfOrSource=function(t){return this.isSpecificResource()&&this.getSource()instanceof e?this.getSource().getProperty(t):this.getProperty(t)},e.prototype.getLabelFromSelfOrSource=function(){return this.isSpecificResource()&&this.getSource()instanceof e?this.getSource().getLabel():this.getLabel()},e.prototype.getSource=function(){var t=[].concat(this.getPropertyAsObject("source"))[0];return t?!0===t.isIRI?t.id:Et.BuildFromJson(t,this.options):null},e.prototype.isModel=function(){return this.getType()===st.S3.MODEL},e.prototype.isSound=function(){return this.getType()===st.S3.SOUND},e.prototype.isSoundCaption=function(){return this.getType()===st.S3.TEXT&&"text/vtt"===this.getProperty("format").toLowerCase()},e.prototype.isSpecificResource=function(){return"SpecificResource"===this.getProperty("type")},e}(ot),gt=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),mt=function(t){function e(e,i){return t.call(this,e,i)||this}return gt(e,t),e.prototype.getColor=function(){var t=this.getPropertyFromSelfOrSource("color");return t?li.fromCSS(t):new li([255,255,255])},Object.defineProperty(e.prototype,"Color",{get:function(){return this.getColor()},enumerable:!1,configurable:!0}),e.prototype.getIntensity=function(){var t=this.getPropertyFromSelfOrSource("intensity");if(!t)return 1;try{if("Value"!==t.type||"relative"!==t.unit)throw new Error;return t.value}catch(e){throw new Error("unable to interpret raw intensity object "+JSON.stringify(t))}},Object.defineProperty(e.prototype,"Intensity",{get:function(){return this.getIntensity()},enumerable:!1,configurable:!0}),e.prototype.getAngle=function(){return this.isSpotLight()?Number(this.getPropertyFromSelfOrSource("angle")):void 0},Object.defineProperty(e.prototype,"Angle",{get:function(){return this.getAngle()},enumerable:!1,configurable:!0}),e.prototype.getLookAt=function(){var t,e,i=null!==(t=this.getPropertyAsObject("lookAt"))&&void 0!==t?t:null;if(null==i)return null;var n=null!==(e=i.type||i["@type"])&&void 0!==e?e:null;if(null==n)return null;if("Annotation"==n)return i;if("PointSelector"==n)return new Oe(i);throw new Error("unidentified value of lookAt ".concat(n))},Object.defineProperty(e.prototype,"LookAt",{get:function(){return this.getLookAt()},enumerable:!1,configurable:!0}),e.prototype.isAmbientLight=function(){return"ambientlight"===Me.normaliseType(this.getType()||"")},e.prototype.isDirectionalLight=function(){return"directionallight"===Me.normaliseType(this.getType()||"")},e.prototype.isPointLight=function(){return"pointlight"===Me.normaliseType(this.getType()||"")},e.prototype.isSpotLight=function(){return"spotlight"===Me.normaliseType(this.getType()||"")},e}(ft),At=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),vt=function(t){function e(e,i){return t.call(this,e,i)||this}return At(e,t),e.prototype.getFieldOfView=function(){if(this.isPerspectiveCamera()){var t=this.getPropertyFromSelfOrSource("fieldOfView");return t?t>0&&t<180?t:void console.warn("Camera fieldOfView out of range and will be considered undefined."):void 0}},Object.defineProperty(e.prototype,"FieldOfView",{get:function(){return this.getFieldOfView()},enumerable:!1,configurable:!0}),e.prototype.getViewHeight=function(){if(this.isOrthographicCamera()){var t=this.getProperty("viewHeight");return t||void 0}},Object.defineProperty(e.prototype,"ViewHeight",{get:function(){return this.getViewHeight()},enumerable:!1,configurable:!0}),e.prototype.getLookAt=function(){var t,e,i=null!==(t=this.getPropertyAsObject("lookAt"))&&void 0!==t?t:null;if(null==i)return null;var n=null!==(e=i.type||i["@type"])&&void 0!==e?e:null;return null==n?null:"Annotation"==n?i:"PointSelector"==n?new Oe(i):"SpecificResource"==n?new dt(i,this.options):(console.error("unidentified value of lookAt ".concat(n)),null)},Object.defineProperty(e.prototype,"LookAt",{get:function(){return this.getLookAt()},enumerable:!1,configurable:!0}),e.prototype.getNear=function(){var t=this.getPropertyFromSelfOrSource("near");return t||void 0},Object.defineProperty(e.prototype,"Near",{get:function(){return this.getNear()},enumerable:!1,configurable:!0}),e.prototype.getFar=function(){var t=this.getPropertyFromSelfOrSource("far");return t||void 0},Object.defineProperty(e.prototype,"Far",{get:function(){return this.getFar()},enumerable:!1,configurable:!0}),e.prototype.isPerspectiveCamera=function(){return"perspectivecamera"===Me.normaliseType(this.getType()||"")},e.prototype.isOrthographicCamera=function(){return"orthographiccamera"===Me.normaliseType(this.getType()||"")},e}(ft),yt=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),bt=function(t){function e(e,i){return t.call(this,e,i)||this}return yt(e,t),Object.defineProperty(e.prototype,"Value",{get:function(){return this.getProperty("value")||""},enumerable:!1,configurable:!0}),e.prototype.getPosition=function(){var t,e=null!==(t=this.getPropertyAsObject("position"))&&void 0!==t?t:null;if(null==e)return null;if(e.type&&"SpecificResource"==e.type)return new dt(e,this.options);throw new Error("unknown position type specified")},Object.defineProperty(e.prototype,"Position",{get:function(){return this.getPosition()},enumerable:!1,configurable:!0}),e}(ft),_t=["AmbientLight","DirectionalLight","PointLight","SpotLight"],xt=["PerspectiveCamera","OrthographicCamera"],wt=["Image","Document","Audio","Model","Video","Canvas","Sound","Text"],Et=function(){function t(){}return t.BuildFromJson=function(t,e){var i="SpecificResource"===t.type&&t.source?[].concat(t.source)[0].type:t.type;if(wt.includes(i))return new ft(t,e);if(_t.includes(i))return new mt(t,e);if(xt.includes(i))return new vt(t,e);if("TextualBody"===i)return new bt(t,e);throw new Error("unimplemented type for AnnotationBody: "+i)},t}();const Ct="srgb",St="srgb-linear";Symbol.iterator;const It=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Mt=1234567;const Tt=Math.PI/180,Bt=180/Math.PI;function Rt(t,e,i){return Math.max(e,Math.min(i,t))}function Pt(t,e){return(t%e+e)%e}function Lt(t,e,i){return(1-i)*t+i*e}var Dt=Object.freeze({__proto__:null,DEG2RAD:Tt,RAD2DEG:Bt,generateUUID:function(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(It[255&t]+It[t>>8&255]+It[t>>16&255]+It[t>>24&255]+"-"+It[255&e]+It[e>>8&255]+"-"+It[e>>16&15|64]+It[e>>24&255]+"-"+It[63&i|128]+It[i>>8&255]+"-"+It[i>>16&255]+It[i>>24&255]+It[255&n]+It[n>>8&255]+It[n>>16&255]+It[n>>24&255]).toLowerCase()},clamp:Rt,euclideanModulo:Pt,mapLinear:function(t,e,i,n,s){return n+(t-e)*(s-n)/(i-e)},inverseLerp:function(t,e,i){return t!==e?(i-t)/(e-t):0},lerp:Lt,damp:function(t,e,i,n){return Lt(t,e,1-Math.exp(-i*n))},pingpong:function(t,e=1){return e-Math.abs(Pt(t,2*e)-e)},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(Mt=t);let e=Mt+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*Tt},radToDeg:function(t){return t*Bt},isPowerOfTwo:function(t){return!(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,i,n,s){const r=Math.cos,o=Math.sin,a=r(i/2),l=o(i/2),c=r((e+n)/2),h=o((e+n)/2),u=r((e-n)/2),d=o((e-n)/2),p=r((n-e)/2),f=o((n-e)/2);switch(s){case"XYX":t.set(a*h,l*u,l*d,a*c);break;case"YZY":t.set(l*d,a*h,l*u,a*c);break;case"ZXZ":t.set(l*u,l*d,a*h,a*c);break;case"XZX":t.set(a*h,l*f,l*p,a*c);break;case"YXY":t.set(l*p,a*h,l*f,a*c);break;case"ZYZ":t.set(l*f,l*p,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}},normalize:function(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}},denormalize:function(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}});class Nt{constructor(t=0,e=0,i=0,n=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=i,this._w=n}static slerpFlat(t,e,i,n,s,r,o){let a=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3];const u=s[r+0],d=s[r+1],p=s[r+2],f=s[r+3];if(0===o)return t[e+0]=a,t[e+1]=l,t[e+2]=c,void(t[e+3]=h);if(1===o)return t[e+0]=u,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(h!==f||a!==u||l!==d||c!==p){let t=1-o;const e=a*u+l*d+c*p+h*f,i=e>=0?1:-1,n=1-e*e;if(n>Number.EPSILON){const s=Math.sqrt(n),r=Math.atan2(s,e*i);t=Math.sin(t*r)/s,o=Math.sin(o*r)/s}const s=o*i;if(a=a*t+u*s,l=l*t+d*s,c=c*t+p*s,h=h*t+f*s,t===1-o){const t=1/Math.sqrt(a*a+l*l+c*c+h*h);a*=t,l*=t,c*=t,h*=t}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=h}static multiplyQuaternionsFlat(t,e,i,n,s,r){const o=i[n],a=i[n+1],l=i[n+2],c=i[n+3],h=s[r],u=s[r+1],d=s[r+2],p=s[r+3];return t[e]=o*p+c*h+a*d-l*u,t[e+1]=a*p+c*u+l*h-o*d,t[e+2]=l*p+c*d+o*u-a*h,t[e+3]=c*p-o*h-a*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const i=t._x,n=t._y,s=t._z,r=t._order,o=Math.cos,a=Math.sin,l=o(i/2),c=o(n/2),h=o(s/2),u=a(i/2),d=a(n/2),p=a(s/2);switch(r){case"XYZ":this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p;break;case"YXZ":this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p;break;case"ZXY":this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p;break;case"ZYX":this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p;break;case"YZX":this._x=u*c*h+l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h-u*d*p;break;case"XZY":this._x=u*c*h-l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h+u*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+r)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,i=e[0],n=e[4],s=e[8],r=e[1],o=e[5],a=e[9],l=e[2],c=e[6],h=e[10],u=i+o+h;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(c-a)*t,this._y=(s-l)*t,this._z=(r-n)*t}else if(i>o&&i>h){const t=2*Math.sqrt(1+i-o-h);this._w=(c-a)/t,this._x=.25*t,this._y=(n+r)/t,this._z=(s+l)/t}else if(o>h){const t=2*Math.sqrt(1+o-i-h);this._w=(s-l)/t,this._x=(n+r)/t,this._y=.25*t,this._z=(a+c)/t}else{const t=2*Math.sqrt(1+h-i-o);this._w=(r-n)/t,this._x=(s+l)/t,this._y=(a+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Rt(this.dot(t),-1,1)))}rotateTowards(t,e){const i=this.angleTo(t);if(0===i)return this;const n=Math.min(1,e/i);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const i=t._x,n=t._y,s=t._z,r=t._w,o=e._x,a=e._y,l=e._z,c=e._w;return this._x=i*c+r*o+n*l-s*a,this._y=n*c+r*a+s*o-i*l,this._z=s*c+r*l+i*a-n*o,this._w=r*c-i*o-n*a-s*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const i=this._x,n=this._y,s=this._z,r=this._w;let o=r*t._w+i*t._x+n*t._y+s*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=r,this._x=i,this._y=n,this._z=s,this;const a=1-o*o;if(a<=Number.EPSILON){const t=1-e;return this._w=t*r+e*this._w,this._x=t*i+e*this._x,this._y=t*n+e*this._y,this._z=t*s+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),h=Math.sin((1-e)*c)/l,u=Math.sin(e*c)/l;return this._w=r*h+this._w*u,this._x=i*h+this._x*u,this._y=n*h+this._y*u,this._z=s*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,i){return this.copy(t).slerp(e,i)}random(){const t=Math.random(),e=Math.sqrt(1-t),i=Math.sqrt(t),n=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(e*Math.cos(n),i*Math.sin(s),i*Math.cos(s),e*Math.sin(n))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ot{constructor(t=0,e=0,i=0){Ot.prototype.isVector3=!0,this.x=t,this.y=e,this.z=i}set(t,e,i){return void 0===i&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(Ut.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Ut.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*e+s[3]*i+s[6]*n,this.y=s[1]*e+s[4]*i+s[7]*n,this.z=s[2]*e+s[5]*i+s[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,s=t.elements,r=1/(s[3]*e+s[7]*i+s[11]*n+s[15]);return this.x=(s[0]*e+s[4]*i+s[8]*n+s[12])*r,this.y=(s[1]*e+s[5]*i+s[9]*n+s[13])*r,this.z=(s[2]*e+s[6]*i+s[10]*n+s[14])*r,this}applyQuaternion(t){const e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,o=t.z,a=t.w,l=a*e+r*n-o*i,c=a*i+o*e-s*n,h=a*n+s*i-r*e,u=-s*e-r*i-o*n;return this.x=l*a+u*-s+c*-o-h*-r,this.y=c*a+u*-r+h*-s-l*-o,this.z=h*a+u*-o+l*-r-c*-s,this}transformDirection(t){const e=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*n,this.y=s[1]*e+s[5]*i+s[9]*n,this.z=s[2]*e+s[6]*i+s[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const i=t.x,n=t.y,s=t.z,r=e.x,o=e.y,a=e.z;return this.x=n*a-s*o,this.y=s*r-i*a,this.z=i*o-n*r,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return kt.copy(this).projectOnVector(t),this.sub(kt)}reflect(t){return this.sub(kt.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(Rt(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){const n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,i=Math.sqrt(1-t**2);return this.x=i*Math.cos(e),this.y=i*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const kt=new Ot,Ut=new Nt;function Ft(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function zt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}const Vt={[Ct]:{[St]:Ft},[St]:{[Ct]:zt}},Qt={legacyMode:!0,get workingColorSpace(){return St},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,i){if(this.legacyMode||e===i||!e||!i)return t;if(Vt[e]&&void 0!==Vt[e][i]){const n=Vt[e][i];return t.r=n(t.r),t.g=n(t.g),t.b=n(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},jt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Gt={r:0,g:0,b:0},Ht={h:0,s:0,l:0},qt={h:0,s:0,l:0};function $t(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}function Wt(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}class Kt{constructor(t,e,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=Ct){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Qt.toWorkingColorSpace(this,e),this}setRGB(t,e,i,n=Qt.workingColorSpace){return this.r=t,this.g=e,this.b=i,Qt.toWorkingColorSpace(this,n),this}setHSL(t,e,i,n=Qt.workingColorSpace){if(t=Pt(t,1),e=Rt(e,0,1),i=Rt(i,0,1),0===e)this.r=this.g=this.b=i;else{const n=i<=.5?i*(1+e):i+e-i*e,s=2*i-n;this.r=$t(s,n,t+1/3),this.g=$t(s,n,t),this.b=$t(s,n,t-1/3)}return Qt.toWorkingColorSpace(this,n),this}setStyle(t,e=Ct){function i(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const s=n[1],r=n[2];switch(s){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,Qt.toWorkingColorSpace(this,e),i(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,Qt.toWorkingColorSpace(this,e),i(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r)){const n=parseFloat(t[1])/360,s=parseFloat(t[2])/100,r=parseFloat(t[3])/100;return i(t[4]),this.setHSL(n,s,r,e)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=n[1],i=t.length;if(3===i)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,Qt.toWorkingColorSpace(this,e),this;if(6===i)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,Qt.toWorkingColorSpace(this,e),this}return t&&t.length>0?this.setColorName(t,e):this}setColorName(t,e=Ct){const i=jt[t.toLowerCase()];return void 0!==i?this.setHex(i,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Ft(t.r),this.g=Ft(t.g),this.b=Ft(t.b),this}copyLinearToSRGB(t){return this.r=zt(t.r),this.g=zt(t.g),this.b=zt(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Ct){return Qt.fromWorkingColorSpace(Wt(this,Gt),t),Rt(255*Gt.r,0,255)<<16^Rt(255*Gt.g,0,255)<<8^Rt(255*Gt.b,0,255)}getHexString(t=Ct){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Qt.workingColorSpace){Qt.fromWorkingColorSpace(Wt(this,Gt),e);const i=Gt.r,n=Gt.g,s=Gt.b,r=Math.max(i,n,s),o=Math.min(i,n,s);let a,l;const c=(o+r)/2;if(o===r)a=0,l=0;else{const t=r-o;switch(l=c<=.5?t/(r+o):t/(2-r-o),r){case i:a=(n-s)/t+(n<s?6:0);break;case n:a=(s-i)/t+2;break;case s:a=(i-n)/t+4}a/=6}return t.h=a,t.s=l,t.l=c,t}getRGB(t,e=Qt.workingColorSpace){return Qt.fromWorkingColorSpace(Wt(this,Gt),e),t.r=Gt.r,t.g=Gt.g,t.b=Gt.b,t}getStyle(t=Ct){return Qt.fromWorkingColorSpace(Wt(this,Gt),t),t!==Ct?`color(${t} ${Gt.r} ${Gt.g} ${Gt.b})`:`rgb(${255*Gt.r|0},${255*Gt.g|0},${255*Gt.b|0})`}offsetHSL(t,e,i){return this.getHSL(Ht),Ht.h+=t,Ht.s+=e,Ht.l+=i,this.setHSL(Ht.h,Ht.s,Ht.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}lerpHSL(t,e){this.getHSL(Ht),t.getHSL(qt);const i=Lt(Ht.h,qt.h,e),n=Lt(Ht.s,qt.s,e),s=Lt(Ht.l,qt.l,e);return this.setHSL(i,n,s),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}Kt.NAMES=jt;class Xt{constructor(){Xt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,e,i,n,s,r,o,a,l,c,h,u,d,p,f,g){const m=this.elements;return m[0]=t,m[4]=e,m[8]=i,m[12]=n,m[1]=s,m[5]=r,m[9]=o,m[13]=a,m[2]=l,m[6]=c,m[10]=h,m[14]=u,m[3]=d,m[7]=p,m[11]=f,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Xt).fromArray(this.elements)}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){const e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,i=t.elements,n=1/Yt.setFromMatrixColumn(t,0).length(),s=1/Yt.setFromMatrixColumn(t,1).length(),r=1/Yt.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*s,e[5]=i[5]*s,e[6]=i[6]*s,e[7]=0,e[8]=i[8]*r,e[9]=i[9]*r,e[10]=i[10]*r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,i=t.x,n=t.y,s=t.z,r=Math.cos(i),o=Math.sin(i),a=Math.cos(n),l=Math.sin(n),c=Math.cos(s),h=Math.sin(s);if("XYZ"===t.order){const t=r*c,i=r*h,n=o*c,s=o*h;e[0]=a*c,e[4]=-a*h,e[8]=l,e[1]=i+n*l,e[5]=t-s*l,e[9]=-o*a,e[2]=s-t*l,e[6]=n+i*l,e[10]=r*a}else if("YXZ"===t.order){const t=a*c,i=a*h,n=l*c,s=l*h;e[0]=t+s*o,e[4]=n*o-i,e[8]=r*l,e[1]=r*h,e[5]=r*c,e[9]=-o,e[2]=i*o-n,e[6]=s+t*o,e[10]=r*a}else if("ZXY"===t.order){const t=a*c,i=a*h,n=l*c,s=l*h;e[0]=t-s*o,e[4]=-r*h,e[8]=n+i*o,e[1]=i+n*o,e[5]=r*c,e[9]=s-t*o,e[2]=-r*l,e[6]=o,e[10]=r*a}else if("ZYX"===t.order){const t=r*c,i=r*h,n=o*c,s=o*h;e[0]=a*c,e[4]=n*l-i,e[8]=t*l+s,e[1]=a*h,e[5]=s*l+t,e[9]=i*l-n,e[2]=-l,e[6]=o*a,e[10]=r*a}else if("YZX"===t.order){const t=r*a,i=r*l,n=o*a,s=o*l;e[0]=a*c,e[4]=s-t*h,e[8]=n*h+i,e[1]=h,e[5]=r*c,e[9]=-o*c,e[2]=-l*c,e[6]=i*h+n,e[10]=t-s*h}else if("XZY"===t.order){const t=r*a,i=r*l,n=o*a,s=o*l;e[0]=a*c,e[4]=-h,e[8]=l*c,e[1]=t*h+s,e[5]=r*c,e[9]=i*h-n,e[2]=n*h-i,e[6]=o*c,e[10]=s*h+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Zt,t,te)}lookAt(t,e,i){const n=this.elements;return ne.subVectors(t,e),0===ne.lengthSq()&&(ne.z=1),ne.normalize(),ee.crossVectors(i,ne),0===ee.lengthSq()&&(1===Math.abs(i.z)?ne.x+=1e-4:ne.z+=1e-4,ne.normalize(),ee.crossVectors(i,ne)),ee.normalize(),ie.crossVectors(ne,ee),n[0]=ee.x,n[4]=ie.x,n[8]=ne.x,n[1]=ee.y,n[5]=ie.y,n[9]=ne.y,n[2]=ee.z,n[6]=ie.z,n[10]=ne.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,s=this.elements,r=i[0],o=i[4],a=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],p=i[2],f=i[6],g=i[10],m=i[14],A=i[3],v=i[7],y=i[11],b=i[15],_=n[0],x=n[4],w=n[8],E=n[12],C=n[1],S=n[5],I=n[9],M=n[13],T=n[2],B=n[6],R=n[10],P=n[14],L=n[3],D=n[7],N=n[11],O=n[15];return s[0]=r*_+o*C+a*T+l*L,s[4]=r*x+o*S+a*B+l*D,s[8]=r*w+o*I+a*R+l*N,s[12]=r*E+o*M+a*P+l*O,s[1]=c*_+h*C+u*T+d*L,s[5]=c*x+h*S+u*B+d*D,s[9]=c*w+h*I+u*R+d*N,s[13]=c*E+h*M+u*P+d*O,s[2]=p*_+f*C+g*T+m*L,s[6]=p*x+f*S+g*B+m*D,s[10]=p*w+f*I+g*R+m*N,s[14]=p*E+f*M+g*P+m*O,s[3]=A*_+v*C+y*T+b*L,s[7]=A*x+v*S+y*B+b*D,s[11]=A*w+v*I+y*R+b*N,s[15]=A*E+v*M+y*P+b*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[4],n=t[8],s=t[12],r=t[1],o=t[5],a=t[9],l=t[13],c=t[2],h=t[6],u=t[10],d=t[14];return t[3]*(+s*a*h-n*l*h-s*o*u+i*l*u+n*o*d-i*a*d)+t[7]*(+e*a*d-e*l*u+s*r*u-n*r*d+n*l*c-s*a*c)+t[11]*(+e*l*h-e*o*d-s*r*h+i*r*d+s*o*c-i*l*c)+t[15]*(-n*o*c-e*a*h+e*o*u+n*r*h-i*r*u+i*a*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){const n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15],A=h*g*l-f*u*l+f*a*d-o*g*d-h*a*m+o*u*m,v=p*u*l-c*g*l-p*a*d+r*g*d+c*a*m-r*u*m,y=c*f*l-p*h*l+p*o*d-r*f*d-c*o*m+r*h*m,b=p*h*a-c*f*a-p*o*u+r*f*u+c*o*g-r*h*g,_=e*A+i*v+n*y+s*b;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/_;return t[0]=A*x,t[1]=(f*u*s-h*g*s-f*n*d+i*g*d+h*n*m-i*u*m)*x,t[2]=(o*g*s-f*a*s+f*n*l-i*g*l-o*n*m+i*a*m)*x,t[3]=(h*a*s-o*u*s-h*n*l+i*u*l+o*n*d-i*a*d)*x,t[4]=v*x,t[5]=(c*g*s-p*u*s+p*n*d-e*g*d-c*n*m+e*u*m)*x,t[6]=(p*a*s-r*g*s-p*n*l+e*g*l+r*n*m-e*a*m)*x,t[7]=(r*u*s-c*a*s+c*n*l-e*u*l-r*n*d+e*a*d)*x,t[8]=y*x,t[9]=(p*h*s-c*f*s-p*i*d+e*f*d+c*i*m-e*h*m)*x,t[10]=(r*f*s-p*o*s+p*i*l-e*f*l-r*i*m+e*o*m)*x,t[11]=(c*o*s-r*h*s-c*i*l+e*h*l+r*i*d-e*o*d)*x,t[12]=b*x,t[13]=(c*f*n-p*h*n+p*i*u-e*f*u-c*i*g+e*h*g)*x,t[14]=(p*o*n-r*f*n-p*i*a+e*f*a+r*i*g-e*o*g)*x,t[15]=(r*h*n-c*o*n+c*i*a-e*h*a-r*i*u+e*o*u)*x,this}scale(t){const e=this.elements,i=t.x,n=t.y,s=t.z;return e[0]*=i,e[4]*=n,e[8]*=s,e[1]*=i,e[5]*=n,e[9]*=s,e[2]*=i,e[6]*=n,e[10]*=s,e[3]*=i,e[7]*=n,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}makeTranslation(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const i=Math.cos(e),n=Math.sin(e),s=1-i,r=t.x,o=t.y,a=t.z,l=s*r,c=s*o;return this.set(l*r+i,l*o-n*a,l*a+n*o,0,l*o+n*a,c*o+i,c*a-n*r,0,l*a-n*o,c*a+n*r,s*a*a+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i,n,s,r){return this.set(1,i,s,0,t,1,r,0,e,n,1,0,0,0,0,1),this}compose(t,e,i){const n=this.elements,s=e._x,r=e._y,o=e._z,a=e._w,l=s+s,c=r+r,h=o+o,u=s*l,d=s*c,p=s*h,f=r*c,g=r*h,m=o*h,A=a*l,v=a*c,y=a*h,b=i.x,_=i.y,x=i.z;return n[0]=(1-(f+m))*b,n[1]=(d+y)*b,n[2]=(p-v)*b,n[3]=0,n[4]=(d-y)*_,n[5]=(1-(u+m))*_,n[6]=(g+A)*_,n[7]=0,n[8]=(p+v)*x,n[9]=(g-A)*x,n[10]=(1-(u+f))*x,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,i){const n=this.elements;let s=Yt.set(n[0],n[1],n[2]).length();const r=Yt.set(n[4],n[5],n[6]).length(),o=Yt.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),t.x=n[12],t.y=n[13],t.z=n[14],Jt.copy(this);const a=1/s,l=1/r,c=1/o;return Jt.elements[0]*=a,Jt.elements[1]*=a,Jt.elements[2]*=a,Jt.elements[4]*=l,Jt.elements[5]*=l,Jt.elements[6]*=l,Jt.elements[8]*=c,Jt.elements[9]*=c,Jt.elements[10]*=c,e.setFromRotationMatrix(Jt),i.x=s,i.y=r,i.z=o,this}makePerspective(t,e,i,n,s,r){const o=this.elements,a=2*s/(e-t),l=2*s/(i-n),c=(e+t)/(e-t),h=(i+n)/(i-n),u=-(r+s)/(r-s),d=-2*r*s/(r-s);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,i,n,s,r){const o=this.elements,a=1/(e-t),l=1/(i-n),c=1/(r-s),h=(e+t)*a,u=(i+n)*l,d=(r+s)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,i=t.elements;for(let t=0;t<16;t++)if(e[t]!==i[t])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}const Yt=new Ot,Jt=new Xt,Zt=new Ot(0,0,0),te=new Ot(1,1,1),ee=new Ot,ie=new Ot,ne=new Ot,se=new Xt,re=new Nt;class oe{constructor(t=0,e=0,i=0,n=oe.DefaultOrder){this.isEuler=!0,this._x=t,this._y=e,this._z=i,this._order=n}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,i,n=this._order){return this._x=t,this._y=e,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,i=!0){const n=t.elements,s=n[0],r=n[4],o=n[8],a=n[1],l=n[5],c=n[9],h=n[2],u=n[6],d=n[10];switch(e){case"XYZ":this._y=Math.asin(Rt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-r,s)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Rt(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Rt(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-r,l)):(this._y=0,this._z=Math.atan2(a,s));break;case"ZYX":this._y=Math.asin(-Rt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(a,s)):(this._x=0,this._z=Math.atan2(-r,l));break;case"YZX":this._z=Math.asin(Rt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Rt(r,-1,1)),Math.abs(r)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===i&&this._onChangeCallback(),this}setFromQuaternion(t,e,i){return se.makeRotationFromQuaternion(t),this.setFromRotationMatrix(se,e,i)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return re.setFromEuler(this),this.setFromQuaternion(re,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}oe.DefaultOrder="XYZ",oe.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];Symbol.iterator;var ae,le=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ce=function(t){function e(e,i){return t.call(this,e,i)||this}return le(e,t),e.prototype.getBody=function(){var t=[],e=this.getProperty("bodyValue");if(e)return[new bt({id:"https://example.com/TextualBody/1",value:e,type:"TextualBody"},this.options)];var i=this.getProperty("body");if(i)for(var n=0,s=[].concat(i);n<s.length;n++){var r=s[n],o=r.items;o?t=t.concat(this.parseBodiesFromItemsList(o)):t.push(this.parseSingletonBody(r))}return t},Object.defineProperty(e.prototype,"Body",{get:function(){return this.getBody()},enumerable:!1,configurable:!0}),e.prototype.parseBodiesFromItemsList=function(t){for(var e=[],i=0,n=[].concat(t);i<n.length;i++){var s=n[i];e.push(this.parseSingletonBody(s))}return e},e.prototype.parseSingletonBody=function(t){return Et.BuildFromJson(t,this.options)},e.prototype.getBody3D=function(){return console.warn("Annotation.getBody3D is deprecated: replace with getBody3D() with getBody()[0]"),this.getBody()[0]},e.prototype.getMotivation=function(){var t=this.getProperty("motivation");return t||null},e.prototype.getOn=function(){return this.getProperty("on")},e.prototype.getTarget=function(){var t=this.getPropertyAsObject("target");if(t.isIRI)return t;if(t.type&&"SpecificResource"==t.type)return new dt(t,this.options);if(["Scene","Canvas"].includes(t.type))return t;throw new Error("unknown target specified")},Object.defineProperty(e.prototype,"Target",{get:function(){return this.getTarget()},enumerable:!1,configurable:!0}),e.prototype.getScopeContent=function(){var t,i,n,s=this,r=null===(n=null===(i=null===(t=this.getTarget())||void 0===t?void 0:t.getScope())||void 0===i?void 0:i.getTarget())||void 0===n?void 0:n.items;return r?r.filter(function(t){return t&&"AnnotationPage"===t.type}).map(function(t){return new pe(t,s.options).getItems()}).flat().filter(function(t){return t&&"Annotation"===t.type}).map(function(t){return new e(t,s.options)}):[]},Object.defineProperty(e.prototype,"ScopeContent",{get:function(){return this.getScopeContent()},enumerable:!1,configurable:!0}),e.prototype.getResource=function(){return new lt(this.getProperty("resource"),this.options)},Object.defineProperty(e.prototype,"LookAtLocation",{get:function(){var t,e=this.getTarget();return e.isSpecificResource&&(null===(t=e.getSelector())||void 0===t?void 0:t.isPointSelector)?e.getSelector().getLocation():new Ot(0,0,0)},enumerable:!1,configurable:!0}),e}(ot),he=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ue=function(t){function e(e,i,n){var s=t.call(this,i)||this;return s.label=e,s.options=n,s}return he(e,t),e.prototype.getIIIFResourceType=function(){return Me.normaliseType(this.getProperty("type"))},e.prototype.getLabel=function(){return this.label},e.prototype.getResources=function(){var t=this;return this.getProperty("resources").map(function(e){return new ce(e,t.options)})},e.prototype.load=function(){var t=this;return new Promise(function(e,i){if(t.isLoaded)e(t);else{var n=t.__jsonld.id;n||(n=t.__jsonld["@id"]),Me.loadManifest(n).then(function(i){t.__jsonld=i,t.context=t.getProperty("context"),t.id=t.getProperty("id"),t.isLoaded=!0,e(t)}).catch(i)}})},e}(et),de=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),pe=function(t){function e(e,i){return t.call(this,e,i)||this}return de(e,t),e.prototype.getItems=function(){return this.getProperty("items")},e}(ot),fe=i(2046),ge=i.n(fe),me=i(9820),Ae=i.n(me),ve=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ye=function(t){function e(e,i){return t.call(this,e,i)||this}return ve(e,t),e.prototype.getCanonicalImageUri=function(t){var e,i=null,n="default",s=t;if(this.externalResource&&this.externalResource.data&&this.externalResource.data["@id"])i=this.externalResource.data["@id"],s||(s=this.externalResource.data.width),this.externalResource.data["@context"]&&(this.externalResource.data["@context"].indexOf("/1.0/context.json")>-1||this.externalResource.data["@context"].indexOf("/1.1/context.json")>-1||this.externalResource.data["@context"].indexOf("/1/context.json")>-1)&&(n="native");else{var r=void 0;if((r=this.getImages())&&r.length){var o=r[0].getResource(),a=o.getServices();if(s||(s=o.getWidth()),l=a?a.find(function(t){return Me.isImageProfile(t.getProfile())||Me.isImageServiceType(t.getIIIFResourceType())}):null)i=l.id,n=Me.getImageQuality(l.getProfile());else if(s===o.getWidth())return o.id}if((r=this.getContent())&&r.length){var l,c=r[0].getBody()[0];a=c.getServices();if(s||(s=c.getWidth()),l=a?a.find(function(t){return Me.isImageServiceType(t.getIIIFResourceType())}):null)i=l.id,n=Me.getImageQuality(l.getProfile());else if(s===c.getWidth())return c.id}if(!i){var h=this.getProperty("thumbnail");if(h){if("string"==typeof h)return h;if(h["@id"])return h["@id"];if(h.length)return h[0].id}}}return e=s+",",i&&i.endsWith("/")&&(i=i.substr(0,i.length-1)),[i,"full",e,0,n+".jpg"].join("/")},e.prototype.getMaxDimensions=function(){var t,e=null;return this.externalResource&&this.externalResource.data&&this.externalResource.data.profile&&(t=this.externalResource.data.profile,Array.isArray(t)&&(t=t.filter(function(t){var e;return null!==(e=t.maxWidth)&&void 0!==e?e:t.maxwidth})[0])&&(e=new We(t.maxWidth,t.maxHeight?t.maxHeight:t.maxWidth))),e},e.prototype.getContent=function(){var t=[],e=this.__jsonld.items||this.__jsonld.content;if(!e)return t;var i=null;if(e.length&&(i=new pe(e[0],this.options)),!i)return t;for(var n=i.getItems(),s=0;s<n.length;s++){var r=n[s],o=new ce(r,this.options);t.push(o)}return t},e.prototype.getDuration=function(){return this.getProperty("duration")},e.prototype.getImages=function(){var t=[];if(!this.__jsonld.images)return t;for(var e=0;e<this.__jsonld.images.length;e++){var i=this.__jsonld.images[e],n=new ce(i,this.options);t.push(n)}return t},e.prototype.getIndex=function(){return this.getProperty("index")},e.prototype.getNonContentAnnotations=function(){var t=this,e=(this.__jsonld.annotations||[]).filter(function(t){return t&&"AnnotationPage"===t.type}).map(function(e){return new pe(e,t.options)});if(!e.length)return[];var i=e.map(function(t){return t.getItems()});return Ae()(i).map(function(e){return new ce(e,t.options)})},e.prototype.getOtherContent=function(){var t=this,e=Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")],i=e.filter(function(t){return t&&(e=t["@type"],i="sc:AnnotationList","string"==typeof e&&"string"==typeof i&&e.toLowerCase()==e.toLowerCase());var e,i}).map(function(e,i){return new ue(e.label||"Annotation list ".concat(i),e,t.options)}).map(function(t){return t.load()});return Promise.all(i)},e.prototype.getWidth=function(){return this.getProperty("width")},e.prototype.getHeight=function(){return this.getProperty("height")},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},Object.defineProperty(e.prototype,"imageResources",{get:function(){var t=this,i=Ae()([this.getImages().map(function(t){return t.getResource()}),this.getContent().map(function(t){return t.getBody()})]);return ge()(i.map(function(i){switch(i.getProperty("type").toLowerCase()){case st.S3.CHOICE:case st.S3.OA_CHOICE:return new e({images:ge()([i.getProperty("default"),i.getProperty("item")]).map(function(t){return{resource:t}})},t.options).getImages().map(function(t){return t.getResource()});default:return i}}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resourceAnnotations",{get:function(){return Ae()([this.getImages(),this.getContent()])},enumerable:!1,configurable:!0}),e.prototype.resourceAnnotation=function(t){return this.resourceAnnotations.find(function(e){return e.getResource().id===t||ge()(new Array(e.getBody())).some(function(e){return e.id===t})})},e.prototype.onFragment=function(t){var e=this.resourceAnnotation(t);if(e){var i=e.getProperty("on"),n=e.getProperty("target");if(i&&n){var s=(i||n).match(/xywh=(.*)$/);if(s)return s[1].split(",").map(function(t){return parseInt(t,10)})}}},Object.defineProperty(e.prototype,"iiifImageResources",{get:function(){return this.imageResources.filter(function(t){return t&&t.getServices()[0]&&t.getServices()[0].id})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"imageServiceIds",{get:function(){return this.iiifImageResources.map(function(t){return t.getServices()[0].id})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aspectRatio",{get:function(){return this.getWidth()/this.getHeight()},enumerable:!1,configurable:!0}),e}(lt),be=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),_e=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.items=[],n._collections=null,n._manifests=null,e.__collection=n,n}return be(e,t),e.prototype.getCollections=function(){return this._collections?this._collections:this._collections=this.items.filter(function(t){return t.isCollection()})},e.prototype.getManifests=function(){return this._manifests?this._manifests:this._manifests=this.items.filter(function(t){return t.isManifest()})},e.prototype.getCollectionByIndex=function(t){for(var e,i=this.getCollections(),n=0;n<i.length;n++){var s=i[n];s.index===t&&(e=s)}if(e)return e.options.index=t,e.load();throw new Error("Collection index not found")},e.prototype.getManifestByIndex=function(t){for(var e,i=this.getManifests(),n=0;n<i.length;n++){var s=i[n];s.index===t&&(e=s)}if(e)return e.options.index=t,e.load();throw new Error("Manifest index not found")},e.prototype.getTotalCollections=function(){return this.getCollections().length},e.prototype.getTotalManifests=function(){return this.getManifests().length},e.prototype.getTotalItems=function(){return this.items.length},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):st.T5.LEFT_TO_RIGHT},e.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e.prototype.getDefaultTree=function(){return t.prototype.getDefaultTree.call(this),this.defaultTree.data.type=Me.normaliseType(Ke.COLLECTION),this._parseManifests(this),this._parseCollections(this),Me.generateTreeNodeIds(this.defaultTree),this.defaultTree},e.prototype._parseManifests=function(t){if(t.getManifests()&&t.getManifests().length)for(var e=0;e<t.getManifests().length;e++){var i=t.getManifests()[e],n=i.getDefaultTree();n.label=i.parentLabel||i.getLabel().getValue(this.options.locale)||"manifest "+(e+1),n.navDate=i.getNavDate(),n.data.id=i.id,n.data.type=Me.normaliseType(Ke.MANIFEST),t.defaultTree.addNode(n)}},e.prototype._parseCollections=function(t){if(t.getCollections()&&t.getCollections().length)for(var e=0;e<t.getCollections().length;e++){var i=t.getCollections()[e],n=i.getDefaultTree();n.label=i.parentLabel||i.getLabel().getValue(this.options.locale)||"collection "+(e+1),n.navDate=i.getNavDate(),n.data.id=i.id,n.data.type=Me.normaliseType(Ke.COLLECTION),t.defaultTree.addNode(n)}},e}(ht),xe=function(){function t(t,e){this.start=t,this.end=e}return t.prototype.getLength=function(){return this.end-this.start},t}(),we=function(){function t(t){this.defaultLocale=t}return t.prototype.parse=function(t){this.resource=t,this.label=Re.parse(this.resource.label,this.defaultLocale),this.value=Re.parse(this.resource.value,this.defaultLocale)},t.prototype.getLabel=function(t){return null===this.label?null:(Array.isArray(t)&&!t.length&&(t=void 0),this.label.getValue(t||this.defaultLocale))},t.prototype.setLabel=function(t){null===this.label&&(this.label=new Re([])),this.label.setValue(t,this.defaultLocale)},t.prototype.getValue=function(t,e){return void 0===e&&(e="<br/>"),null===this.value?null:(Array.isArray(t)&&!t.length&&(t=void 0),this.value.getValue(t||this.defaultLocale,e))},t.prototype.getValues=function(t){return null===this.value?[]:(Array.isArray(t)&&!t.length&&(t=void 0),this.value.getValues(t||this.defaultLocale))},t.prototype.setValue=function(t){null===this.value&&(this.value=new Re([])),this.value.setValue(t,this.defaultLocale)},t}(),Ee=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ce=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Ee(e,t),e.getValue=function(t,e){return t.getValue(e,"<br/>")},e.getValues=function(t,e){return t.getValues(e)}}(Array),i(3407)),Se=(i(2126),function(t,e,i,n){return new(i||(i=Promise))(function(s,r){function o(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})}),Ie=function(t,e){var i,n,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(r=0)),r;)try{if(i=1,n&&(s=2&a[0]?n.return:a[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,a[1])).done)return s;switch(n=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,n=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(s=r.trys,(s=s.length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){r.label=a[1];break}if(6===a[0]&&r.label<s[1]){r.label=s[1],s=a;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(a);break}s[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t],n=0}finally{i=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},Me=function(){function t(){}return t.getMediaType=function(t){return(t=(t=t.toLowerCase()).split(";")[0]).trim()},t.getImageQuality=function(t){return t===st.bB.IMAGE_0_COMPLIANCE_LEVEL_1||t===st.bB.IMAGE_0_COMPLIANCE_LEVEL_2||t===st.bB.IMAGE_1_COMPLIANCE_LEVEL_1||t===st.bB.IMAGE_1_COMPLIANCE_LEVEL_2||t===st.bB.IMAGE_0_CONFORMANCE_LEVEL_1||t===st.bB.IMAGE_0_CONFORMANCE_LEVEL_2||t===st.bB.IMAGE_1_CONFORMANCE_LEVEL_1||t===st.bB.IMAGE_1_CONFORMANCE_LEVEL_2||t===st.bB.IMAGE_1_LEVEL_1||t===st.bB.IMAGE_1_PROFILE_LEVEL_1||t===st.bB.IMAGE_1_LEVEL_2||t===st.bB.IMAGE_1_PROFILE_LEVEL_2?"native":"default"},t.getInexactLocale=function(t){return-1!==t.indexOf("-")?t.substr(0,t.indexOf("-")):t},t.getLocalisedValue=function(t,e){if(!Array.isArray(t))return t;for(var i=0;i<t.length;i++){var n=t[i];if(e===n["@language"])return n["@value"]}var s=e.substr(0,e.indexOf("-"));for(i=0;i<t.length;i++){var r=t[i];if(r["@language"]===s)return r["@value"]}return null},t.generateTreeNodeIds=function(e,i){var n;void 0===i&&(i=0),n=e.parentNode?e.parentNode.id+"-"+i:"0",e.id=n;for(var s=0;s<e.nodes.length;s++){var r=e.nodes[s];t.generateTreeNodeIds(r,s)}},t.normaliseType=function(t){return-1!==(t=(t||"").toLowerCase()).indexOf(":")?t.split(":")[1]:t},t.normaliseUrl=function(t){return-1!==(t=t.substr(t.indexOf("://"))).indexOf("#")&&(t=t.split("#")[0]),t},t.normalisedUrlsMatch=function(e,i){return t.normaliseUrl(e)===t.normaliseUrl(i)},t.isImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,st.bB.IMAGE_0_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_0_COMPLIANCE_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_0_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_0_CONFORMANCE_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_0_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_0_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_PROFILE_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_PROFILE_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_PROFILE_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_PROFILE_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_PROFILE_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_PROFILE_LEVEL_2))},t.isImageServiceType=function(t){return null!==t&&t.toLowerCase()===st.C0.IMAGE_SERVICE_2.toLowerCase()||t===st.C0.IMAGE_SERVICE_3.toLowerCase()},t.isLevel0ImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,st.bB.IMAGE_0_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_COMPLIANCE_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_0_CONFORMANCE_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_CONFORMANCE_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_PROFILE_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_LEVEL_0)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_PROFILE_LEVEL_0))},t.isLevel1ImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,st.bB.IMAGE_0_COMPLIANCE_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_COMPLIANCE_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_0_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_CONFORMANCE_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_PROFILE_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_LEVEL_1)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_PROFILE_LEVEL_1))},t.isLevel2ImageProfile=function(e){return!!(t.normalisedUrlsMatch(e,st.bB.IMAGE_0_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_COMPLIANCE_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_0_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_CONFORMANCE_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_1_PROFILE_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_LEVEL_2)||t.normalisedUrlsMatch(e,st.bB.IMAGE_2_PROFILE_LEVEL_2))},t.parseManifest=function(t,e){return He.parse(t,e)},t.checkStatus=function(t){if(t.ok)return t;var e=new Error(t.statusText);return e.response=t,Promise.reject(e)},t.loadManifest=function(e){return new Promise(function(i,n){fetch(e).then(t.checkStatus).then(function(t){return t.json()}).then(function(t){i(t)}).catch(function(t){n()})})},t.loadExternalResourcesAuth1=function(e,i,n,s,r,o,a,l){return new Promise(function(c,h){var u=e.map(function(e){return t.loadExternalResourceAuth1(e,i,n,s,r,o,a,l)});Promise.all(u).then(function(){c(e)}).catch(function(t){h(t)})})},t.loadExternalResourceAuth1=function(e,i,n,s,r,o,a,l){return Se(this,void 0,void 0,function(){var c;return Ie(this,function(h){switch(h.label){case 0:return[4,s(e)];case 1:return(c=h.sent())?[4,e.getData(c)]:[3,6];case 2:return h.sent(),e.status!==Ce.OK?[3,3]:[2,e];case 3:return[4,t.doAuthChain(e,i,n,r,o,a,l)];case 4:h.sent(),h.label=5;case 5:if(e.status===Ce.OK||e.status===Ce.lf)return[2,e];throw t.createAuthorizationFailedError();case 6:return[4,e.getData()];case 7:return h.sent(),e.status!==Ce.lf&&e.status!==Ce.hB?[3,9]:[4,t.doAuthChain(e,i,n,r,o,a,l)];case 8:h.sent(),h.label=9;case 9:if(e.status===Ce.OK||e.status===Ce.lf)return[2,e];throw t.createAuthorizationFailedError()}})})},t.doAuthChain=function(e,i,n,s,r,o,a){return Se(this,void 0,void 0,function(){var l,c,h,u,d,p,f,g;return Ie(this,function(m){switch(m.label){case 0:return e.isAccessControlled()?((l=e.externalService)&&(l.options=e.options),(c=e.kioskService)&&(c.options=e.options),(h=e.clickThroughService)&&(h.options=e.options),(u=e.loginService)&&(u.options=e.options),e.isResponseHandled||e.status!==Ce.lf?[3,2]:[4,o(e)]):[2,e];case 1:case 3:case 6:case 10:case 14:return m.sent(),[2,e];case 2:return d=null,p=null,(d=l)?(p=d,[4,t.attemptResourceWithToken(e,n,d)]):[3,4];case 4:return(d=c)?(p=d,(f=i(d))?[4,s(f)]:[3,7]):[3,7];case 5:case 9:case 13:return m.sent(),[4,t.attemptResourceWithToken(e,n,d)];case 7:return(d=h)?(p=d,[4,r(e,d)]):[3,11];case 8:return(g=m.sent())?[4,s(g)]:[3,11];case 11:return(d=u)?(p=d,[4,r(e,d)]):[3,15];case 12:return(g=m.sent())?[4,s(g)]:[3,15];case 15:return p&&a(e,p),[2]}})})},t.attemptResourceWithToken=function(t,e,i){return Se(this,void 0,void 0,function(){var n,s;return Ie(this,function(r){switch(r.label){case 0:return(n=i.getService(st.bB.AUTH_1_TOKEN))?[4,e(t,n)]:[3,3];case 1:return(s=r.sent())&&s.accessToken?[4,t.getData(s)]:[3,3];case 2:return r.sent(),[2,t];case 3:return[2]}})})},t.loadExternalResourcesAuth09=function(e,i,n,s,r,o,a,l,c,h){return new Promise(function(u,d){var p=e.map(function(e){return t.loadExternalResourceAuth09(e,i,n,s,r,o,a,l,c,h)});Promise.all(p).then(function(){u(e)}).catch(function(t){d(t)})})},t.loadExternalResourceAuth09=function(e,i,n,s,r,o,a,l,c,h){return new Promise(function(u,d){h&&h.pessimisticAccessControl?e.getData().then(function(){e.isAccessControlled()?e.clickThroughService?(u(n(e)),u(s(e))):r(e).then(function(){o(e,!0).then(function(i){e.getData(i).then(function(){u(c(e))}).catch(function(e){d(t.createInternalServerError(e))})}).catch(function(e){d(t.createInternalServerError(e))})}).catch(function(e){d(t.createInternalServerError(e))}):u(e)}).catch(function(e){d(t.createInternalServerError(e))}):l(e,i).then(function(h){h?e.getData(h).then(function(){e.status===Ce.OK?u(c(e)):t.authorize(e,i,n,s,r,o,a,l).then(function(){u(c(e))}).catch(function(e){d(t.createAuthorizationFailedError())})}).catch(function(e){d(t.createAuthorizationFailedError())}):t.authorize(e,i,n,s,r,o,a,l).then(function(){u(c(e))}).catch(function(e){d(t.createAuthorizationFailedError())})}).catch(function(e){d(t.createAuthorizationFailedError())})})},t.createError=function(t,e){var i=new Error;return i.message=e,i.name=String(t),i},t.createAuthorizationFailedError=function(){return t.createError(De.AUTHORIZATION_FAILED,"Authorization failed")},t.createRestrictedError=function(){return t.createError(De.RESTRICTED,"Restricted")},t.createInternalServerError=function(e){return t.createError(De.INTERNAL_SERVER_ERROR,e)},t.authorize=function(e,i,n,s,r,o,a,l){return new Promise(function(c,h){e.getData().then(function(){e.isAccessControlled()?l(e,i).then(function(l){l?e.getData(l).then(function(){e.status===Ce.OK?c(e):t.showAuthInteraction(e,i,n,s,r,o,a,c,h)}).catch(function(e){h(t.createInternalServerError(e))}):o(e,!1).then(function(l){l?a(e,l,i).then(function(){e.getData(l).then(function(){e.status===Ce.OK?c(e):t.showAuthInteraction(e,i,n,s,r,o,a,c,h)}).catch(function(e){h(t.createInternalServerError(e))})}).catch(function(e){h(t.createInternalServerError(e))}):t.showAuthInteraction(e,i,n,s,r,o,a,c,h)})}).catch(function(e){h(t.createInternalServerError(e))}):c(e)})})},t.showAuthInteraction=function(e,i,n,s,r,o,a,l,c){e.status!==Ce.lf||e.isResponseHandled?e.clickThroughService&&!e.isResponseHandled?n(e).then(function(){o(e,!0).then(function(n){a(e,n,i).then(function(){e.getData(n).then(function(){l(e)}).catch(function(e){c(t.createInternalServerError(e))})}).catch(function(e){c(t.createInternalServerError(e))})}).catch(function(e){c(t.createInternalServerError(e))})}):r(e).then(function(){o(e,!0).then(function(n){a(e,n,i).then(function(){e.getData(n).then(function(){l(e)}).catch(function(e){c(t.createInternalServerError(e))})}).catch(function(e){c(t.createInternalServerError(e))})}).catch(function(e){c(t.createInternalServerError(e))})}):l(e)},t.getService=function(t,e){for(var i=this.getServices(t),n=0;n<i.length;n++){var s=i[n];if(s.getProfile()===e)return s}return null},t.getResourceById=function(e,i){return t.traverseAndFind(e.__jsonld,"@id",i)},t.traverseAndFind=function(e,i,n){if(e.hasOwnProperty(i)&&e[i]===n)return e;for(var s=0;s<Object.keys(e).length;s++)if("object"==typeof e[Object.keys(e)[s]]){var r=t.traverseAndFind(e[Object.keys(e)[s]],i,n);if(null!=r)return r}},t.getServices=function(e,i){var n=void 0===i?{}:i,s=n.onlyService,r=void 0!==s&&s,o=n.onlyServices,a=void 0!==o&&o,l=n.skipParentResources,c=[];!(void 0!==l&&l)&&e&&e.options&&e.options.resource&&e.options.resource!==e&&c.push.apply(c,t.getServices(e.options.resource,{onlyServices:!0}));var h=a?[]:(e.__jsonld||e).service||[];if(Array.isArray(h)||(h=[h]),r||h.push.apply(h,(e.__jsonld||e).services||[]),0===h.length)return c;for(var u=0;u<h.length;u++){var d=h[u];if("string"==typeof d){var p=this.getResourceById(e.options.resource,d);p&&c.push(new $e(p.__jsonld||p,e.options))}else c.push(new $e(d,e.options))}return c},t.getTemporalComponent=function(t){var e=/t=([^&]+)/g.exec(t),i=null;return e&&e[1]&&(i=e[1].split(",")),i},t}(),Te=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Be=function(){function t(t,e,i){void 0===i&&(i="none"),Array.isArray(t)&&1===t.length?this._value=t[0]:this._value=t,"none"!==e&&"@none"!==e||(e=void 0),this._locale=e,this._defaultLocale=i}return t.parseV2Value=function(e,i){return"string"==typeof e?new t(e,void 0,i):e["@value"]?new t(e["@value"],e["@language"],i):null},Object.defineProperty(t.prototype,"value",{get:function(){return Array.isArray(this._value)?this._value.join("<br/>"):this._value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"locale",{get:function(){return void 0===this._locale?this._defaultLocale:this._locale},enumerable:!1,configurable:!0}),t.prototype.addValue=function(t){Array.isArray(this._value)||(this._value=[this._value]),Array.isArray(t)?this._value=this._value.concat(t):this._value.push(t)},t}(),Re=function(t){function e(i,n){void 0===i&&(i=[]);var s=t.apply(this,i)||this;return s.__proto__=e.prototype,s._defaultLocale=n,s}return Te(e,t),e.parse=function(t,i){if(!t)return new e([],i);if(Array.isArray(t)){var n=(s=t.map(function(t){return Be.parseV2Value(t,i)}).filter(function(t){return null!==t})).reduce(function(t,e){var i=e._locale;return i||(i="none"),t[i]?t[i].addValue(e._value):t[i]=e,t},{});return new e(Object.values(n),i)}return"string"==typeof t?new e([new Be(t,void 0,i)],i):t["@language"]||t["@value"]?new e(null!==(s=Be.parseV2Value(t))?[s]:[],i):new e(Object.keys(t).map(function(e){var n=t[e];if(!Array.isArray(n))throw new Error("A IIIF v3 localized property value must have an array as the value for a given language.");return new Be(n,e,i)}),i);var s},e.prototype.getSuitableLocale=function(t){0==t.length&&this._defaultLocale&&t.push(this._defaultLocale);for(var e=Array.from(this.values()).map(function(t){return t._locale}).filter(function(t){return void 0!==t}),i=function(t){var i=e.find(function(e){return e===t});if(i)return{value:i}},n=0,s=t;n<s.length;n++){var r=i(s[n]);if("object"==typeof r)return r.value}for(var o=function(t){var i=e.find(function(e){return Me.getInexactLocale(e)===Me.getInexactLocale(t)});if(i)return{value:i}},a=0,l=t;a<l.length;a++){var c=o(l[a]);if("object"==typeof c)return c.value}},e.prototype.setValue=function(t,e){var i=void 0;if(e){var n=this.getSuitableLocale([e]);n&&(i=this.find(function(t){return t._locale===n}))}else i=this.find(function(t){return void 0===t._locale});i?i._value=t:this.push(new Be(t,e,this._defaultLocale))},e.prototype.getValue=function(t,e){var i=this.getValues(t);return 0===i.length?null:e?i.join(e):i[0]},e.prototype.getValues=function(t){if(!this.length)return[];var e;if(e=t?Array.isArray(t)?t:[t]:[],1===this.length&&void 0===this[0]._locale){var i=this[0]._value;return Array.isArray(i)?i:[i]}var n=this.getSuitableLocale(e);if(n){i=this.find(function(t){return t._locale===n})._value;return Array.isArray(i)?i:[i]}var s=!this.find(function(t){return void 0===t._locale});if(s){i=this[0]._value;return Array.isArray(i)?i:[i]}var r=this.find(function(t){return void 0===t._locale});return r?Array.isArray(r._value)?r._value:[r._value]:[]},e}(Array),Pe=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Le=function(t){function e(e,i){var n=t.call(this,e,i)||this;if(n.index=0,n._allRanges=null,n.items=[],n._topRanges=[],n.__jsonld.structures&&n.__jsonld.structures.length)for(var s=n._getTopRanges(),r=0;r<s.length;r++){var o=s[r];n._parseRanges(o,String(r))}return n._annotationIdMap=null,n}return Pe(e,t),e.prototype.getPosterCanvas=function(){var t=this.getProperty("posterCanvas");return t&&(t=new ye(t,this.options)),t},e.prototype.getAccompanyingCanvas=function(){var t=this.getProperty("accompanyingCanvas");return t&&(t=new ye(t,this.options)),t},e.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},e.prototype.getDefaultTree=function(){if(t.prototype.getDefaultTree.call(this),this.defaultTree.data.type=Me.normaliseType(Ke.MANIFEST),!this.isLoaded)return this.defaultTree;var e=this.getTopRanges();return e.length&&e[0].getTree(this.defaultTree),Me.generateTreeNodeIds(this.defaultTree),this.defaultTree},e.prototype._getTopRanges=function(){var t=[];if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var e=0;e<this.__jsonld.structures.length;e++){var i=this.__jsonld.structures[e];i.viewingHint===st.LX.TOP&&t.push(i)}if(!t.length){var n={};n.ranges=this.__jsonld.structures,t.push(n)}}return t},e.prototype.getTopRanges=function(){return this._topRanges},e.prototype._getRangeById=function(t){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var e=0;e<this.__jsonld.structures.length;e++){var i=this.__jsonld.structures[e];if(i["@id"]===t||i.id===t)return i}return null},e.prototype._parseRanges=function(t,e,i){var n=null;if("string"==typeof t&&(n=t,t=this._getRangeById(n)),t){var s=new Ue(t,this.options);s.parentRange=i,s.path=e,i?i.items.push(s):this._topRanges.push(s);var r=t.items||t.members;if(r)for(var o=0;o<r.length;o++){var a=r[o];if(a["@type"]&&"sc:range"===a["@type"].toLowerCase()||a.type&&"range"===a.type.toLowerCase())this._parseRanges(a,e+"/"+o,s);else if(a["@type"]&&"sc:canvas"===a["@type"].toLowerCase()||a.type&&"canvas"===a.type.toLowerCase()){s.canvases||(s.canvases=[]);var l=a.id||a["@id"];s.canvases.push(l)}}else if(t.ranges)for(o=0;o<t.ranges.length;o++)this._parseRanges(t.ranges[o],e+"/"+o,s)}else console.warn("Range:",n,"does not exist")},e.prototype.getAllRanges=function(){if(null!=this._allRanges)return this._allRanges;this._allRanges=[];for(var t=this.getTopRanges(),e=function(e){var n=t[e];n.id&&i._allRanges.push(n);var s=function(t,e){t.add(e);var i=e.getRanges();return i.length?i.reduce(s,t):t},r=Array.from(n.getRanges().reduce(s,new Set));i._allRanges=i._allRanges.concat(r)},i=this,n=0;n<t.length;n++)e(n);return this._allRanges},e.prototype.getRangeById=function(t){for(var e=this.getAllRanges(),i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}return null},e.prototype.getRangeByPath=function(t){for(var e=this.getAllRanges(),i=0;i<e.length;i++){var n=e[i];if(n.path===t)return n}return null},e.prototype.getSequences=function(){if(this.items.length)return this.items;var t=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(t)for(var e=0;e<t.length;e++){var i=t[e],n=new Ge(i,this.options);this.items.push(n)}else if(this.__jsonld.items){n=new Ge(this.__jsonld.items,this.options);this.items.push(n)}return this.items},e.prototype.getSequenceByIndex=function(t){return this.getSequences()[t]},e.prototype.getTotalSequences=function(){return this.getSequences().length},e.prototype.getManifestType=function(){var t=this.getService(st.bB.UI_EXTENSIONS);return t?t.getProperty("manifestType"):ae.EMPTY},e.prototype.isMultiSequence=function(){return this.getTotalSequences()>1},e.prototype.isPagingEnabled=function(){var t=this.getViewingHint();if(t)return t===st.LX.PAGED;var e=this.getBehavior();return!!e&&e===st.nS.PAGED},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},Object.defineProperty(e.prototype,"annotationIdMap",{get:function(){if(null==this._annotationIdMap){this._annotationIdMap={};for(var t=0,e=this.getSequences();t<e.length;t++)for(var i=0,n=e[t].getScenes();i<n.length;i++)for(var s=0,r=n[i].getContent();s<r.length;s++){var o=r[s];this._annotationIdMap[o.id]=o}}return this._annotationIdMap},enumerable:!1,configurable:!0}),e}(ht);!function(t){t.EMPTY="",t.MANUSCRIPT="manuscript",t.MONOGRAPH="monograph"}(ae||(ae={}));var De,Ne=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Oe=function(t){function e(e){var i=t.call(this,e)||this;return i.isPointSelector=!0,i}return Ne(e,t),e.prototype.getLocation=function(){return new Ot(this.__jsonld.x,this.__jsonld.y,this.__jsonld.z)},Object.defineProperty(e.prototype,"Location",{get:function(){return this.getLocation()},enumerable:!1,configurable:!0}),e}(et),ke=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ue=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._ranges=null,n.canvases=null,n.items=[],n}return ke(e,t),e.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:this.canvases?this.canvases:[]},e.prototype.getDuration=function(){if(this.canvases&&this.canvases.length){for(var t=[],e=[],i=0,n=this.canvases;i<n.length;i++){if(p=n[i]){var s=p.match(/(.*)#t=([0-9.]+),?([0-9.]+)?/)||[void 0,p],r=s[1],o=s[2],a=s[3];r&&(t.push(parseFloat(o)),e.push(parseFloat(a)))}}if(t.length&&e.length)return new xe(Math.min.apply(Math,t),Math.max.apply(Math,e))}else{t=[],e=[];for(var l=0,c=g=this.getRanges();l<c.length;l++){(m=c[l].getDuration())&&(t.push(m.start),e.push(m.end))}if(t.length&&e.length)return new xe(Math.min.apply(Math,t),Math.max.apply(Math,e))}var h,u;if(this.canvases&&this.canvases.length)for(var d=0;d<this.canvases.length;d++){var p=this.canvases[d],f=Me.getTemporalComponent(p);f&&f.length>1&&(0===d&&(h=Number(f[0])),d===this.canvases.length-1&&(u=Number(f[1])))}else{var g=this.getRanges();for(d=0;d<g.length;d++){var m;(m=g[d].getDuration())&&(0===d&&(h=m.start),d===g.length-1&&(u=m.end))}}if(void 0!==h&&void 0!==u)return new xe(h,u)},e.prototype.getRanges=function(){return this._ranges?this._ranges:this._ranges=this.items.filter(function(t){return t.isRange()})},e.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e.prototype.getTree=function(t){t.data=this,this.treeNode=t;var e=this.getRanges();if(e&&e.length)for(var i=0;i<e.length;i++){var n=e[i],s=new ii;t.addNode(s),this._parseTreeNode(s,n)}return Me.generateTreeNodeIds(t),t},e.prototype.spansTime=function(t){var e=this.getDuration();return!!(e&&t>=e.start&&t<=e.end)},e.prototype._parseTreeNode=function(t,e){t.label=e.getLabel().getValue(this.options.locale),t.data=e,t.data.type=Me.normaliseType(Ke.RANGE),e.treeNode=t;var i=e.getRanges();if(i&&i.length)for(var n=0;n<i.length;n++){var s=i[n];if(s.getBehavior()!==st.nS.NO_NAV){var r=new ii;t.addNode(r),this._parseTreeNode(r,s)}}},e}(ot),Fe=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ze=function(t){function e(e,i){return t.call(this,e,i)||this}return Fe(e,t),e.prototype.getFormat=function(){return this.getProperty("format")},e}(ot),Ve=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Qe=function(t){function e(e,i){return t.call(this,e,i)||this}return Ve(e,t),e.prototype.getContent=function(){var t=[],e=this.__jsonld.items||this.__jsonld.content;if(!e)return t;var i=null;if(e.length&&(i=new pe(e[0],this.options)),!i)return t;for(var n=i.getItems(),s=0;s<n.length;s++){var r=n[s],o=new ce(r,this.options);t.push(o)}return t},Object.defineProperty(e.prototype,"Content",{get:function(){return this.getContent()},enumerable:!1,configurable:!0}),e.prototype.getAnnotationById=function(t){for(var e=0,i=this.Content;e<i.length;e++){var n=i[e];if(n.id===t)return n}return null},e.prototype.getBackgroundColor=function(){var t=this.getProperty("backgroundColor");return t?li.fromCSS(t):null},e.prototype.getNonContentAnnotations=function(){var t=this,e=(this.__jsonld.annotations||[]).filter(function(t){return t&&"AnnotationPage"===t.type}).map(function(e){return new pe(e,t.options)});if(!e.length)return[];var i=e.map(function(t){return t.getItems()});return Ae()(i).map(function(e){return new ce(e,t.options)})},e}(ot),je=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ge=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.items=[],n._thumbnails=null,n}return je(e,t),e.prototype.getCanvases=function(){if(this.items.length)return this.items;var t=this.__jsonld.canvases||this.__jsonld.elements;if(t)for(var e=0;e<t.length;e++){var i=t[e];(n=new ye(i,this.options)).index=e,this.items.push(n)}else if(this.__jsonld)for(e=0;e<this.__jsonld.length;e++){var n;i=this.__jsonld[e];(n=new ye(i,this.options)).index=e,this.items.push(n)}return this.items},e.prototype.getCanvasById=function(t){for(var e=0;e<this.getTotalCanvases();e++){var i=this.getCanvasByIndex(e),n=Me.normaliseUrl(i.id);if(Me.normaliseUrl(t)===n)return i}return null},e.prototype.getCanvasByIndex=function(t){return this.getCanvases()[t]},e.prototype.getCanvasIndexById=function(t){for(var e=0;e<this.getTotalCanvases();e++){if(this.getCanvasByIndex(e).id===t)return e}return null},e.prototype.getCanvasIndexByLabel=function(t,e){t=t.trim(),isNaN(t)||(t=parseInt(t,10).toString(),e&&(t+="r"));for(var i,n,s,r=/(\d*)\D+(\d*)/,o=0;o<this.getTotalCanvases();o++){var a=this.getCanvasByIndex(o);if(a.getLabel().getValue(this.options.locale)===t)return o;if((i=r.exec(t))&&(n=i[1],(s=i[2])&&new RegExp("^"+n+"\\D+"+s+"$").test(a.getLabel().toString())))return o}return-1},e.prototype.getLastCanvasLabel=function(t){for(var e=this.getTotalCanvases()-1;e>=0;e--){var i=this.getCanvasByIndex(e).getLabel().getValue(this.options.locale);if(t){if(/^[a-zA-Z0-9]*$/.test(i))return i}else if(i)return i}return this.options.defaultLabel},e.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},e.prototype.getNextPageIndex=function(t,e){var i;if(e){var n=this.getPagedIndices(t),s=this.getViewingDirection();i=s&&s===st.T5.RIGHT_TO_LEFT?n[0]+1:n[n.length-1]+1}else i=t+1;return i>this.getLastPageIndex()?-1:i},e.prototype.getPagedIndices=function(t,e){var i=[];if(e){i=this.isFirstCanvas(t)||this.isLastCanvas(t)?[t]:t%2?[t,t+1]:[t-1,t];var n=this.getViewingDirection();n&&n===st.T5.RIGHT_TO_LEFT&&(i=i.reverse())}else i.push(t);return i},e.prototype.getPrevPageIndex=function(t,e){var i;if(e){var n=this.getPagedIndices(t),s=this.getViewingDirection();i=s&&s===st.T5.RIGHT_TO_LEFT?n[n.length-1]-1:n[0]-1}else i=t-1;return i},e.prototype.getScenes=function(){var t=[],e=this.__jsonld.elements||this.__jsonld;if(e)for(var i=0;i<e.length;++i){var n=e[i];if("Scene"===n.type){var s=new Qe(n,this.options);t.push(s)}}return t},e.prototype.getStartCanvasIndex=function(){var t=this.getStartCanvas();if(t)for(var e=0;e<this.getTotalCanvases();e++){if(this.getCanvasByIndex(e).id===t)return e}return 0},e.prototype.getThumbs=function(t,e){for(var i=[],n=this.getTotalCanvases(),s=0;s<n;s++){var r=this.getCanvasByIndex(s),o=new Xe(t,r);i.push(o)}return i},e.prototype.getThumbnails=function(){if(null!=this._thumbnails)return this._thumbnails;this._thumbnails=[];for(var t=this.getCanvases(),e=0;e<t.length;e++){var i=t[e].getThumbnail();i&&this._thumbnails.push(i)}return this._thumbnails},e.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},e.prototype.getTotalCanvases=function(){return this.getCanvases().length},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):this.options.resource.getViewingDirection?this.options.resource.getViewingDirection():null},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e.prototype.isCanvasIndexOutOfRange=function(t){return t>this.getTotalCanvases()-1},e.prototype.isFirstCanvas=function(t){return 0===t},e.prototype.isLastCanvas=function(t){return t===this.getTotalCanvases()-1},e.prototype.isMultiCanvas=function(){return this.getTotalCanvases()>1},e.prototype.isPagingEnabled=function(){var t=this.getViewingHint();return!!t&&t===st.LX.PAGED},e.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},e}(ot),He=function(){function t(){}return t.parse=function(t,e){return"string"==typeof t&&(t=JSON.parse(t)),this.parseJson(t,e)},t.parseJson=function(t,e){var i;if(e&&e.navDate&&!isNaN(e.navDate.getTime())&&(t.navDate=e.navDate.toString()),t["@type"])switch(t["@type"]){case"sc:Collection":i=this.parseCollection(t,e);break;case"sc:Manifest":i=this.parseManifest(t,e);break;default:return null}else switch(t.type){case"Collection":i=this.parseCollection(t,e);break;case"Manifest":i=this.parseManifest(t,e);break;default:return null}return i.isLoaded=!0,i},t.parseCollection=function(t,e){var i=new _e(t,e);return e?(i.index=e.index||0,e.resource&&(i.parentCollection=e.resource.parentCollection)):i.index=0,this.parseCollections(i,e),this.parseManifests(i,e),this.parseItems(i,e),i},t.parseCollections=function(t,e){var i;if(t.__jsonld.collections?i=t.__jsonld.collections:t.__jsonld.items&&(i=t.__jsonld.items.filter(function(t){return"collection"===t.type.toLowerCase()})),i)for(var n=0;n<i.length;n++){e&&(e.index=n);var s=this.parseCollection(i[n],e);s.index=n,s.parentCollection=t,t.items.push(s)}},t.parseManifest=function(t,e){return new Le(t,e)},t.parseManifests=function(t,e){var i;if(t.__jsonld.manifests?i=t.__jsonld.manifests:t.__jsonld.items&&(i=t.__jsonld.items.filter(function(t){return"manifest"===t.type.toLowerCase()})),i)for(var n=0;n<i.length;n++){var s=this.parseManifest(i[n],e);s.index=n,s.parentCollection=t,t.items.push(s)}},t.parseItem=function(t,e){if(t["@type"]){if("sc:manifest"===t["@type"].toLowerCase())return this.parseManifest(t,e);if("sc:collection"===t["@type"].toLowerCase())return this.parseCollection(t,e)}else if(t.type){if("manifest"===t.type.toLowerCase())return this.parseManifest(t,e);if("collection"===t.type.toLowerCase())return this.parseCollection(t,e)}return null},t.parseItems=function(t,e){var i=t.__jsonld.members||t.__jsonld.items;if(i)for(var n=function(n){e&&(e.index=n);var r=s.parseItem(i[n],e);return r?t.items.filter(function(t){return t.id===r.id})[0]?"continue":(r.index=n,r.parentCollection=t,void t.items.push(r)):{value:void 0}},s=this,r=0;r<i.length;r++){var o=n(r);if("object"==typeof o)return o.value}},t}(),qe=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),$e=function(t){function e(e,i){return t.call(this,e,i)||this}return qe(e,t),e.prototype.getProfile=function(){var t=this.getProperty("profile");return t||(t=this.getProperty("dcterms:conformsTo")),Array.isArray(t)?t[0]:t},e.prototype.getConfirmLabel=function(){return Me.getLocalisedValue(this.getProperty("confirmLabel"),this.options.locale)},e.prototype.getDescription=function(){return Me.getLocalisedValue(this.getProperty("description"),this.options.locale)},e.prototype.getFailureDescription=function(){return Me.getLocalisedValue(this.getProperty("failureDescription"),this.options.locale)},e.prototype.getFailureHeader=function(){return Me.getLocalisedValue(this.getProperty("failureHeader"),this.options.locale)},e.prototype.getHeader=function(){return Me.getLocalisedValue(this.getProperty("header"),this.options.locale)},e.prototype.getServiceLabel=function(){return Me.getLocalisedValue(this.getProperty("label"),this.options.locale)},e.prototype.getInfoUri=function(){var t=this.id;return t.endsWith("/")||(t+="/"),t+="info.json"},e}(ot),We=function(t,e){this.width=t,this.height=e};!function(t){t[t.AUTHORIZATION_FAILED=1]="AUTHORIZATION_FAILED",t[t.FORBIDDEN=2]="FORBIDDEN",t[t.INTERNAL_SERVER_ERROR=3]="INTERNAL_SERVER_ERROR",t[t.RESTRICTED=4]="RESTRICTED"}(De||(De={}));var Ke,Xe=function(t,e){this.data=e,this.index=e.index,this.width=t;var i=e.getHeight()/e.getWidth();this.height=i?Math.floor(this.width*i):t,this.uri=e.getCanonicalImageUri(t),this.label=e.getLabel().getValue(),this.viewingHint=e.getViewingHint()},Ye=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Je=function(t){function e(e,i){return t.call(this,e,i)||this}return Ye(e,t),e}(lt),Ze=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ti=function(t){function e(e){var i=t.call(this,e)||this;return i.isTranslateTransform=!0,i}return Ze(e,t),e.prototype.getTranslation=function(){for(var t={},e=0,i=["x","y","z"];e<i.length;e++){var n=i[e],s=this.__jsonld[n];t[n]=void 0!==s?Number(s):0}return t},e}(nt),ei=function(){function t(){}return t.BuildFromJson=function(t){if("TranslateTransform"===t.type)return new ti(t);if("RotateTransform"===t.type)return new si(t);if("ScaleTransform"===t.type)return new oi(t);throw new Error("Unknown transform type "+t.type)},t}(),ii=function(){function t(t,e){this.label=t,this.data=e||{},this.nodes=[]}return t.prototype.addNode=function(t){this.nodes.push(t),t.parentNode=this},t.prototype.isCollection=function(){return this.data.type===Me.normaliseType(Ke.COLLECTION)},t.prototype.isManifest=function(){return this.data.type===Me.normaliseType(Ke.MANIFEST)},t.prototype.isRange=function(){return this.data.type===Me.normaliseType(Ke.RANGE)},t}();!function(t){t.COLLECTION="collection",t.MANIFEST="manifest",t.RANGE="range"}(Ke||(Ke={}));var ni=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),si=function(t){function e(e){var i=t.call(this,e)||this;return i.isRotateTransform=!0,i}return ni(e,t),e.prototype.getRotation=function(){for(var t={},e=0,i=["x","y","z"];e<i.length;e++){var n=i[e],s=this.__jsonld[n];t[n]=void 0!==s?Number(s):0}return t},Object.defineProperty(e.prototype,"Rotation",{get:function(){return this.getRotation()},enumerable:!1,configurable:!0}),e}(nt),ri=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),oi=function(t){function e(e){var i=t.call(this,e)||this;return i.isScaleTransform=!0,i}return ri(e,t),e.prototype.getScale=function(){for(var t={},e=0,i=["x","y","z"];e<i.length;e++){var n=i[e],s=this.__jsonld[n];t[n]=void 0!==s?Number(s):1}return t},e}(nt),ai=i(8570),li=function(){function t(t){this.value=t}return t.fromCSS=function(e){var i=ai.get(e);if("rgb"!==i.model)throw new Error("unsupported color string: "+e);return new t([i.value[0],i.value[1],i.value[2]])},Object.defineProperty(t.prototype,"red",{get:function(){return this.value[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"green",{get:function(){return this.value[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blue",{get:function(){return this.value[2]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"CSS",{get:function(){return ai.to.hex(this.value)},enumerable:!1,configurable:!0}),t}();function ci(t){var e=t.Rotation;return new oe(Dt.degToRad(e.x),Dt.degToRad(e.y),Dt.degToRad(e.z),"XYZ")}var hi=function(t,e){return Me.parseManifest(t,e)},ui=i(8722),di=i(8424),pi=i(2222),fi=i(6884),gi=i(2552),mi=i(4965),Ai=i(5676),vi=i(5852),yi=i(2690),bi=i(4260),_i=i.n(bi),xi=i(4640),wi=i(7832),Ei=i(8446);const Ci=new xi.kn4,Si=new xi.kn4,Ii=new xi.Pq0,Mi=new xi.Pq0,Ti=new xi.O9p,Bi=new xi.Q1f,Ri=new xi.Pq0(0,1,0);class Pi{constructor(t){this.application=null,this.application=t}loadIIIFManifest(t){const e=this.application,i=[];console.log("LOADING IIIF MANIFEST");const n=e.system.getMainComponent(z.A),s=e.system.getMainComponent(Q.A),r=n.activeComponent,o=new Li(t);let a=null;const l=r.getInnerComponent(J.A),c=r.setup;o.loadManifest().then(()=>{const t=o.scenes,n=r.meta.collection.get("titles");o.manifest.getLabel().forEach(t=>{n[t._locale.substring(0,2).toUpperCase()]=t._value}),r.ins.title.setValue(n[tt.aL[c.language.outs.activeLanguage.value]]),r.meta.collection.insert(o.manifest.getSummary().getValue(),"IIIFManifestSummary"),t.forEach(t=>{var n,h,u;const d=[],p=[],f=[],g=[],m=[],A=[];let v=null;l.node.name=null!==(n=t.getLabel().getValue())&&void 0!==n?n:"Scene";const y=null===(h=t.getProperty("spatialScale"))||void 0===h?void 0:h.quantityValue;if(y){const t=null===(u=[{factor:.001,unit:tt.uj.mm},{factor:.01,unit:tt.uj.cm},{factor:1,unit:tt.uj.m},{factor:1e3,unit:tt.uj.km},{factor:.0254,unit:tt.uj.in},{factor:.3048,unit:tt.uj.ft},{factor:.9144,unit:tt.uj.yd},{factor:1609,unit:tt.uj.mi}].find(t=>Math.abs(t.factor-y)<.001))||void 0===u?void 0:u.unit;l.ins.units.setValue(t||tt.uj.cm)}else l.ins.units.setValue(tt.uj.cm);const b=t.getBackgroundColor();b&&(e.setBackgroundStyle("solid"),e.setBackgroundColor("rgb("+b.red+","+b.green+","+b.blue+")"));if(o.annotationsFromScene(t).forEach(t=>{const e=t.getBody()[0],i=e.isSpecificResource()?e.getSource():e,n=i.getType();switch(n){case"model":d.push(t);break;case"perspectivecamera":case"orthographiccamera":p.push(t);break;case"directionallight":case"spotlight":case"pointlight":case"ambientlight":f.push(t);break;case"textualbody":g.push(t);break;case"canvas":m.push(t);break;case"sound":A.push(t);break;case"text":i.isSoundCaption&&(v=t);break;default:console.log("Unsupported IIIF annotation type: "+n)}}),d.forEach(t=>{var e;const n=t.getBody()[0],s=r.appendModel(n.isSpecificResource()?null===(e=n.getSource())||void 0===e?void 0:e.id:n.id);i.push(s),s.ins.localUnits.setValue(y?l.ins.units.value:tt.uj.cm);const o=n.getLabelFromSelfOrSource().getValue();s.node.name=null!=o?o:"Model",s.ins.name.setValue(s.node.name),s.setFromMatrix(this.getIIIFBodyTransform(n,t))}),f.length>0){c.navigation.ins.lightsFollowCamera.setValue(!1);const e=r.innerGraph.findNodeByName("Lights"),i=e.getComponent(di.Ay).children.slice();for(;i.length>0;){const t=i.pop();t.hasComponent(E.A)?t.getComponent(E.A).ins.enabled.setValue(!1):t.dispose()}f.forEach(i=>{const n=i.getBody()[0],s=n.getLabelFromSelfOrSource().getValue();let o=null;const a=r.innerGraph.createCustomNode(pi.A);if(e.getComponent(di.Ay).addChild(a.transform),n.isPointLight()?o=a.createComponent(fi.A):n.isDirectionalLight()?o=a.createComponent(gi.A):n.isSpotLight()?(o=a.createComponent(mi.A),o.ins.angle.setValue(n.getAngle()||ui.A.PI/3)):n.isAmbientLight()&&(o=a.createComponent(vi.A)),o){a.name=null!=s?s:o.typeName,o.ins.name.setValue(a.name),o.ins.intensity.setValue(n.getIntensity());const e=n.getColor().value;o.ins.color.setValue([e[0]/255,e[1]/255,e[2]/255]);const r=this.getIIIFBodyTransform(n,i);Ii.setFromMatrixPosition(r),o.transform.object3D.matrix.copy(r);const l=this.getIIIFLookAtTransform(n,t,Ii,Ri);l&&(o.transform.object3D.matrix.multiply(l),o.transform.object3D.matrix.multiply(Ci.makeRotationX(90*ui.A.DEG2RAD))),o.transform.setPropertiesFromMatrix()}else console.warn("Unhandled IIIF light type: "+n.getType())})}if(p.length>0){const e=p[0],i=l.cameras[0],n=c.navigation.ins;n.autoZoom.setValue(!1),n.minOffset.setValue([-1/0,-1/0,-1/0]);const s=e.getBody()[0],r=s.getLabelFromSelfOrSource().getValue();i.node.name=null!=r?r:"Camera",Si.copy(this.getIIIFBodyTransform(s,e)),Ii.setFromMatrixPosition(Si);const o=this.getIIIFLookAtTransform(s,t,Ii,Ri);Ti.setFromRotationMatrix(o||Si,"YXZ"),Mi.setFromEuler(Ti).multiplyScalar(ui.A.RAD2DEG),Ii.applyMatrix4(Si.makeRotationFromEuler(Ti).invert()),n.offset.setValue(Ii.toArray()),n.orbit.setValue(Mi.toArray());const a=s.FieldOfView;a&&i.ins.fov.setValue(a);const h=s.Near,u=s.Far;(h||u)&&(i.addIns.autoNearFar.setValue(!1),h&&i.ins.near.setValue(h),u&&i.ins.far.setValue(u)),i.ins.projection.setValue(s.isPerspectiveCamera()?Ai.$R.Perspective:Ai.$R.Orthographic)}if(A.length>0){const t=A[0].getBody();t.forEach(e=>{var i;const n=(null===(i=e.getProperty("language"))||void 0===i?void 0:i.toUpperCase())||tt.Nm,s=t.getLabelFromSelfOrSource().getValue(),r=c.audio.narrationId=Ei.A.generateId(),o={id:r,name:null!=s?s:"Narration Audio",uris:{},captionUris:{},durations:{}};c.audio.addAudioClip(o);const a=e.getProperty("id");o.uris[n]=a,c.audio.updateAudioClip(r)}),v&&v.getBody().forEach(t=>{var e;const i=(null===(e=t.getProperty("language"))||void 0===e?void 0:e.toUpperCase())||tt.Nm;if(t.isSoundCaption()){const e=c.audio.getAudioClip(c.audio.narrationId);e?e.captionUris[i]=t.getProperty("id"):console.warn("Caption file not loaded - no corresponding audio clip.")}})}c.viewer.ins.annotationsVisible.setValue(g.length>0),g.forEach(e=>{const n=e.getTarget(),s=e.getBody()[0];if(n.isSpecificResource){Ii.set(0,0,0);const r=n.getSelector(),o=new wi.A(void 0),a=o.data;if(r&&r.isPointSelector){const t=r.Location;a.position=[t.x,t.y,t.z],Ii.fromArray(a.position)}const l=s.Position;if(l){const t=l.getSelector().Location;Mi.set(t.x,t.y,t.z);const e=Mi.sub(Ii);a.direction=e.toArray(),a.scale=e.length()}else i[0].localBoundingBox.getCenter(Mi),a.direction=Ii.sub(Mi).toArray(),a.scale=.001;e.getBody().forEach(t=>{var e;const i=(null===(e=t.getProperty("language"))||void 0===e?void 0:e.toUpperCase())||tt.Nm;if(t.isSound()){const e=o.data.audioId||Ei.A.generateId(),n=t.getLabelFromSelfOrSource().getValue();let s=c.audio.getAudioClip(e);void 0===s&&(s={id:e,name:null!=n?n:"New Audio Element",uris:{},captionUris:{},durations:{}},c.audio.addAudioClip(s),o.data.audioId=e,a.style="Extended");const r=t.getProperty("id");s.uris[i]=r,c.audio.updateAudioClip(e)}else{if(t.isSoundCaption())return;{const e=t.Value,n=e.indexOf("\n");if(n>=0){o.data.titles[i]=_i()(e.substring(0,n),{allowedTags:[]});const t=e.substring(n+1);if(t.indexOf("<img")>=0){const e=_i()(t,{allowedTags:["img"]});let n=document.createElement("div");n.innerHTML=e;const s=n.getElementsByTagName("img")[0];o.data.imageUri=s.src,o.data.imageAltText[i]=s.alt}o.data.leads[i]=_i()(t,{allowedTags:["b","i","em","strong","a","sup","sub"],allowedAttributes:{a:["href","target"]}}),a.style="Extended"}else o.data.titles[i]=_i()(e,{allowedTags:[]})}}}),e.getBody().forEach(t=>{var e;const i=(null===(e=t.getProperty("language"))||void 0===e?void 0:e.toUpperCase())||tt.Nm;if(t.isSoundCaption()){const e=c.audio.getAudioClip(o.data.audioId);e?e.captionUris[i]=t.getProperty("id"):console.warn("Caption file not loaded - no corresponding audio clip.")}});e.ScopeContent.forEach(e=>{const i=e.getBody()[0],n=(i.isSpecificResource()?i.getSource():i).getType();switch(n){case"perspectivecamera":case"orthographiccamera":const i=e.getBody()[0];Si.copy(this.getIIIFBodyTransform(i,e)),Ii.setFromMatrixPosition(Si);const s=this.getIIIFLookAtTransform(i,t,Ii,Ri);Ti.setFromRotationMatrix(s||Si,"YXZ"),Mi.setFromEuler(Ti).multiplyScalar(ui.A.RAD2DEG),Ii.applyMatrix4(Si.makeRotationFromEuler(Ti).invert());const r=c.snapshots,a=r.getTargetProperties(),l=a.findIndex(t=>"Orbit"==t.name),h=a.findIndex(t=>"Offset"==t.name),u=r.getCurrentValues();u[h]=Ii.toArray(),u[l]=Mi.toArray();const d=r.setState({values:u,curve:yi.kp.EaseOutQuad,duration:1,threshold:.5});o.set("viewId",d);break;default:console.log("Unsupported IIIF scope annotation type: "+n)}});i[0].getGraphComponent(Z.A).addAnnotation(o)}}),m.forEach(t=>{var e,i;const n=t.getTarget();if(n.isSpecificResource){const r=n.__jsonld.selector[0];if("PolygonZSelector"===r.type){const n=r.value,c=n.lastIndexOf("(")+1,h=n.slice(c,n.indexOf(")")).split(" "),u=[];for(let t=0;t<h.length;t+=3)u.push(new xi.Pq0(parseFloat(h[t]),parseFloat(h[t+1]),parseFloat(h[t+2])));const d=(new xi.LoY).setFromPoints(u);d.setIndex([0,1,2,2,3,0]),d.setAttribute("uv",new xi.THS(new Float32Array([0,1,0,0,1,0,1,1]),2)),d.computeVertexNormals();const p=t.getBody()[0].id,f=null===(i=null===(e=o.manifest)||void 0===e?void 0:e.getSequences()[0])||void 0===i?void 0:i.getCanvasById(p),g=f.getCanonicalImageUri(),m=f.getProperty("backgroundColor");s.getTexture(g).then(t=>{const e=new xi.eaF(d,new xi._4j({map:t,side:xi.$EB}));l.object3D.add(e),null!=a||(a=JSON.parse(o.manifestJson)),e.userData.IIIFCanvas=a.items.find(t=>t.id===p),m&&(Bi.set(m),e.material.onBeforeCompile=t=>{t.fragmentShader=t.fragmentShader.slice(0,t.fragmentShader.lastIndexOf("}")).concat("\n                                         if (!gl_FrontFacing) {\n                                             gl_FragColor = vec4("+Bi.toArray().toString()+", 1.0);\n                                         }\n                                         }")})})}}})})}),c.ins.saveState.set(),this.application=null}getIIIFBodyTransform(t,e){if(Ci.identity(),t.isSpecificResource()){(t.getTransform()||[]).forEach(t=>{if(Si.identity(),t.isTranslateTransform){const e=t.getTranslation();e&&(Ii.set(e.x,e.y,e.z),Si.setPosition(Ii))}else if(t.isRotateTransform){const e=t.getRotation();Ti.set(e.x*ui.A.DEG2RAD,e.y*ui.A.DEG2RAD,e.z*ui.A.DEG2RAD,"XYZ"),Si.makeRotationFromEuler(Ti)}else if(t.isScaleTransform){const e=t.getScale();Si.makeScale(e.x,e.y,e.z)}Ci.premultiply(Si)})}const i=e.getTarget();if(i&&i.isSpecificResource){const t=i.getSelector();t&&t.isPointSelector&&(Si.identity(),Si.setPosition(t.Location.x,t.Location.y,t.Location.z),Ci.premultiply(Si))}return Ci}getIIIFLookAtTransform(t,e,i,n){var s,r,o;if(Ci.identity(),null===(s=t.LookAt)||void 0===s?void 0:s.isPointSelector){const e=null===(r=t.LookAt)||void 0===r?void 0:r.Location;return Ci.lookAt(i,e,n),Ci}if(null===(o=t.LookAt)||void 0===o?void 0:o.id){const s=e.getAnnotationById(t.LookAt.id);return Mi.set(s.LookAtLocation.x,s.LookAtLocation.y,s.LookAtLocation.z),Ci.lookAt(i,Mi,n),Ci}return null}}class Li{constructor(t){this.manifestJson=null,this.manifestUrl=null,this.manifest=null,this.scenes=null,!function(t){try{JSON.parse(t)}catch(t){return!1}return!0}(t)?(this.manifestJson=null,this.manifestUrl=t):(this.manifestJson=t,this.manifestUrl=null,this.manifest=hi(t))}async loadManifest(){var t,e,i;this.manifestUrl&&(this.manifestJson=await(i=this.manifestUrl,Me.loadManifest(i))),this.manifestJson&&(this.manifest=await hi(this.manifestJson)),this.manifest&&(this.scenes=(null===(e=null===(t=this.manifest)||void 0===t?void 0:t.getSequences()[0])||void 0===e?void 0:e.getScenes())||[])}annotationsFromScene(t){return(null==t?void 0:t.getContent().concat(null==t?void 0:t.getNonContentAnnotations()))||[]}}class Di{get assetManager(){return this.system.getMainComponent(V.A)}get assetReader(){return this.system.getMainComponent(Q.A)}get documentProvider(){return this.system.getMainComponent(z.A)}get analytics(){return this.system.getMainComponent(j.A)}constructor(t,e,i){this.props=e||{},console.log(Di.splashMessage);const s=new n.A;s.add(o.A),s.add(k);const a=this.system=new r.A(s),l=a.graph.createCustomNode(G.A);a.graph.createCustomNode(O),a.graph.createCustomNode(H.A),this.analytics.startTimer(),t&&new q.A(this).appendTo(t),i||(this.documentProvider.createDocument(F),this.evaluateProps());(/^(iPad|iPhone|iPod)/.test(window.navigator.platform)||/^Mac/.test(window.navigator.platform)&&window.navigator.maxTouchPoints>1)&&(window.createImageBitmap=void 0),l.pulse.start()}dispose(){this.assetReader.dispose(),this.documentProvider.activeComponent.setup.floor.dispose(),this.documentProvider.activeComponent.setup.tape.dispose(),this.documentProvider.activeComponent.setup.grid.dispose(),this.documentProvider.activeComponent.clearNodeTree(),this.system.getMainComponent(X.A).views.forEach(t=>t.dispose())}setBaseUrl(t){this.assetManager.baseUrl=t}loadDocument(t,e,i){const n=$.a9[i];return this.assetReader.getJSON(t).then(i=>{if(!i.type||"Manifest"!=i.type)return e=void 0===e?!i.lights&&!i.cameras:e,this.documentProvider.amendDocument(i,t,e);new Pi(this).loadIIIFManifest(JSON.stringify(i))}).then(t=>(isFinite(n)&&t.setup.viewer.ins.quality.setValue(n),t))}reloadDocument(){const t=this.documentProvider.activeComponent;this.documentProvider.createDocument(F),this.evaluateProps(),null==t||t.dispose()}loadModel(t,e){return this.documentProvider.appendModel(t,e)}loadGeometry(t,e,i,n,s){return this.documentProvider.appendGeometry(t,e,i,n,s)}evaluateProps(){const t=Object.assign({},this.props),e=this.assetManager,i=new URL(window.location.href).searchParams;t.root=t.root||i.get("root")||i.get("r"),t.dracoRoot=t.dracoRoot||i.get("dracoRoot")||i.get("dr"),t.resourceRoot=t.resourceRoot||i.get("resourceRoot")||i.get("rr"),t.document=t.document||i.get("document")||i.get("d")||i.get("iiif-content"),t.model=t.model||i.get("model")||i.get("m"),t.geometry=t.geometry||i.get("geometry")||i.get("g"),t.texture=t.texture||i.get("texture")||i.get("t"),t.occlusion=t.occlusion||i.get("occlusion")||i.get("o"),t.normals=t.normals||i.get("normals")||i.get("n"),t.quality=t.quality||i.get("quality")||i.get("q"),t.uiMode=t.uiMode||i.get("uiMode")||i.get("u"),t.bgColor=t.bgColor||i.get("bgColor")||i.get("bc"),t.bgStyle=t.bgStyle||i.get("bgStyle")||i.get("bs"),t.controls=t.controls||i.get("controls")||i.get("ct"),t.prompt=t.prompt||i.get("prompt")||i.get("pm"),t.reader=t.reader||i.get("reader")||i.get("rdr"),t.lang=t.lang||i.get("lang")||i.get("l");const n=t.root||t.document||t.model||t.geometry,r=t.document&&t.document.startsWith("data:");if(this.setBaseUrl(r?"":new URL(n||".",window.location).href),t.uiMode){let e=0,i=!1;const n=Object.values(K.T).filter(t=>"string"==typeof t);t.uiMode.split("|").forEach(t=>{const s=t.toLowerCase();n.includes(s)&&(e+=K.T[s],i=!0)}),i&&this.documentProvider.activeComponent.setup.interface.ins.visibleElements.setValue(e)}t.dracoRoot&&this.assetReader.setDracoPath(t.dracoRoot),t.resourceRoot&&this.assetReader.setSystemAssetPath(t.resourceRoot),t.lang&&this.setLanguage(t.lang),t.document?(t.document=r?t.document:e.getAssetName(t.document),this.loadDocument(t.document,void 0,t.quality).then(()=>this.postLoadHandler(t)).catch(t=>s.Ay.show(`Failed to load document: ${t.message}`,"error"))):t.model?(t.model=e.getAssetName(t.model),this.assetReader.getText(t.model).then(()=>{this.loadModel(t.model,t.quality),this.postLoadHandler(t)}).catch(t=>s.Ay.show(`Bad Model Path: ${t.message}`,"error"))):t.geometry?(t.geometry=e.getAssetName(t.geometry),t.texture=t.texture?e.getAssetName(t.texture):null,t.occlusion=t.occlusion?e.getAssetName(t.occlusion):null,t.normals=t.normals?e.getAssetName(t.normals):null,this.assetReader.getText(t.geometry).then(()=>{this.loadGeometry(t.geometry,t.texture,t.occlusion,t.normals,t.quality),this.postLoadHandler(t)}).catch(t=>s.Ay.show(`Bad Geometry Path: ${t.message}`,"error"))):t.root&&this.loadDocument("scene.svx.json",void 0).then(()=>this.postLoadHandler(t)).catch(()=>{})}postLoadHandler(t){if(this.assetManager.ins.baseUrlValid.setValue(!0),t.bgColor){const e=t.bgColor.split(" ");this.setBackgroundColor(e[0],e[1]||null)}t.bgStyle&&this.setBackgroundStyle(t.bgStyle),t.controls&&this.enableNavigation(t.controls),t.prompt&&this.enablePrompt(t.prompt),t.reader&&this.enableReader(t.reader),t.lang&&this.setLanguage(t.lang),this.system.getMainComponent(z.A).activeComponent.setup.environment.ins.initialize.set()}toggleAnnotations(){const t=this.system.getMainComponent(z.A).activeComponent.setup.viewer.ins,e=this.system.getMainComponent(l.A).ins;e.visible.value&&e.visible.setValue(!1),t.annotationsVisible.setValue(!t.annotationsVisible.value),this.analytics.sendProperty("Annotations_Visible",t.annotationsVisible.value)}toggleReader(){const t=this.system.getMainComponent(z.A).activeComponent.setup.reader,e=t.ins;e.enabled.setValue(!e.enabled.value),e.focus.setValue(e.enabled.value),e.enabled.value&&e.articleId.setValue(1===t.articles.length?t.articles[0].article.id:""),this.analytics.sendProperty("Reader_Enabled",e.enabled.value)}toggleTours(){const t=this.system.getMainComponent(z.A).activeComponent.setup.tours.ins,e=this.system.getMainComponent(z.A).activeComponent.setup.reader.ins;t.enabled.value?t.enabled.setValue(!1):(e.enabled.value&&e.enabled.setValue(!1),t.enabled.setValue(!0),t.tourIndex.setValue(-1)),this.analytics.sendProperty("Tours_Enabled",t.enabled.value)}toggleTools(){const t=this.system.getMainComponent(l.A).ins,e=this.system.getMainComponent(z.A).activeComponent.setup.viewer.ins;e.annotationsVisible.value&&e.annotationsVisible.setValue(!1),t.visible.setValue(!t.visible.value),this.analytics.sendProperty("Tools_Visible",t.visible.value)}toggleMeasurement(){const t=this.system.getMainComponent(z.A).activeComponent.setup.tape.ins;t.visible.setValue(!t.visible.value)}enableAR(){this.system.getMainComponent(W.A).ins.enabled.setValue(!0),this.analytics.sendProperty("AR_enabled",!0)}getArticles(){return this.system.getMainComponent(z.A).activeComponent.setup.reader.articles.map(t=>t.article.data)}getAnnotations(){const t=this.system.getComponent(J.A).getGraphComponents(Z.A);let e=[];return t.forEach(t=>{e=e.concat(t.getAnnotations())}),e}getCameraOrbit(t){const e=this.system.getMainComponent(z.A).activeComponent.setup.navigation.ins;let i=e.orbit.value;if(t){const n=t.toLowerCase();if("max"===n)i=e.maxOrbit.value;else if("min"===n)i=e.minOrbit.value;else if("active"!==n)return void console.error("Error: getCameraOrbit invalid type param.")}return i.slice(0,2)}setCameraOrbit(t,e){const i=this.system.getMainComponent(z.A).activeComponent.setup.navigation.ins,n=parseFloat(t),s=parseFloat(e);isNaN(n)||isNaN(s)?console.error("Error: setCameraOrbit param is not a number."):i.orbit.setValue([n,s,0])}getCameraOffset(t){const e=this.system.getMainComponent(z.A).activeComponent.setup.navigation.ins;let i=e.offset.value;if(t){const n=t.toLowerCase();if("max"===n)i=e.maxOffset.value;else if("min"===n)i=e.minOffset.value;else if("active"!==n)return void console.error("Error: getCameraOffset invalid type param.")}return i.slice(0,3)}setCameraOffset(t,e,i){const n=this.system.getMainComponent(z.A).activeComponent.setup.navigation.ins;let s=parseFloat(t),r=parseFloat(e),o=parseFloat(i);if(isNaN(s)||isNaN(r)||isNaN(o))console.error("Error: setCameraOffset param is not a number.");else{const t=n.minOffset.value,e=n.maxOffset.value;s=(0,Y.q)(s,t[0],e[0]),r=(0,Y.q)(r,t[1],e[1]),o=(0,Y.q)(o,t[2],e[2]),n.offset.setValue([s,r,o])}}setBackgroundColor(t,e){const i=this.system.getMainComponent(z.A).activeComponent.setup.background.ins,n=document.createElement("div");if(n.id="temp-color",n.style.color=t,document.body.appendChild(n),""!==n.style.color){const t=getComputedStyle(n).color.split("(")[1].split(")")[0].split(",").map(t=>parseInt(t)/255);i.color0.setValue(t)}else console.error("Error: Color0 param is invalid.");if(e)if(n.style.color=e,""!==n.style.color){const t=getComputedStyle(n).color.split("(")[1].split(")")[0].split(",").map(t=>parseInt(t)/255);i.color1.setValue(t)}else console.error("Error: Color1 param is invalid.");document.body.removeChild(n)}setBackgroundStyle(t){const e=this.system.getMainComponent(z.A).activeComponent.setup.background.ins,i=Object.values(d.zZ).filter(t=>"string"==typeof t).find(e=>e.toLowerCase()===t.toLowerCase());void 0!==i?e.style.setValue(d.zZ[i]):console.error("Error: Style param is invalid.")}setTourStep(t,e,i){const n=this.system.getMainComponent(z.A).activeComponent.setup.tours.ins,s=this.system.getMainComponent(z.A).activeComponent.setup.tours.outs;let r=parseInt(t),o=parseInt(e);!isNaN(r)&&!isNaN(o)&&r>=0&&o>=0?(n.tourIndex.setValue(r),i?(s.stepIndex.setValue(o-1),n.next.set()):n.stepIndex.setValue(o)):console.error("Error: setTourStep param ["+r+" "+o+"] is not a valid number.")}getTours(){return this.system.getMainComponent(z.A).activeComponent.setup.tours.tours}enableNavigation(t){const e=this.isTrue(t);if(null!=e){this.system.getMainComponent(z.A).activeComponent.setup.navigation.ins.pointerEnabled.setValue(e)}else console.error("Error: enableNavigation param is not valid.")}enablePrompt(t){const e=this.isTrue(t);if(null!=e){this.system.getMainComponent(z.A).activeComponent.setup.navigation.ins.promptEnabled.setValue(e)}else console.error("Error: enablePrompt param is not valid.")}enableReader(t){const e=this.isTrue(t);if(null!=e){this.system.getMainComponent(z.A).activeComponent.setup.reader.ins.visible.setValue(e)}else console.error("Error: enableReader param is not valid.")}setLanguage(t){const e=this.system.getMainComponent(z.A).activeComponent.setup.language.ins,i=t.toUpperCase();i in tt.aL?e.activeLanguage.setValue(tt.aL[i]):console.error("Error: setLanguage param is not a valid language id.")}getActiveLanguage(){const t=this.system.getMainComponent(z.A).activeComponent.setup.language.ins.activeLanguage;return tt.aL[t.value]}getLanguages(){return this.system.getMainComponent(z.A).activeComponent.setup.language.sceneLanguages.map(t=>tt.aL[t.id])}setActiveArticle(t){const e=this.system.getMainComponent(z.A).activeComponent.setup.reader;e.ins.enabled.setValue(!0),e.ins.articleId.setValue(t)}resetViewer(){this.system.getMainComponent(z.A).activeComponent.setup.resetViewer()}isTrue(t){let e;const i=t.toLowerCase();return"true"===i?e=!0:"false"===i&&(e=!1),e}}Di.splashMessage="\n  _________       .__  __  .__                        .__                ________ ________   \n /   _____/ _____ |__|/  |_|  |__   __________   ____ |__|____    ____   \\_____  \\\\______ \\  \n \\_____  \\ /     \\|  \\   __\\  |  \\ /  ___/  _ \\ /    \\|  \\__  \\  /    \\    _(__  < |    |  \\ \n /        \\  Y Y  \\  ||  | |   Y  \\\\___ (  <_> )   |  \\  |/ __ \\|   |  \\  /       \\|    `   \\\n/_______  /__|_|  /__||__| |___|  /____  >____/|___|  /__(____  /___|  / /______  /_______  /\n        \\/      \\/              \\/     \\/           \\/        \\/     \\/         \\/        \\/ \n    \nVoyager - 3D Explorer and Tool Suite\n3D Foundation Project\n(c) 2025 Smithsonian Institution\n\nhttps://3d.si.edu\nhttps://github.com/smithsonian/dpo-voyager\n\n-----------------------------------------------------\nVersion: Voyager c3f0186-dirty  PROD\n-----------------------------------------------------\n    ",window.VoyagerExplorer=Di},935:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s=i(3151),r=i(25),o={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:t,schemaCode:e}){const i="maxLength"===t?"more":"fewer";return n.str`must NOT have ${i} than ${e} characters`},params:({schemaCode:t})=>n._`{limit: ${t}}`},code(t){const{keyword:e,data:i,schemaCode:o,it:a}=t,l="maxLength"===e?n.operators.GT:n.operators.LT,c=!1===a.opts.unicode?n._`${i}.length`:n._`${(0,s.useFunc)(t.gen,r.default)}(${i})`;t.fail$data(n._`${c} ${l} ${o}`)}};e.default=o},945:t=>{t.exports={nanoid:(t=21)=>{let e="",i=0|t;for(;i--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return e},customAlphabet:(t,e=21)=>(i=e)=>{let n="",s=0|i;for(;s--;)n+=t[Math.random()*t.length|0];return n}}},946:(t,e,i)=>{"use strict";i.d(e,{e:()=>n});const n=function(t){return Object.keys(t).filter(t=>isNaN(Number(t)))}},991:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3151),s={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){const{gen:e,schema:i,it:s}=t;if((0,n.alwaysValidSchema)(s,i))return void t.fail();const r=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},r),t.failResult(r,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};e.default=s},1024:(t,e,i)=>{"use strict";let n=i(6613);class s extends n{constructor(t){super(t),this.type="atrule"}append(...t){return this.proxyOf.nodes||(this.nodes=[]),super.append(...t)}prepend(...t){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...t)}}t.exports=s,s.default=s,n.registerAtRule(s)},1046:(t,e,i)=>{"use strict";i.d(e,{c:()=>r,v:()=>s});var n=i(4709);function s(t){let e=r.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},r.set(t.type,e));let i=e.stringsArray.get(t.strings);if(void 0!==i)return i;const s=t.strings.join(n.xL);return i=e.keyString.get(s),void 0===i&&(i=new n.Bj(t,t.getTemplateElement()),e.keyString.set(s,i)),e.stringsArray.set(t.strings,i),i}const r=new Map},1071:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n=i(3423),s=i(4955),r=i(2222),o=i(2902);class a extends s.A{constructor(t,e){super(t,e),this.outs=this.addOutputs(a.outs),this.scope=s.k.Graph}get documentProvider(){return this.getComponent(o.A)}create(){super.create(),this.documentProvider.on("active-component",this.onActiveDocument,this)}dispose(){this.documentProvider.off("active-component",this.onActiveDocument,this),super.dispose()}onActiveDocument(t){this.scopedGraph=t.next}onActiveNode(t,e){this.outs.activeNode.setValue(e);const i=this.selection;e?i.nodeContainsSelectedComponent(e)||i.selectNode(e):t&&i.clearSelection()}onScopedNodes(){this.outs.changedNodes.set()}}a.typeName="CVNodeProvider",a.nodeType=r.A,a.followComponentSelection=!0,a.outs={activeNode:n.gK.Object("Nodes.Active",r.A),changedNodes:n.gK.Event("Nodes.Changed")}},1086:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var n=i(4640),s=i(8424);const r=new n.Pq0,o=new n.Pq0,a=new n.kn4,l=new n.PTz,c=new n.O9p;class h extends s.Ay{get settingProperties(){return[this.ins.position,this.ins.rotation,this.ins.scale]}get snapshotProperties(){return[this.ins.position,this.ins.rotation,this.ins.scale]}fromData(t){const{position:e,rotation:i,order:h,scale:u}=this.ins,d=s.I8[h.getValidatedValue()];t.name&&(this.object3D.name=t.name),t.matrix?(a.fromArray(t.matrix),a.decompose(r,l,o),r.toArray(e.value),c.setFromQuaternion(l,d),r.setFromEuler(c).multiplyScalar(n.cj9.RAD2DEG).toArray(i.value),o.toArray(u.value),e.set(),i.set(),u.set()):(t.translation&&e.setValue(t.translation.slice()),t.rotation&&(l.fromArray(t.rotation),c.setFromQuaternion(l,d),r.setFromEuler(c).multiplyScalar(n.cj9.RAD2DEG).toArray(i.value),i.set()),t.scale&&u.setValue(t.scale.slice()),this.transform.changed=!0)}toData(){this.object3D.matrix.decompose(r,l,o);const t={};return 0===r.x&&0===r.y&&0===r.z||(t.translation=r.toArray()),0===l.x&&0===l.y&&0===l.z&&1===l.w||(t.rotation=l.toArray()),1===o.x&&1===o.y&&1===o.z||(t.scale=o.toArray()),t}}h.typeName="CVNode",h.text="Transform",h.icon=""},1142:(t,e,i)=>{"use strict";i.d(e,{c:()=>n,s:()=>s});const n={},s={}},1155:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s=i(3151),r=i(7430),o={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:t})=>n._`{allowedValue: ${t}}`},code(t){const{gen:e,data:i,$data:o,schemaCode:a,schema:l}=t;o||l&&"object"==typeof l?t.fail$data(n._`!${(0,s.useFunc)(e,r.default)}(${i}, ${a})`):t.fail(n._`${l} !== ${i}`)}};e.default=o},1160:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>l,EM:()=>o.EM,gK:()=>n.gK,iv:()=>c,qy:()=>o.qy});var n=i(3423),s=i(3365),r=i(8604),o=i(4240),a=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class l extends s.A{constructor(){super(...arguments),this.ins=this.addInputs(l.toolIns),this.outs=this.addOutputs(l.toolOuts),this._isActiveTool=!1,this._enabled=!0}get isActiveTool(){return this._isActiveTool}get enabled(){return this._enabled}set enabled(t){this._enabled=t}dispose(){this._isActiveTool&&this.deactivateTool(),super.dispose()}createView(){throw new Error("must override")}activateTool(){this._isActiveTool=!0,this.startObserving()}deactivateTool(){this.stopObserving(),this._isActiveTool=!1}}l.typeName="CVTool",l.toolIns={},l.toolOuts={};class c extends o.Ay{get analytics(){return this.system.getMainComponent(r.A)}constructor(t){super(t.system),this.tool=null,this.needsFocus=!1,this.tool=t}firstConnected(){this.classList.add("sv-group","sv-tool-view"),this.needsFocus=!0}connected(){super.connected(),this.tool.on("update",this.onUpdate,this)}disconnected(){this.tool.off("update",this.onUpdate,this),super.disconnected()}updated(t){super.updated(t),this.needsFocus&&(this.setFocus(),this.needsFocus=!1)}setFocus(){}}a([(0,o.MZ)({attribute:!1})],c.prototype,"tool",void 0)},1168:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getRules=e.isJSONType=void 0;const i=new Set(["string","number","integer","boolean","null","object","array"]);e.isJSONType=function(t){return"string"==typeof t&&i.has(t)},e.getRules=function(){const t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}},1192:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=new Uint16Array("Ȁaglq\tɭ\0\0p;䀦os;䀧t;䀾t;䀼uot;䀢".split("").map(function(t){return t.charCodeAt(0)}))},1229:(t,e,i)=>{"use strict";i.d(e,{A:()=>E});var n=i(5940),s=i(3423),r=i(4640),o=i(4424),a=i(8424),l=i(6436);class c extends o.Ay{constructor(t,e){super(t,e),this.ins=this.addInputs(c.rgIns),this._object3D=null,this._isAttached=!1,this._object3D=new r.B69,this._object3D.name="Graph",this._object3D.matrixAutoUpdate=!1}get transform(){return this.node.components.get(a.Ay,!0)}get scene(){const t=this.transform;return t?t.getParentComponent(l.A,!0):void 0}get object3D(){return this._object3D}create(){super.create(),this.innerRoots.filter(t=>t.is(a.Ay)).forEach(t=>this._object3D.add(t.object3D)),this.trackComponent(a.Ay,t=>this.ins.visible.value&&this.attachObject3D(t),t=>this.detachObject3D(t))}dispose(){this.detachObject3D(this.transform),this.innerRoots.filter(t=>t.is(a.Ay)).forEach(t=>this._object3D.remove(t.object3D)),super.dispose()}update(t){super.update(t);const e=this.ins;if(e.visible.changed){const t=this.transform;e.visible.value?this.attachObject3D(t):this.detachObject3D(t)}return!0}onAddInnerRoot(t){t.is(a.Ay)&&this._object3D.add(t.object3D)}onRemoveInnerRoot(t){t.is(a.Ay)&&this._object3D.remove(t.object3D)}attachObject3D(t){this._isAttached||t&&(t.object3D.add(this._object3D),this._isAttached=!0)}detachObject3D(t){this._isAttached&&t&&(t.object3D.remove(this._object3D),this._isAttached=!1)}}c.typeName="CRenderGraph",c.rgIns={visible:o.gK.Boolean("Graph.Visible",!0)};var h=i(2382),u=i.n(h);const d=JSON.parse('{"$id":"https://schemas.3d.si.edu/voyager/document.schema.json","$schema":"http://json-schema.org/draft-07/schema#","title":"Smithsonian 3D Document","description":"Describes a 3D document containing a scene with 3D models.","definitions":{"scene":{"$id":"#scene","type":"object","properties":{"nodes":{"type":"array","description":"The indices of the scene\'s root nodes.","items":{"type":"integer","minimum":0},"uniqueItems":true,"minItems":1},"setup":{"description":"The index of the scene\'s setup.","type":"integer","minimum":0}}},"node":{"$id":"#node","type":"object","properties":{"name":{"type":"string"},"children":{"type":"array","description":"The indices of this node\'s children.","items":{"type":"integer","minimum":0},"uniqueItems":true,"minItems":1},"matrix":{"description":"A floating-point 4x4 transformation matrix stored in column-major order.","type":"array","items":{"type":"number"},"minItems":16,"maxItems":16,"default":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},"translation":{"description":"The node\'s translation along the x, y, and z axes.","type":"array","items":{"type":"number"},"minItems":3,"maxItems":3,"default":[0,0,0]},"rotation":{"description":"The node\'s unit quaternion rotation in the order (x, y, z, w), where w is the scalar.","type":"array","items":{"type":"number","minimum":-1,"maximum":1},"minItems":4,"maxItems":4,"default":[0,0,0,1]},"scale":{"description":"The node\'s non-uniform scale, given as the scaling factors along the x, y, and z axes.","type":"array","items":{"type":"number"},"minItems":3,"maxItems":3,"default":[1,1,1]},"camera":{"description":"The index of the camera component of this node.","type":"integer","minimum":0},"light":{"description":"The index of the light component of this node.","type":"integer","minimum":0},"meta":{"description":"The index of the meta data component of this node.","type":"integer","minimum":0},"model":{"description":"The index of the model component of this node.","type":"integer","minimum":0}},"not":{"anyOf":[{"required":["matrix","translation"]},{"required":["matrix","rotation"]},{"required":["matrix","scale"]}]}},"camera":{"$id":"#camera","type":"object","properties":{"type":{"description":"Specifies if the camera uses a perspective or orthographic projection.","type":"string","enum":["perspective","orthographic"]},"perspective":{"description":"A perspective camera containing properties to create a perspective projection matrix.","type":"object","properties":{"yfov":{"type":"number","description":"The floating-point vertical field of view in radians.","exclusiveMinimum":0},"aspectRatio":{"type":"number","description":"The floating-point aspect ratio of the field of view.","exclusiveMinimum":0},"znear":{"type":"number","description":"The floating-point distance to the near clipping plane.","exclusiveMinimum":0},"zfar":{"type":"number","description":"The floating-point distance to the far clipping plane.","exclusiveMinimum":0}},"required":["yfov","znear"]},"orthographic":{"description":"An orthographic camera containing properties to create an orthographic projection matrix.","type":"object","properties":{"xmag":{"type":"number","description":"The floating-point horizontal magnification of the view. Must not be zero."},"ymag":{"type":"number","description":"The floating-point vertical magnification of the view. Must not be zero."},"znear":{"type":"number","description":"The floating-point distance to the near clipping plane.","exclusiveMinimum":0},"zfar":{"type":"number","description":"The floating-point distance to the far clipping plane. `zfar` must be greater than `znear`.","exclusiveMinimum":0}},"required":["ymag","znear","zfar"]},"autoNearFar":{"type":"boolean","default":true}},"required":["type"],"not":{"required":["perspective","orthographic","autoNearFar"]}},"light":{"$id":"#light","type":"object","properties":{"type":{"description":"Specifies the type of the light source.","type":"string","enum":["ambient","directional","point","spot","hemisphere","rect","environment"]},"color":{"$ref":"#/definitions/colorRGB"},"intensity":{"type":"number","minimum":0,"default":1},"castShadow":{"type":"boolean","default":false},"point":{"type":"object","properties":{"distance":{"type":"number","minimum":0},"decay":{"type":"number","minimum":0}}},"spot":{"type":"object","properties":{"distance":{"type":"number","minimum":0},"decay":{"type":"number","minimum":0},"angle":{"type":"number","minimum":0},"penumbra":{"type":"number","minimum":0}}},"hemisphere":{"type":"object","properties":{"groundColor":{"$ref":"#/definitions/colorRGB"}}}},"required":["type"],"not":{"required":["point","spot","hemisphere"]}},"colorRGB":{"$id":"#colorRGB","type":"array","items":{"type":"number","minimum":0,"maximum":1},"minItems":3,"maxItems":3,"default":[1,1,1]}},"type":"object","properties":{"asset":{"type":"object","properties":{"type":{"type":"string","const":"application/si-dpo-3d.document+json"},"version":{"description":"Version of this presentation description.","type":"string","minLength":1},"copyright":{"description":"A copyright message to credit the content creator.","type":"string","minLength":0},"generator":{"description":"Tool that generated this presentation description.","type":"string","minLength":1}},"required":["type","version"]},"scene":{"description":"Index of the root scene of the document.","type":"integer","minimum":0},"scenes":{"description":"An array of scenes.","type":"array","items":{"$ref":"#/definitions/scene"}},"nodes":{"description":"An array of nodes.","type":"array","items":{"$ref":"#/definitions/node"},"minItems":1},"metas":{"description":"An array of meta data components.","type":"array","items":{"$ref":"./meta.schema.json"}},"setups":{"description":"An array of setup components.","type":"array","items":{"$ref":"./setup.schema.json"},"minItems":1},"cameras":{"description":"An array of camera components.","type":"array","items":{"$ref":"#/definitions/camera"},"minItems":1},"lights":{"description":"An array of light components.","type":"array","items":{"$ref":"#/definitions/light"},"minItems":1},"models":{"description":"An array of model components.","type":"array","items":{"$ref":"./model.schema.json"},"minItems":1}},"required":["asset","scene","scenes"],"additionalProperties":false}'),p=JSON.parse('{"$id":"https://schemas.3d.si.edu/voyager/common.schema.json","$schema":"http://json-schema.org/draft-07/schema#","title":"Math","description":"Definitions for mathematical compound objects such as vectors and matrices.","definitions":{"units":{"$id":"#units","type":"string","enum":["inherit","mm","cm","m","km","in","ft","yd","mi"]},"vector2":{"description":"2-component vector.","$id":"#vector2","type":"array","items":{"type":"number"},"minItems":2,"maxItems":2,"default":[0,0]},"vector3":{"description":"3-component vector.","$id":"#vector3","type":"array","items":{"type":"number"},"minItems":3,"maxItems":3,"default":[0,0,0]},"vector4":{"description":"4-component vector.","$id":"#vector4","type":"array","items":{"type":"number"},"minItems":4,"maxItems":4,"default":[0,0,0,0]},"matrix3":{"description":"3 by 3, matrix, storage: column-major.","$id":"#matrix3","type":"array","items":{"type":"number"},"minItems":9,"maxItems":9,"default":[1,0,0,0,1,0,0,0,1]},"matrix4":{"description":"4 by 4 matrix, storage: column-major.","$id":"#matrix4","type":"array","items":{"type":"number"},"minItems":16,"maxItems":16,"default":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},"boundingBox":{"description":"Axis-aligned 3D bounding box.","$id":"#boundingBox","type":"object","properties":{"min":{"$ref":"#/definitions/vector3"},"max":{"$ref":"#/definitions/vector3"}},"required":["min","max"]}}}'),f=JSON.parse('{"$id":"https://schemas.3d.si.edu/voyager/meta.schema.json","$schema":"http://json-schema.org/draft-07/schema#","title":"Meta","description":"Meta data for a scene or model item.","definitions":{"image":{"$id":"image","description":"Reference to a scene supplementing image","type":"object","properties":{"uri":{"description":"Location of the image resource, absolute URL or path relative to this document","type":"string","minLength":1},"quality":{"type":"string","enum":["Thumb","Low","Medium","High","HDR"]},"byteSize":{"type":"integer","minimum":1},"width":{"type":"integer","minimum":1},"height":{"type":"integer","minimum":1},"usage":{"type":"string","enum":["Render","Environment","ARCode"]}},"required":["uri","quality"]},"article":{"$id":"#article","description":"Reference to an external document (HTML)","type":"object","properties":{"id":{"type":"string","minLength":1},"title":{"description":"Short title.","type":"string"},"titles":{"description":"Short title with language key.","type":"object"},"lead":{"description":"Short lead text.","type":"string"},"leads":{"description":"Short lead text with language key.","type":"object"},"tags":{"description":"Array of tags, categorizing the article.","type":"array","items":{"type":"string"}},"taglist":{"description":"Array of tags, categorizing the annotation with language key.","type":"object"},"intros":{"description":"Introductory splash screen text with language key.","type":"object"},"uri":{"description":"Location of the article resource, absolute URL or path relative to this document","type":"string","minLength":1},"uris":{"description":"Location of the article resource, absolute URL or path relative to this document with language key","type":"object"},"mimeType":{"description":"MIME type of the resource.","type":"string"},"thumbnailUri":{"description":"Location of a thumbnail/preview image of the resource.","type":"string"}},"required":["id"],"additionalProperties":false},"audioclip":{"$id":"audioclip","description":"Reference to an audio file","type":"object","properties":{"id":{"type":"string","minLength":1},"name":{"description":"Short name.","type":"string"},"uris":{"description":"Location of the audio resource, absolute URL or path relative to this document with language key","type":"object"},"captionUris":{"description":"Location of the caption resource, absolute URL or path relative to this document with language key","type":"object"},"durations":{"description":"Length of the audio resource with language key","type":"object"}},"required":["id","uris"]},"action":{"$id":"action","description":"Reference to a Voyager action element","type":"object","properties":{"id":{"type":"string","minLength":1},"type":{"type":"string","enum":["PlayAnimation","PlayAudio"]},"trigger":{"type":"string","enum":["OnClick","OnLoad","OnAnnotation"]},"audioId":{"type":"string","minLength":1},"annotationId":{"type":"string","minLength":1},"animation":{"type":"string","minLength":1},"style":{"type":"string","enum":["Single","PingPong","Loop"]}},"required":["id","type","trigger"]}},"type":"object","properties":{"collection":{"description":"Information retrieved from the collection record for the item.","type":"object"},"process":{"description":"Information about how the item was processed.","type":"object"},"images":{"type":"array","items":{"$ref":"#/definitions/image"},"minItems":1},"articles":{"type":"array","items":{"$ref":"#/definitions/article"},"minItems":1},"leadArticle":{"description":"Index of the main article. This is the default article displayed with the item.","type":"integer","minimum":0},"audio":{"type":"array","items":{"$ref":"#/definitions/audioclip"},"minItems":0},"actions":{"type":"array","items":{"$ref":"#/definitions/action"},"minItems":0}},"additionalProperties":false}'),g=JSON.parse('{"$id":"https://schemas.3d.si.edu/voyager/model.schema.json","$schema":"http://json-schema.org/draft-07/schema#","title":"Model","description":"Describes the visual representations (models, derivatives) of a 3D item.","definitions":{"annotation":{"description":"Spatial annotation (hot spot, hot zone) on a model. Annotations can reference articles.","type":"object","properties":{"id":{"type":"string","minLength":1},"title":{"type":"string"},"titles":{"description":"Short title with language key.","type":"object"},"lead":{"type":"string"},"leads":{"description":"Short lead text with language key.","type":"object"},"marker":{"type":"string"},"tags":{"description":"Array of tags, categorizing the annotation.","type":"array","items":{"type":"string"}},"taglist":{"description":"Array of tags, categorizing the annotation with language key.","type":"object"},"articleId":{"description":"Id of an article related to this annotation.","type":"string","minLength":1},"imageUri":{"description":"URI of an image resource for this annotation.","type":"string","minLength":1},"imageCredit":{"description":"Credit line image in this annotation with language key.","type":"object"},"imageAltText":{"description":"Alt text for image in this annotation with language key","type":"object"},"audioId":{"description":"Id of an audio resource for this annotation.","type":"string","minLength":1},"viewId":{"description":"Id of a snapshot resource with camera view information for this annotation.","type":"string","minLength":1},"style":{"type":"string"},"visible":{"description":"Flag indicating whether the annotation is visible.","type":"boolean","default":true},"expanded":{"description":"Flag indicating whether the annotation is displayed in expanded state.","type":"boolean","default":false},"scale":{"description":"Scales the annotation relative to its default size.","type":"number","default":1},"offset":{"description":"Offsets the annotation along its direction.","type":"number","default":0},"tilt":{"description":"Tilt angle of the annotation relative to the direction vector in degrees.","type":"number","default":0},"azimuth":{"description":"Azimuth angle of a tilted annotation.","type":"number","default":0},"color":{"description":"Color of the annotation","type":"array","minItems":3,"maxItems":3,"items":{"type":"number"}},"position":{"description":"Position where the annotation is anchored, in local item coordinates.","$ref":"./common.schema.json#/definitions/vector3"},"direction":{"description":"Direction of the stem of this annotation, usually corresponds to the surface normal.","$ref":"./common.schema.json#/definitions/vector3"},"zoneIndex":{"description":"Index of the zone on the zone texture.","type":"integer","minimum":0}},"required":["id"],"additionalProperties":false},"derivative":{"description":"Visual representation derived from the master model.","type":"object","properties":{"usage":{"description":"usage categories for a derivative.","type":"string","enum":["Image2D","Web3D","App3D","iOSApp3D","Print3D","Editorial3D"]},"quality":{"type":"string","enum":["Thumb","Low","Medium","High","Highest","AR"]},"assets":{"description":"List of individual resources this derivative is composed of.","type":"array","items":{"$ref":"#/definitions/asset"}}}},"asset":{"description":"an individual resource for a 3D model.","type":"object","properties":{"uri":{"type":"string","minLength":1},"type":{"type":"string","enum":["Model","Geometry","Image","Texture","Points","Volume"]},"part":{"type":"string","minLength":1},"mimeType":{"type":"string","minLength":1},"byteSize":{"type":"integer","minimum":1},"numFaces":{"type":"integer","minimum":1},"imageSize":{"type":"integer","minimum":1},"mapType":{"type":"string","enum":["Color","Normal","Occlusion","Emissive","MetallicRoughness","Zone"]}},"required":["uri","type"]},"material":{"description":"Surface properties for this model, shared by all derivatives.","type":"object","properties":{}}},"type":"object","properties":{"units":{"$ref":"./common.schema.json#/definitions/units"},"tags":{"type":"string"},"visible":{"type":"boolean"},"renderOrder":{"type":"number"},"overlayMap":{"type":"number"},"shadowSide":{"type":"string","enum":["Front","Back","Double"]},"derivatives":{"type":"array","items":{"$ref":"#/definitions/derivative"}},"translation":{"description":"Translation vector. Must be applied to bring model into its \'neutral\' pose.","$ref":"./common.schema.json#/definitions/vector3"},"rotation":{"description":"Rotation quaternion. Must be applied to bring model into its \'neutral\' pose.","$ref":"./common.schema.json#/definitions/vector4"},"boundingBox":{"description":"Bounding box for this model, shared by all derivatives.","$ref":"./common.schema.json#/definitions/boundingBox"},"material":{"$ref":"#/definitions/material"},"annotations":{"description":"List of annotations to be displayed with the model","type":"array","items":{"$ref":"#/definitions/annotation"}}},"required":["units","derivatives"],"additionalProperties":false}'),m=JSON.parse('{"$id":"https://schemas.3d.si.edu/voyager/setup.schema.json","$schema":"http://json-schema.org/draft-07/schema#","title":"Setup","description":"Tours and settings for explorer documents (background, interface, etc.)","definitions":{"viewer":{"type":"object","properties":{"shader":{"type":"string"},"exposure":{"type":"number"},"toneMapping":{"type":"boolean"},"gamma":{"type":"number"},"annotationsVisible":{"type":"boolean"},"isWallMountAR":{"type":"boolean"},"arScale":{"type":"number"},"activeTags":{"type":"string"},"sortedTags":{"type":"string"},"radioTags":{"type":"boolean"}},"required":["shader","exposure","gamma"]},"reader":{"type":"object","properties":{"enabled":{"type":"boolean"},"position":{"type":"string"},"articleId":{"description":"Id of the article currently displayed in the reader.","type":"string","minLength":1}}},"interface":{"type":"object","properties":{"visible":{"type":"boolean"},"logo":{"type":"boolean"},"menu":{"type":"boolean"},"tools":{"type":"boolean"}}},"navigation":{"type":"object","properties":{"type":{"type":"string","enum":["Orbit","Fly","Walk"]},"enabled":{"type":"boolean"},"autoZoom":{"type":"boolean"},"autoRotation":{"type":"boolean"},"lightsFollowCamera":{"type":"boolean"},"orbit":{"$comment":"TODO: Implement","type":"object","properties":{}},"walk":{"$comment":"TODO: Implement","type":"object","properties":{}}}},"background":{"type":"object","properties":{"style":{"type":"string","enum":["Solid","LinearGradient","RadialGradient"]},"color0":{"$ref":"./common.schema.json#/definitions/vector3"},"color1":{"$ref":"./common.schema.json#/definitions/vector3"}}},"floor":{"type":"object","properties":{"visible":{"type":"boolean"},"position":{"$ref":"./common.schema.json#/definitions/vector3"},"size":{"type":"number"},"color":{"$ref":"./common.schema.json#/definitions/vector3"},"opacity":{"type":"number"},"receiveShadow":{"type":"boolean"},"autoSize":{"type":"boolean"}}},"grid":{"type":"object","properties":{"visible":{"type":"boolean"},"color":{"$ref":"./common.schema.json#/definitions/vector3"}}},"tape":{"type":"object","properties":{"enabled":{"type":"boolean"},"startPosition":{"$ref":"./common.schema.json#/definitions/vector3"},"startDirection":{"$ref":"./common.schema.json#/definitions/vector3"},"endPosition":{"$ref":"./common.schema.json#/definitions/vector3"},"endDirection":{"$ref":"./common.schema.json#/definitions/vector3"}}},"slicer":{"type":"object","properties":{"enabled":{"type":"boolean"},"axis":{"type":"string","enum":["X","Y","Z"]},"inverted":{"type":"boolean"},"position":{"type":"number"},"color":{"$ref":"./common.schema.json#/definitions/vector3"}}},"audio":{"type":"object","properties":{"narrationId":{"type":"string"}}},"language":{"type":"object","properties":{"language":{"type":"string","enum":["EN","ES","DE","NL","JA","FR","HAW","IT","AR"]}}},"tours":{"description":"Animated tours.","type":"array","items":{"type":"object","properties":{"title":{"type":"string"},"titles":{"description":"Short title with language key.","type":"object"},"lead":{"type":"string"},"leads":{"description":"Short lead text with language key.","type":"object"},"tags":{"description":"Array of tags, categorizing the tour.","type":"array","items":{"type":"string"}},"taglist":{"description":"Array of tags, categorizing the annotation with language key.","type":"object"},"steps":{"type":"array","items":{"type":"object","properties":{"title":{"type":"string"},"titles":{"description":"Short title with language key.","type":"object"},"id":{"type":"string"}}}}}}},"snapshots":{"description":"Snapshots are animatable scene states.","type":"object","properties":{"features":{"type":"array","items":{"type":"string"}},"targets":{"type":"array","items":{"type":"string"}},"states":{"type":"array","items":{"type":"object"}}}}},"type":"object","properties":{"units":{"$ref":"./common.schema.json#/definitions/units"},"interface":{"$ref":"#/definitions/interface"},"viewer":{"$ref":"#/definitions/viewer"},"reader":{"$ref":"#/definitions/reader"},"navigation":{"$ref":"#/definitions/navigation"},"background":{"$ref":"#/definitions/background"},"floor":{"$ref":"#/definitions/floor"},"grid":{"$ref":"#/definitions/grid"},"tape":{"$ref":"#/definitions/tape"},"slicer":{"$ref":"#/definitions/slicer"},"tours":{"$ref":"#/definitions/tours"},"language":{"$ref":"#/definitions/language"},"audio":{"$ref":"#/definitions/audio"}}}');var A=i(2222),v=i(3164),y=i(8313),b=i(1721),_=i(161),x=i(8604),w=i(3675);class E extends c{constructor(t,e){super(t,e),this.titles={},this.intros={},this._meta=null,this.ins=this.addInputs(E.ins),this.outs=this.addOutputs(E.outs),this.innerGraph.createCustomNode(v.A),this.ins.active.setValue(!1),this.ins.visible.setValue(!1)}get root(){return this.innerNodes.get(v.A)}get setup(){return this.innerComponents.get(b.A)}get assetPath(){return this.outs.assetPath.value}get assetBaseName(){let t=this.assetPath;const e=t.indexOf(".svx.json");return e>=0&&(t=t.substr(0,e)),t}get meta(){return this._meta}titleIn(t){return this.titles[w.aL[t]]||""}get analytics(){return this.getMainComponent(x.A)}create(){super.create(),this.innerGraph.components.on(y.A,this.onMetaComponent,this),this.setup.language.outs.activeLanguage.on("value",this.onLanguageUpdate,this)}dispose(){this.setup.language.outs.activeLanguage.off("value",this.onLanguageUpdate,this),this.innerGraph.components.off(y.A,this.onMetaComponent,this),super.dispose()}update(t){super.update(t);const{ins:e,outs:i}=this;if(e.dumpJson.changed){const t=this.deflateDocument();console.log("-------------------- VOYAGER DOCUMENT --------------------"),console.log(JSON.stringify(t,(t,e)=>"number"==typeof e?parseFloat(e.toFixed(5)):e,2))}if(e.dumpTree.changed&&(console.log("-------------------- VOYAGER DOCUMENT --------------------"),this.dump()),e.download.changed){const t=i.assetPath.value.split("/").pop()||"voyager-document.json";n.A.json(this.deflateDocument(),t)}if(e.title.changed&&this.titles){const t=this.setup.language;e.title.setValue(e.title.value,!0),i.title.setValue(e.title.value),e.title.value&&(this.titles[w.aL[t.outs.activeLanguage.value]]=e.title.value,this.updateMeta())}if(e.intro.changed&&this.intros){const t=this.setup.language;i.intro.setValue(e.intro.value),this.intros[w.aL[t.outs.activeLanguage.value]]=e.intro.value,this.updateMeta()}return!0}clearNodeTree(){this.root.transform.children.slice().forEach(t=>t.node.dispose())}openDocument(t,e,i){var n;if(!E.validator.validate(t))throw new Error("document schema validation failed");i||(this.clearNodeTree(),this.ins.title.setValue(null)),this.ins.copyright.setValue(null!==(n=t.asset.copyright)&&void 0!==n?n:this.ins.copyright.schema.preset),this.onMetaComponent({type:"CVMeta",object:this.root.meta,add:!0,remove:!1});let s="object"==typeof i?i:this.root;if(s.graph!==this.innerGraph)throw new Error("invalid parent node");const r=new Map;if(s instanceof v.A)s.fromDocument(t,t.scene,r);else{t.scenes[t.scene].nodes.forEach(e=>{const i=this.innerGraph.createCustomNode(A.A);s.transform.addChild(i.transform),i.fromDocument(t,e,r)})}e&&(this.outs.assetPath.setValue(e),this.name=this.getMainComponent(_.A).getAssetName(e))}appendModel(t,e,i){if(i&&i.graph!==this.innerGraph)throw new Error("invalid parent node");if(this.isEmpty())throw new Error("empty document, can't append model");i=i||this.root;const n=this.innerGraph.createCustomNode(A.A);i.transform.addChild(n.transform),n.createModel();const s=n.model;return s.derivatives.createModelAsset(t,e),s}appendGeometry(t,e,i,n,s,r){if(r&&r.graph!==this.innerGraph)throw new Error("invalid parent node");if(this.isEmpty())throw new Error("empty document, can't append geometry");r=r||this.root;const o=this.innerGraph.createCustomNode(A.A);r.transform.addChild(o.transform),o.createModel();o.model.derivatives.createMeshAsset(t,e,i,n,s)}deflateDocument(t){if(this.isEmpty())throw new Error("empty document, can't serialize");const e={asset:{type:E.mimeType,version:E.version,generator:"Voyager"},scene:0,scenes:[]};this.ins.copyright.value.length>0&&(e.asset.copyright=this.ins.copyright.value);const i=new Map;return e.scene=this.root.toDocument(e,i,t),e}onMetaComponent(t){const e=t.object,i=this.ins.title,n=this.ins.intro,s=this.setup.language;null===this._meta&&(this._meta=e),t.add&&!i.value&&e.once("load",()=>{this.titles=e.collection.get("titles")||{},this.intros=e.collection.get("intros")||{},0===Object.keys(this.titles).length&&(this.titles[w.aL[s.outs.activeLanguage.value]]=e.collection.get("title")||"",e.collection.dictionary.titles=this.titles);const t=this.titles[w.aL[s.outs.activeLanguage.value]];i.setValue(t);const r=this.intros[w.aL[s.outs.activeLanguage.value]]||"";n.setValue(r),this.analytics.setTitle(t),this._meta=e})}onLanguageUpdate(){const t=this.setup.language,e=this.titles[w.aL[t.outs.activeLanguage.value]];this.ins.title.setValue(e);const i=this.intros[w.aL[t.outs.activeLanguage.value]]||"";this.ins.intro.setValue(i)}updateMeta(){const t=this.meta;t&&(t.collection.dictionary.titles=this.titles,t.collection.dictionary.intros=this.intros)}}E.typeName="CVDocument",E.mimeType="application/si-dpo-3d.document+json",E.version="1.0",E.validator=new class{constructor(){this._schemaValidator=new(u())({schemas:[d,p,f,g,m],allErrors:!0}),this._validateDocument=this._schemaValidator.getSchema("https://schemas.3d.si.edu/voyager/document.schema.json")}validate(t){return!!this._validateDocument(t)||(console.warn(this._schemaValidator.errorsText(this._validateDocument.errors,{separator:", ",dataVar:"document"})),!1)}},E.ins={dumpJson:s.gK.Event("Document.DumpJSON"),dumpTree:s.gK.Event("Document.DumpTree"),download:s.gK.Event("Document.Download"),title:s.gK.String("Document.Title"),intro:s.gK.String("Document.Intro",""),copyright:s.gK.String("Document.Copyright","")},E.outs={assetPath:s.gK.AssetPath("Asset.Path",{preset:"scene.svx.json"}),title:s.gK.String("Document.Title"),intro:s.gK.String("Document.Intro","")}},1266:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var n=i(9660);class s extends n.A{get settingProperties(){return[this.ins.style,this.ins.color0,this.ins.color1]}get snapshotProperties(){return[this.ins.color0,this.ins.color1]}constructor(t,e){super(t,e),this.background.layers.set(1)}fromData(t){this.ins.copyValues({style:n.z[t.style]||n.z.Solid,color0:t.color0||[.2,.25,.3],color1:t.color1||[.01,.03,.05]})}toData(){const t=this.ins;return{style:n.z[t.style.value],color0:t.color0.cloneValue(),color1:t.color1.cloneValue()}}}s.typeName="CVBackground"},1274:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},1308:(t,e,i)=>{"use strict";var n=i(6763),s=(i(9498),i(4019)),r=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let o=class extends s.A{firstConnected(){super.firstConnected(),this.classList.add("sv-property-event")}update(t){if(t.has("property")){if(!this.property)throw new Error("missing property attribute");if(!this.property.schema.event)throw new Error(`not an event property: '${this.property.path}'`);const e=t.get("property");e&&e.off("value",this.onUpdate,this),this.property&&this.property.on("value",this.onUpdate,this)}super.update(t)}render(){const t=this.property,e=this.name||t.name,i=this.text;return n.qy`<label id="${e}-label" class="ff-label ff-off">${e}</label>
            <div class="sv-options">
                <ff-button ?disabled=${"true"===this.ariaDisabled} aria-labelledby="${e}-label" icon="zoom" .text=${i} @click=${this.onButtonClick}></ff-button>
            </div>`}onButtonClick(t){this.property.set()}};r([(0,n.MZ)({type:String})],o.prototype,"icon",void 0),o=r([(0,n.EM)("sv-property-event")],o)},1327:(t,e,i)=>{var n=i(1741),s=i(6888),r=i(4509),o=n?n.isConcatSpreadable:void 0;t.exports=function(t){return r(t)||s(t)||!!(o&&t&&t[o])}},1352:t=>{"use strict";const e={after:"\n",beforeClose:"\n",beforeComment:"\n",beforeDecl:"\n",beforeOpen:" ",beforeRule:"\n",colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};class i{constructor(t){this.builder=t}atrule(t,e){let i="@"+t.name,n=t.params?this.rawValue(t,"params"):"";if(void 0!==t.raws.afterName?i+=t.raws.afterName:n&&(i+=" "),t.nodes)this.block(t,i+n);else{let s=(t.raws.between||"")+(e?";":"");this.builder(i+n+s,t)}}beforeAfter(t,e){let i;i="decl"===t.type?this.raw(t,null,"beforeDecl"):"comment"===t.type?this.raw(t,null,"beforeComment"):"before"===e?this.raw(t,null,"beforeRule"):this.raw(t,null,"beforeClose");let n=t.parent,s=0;for(;n&&"root"!==n.type;)s+=1,n=n.parent;if(i.includes("\n")){let e=this.raw(t,null,"indent");if(e.length)for(let t=0;t<s;t++)i+=e}return i}block(t,e){let i,n=this.raw(t,"between","beforeOpen");this.builder(e+n+"{",t,"start"),t.nodes&&t.nodes.length?(this.body(t),i=this.raw(t,"after")):i=this.raw(t,"after","emptyBody"),i&&this.builder(i),this.builder("}",t,"end")}body(t){let e=t.nodes.length-1;for(;e>0&&"comment"===t.nodes[e].type;)e-=1;let i=this.raw(t,"semicolon");for(let n=0;n<t.nodes.length;n++){let s=t.nodes[n],r=this.raw(s,"before");r&&this.builder(r),this.stringify(s,e!==n||i)}}comment(t){let e=this.raw(t,"left","commentLeft"),i=this.raw(t,"right","commentRight");this.builder("/*"+e+t.text+i+"*/",t)}decl(t,e){let i=this.raw(t,"between","colon"),n=t.prop+i+this.rawValue(t,"value");t.important&&(n+=t.raws.important||" !important"),e&&(n+=";"),this.builder(n,t)}document(t){this.body(t)}raw(t,i,n){let s;if(n||(n=i),i&&(s=t.raws[i],void 0!==s))return s;let r=t.parent;if("before"===n){if(!r||"root"===r.type&&r.first===t)return"";if(r&&"document"===r.type)return""}if(!r)return e[n];let o=t.root();if(o.rawCache||(o.rawCache={}),void 0!==o.rawCache[n])return o.rawCache[n];if("before"===n||"after"===n)return this.beforeAfter(t,n);{let e="raw"+((a=n)[0].toUpperCase()+a.slice(1));this[e]?s=this[e](o,t):o.walk(t=>{if(s=t.raws[i],void 0!==s)return!1})}var a;return void 0===s&&(s=e[n]),o.rawCache[n]=s,s}rawBeforeClose(t){let e;return t.walk(t=>{if(t.nodes&&t.nodes.length>0&&void 0!==t.raws.after)return e=t.raws.after,e.includes("\n")&&(e=e.replace(/[^\n]+$/,"")),!1}),e&&(e=e.replace(/\S/g,"")),e}rawBeforeComment(t,e){let i;return t.walkComments(t=>{if(void 0!==t.raws.before)return i=t.raws.before,i.includes("\n")&&(i=i.replace(/[^\n]+$/,"")),!1}),void 0===i?i=this.raw(e,null,"beforeDecl"):i&&(i=i.replace(/\S/g,"")),i}rawBeforeDecl(t,e){let i;return t.walkDecls(t=>{if(void 0!==t.raws.before)return i=t.raws.before,i.includes("\n")&&(i=i.replace(/[^\n]+$/,"")),!1}),void 0===i?i=this.raw(e,null,"beforeRule"):i&&(i=i.replace(/\S/g,"")),i}rawBeforeOpen(t){let e;return t.walk(t=>{if("decl"!==t.type&&(e=t.raws.between,void 0!==e))return!1}),e}rawBeforeRule(t){let e;return t.walk(i=>{if(i.nodes&&(i.parent!==t||t.first!==i)&&void 0!==i.raws.before)return e=i.raws.before,e.includes("\n")&&(e=e.replace(/[^\n]+$/,"")),!1}),e&&(e=e.replace(/\S/g,"")),e}rawColon(t){let e;return t.walkDecls(t=>{if(void 0!==t.raws.between)return e=t.raws.between.replace(/[^\s:]/g,""),!1}),e}rawEmptyBody(t){let e;return t.walk(t=>{if(t.nodes&&0===t.nodes.length&&(e=t.raws.after,void 0!==e))return!1}),e}rawIndent(t){if(t.raws.indent)return t.raws.indent;let e;return t.walk(i=>{let n=i.parent;if(n&&n!==t&&n.parent&&n.parent===t&&void 0!==i.raws.before){let t=i.raws.before.split("\n");return e=t[t.length-1],e=e.replace(/\S/g,""),!1}}),e}rawSemicolon(t){let e;return t.walk(t=>{if(t.nodes&&t.nodes.length&&"decl"===t.last.type&&(e=t.raws.semicolon,void 0!==e))return!1}),e}rawValue(t,e){let i=t[e],n=t.raws[e];return n&&n.value===i?n.raw:i}root(t){this.body(t),t.raws.after&&this.builder(t.raws.after)}rule(t){this.block(t,this.rawValue(t,"selector")),t.raws.ownSemicolon&&this.builder(t.raws.ownSemicolon,t,"end")}stringify(t,e){if(!this[t.type])throw new Error("Unknown AST node type "+t.type+". Maybe you need to change PostCSS stringifier.");this[t.type](t,e)}}t.exports=i,i.default=i},1365:t=>{"use strict";t.exports=function t(e,i){if(e===i)return!0;if(e&&i&&"object"==typeof e&&"object"==typeof i){if(e.constructor!==i.constructor)return!1;var n,s,r;if(Array.isArray(e)){if((n=e.length)!=i.length)return!1;for(s=n;0!==s--;)if(!t(e[s],i[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===i.source&&e.flags===i.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===i.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===i.toString();if((n=(r=Object.keys(e)).length)!==Object.keys(i).length)return!1;for(s=n;0!==s--;)if(!Object.prototype.hasOwnProperty.call(i,r[s]))return!1;for(s=n;0!==s--;){var o=r[s];if(!t(e[o],i[o]))return!1}return!0}return e!=e&&i!=i}},1469:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.contentVocabulary=e.metadataVocabulary=void 0,e.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],e.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]},1572:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>c,UH:()=>o.UH,a9:()=>o.a9,iO:()=>a.iO});var n=i(4640),s=i(6351),r=i(8446),o=i(7297),a=i(9261),l=i(7229);class c extends r.A{static fromJSON(t){return new c(t)}constructor(t){super(t),this.model=null,this.abortControl=null,this.addEvent("load")}dispose(){this.unload(),super.dispose()}load(t){if(this.data.usage!==o.UH.Web3D)throw new Error("can't load, not a Web3D derivative");this.abortControl&&this.abortControl.abort(new Error("Derivative load cancelled")),this.abortControl=new AbortController;const e=this.findAsset(a.iO.Model);if(e)return t.getModel(e.data.uri,{signal:this.abortControl.signal}).then(t=>(this.model&&(0,s.nZ)(this.model),this.model=t,t));const i=this.findAsset(a.iO.Geometry),r=this.findAssets(a.iO.Image);return i?t.getGeometry(i.data.uri).then(e=>(this.model=new n.eaF(e,new n._4j),this.model.castShadow=!0,Promise.all(r.map(e=>t.getTexture(e.data.uri))).catch(t=>(console.warn("failed to load texture files"),[])))).then(t=>{const e=this.model.material;return this.assignTextures(r,t,e),(0,l.zv)(e),e.userData.paramCopy={},(0,l.AG)(e),e.map||(e.color.setScalar(.5),e.roughness=.8,e.metalness=0),this.model}):void 0}unload(){var t;if(null===(t=this.abortControl)||void 0===t||t.abort(),this.model){if(this.model.userData.variants){const t=this.model.userData.variants.variantMaterials;for(let e in t){const i=t[e];if(i){for(let t in i){const e=i[t];e&&e.isTexture&&e.dispose()}i.dispose()}}this.model.userData.variants.variantMaterials=null}(0,s.nZ)(this.model),this.model=null}}createAsset(t,e){const i=new a.Ay;return i.data.type=t,i.data.uri=e,this.addAsset(i),i}addAsset(t){if(!t.data.uri)throw new Error("uri must be specified");this.data.assets.push(t),this.update()}removeAsset(t){const e=this.data.assets.indexOf(t);e>=0&&this.data.assets.splice(e,1)}findAsset(t){return this.data.assets.find(e=>e.data.type===t)}findAssets(t){return this.data.assets.filter(e=>e.data.type===t)}toString(t=!1){const e=this.data;return t?`Derivative - usage: '${o.UH[e.usage]}', quality: '${o.a9[e.quality]}'\n   `+e.assets.map(t=>t.toString()).join("\n   "):`Derivative - usage: '${o.UH[e.usage]}', quality: '${o.a9[e.quality]}', #assets: ${e.assets.length})`}init(){return{usage:o.UH.Web3D,quality:o.a9.Medium,assets:[]}}deflate(t,e){e.usage=o.UH[t.usage],e.quality=o.a9[t.quality],e.assets=t.assets.map(t=>t.toJSON())}inflate(t,e){if(e.usage=o.UH[t.usage],void 0===e.usage)throw new Error(`unknown derivative usage: ${t.usage}`);if(e.quality=o.a9[t.quality],void 0===e.quality)throw new Error(`unknown derivative quality: ${t.quality}`);e.assets=t.assets.map(t=>new a.Ay(t))}assignTextures(t,e,i){for(let n=0;n<t.length;++n){const s=t[n],r=e[n];switch(s.data.mapType){case a.oo.Color:i.map=r;break;case a.oo.Occlusion:i.aoMap=r;break;case a.oo.Emissive:i.emissiveMap=r;break;case a.oo.MetallicRoughness:i.metalnessMap=r,i.roughnessMap=r;break;case a.oo.Normal:i.normalMap=r}}}}},1721:(t,e,i)=>{"use strict";i.d(e,{A:()=>x});var n=i(3423),s=i(8424),r=i(3675),o=i(5007),a=i(2652),l=i(7801),c=i(2654),h=i(1266),u=i(7137),d=i(7109),p=i(4340),f=i(2566),g=i(5659),m=i(4085),A=i(6389),v=i(9337),y=i(3019),b=i(66),_=i(9909);class x extends n.Ay{constructor(){super(...arguments),this._savedSetupData={},this.ins=this.addInputs(x.ins)}get featureMap(){return this.constructor.featureMap}get transform(){return this.getComponent(s.Ay)}get setupCache(){return this._savedSetupData}create(){super.create();const t=this.node,e=x.featureMap;for(const i in e)this[i]=t.createComponent(e[i]);this.snapshots=t.createComponent(m.A)}dispose(){this._savedSetupData=null}update(){const t=this.ins;return t.saveState.changed&&this.cacheSetupState(),t.restoreState.changed&&this.restoreSetupState(),!0}fromDocument(t,e,i){const n=t.scenes[e];if(!isFinite(n.setup))throw new Error("setup property missing in node");const s=t.setups[n.setup];this._savedSetupData=JSON.parse(JSON.stringify(s));const r=x.featureMap;for(const t in r){i.set(`scenes/${e}/setup/${t}`,this[t]);const n=s[t];n&&this[t].fromData(n)}}toDocument(t,e,i){const n=this._savedSetupData,s=x.featureMap;for(const t in s)i.set(this[t],`scenes/${e}/setup/${t}`);const r=this.tours.toData();r?n.tours=r:n.tours&&delete n.tours;const o=this.snapshots.toData(i);if(o&&(n.snapshots=o),n){t.setups=t.setups||[];const i=t.setups.length;t.setups.push(n),t.scenes[e].setup=i}}cacheSetupState(){const t=x.featureMap;for(const e in t){const t=this[e].toData();t&&(this._savedSetupData[e]=t)}this.language.ins.primarySceneLanguage.setValue(r.aL[this._savedSetupData.language.language])}restoreSetupState(){const t=this._savedSetupData,e=x.featureMap;for(const i in e){const e=t[i];e&&"tours"!==i&&this[i].fromData(e)}this.slicer.ins.enabled.set(),this.navigation.ins.autoZoom.value&&this.navigation.ins.zoomExtents.set()}resetViewer(){this.actions.ins.reset.set(),this.audio.ins.reset.set(),this.navigation.ins.projection.reset(),this.ins.restoreState.set()}}x.typeName="CVSetup",x.ins={saveState:n.gK.Event("Setup.SaveState"),restoreState:n.gK.Event("Setup.RestoreState")},x.featureMap={interface:o.A,reader:l.Ay,viewer:a.A,navigation:c.Ay,derivatives:b.Ay,background:h.A,environment:A.A,language:v.A,floor:u.A,grid:d.A,tape:p.A,slicer:f.A,tours:g.A,audio:y.A,actions:_.A}},1741:(t,e,i)=>{var n=i(5289).Symbol;t.exports=n},1757:(t,e,i)=>{"use strict";i.d(e,{i:()=>r});var n=i(6187),s=i(4709);class r{constructor(t,e,i){this.__parts=[],this.template=t,this.processor=e,this.options=i}update(t){let e=0;for(const i of this.__parts)void 0!==i&&i.setValue(t[e]),e++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=n.o6?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=[],i=this.template.parts,r=document.createTreeWalker(t,133,null,!1);let o,a=0,l=0,c=r.nextNode();for(;a<i.length;)if(o=i[a],(0,s.s9)(o)){for(;l<o.index;)l++,"TEMPLATE"===c.nodeName&&(e.push(c),r.currentNode=c.content),null===(c=r.nextNode())&&(r.currentNode=e.pop(),c=r.nextNode());if("node"===o.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(c.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(c,o.name,o.strings,this.options));a++}else this.__parts.push(void 0),a++;return n.o6&&(document.adoptNode(t),customElements.upgrade(t)),t}}},1860:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n=i(449),s=i(3331),r=i(3627),o=i(3423);class a extends s.A{static getTypeName(t){return"function"==typeof t?t.typeName:"object"==typeof t?t.constructor.typeName:t||a.typeName}constructor(t,e){super({knownEvents:!1}),this.graph=null,this.components=new r.A(o.Ay),this._name="",this._tags=new Set,this._isLocked=void 0,this.graph=t,this.id=e}get typeName(){return this.constructor.typeName}get displayTypeName(){const t=this.typeName;return"Node"===t?t:t.substr(1)}get isLocked(){return this._isLocked}get text(){return this.constructor.text}get icon(){return this.constructor.icon}get name(){return this._name}get displayName(){return this._name||this.text||this.displayTypeName}set name(t){this._name=t,this.emit({type:"change",what:"name",node:this})}get tags(){return this._tags}addTag(t){this._tags.has(t)||(this._tags.add(t),this.graph._addNodeTag(t,this))}removeTag(t){this._tags.has(t)&&(this._tags.delete(t),this.graph._removeNodeTag(t,this))}get system(){return this.graph.system}getComponent(t,e=!1){return this.components.get(t,e)}getComponents(t){return this.components.getArray(t)}getComponentsByTag(t){return this.components.getByTag(t)}getOrCreateComponent(t){return this.components.get(t,!0)||this.createComponent(t)}hasComponent(t){return this.components.has(t)}getGraphComponent(t,e=!1){return this.graph.components.get(t,e)}getGraphComponents(t){return this.graph.components.getArray(t)}getGraphComponentsByTag(t){return this.graph.components.getByTag(t)}hasGraphComponent(t){return this.graph.components.has(t)}getMainComponent(t,e=!1){return this.graph.system.graph.components.get(t,e)}getMainComponents(t){return this.graph.system.graph.components.getArray(t)}getMainComponentsByTag(t){return this.graph.system.graph.components.getByTag(t)}hasMainComponent(t){return this.graph.system.graph.components.has(t)}getSystemComponent(t,e=!1){return this.graph.system.components.get(t,e)}getSystemComponents(t){return this.graph.system.components.getArray(t)}getSystemComponentsByTag(t){return this.graph.system.components.getByTag(t)}hasSystemComponent(t){return this.graph.system.components.has(t)}getComponentById(t){return this.graph.system.components.getById(t)}getNode(t,e=!1){return this.graph.nodes.get(t,e)}getNodes(t){return this.graph.nodes.getArray(t)}getNodesByTag(t){return this.graph.nodes.getByTag(t)}hasNode(t){return this.graph.nodes.has(t)}getMainNode(t,e=!1){return this.graph.system.graph.nodes.get(t,e)}getMainNodes(t){return this.graph.system.graph.nodes.getArray(t)}getMainNodesByTag(t){return this.graph.system.graph.nodes.getByTag(t)}hasMainNode(t){return this.graph.system.graph.nodes.has(t)}getSystemNode(t,e=!1){return this.graph.system.nodes.get(t,e)}getSystemNodes(t){return this.graph.system.nodes.getArray(t)}getSystemNodesByTag(t){return this.graph.system.nodes.getByTag(t)}hasSystemNode(t){return this.graph.system.nodes.has(t)}getNodeById(t){return this.graph.system.nodes.getById(t)}lock(){if(!1===this._isLocked)throw new Error("can't lock an unlocked node again");this._isLocked=!0}unlock(){this._isLocked=!1}create(){this.graph._addNode(this)}createComponents(){}clear(){this.components.getArray().slice().forEach(t=>t.dispose())}dispose(){this.components.cloneArray().reverse().forEach(t=>t.dispose()),this.emit({type:"dispose",node:this}),this.graph&&(this.graph._removeNode(this),this.graph=null)}createComponent(t,e,i){if(!0===this._isLocked)throw new Error("node is locked, can't create component");const s=this.system.registry.getType(t);if(!s)throw new Error(`component type '${o.Ay.getTypeName(t)}' not registered`);const r=new s(this,i||(0,n.A)(12,this.system.components.getDictionary()));return r.create(),e&&(r.name=e),r}is(t){const e=a.getTypeName(t);let i=this;do{if(i=Object.getPrototypeOf(i),i.constructor.typeName===e)return!0}while(i.constructor.typeName!==a.typeName);return!1}toString(t=!1){const e=this.components.getArray(),i=`Node '${this.name}' - ${e.length} components`;return t?i+"\n"+e.map(t=>"  "+t.toString()).join("\n"):i}dump(t=""){console.log(t+`%cNode '${this.typeName}' (${this.displayName})`,"color: blue"),this.components.getArray().forEach(e=>e.dump(t+"  "))}toJSON(){const t={},e=[];this._isLocked&&(t.locked=!0);const i=this.components.getArray();for(let t=0,n=i.length;t<n;++t){const n=i[t],s=this.componentToJSON(n);s&&(s.type=n.typeName,s.id=n.id,n.name&&(s.name=n.name),e.push(s))}return e.length>0&&(t.components=e),t}fromJSON(t){this._isLocked=!!t.locked,t.components&&t.components.forEach(t=>this.componentFromJSON(t))}componentFromJSON(t){this.createComponent(t.type,t.name,t.id).fromJSON(t)}referencesFromJSON(t){t.components&&t.components.forEach(t=>{this.components.getById(t.id).referencesFromJSON(t)})}componentToJSON(t){return t.toJSON()}_addComponent(t){if(t.isNodeSingleton&&this.components.has(t))throw new Error(`only one component of type '${t.typeName}' allowed per node`);this.components.add(t),this.graph._addComponent(t)}_removeComponent(t){this.graph._removeComponent(t),this.components.remove(t)}_addComponentTag(t,e){this.components.addByTag(t,e),this.graph._addComponentTag(t,e)}_removeComponentTag(t,e){this.graph._removeComponentTag(t,e),this.components.removeByTag(t,e)}}a.typeName="Node",a.text="",a.icon=""},1881:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.hasChildren=e.isDocument=e.isComment=e.isText=e.isCDATA=e.isTag=void 0,s(i(272),e),s(i(5295),e),s(i(4516),e),s(i(1991),e),s(i(5362),e),s(i(564),e),s(i(6944),e);var r=i(5724);Object.defineProperty(e,"isTag",{enumerable:!0,get:function(){return r.isTag}}),Object.defineProperty(e,"isCDATA",{enumerable:!0,get:function(){return r.isCDATA}}),Object.defineProperty(e,"isText",{enumerable:!0,get:function(){return r.isText}}),Object.defineProperty(e,"isComment",{enumerable:!0,get:function(){return r.isComment}}),Object.defineProperty(e,"isDocument",{enumerable:!0,get:function(){return r.isDocument}}),Object.defineProperty(e,"hasChildren",{enumerable:!0,get:function(){return r.hasChildren}})},1991:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.findAll=e.existsOne=e.findOne=e.findOneChild=e.find=e.filter=void 0;var n=i(5724);function s(t,e,i,s){for(var r=[],o=[e],a=[0];;)if(a[0]>=o[0].length){if(1===a.length)return r;o.shift(),a.shift()}else{var l=o[0][a[0]++];if(t(l)&&(r.push(l),--s<=0))return r;i&&(0,n.hasChildren)(l)&&l.children.length>0&&(a.unshift(0),o.unshift(l.children))}}e.filter=function(t,e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=1/0),s(t,Array.isArray(e)?e:[e],i,n)},e.find=s,e.findOneChild=function(t,e){return e.find(t)},e.findOne=function t(e,i,s){void 0===s&&(s=!0);for(var r=null,o=0;o<i.length&&!r;o++){var a=i[o];(0,n.isTag)(a)&&(e(a)?r=a:s&&a.children.length>0&&(r=t(e,a.children,!0)))}return r},e.existsOne=function t(e,i){return i.some(function(i){return(0,n.isTag)(i)&&(e(i)||t(e,i.children))})},e.findAll=function(t,e){for(var i=[],s=[e],r=[0];;)if(r[0]>=s[0].length){if(1===s.length)return i;s.shift(),r.shift()}else{var o=s[0][r[0]++];(0,n.isTag)(o)&&(t(o)&&i.push(o),o.children.length>0&&(r.unshift(0),s.unshift(o.children)))}}},2046:(t,e,i)=>{var n=i(6788);t.exports=function(t){return(null==t?0:t.length)?n(t,1):[]}},2126:(t,e,i)=>{t.exports=self.fetch||(self.fetch=i(4106).default||i(4106))},2143:(t,e,i)=>{var n=i(1741),s=Object.prototype,r=s.hasOwnProperty,o=s.toString,a=n?n.toStringTag:void 0;t.exports=function(t){var e=r.call(t,a),i=t[a];try{t[a]=void 0;var n=!0}catch(t){}var s=o.call(t);return n&&(e?t[a]=i:delete t[a]),s}},2154:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n=i(1860),s=i(6436),r=i(2902),o=i(1071);class a extends n.A{get scene(){return this.components.get(s.A)}get documentProvider(){return this.components.get(r.A)}get nodeProvider(){return this.components.get(o.A)}createComponents(){this.createComponent(s.A,"Master Scene"),this.createComponent(r.A),this.createComponent(o.A)}}a.typeName="NVDocuments"},2177:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.Doctype=e.CDATA=e.Tag=e.Style=e.Script=e.Comment=e.Directive=e.Text=e.Root=e.isTag=e.ElementType=void 0,function(t){t.Root="root",t.Text="text",t.Directive="directive",t.Comment="comment",t.Script="script",t.Style="style",t.Tag="tag",t.CDATA="cdata",t.Doctype="doctype"}(i=e.ElementType||(e.ElementType={})),e.isTag=function(t){return t.type===i.Tag||t.type===i.Script||t.type===i.Style},e.Root=i.Root,e.Text=i.Text,e.Directive=i.Directive,e.Comment=i.Comment,e.Script=i.Script,e.Style=i.Style,e.Tag=i.Tag,e.CDATA=i.CDATA,e.Doctype=i.Doctype},2222:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var n=i(1860),s=i(1086),r=i(9610),o=i(7078),a=i(8313),l=i(9616),c=i(8172),h=i(6687);class u extends n.A{get transform(){return this.components.get(s.A)}get meta(){return this.components.get(a.A,!0)}get model(){return this.components.get(l.A,!0)}get camera(){return this.components.get(r.A,!0)}get light(){return this.components.get(o.I,!0)}get scene(){return this.components.get(c.A,!0)}createComponents(){this.name="Node",this.createComponent(s.A)}createModel(){this.name="Model",this.createComponent(a.A),this.createComponent(l.A)}fromDocument(t,e,i){const n=t.nodes[e];this.transform.fromData(n),i.set(`node/${e}`,this.transform);let s="Node";if(isFinite(n.meta)&&(this.createComponent(a.A).fromDocument(t,n),i.set(`meta/${n.meta}`,this.meta),s="Meta"),isFinite(n.model)&&(this.createComponent(l.A).fromDocument(t,n),i.set(`model/${n.model}`,this.model),s="Model"),isFinite(n.camera)&&(this.addTag("controlled"),this.createComponent(r.A).fromDocument(t,n),i.set(`camera/${n.camera}`,this.camera),s="Camera"),isFinite(n.light)){this.addTag("controlled");const e=t.lights[n.light].type;let r=h.h.find(t=>t.type==e);if(!r)throw new Error(`unknown light type: '${e}'`);this.createComponent(r).fromDocument(t,n),s=r.text,i.set(`light/${n.light}`,this.light)}this.name=n.name||s;const o=n.children;o&&o.forEach(e=>{const n=this.graph.createCustomNode(u);this.transform.addChild(n.transform),n.fromDocument(t,e,i)})}toDocument(t,e,i){i=i||{meta:!0,setup:!0,model:!0,camera:!0,light:!0},t.nodes=t.nodes||[];const n=t.nodes.length,s=this.transform.toData();t.nodes.push(s),e.set(this.transform,`node/${n}`),this.name&&(s.name=this.name),this.model&&i.model&&(s.model=this.model.toDocument(t,s),e.set(this.model,`model/${s.model}`)),this.camera&&i.camera&&(s.camera=this.camera.toDocument(t,s),e.set(this.camera,`camera/${s.camera}`)),this.light&&i.light&&(s.light=this.light.toDocument(t,s),e.set(this.light,`light/${s.light}`)),this.meta&&i.meta&&(s.meta=this.meta.toDocument(t,s),e.set(this.meta,`info/${s.meta}`));const r=this.transform.children.map(t=>t.node).filter(t=>t.is(u));return r.forEach(n=>{if(n.hasNodeComponents(i)){const r=n.toDocument(t,e,i);s.children=s.children||[],s.children.push(r)}}),n}hasNodeComponents(t){if(!t)return!0;const e=this.transform,i=this.components;return!(!t.model||!i.has(l.A)&&!e.hasChildComponents(l.A,!0))||(!(!t.camera||!i.has(r.A)&&!e.hasChildComponents(r.A,!0))||!(!t.light||!i.has(o.I)&&!e.hasChildComponents(o.I,!0)))}}u.typeName="NVNode"},2310:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getData=e.KeywordCxt=e.validateFunctionCode=void 0;const n=i(6971),s=i(444),r=i(3211),o=i(444),a=i(7738),l=i(5277),c=i(8203),h=i(5265),u=i(2363),d=i(5391),p=i(3151),f=i(6280);function g({gen:t,validateName:e,schema:i,schemaEnv:n,opts:s},r){s.code.es5?t.func(e,h._`${u.default.data}, ${u.default.valCxt}`,n.$async,()=>{t.code(h._`"use strict"; ${m(i,s)}`),function(t,e){t.if(u.default.valCxt,()=>{t.var(u.default.instancePath,h._`${u.default.valCxt}.${u.default.instancePath}`),t.var(u.default.parentData,h._`${u.default.valCxt}.${u.default.parentData}`),t.var(u.default.parentDataProperty,h._`${u.default.valCxt}.${u.default.parentDataProperty}`),t.var(u.default.rootData,h._`${u.default.valCxt}.${u.default.rootData}`),e.dynamicRef&&t.var(u.default.dynamicAnchors,h._`${u.default.valCxt}.${u.default.dynamicAnchors}`)},()=>{t.var(u.default.instancePath,h._`""`),t.var(u.default.parentData,h._`undefined`),t.var(u.default.parentDataProperty,h._`undefined`),t.var(u.default.rootData,u.default.data),e.dynamicRef&&t.var(u.default.dynamicAnchors,h._`{}`)})}(t,s),t.code(r)}):t.func(e,h._`${u.default.data}, ${function(t){return h._`{${u.default.instancePath}="", ${u.default.parentData}, ${u.default.parentDataProperty}, ${u.default.rootData}=${u.default.data}${t.dynamicRef?h._`, ${u.default.dynamicAnchors}={}`:h.nil}}={}`}(s)}`,n.$async,()=>t.code(m(i,s)).code(r))}function m(t,e){const i="object"==typeof t&&t[e.schemaId];return i&&(e.code.source||e.code.process)?h._`/*# sourceURL=${i} */`:h.nil}function A(t,e){y(t)&&(b(t),v(t))?function(t,e){const{schema:i,gen:n,opts:s}=t;s.$comment&&i.$comment&&x(t);(function(t){const e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,d.resolveUrl)(t.baseId,e))})(t),function(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}(t);const r=n.const("_errs",u.default.errors);_(t,r),n.var(e,h._`${r} === ${u.default.errors}`)}(t,e):(0,n.boolOrEmptySchema)(t,e)}function v({schema:t,self:e}){if("boolean"==typeof t)return!t;for(const i in t)if(e.RULES.all[i])return!0;return!1}function y(t){return"boolean"!=typeof t.schema}function b(t){(0,p.checkUnknownRules)(t),function(t){const{schema:e,errSchemaPath:i,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,p.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${i}"`)}(t)}function _(t,e){if(t.opts.jtd)return w(t,[],!1,e);const i=(0,s.getSchemaTypes)(t.schema);w(t,i,!(0,s.coerceAndCheckDataType)(t,i),e)}function x({gen:t,schemaEnv:e,schema:i,errSchemaPath:n,opts:s}){const r=i.$comment;if(!0===s.$comment)t.code(h._`${u.default.self}.logger.log(${r})`);else if("function"==typeof s.$comment){const i=h.str`${n}/$comment`,s=t.scopeValue("root",{ref:e.root});t.code(h._`${u.default.self}.opts.$comment(${r}, ${i}, ${s}.schema)`)}}function w(t,e,i,n){const{gen:s,schema:a,data:l,allErrors:c,opts:d,self:f}=t,{RULES:g}=f;function m(p){(0,r.shouldUseGroup)(a,p)&&(p.type?(s.if((0,o.checkDataType)(p.type,l,d.strictNumbers)),E(t,p),1===e.length&&e[0]===p.type&&i&&(s.else(),(0,o.reportTypeError)(t)),s.endIf()):E(t,p),c||s.if(h._`${u.default.errors} === ${n||0}`))}!a.$ref||!d.ignoreKeywordsWithRef&&(0,p.schemaHasRulesButRef)(a,g)?(d.jtd||function(t,e){if(t.schemaEnv.meta||!t.opts.strictTypes)return;(function(t,e){if(!e.length)return;if(!t.dataTypes.length)return void(t.dataTypes=e);e.forEach(e=>{S(t.dataTypes,e)||I(t,`type "${e}" not allowed by context "${t.dataTypes.join(",")}"`)}),t.dataTypes=t.dataTypes.filter(t=>S(e,t))})(t,e),t.opts.allowUnionTypes||function(t,e){e.length>1&&(2!==e.length||!e.includes("null"))&&I(t,"use allowUnionTypes to allow union type keyword")}(t,e);!function(t,e){const i=t.self.RULES.all;for(const n in i){const s=i[n];if("object"==typeof s&&(0,r.shouldUseRule)(t.schema,s)){const{type:i}=s.definition;i.length&&!i.some(t=>C(e,t))&&I(t,`missing type "${i.join(",")}" for keyword "${n}"`)}}}(t,t.dataTypes)}(t,e),s.block(()=>{for(const t of g.rules)m(t);m(g.post)})):s.block(()=>T(t,"$ref",g.all.$ref.definition))}function E(t,e){const{gen:i,schema:n,opts:{useDefaults:s}}=t;s&&(0,a.assignDefaults)(t,e.type),i.block(()=>{for(const i of e.rules)(0,r.shouldUseRule)(n,i)&&T(t,i.keyword,i.definition,e.type)})}function C(t,e){return t.includes(e)||"number"===e&&t.includes("integer")}function S(t,e){return t.includes(e)||"integer"===e&&t.includes("number")}function I(t,e){e+=` at "${t.schemaEnv.baseId+t.errSchemaPath}" (strictTypes)`,(0,p.checkStrictMode)(t,e,t.opts.strictTypes)}e.validateFunctionCode=function(t){y(t)&&(b(t),v(t))?function(t){const{schema:e,opts:i,gen:n}=t;g(t,()=>{i.$comment&&e.$comment&&x(t),function(t){const{schema:e,opts:i}=t;void 0!==e.default&&i.useDefaults&&i.strictSchema&&(0,p.checkStrictMode)(t,"default is ignored in the schema root")}(t),n.let(u.default.vErrors,null),n.let(u.default.errors,0),i.unevaluated&&function(t){const{gen:e,validateName:i}=t;t.evaluated=e.const("evaluated",h._`${i}.evaluated`),e.if(h._`${t.evaluated}.dynamicProps`,()=>e.assign(h._`${t.evaluated}.props`,h._`undefined`)),e.if(h._`${t.evaluated}.dynamicItems`,()=>e.assign(h._`${t.evaluated}.items`,h._`undefined`))}(t),_(t),function(t){const{gen:e,schemaEnv:i,validateName:n,ValidationError:s,opts:r}=t;i.$async?e.if(h._`${u.default.errors} === 0`,()=>e.return(u.default.data),()=>e.throw(h._`new ${s}(${u.default.vErrors})`)):(e.assign(h._`${n}.errors`,u.default.vErrors),r.unevaluated&&function({gen:t,evaluated:e,props:i,items:n}){i instanceof h.Name&&t.assign(h._`${e}.props`,i);n instanceof h.Name&&t.assign(h._`${e}.items`,n)}(t),e.return(h._`${u.default.errors} === 0`))}(t)})}(t):g(t,()=>(0,n.topBoolOrEmptySchema)(t))};class M{constructor(t,e,i){if((0,l.validateKeywordUsage)(t,e,i),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=i,this.data=t.data,this.schema=t.schema[i],this.$data=e.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,p.schemaRefOrVal)(t,this.schema,i,this.$data),this.schemaType=e.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=e,this.$data)this.schemaCode=t.gen.const("vSchema",P(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,l.validSchemaType)(this.schema,e.schemaType,e.allowUndefined))throw new Error(`${i} value must be ${JSON.stringify(e.schemaType)}`);("code"in e?e.trackErrors:!1!==e.errors)&&(this.errsCount=t.gen.const("_errs",u.default.errors))}result(t,e,i){this.failResult((0,h.not)(t),e,i)}failResult(t,e,i){this.gen.if(t),i?i():this.error(),e?(this.gen.else(),e(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,e){this.failResult((0,h.not)(t),void 0,e)}fail(t){if(void 0===t)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);const{schemaCode:e}=this;this.fail(h._`${e} !== undefined && (${(0,h.or)(this.invalid$data(),t)})`)}error(t,e,i){if(e)return this.setParams(e),this._error(t,i),void this.setParams({});this._error(t,i)}_error(t,e){(t?f.reportExtraError:f.reportError)(this,this.def.error,e)}$dataError(){(0,f.reportError)(this,this.def.$dataError||f.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,f.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,e){e?Object.assign(this.params,t):this.params=t}block$data(t,e,i=h.nil){this.gen.block(()=>{this.check$data(t,i),e()})}check$data(t=h.nil,e=h.nil){if(!this.$data)return;const{gen:i,schemaCode:n,schemaType:s,def:r}=this;i.if((0,h.or)(h._`${n} === undefined`,e)),t!==h.nil&&i.assign(t,!0),(s.length||r.validateSchema)&&(i.elseIf(this.invalid$data()),this.$dataError(),t!==h.nil&&i.assign(t,!1)),i.else()}invalid$data(){const{gen:t,schemaCode:e,schemaType:i,def:n,it:s}=this;return(0,h.or)(function(){if(i.length){if(!(e instanceof h.Name))throw new Error("ajv implementation error");const t=Array.isArray(i)?i:[i];return h._`${(0,o.checkDataTypes)(t,e,s.opts.strictNumbers,o.DataType.Wrong)}`}return h.nil}(),function(){if(n.validateSchema){const i=t.scopeValue("validate$data",{ref:n.validateSchema});return h._`!${i}(${e})`}return h.nil}())}subschema(t,e){const i=(0,c.getSubschema)(this.it,t);(0,c.extendSubschemaData)(i,this.it,t),(0,c.extendSubschemaMode)(i,t);const n={...this.it,...i,items:void 0,props:void 0};return A(n,e),n}mergeEvaluated(t,e){const{it:i,gen:n}=this;i.opts.unevaluated&&(!0!==i.props&&void 0!==t.props&&(i.props=p.mergeEvaluated.props(n,t.props,i.props,e)),!0!==i.items&&void 0!==t.items&&(i.items=p.mergeEvaluated.items(n,t.items,i.items,e)))}mergeValidEvaluated(t,e){const{it:i,gen:n}=this;if(i.opts.unevaluated&&(!0!==i.props||!0!==i.items))return n.if(e,()=>this.mergeEvaluated(t,h.Name)),!0}}function T(t,e,i,n){const s=new M(t,i,e);"code"in i?i.code(s,n):s.$data&&i.validate?(0,l.funcKeywordCode)(s,i):"macro"in i?(0,l.macroKeywordCode)(s,i):(i.compile||i.validate)&&(0,l.funcKeywordCode)(s,i)}e.KeywordCxt=M;const B=/^\/(?:[^~]|~0|~1)*$/,R=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function P(t,{dataLevel:e,dataNames:i,dataPathArr:n}){let s,r;if(""===t)return u.default.rootData;if("/"===t[0]){if(!B.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,r=u.default.rootData}else{const o=R.exec(t);if(!o)throw new Error(`Invalid JSON-pointer: ${t}`);const a=+o[1];if(s=o[2],"#"===s){if(a>=e)throw new Error(l("property/index",a));return n[e-a]}if(a>e)throw new Error(l("data",a));if(r=i[e-a],!s)return r}let o=r;const a=s.split("/");for(const t of a)t&&(r=h._`${r}${(0,h.getProperty)((0,p.unescapeJsonPointer)(t))}`,o=h._`${o} && ${r}`);return o;function l(t,i){return`Cannot access ${t} ${i} levels up, current level is ${e}`}}e.getData=P},2363:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s={data:new n.Name("data"),valCxt:new n.Name("valCxt"),instancePath:new n.Name("instancePath"),parentData:new n.Name("parentData"),parentDataProperty:new n.Name("parentDataProperty"),rootData:new n.Name("rootData"),dynamicAnchors:new n.Name("dynamicAnchors"),vErrors:new n.Name("vErrors"),errors:new n.Name("errors"),this:new n.Name("this"),self:new n.Name("self"),scope:new n.Name("scope"),json:new n.Name("json"),jsonPos:new n.Name("jsonPos"),jsonLen:new n.Name("jsonLen"),jsonPart:new n.Name("jsonPart")};e.default=s},2382:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;const n=i(4038),s=i(5092),r=i(6945),o=i(3928),a=["/properties"],l="http://json-schema.org/draft-07/schema";class c extends n.default{_addVocabularies(){super._addVocabularies(),s.default.forEach(t=>this.addVocabulary(t)),this.opts.discriminator&&this.addKeyword(r.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const t=this.opts.$data?this.$dataMetaSchema(o,a):o;this.addMetaSchema(t,l,!1),this.refs["http://json-schema.org/schema"]=l}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(l)?l:void 0)}}t.exports=e=c,Object.defineProperty(e,"__esModule",{value:!0}),e.default=c;var h=i(2310);Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return h.KeywordCxt}});var u=i(5265);Object.defineProperty(e,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}})},2387:(t,e,i)=>{"use strict";i.d(e,{Q:()=>o});i(6187);var n=i(4709);const s=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),r=` ${n.xL} `;class o{constructor(t,e,i,n){this.strings=t,this.values=e,this.type=i,this.processor=n}getHTML(){const t=this.strings.length-1;let e="",i=!1;for(let s=0;s<t;s++){const t=this.strings[s],o=t.lastIndexOf("\x3c!--");i=(o>-1||i)&&-1===t.indexOf("--\x3e",o+1);const a=n.zY.exec(t);e+=null===a?t+(i?r:n.XY):t.substr(0,a.index)+a[1]+a[2]+n.c1+a[3]+n.xL}return e+=this.strings[t],e}getTemplateElement(){const t=document.createElement("template");let e=this.getHTML();return void 0!==s&&(e=s.createHTML(e)),t.innerHTML=e,t}}},2420:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(323),s=i(425),r=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",n.default,s.default];e.default=r},2426:function(t,e,i){"use strict";var n,s=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.cloneNode=e.hasChildren=e.isDocument=e.isDirective=e.isComment=e.isText=e.isCDATA=e.isTag=e.Element=e.Document=e.CDATA=e.NodeWithChildren=e.ProcessingInstruction=e.Comment=e.Text=e.DataNode=e.Node=void 0;var o=i(2177),a=function(){function t(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent},set:function(t){this.parent=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){return this.prev},set:function(t){this.prev=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){return this.next},set:function(t){this.next=t},enumerable:!1,configurable:!0}),t.prototype.cloneNode=function(t){return void 0===t&&(t=!1),x(this,t)},t}();e.Node=a;var l=function(t){function e(e){var i=t.call(this)||this;return i.data=e,i}return s(e,t),Object.defineProperty(e.prototype,"nodeValue",{get:function(){return this.data},set:function(t){this.data=t},enumerable:!1,configurable:!0}),e}(a);e.DataNode=l;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=o.ElementType.Text,e}return s(e,t),Object.defineProperty(e.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),e}(l);e.Text=c;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=o.ElementType.Comment,e}return s(e,t),Object.defineProperty(e.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),e}(l);e.Comment=h;var u=function(t){function e(e,i){var n=t.call(this,i)||this;return n.name=e,n.type=o.ElementType.Directive,n}return s(e,t),Object.defineProperty(e.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),e}(l);e.ProcessingInstruction=u;var d=function(t){function e(e){var i=t.call(this)||this;return i.children=e,i}return s(e,t),Object.defineProperty(e.prototype,"firstChild",{get:function(){var t;return null!==(t=this.children[0])&&void 0!==t?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.children},set:function(t){this.children=t},enumerable:!1,configurable:!0}),e}(a);e.NodeWithChildren=d;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=o.ElementType.CDATA,e}return s(e,t),Object.defineProperty(e.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),e}(d);e.CDATA=p;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=o.ElementType.Root,e}return s(e,t),Object.defineProperty(e.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),e}(d);e.Document=f;var g=function(t){function e(e,i,n,s){void 0===n&&(n=[]),void 0===s&&(s="script"===e?o.ElementType.Script:"style"===e?o.ElementType.Style:o.ElementType.Tag);var r=t.call(this,n)||this;return r.name=e,r.attribs=i,r.type=s,r}return s(e,t),Object.defineProperty(e.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.name},set:function(t){this.name=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributes",{get:function(){var t=this;return Object.keys(this.attribs).map(function(e){var i,n;return{name:e,value:t.attribs[e],namespace:null===(i=t["x-attribsNamespace"])||void 0===i?void 0:i[e],prefix:null===(n=t["x-attribsPrefix"])||void 0===n?void 0:n[e]}})},enumerable:!1,configurable:!0}),e}(d);function m(t){return(0,o.isTag)(t)}function A(t){return t.type===o.ElementType.CDATA}function v(t){return t.type===o.ElementType.Text}function y(t){return t.type===o.ElementType.Comment}function b(t){return t.type===o.ElementType.Directive}function _(t){return t.type===o.ElementType.Root}function x(t,e){var i;if(void 0===e&&(e=!1),v(t))i=new c(t.data);else if(y(t))i=new h(t.data);else if(m(t)){var n=e?w(t.children):[],s=new g(t.name,r({},t.attribs),n);n.forEach(function(t){return t.parent=s}),null!=t.namespace&&(s.namespace=t.namespace),t["x-attribsNamespace"]&&(s["x-attribsNamespace"]=r({},t["x-attribsNamespace"])),t["x-attribsPrefix"]&&(s["x-attribsPrefix"]=r({},t["x-attribsPrefix"])),i=s}else if(A(t)){n=e?w(t.children):[];var o=new p(n);n.forEach(function(t){return t.parent=o}),i=o}else if(_(t)){n=e?w(t.children):[];var a=new f(n);n.forEach(function(t){return t.parent=a}),t["x-mode"]&&(a["x-mode"]=t["x-mode"]),i=a}else{if(!b(t))throw new Error("Not implemented yet: ".concat(t.type));var l=new u(t.name,t.data);null!=t["x-name"]&&(l["x-name"]=t["x-name"],l["x-publicId"]=t["x-publicId"],l["x-systemId"]=t["x-systemId"]),i=l}return i.startIndex=t.startIndex,i.endIndex=t.endIndex,null!=t.sourceCodeLocation&&(i.sourceCodeLocation=t.sourceCodeLocation),i}function w(t){for(var e=t.map(function(t){return x(t,!0)}),i=1;i<e.length;i++)e[i].prev=e[i-1],e[i-1].next=e[i];return e}e.Element=g,e.isTag=m,e.isCDATA=A,e.isText=v,e.isComment=y,e.isDirective=b,e.isDocument=_,e.hasChildren=function(t){return Object.prototype.hasOwnProperty.call(t,"children")},e.cloneNode=x},2464:(t,e,i)=>{"use strict";i.d(e,{A:()=>a,Y:()=>n});var n,s=i(3423),r=i(3074);!function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"}(n||(n={}));const o={[n.Low]:512,[n.Medium]:1024,[n.High]:2048};class a extends r.Ay{constructor(){super(...arguments),this.canDelete=!0,this.ins=this.addInputs(a.lightIns)}get light(){return this.object3D}update(t){super.update(t);const e=this.light,i=this.ins;if(i.name.changed&&(this.node.name=i.name.value),i.enabled.changed&&(e.visible=i.enabled.value,this.node.emit({type:"change",what:"enabled",node:this.node})),(i.color.changed||i.intensity.changed)&&(e.color.fromArray(i.color.value),e.intensity=i.intensity.value),"shadow"in e&&(i.shadowEnabled.changed&&(e.castShadow=i.shadowEnabled.value),i.shadowBlur.changed&&(e.shadow.radius=i.shadowBlur.value),i.shadowIntensity.changed&&(e.shadow.intensity=i.shadowIntensity.value),i.shadowResolution.changed)){const t=o[i.shadowResolution.getValidatedValue()];e.shadow.mapSize.set(t,t),e.shadow.map=null}return!0}}a.typeName="CLight",a.lightIns={name:s.gK.String("Light.Name"),enabled:s.gK.Boolean("Light.Enabled",!0),color:s.gK.ColorRGB("Light.Color"),intensity:s.gK.Number("Light.Intensity",{preset:1,min:0}),shadowEnabled:s.gK.Boolean("Shadow.Enabled"),shadowResolution:s.gK.Enum("Shadow.Resolution",n,n.Medium),shadowBlur:s.gK.Number("Shadow.Blur",1),shadowIntensity:s.gK.Number("Shadow.Intensity",{preset:1,min:0})}},2552:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var n=i(5590),s=i(2464);class r extends n.A{get settingProperties(){return[this.ins.name,this.ins.enabled,this.ins.color,this.ins.intensity,this.ins.shadowEnabled,this.ins.shadowSize,this.ins.shadowResolution,this.ins.shadowBlur,this.ins.shadowIntensity]}get snapshotProperties(){return[this.ins.color,this.ins.intensity]}dispose(){this.ins.shadowEnabled.value&&this.light.shadow.map&&this.light.shadow.map.dispose(),super.dispose()}fromDocument(t,e){if(!isFinite(e.light))throw new Error("light property missing in node");const i=t.lights[e.light],n=this.ins;if("directional"!==i.type)throw new Error("light type mismatch: not a directional light");return n.name.setValue(e.name),n.copyValues({enabled:void 0!==i.enabled?i.enabled:n.enabled.schema.preset,color:void 0!==i.color?i.color:n.color.schema.preset,intensity:void 0!==i.intensity?i.intensity:n.intensity.schema.preset,position:n.position.schema.preset,target:n.target.schema.preset,shadowEnabled:i.shadowEnabled||!1,shadowSize:void 0!==i.shadowSize?i.shadowSize:n.shadowSize.schema.preset,shadowResolution:void 0!==i.shadowResolution?s.Y[i.shadowResolution]||0:n.shadowResolution.schema.preset,shadowBlur:void 0!==i.shadowBlur?i.shadowBlur:n.shadowBlur.schema.preset,shadowIntensity:void 0!==i.shadowIntensity?i.shadowIntensity:n.shadowIntensity.schema.preset}),e.light}toDocument(t,e){const i=this.ins,n={enabled:i.enabled.value,color:i.color.cloneValue(),intensity:i.intensity.value};n.type=r.type,i.shadowEnabled.value&&(n.shadowEnabled=!0,i.shadowSize.isDefault()||(n.shadowSize=i.shadowSize.value),i.shadowBlur.isDefault()||(n.shadowBlur=i.shadowBlur.value),i.shadowResolution.isDefault()||(n.shadowResolution=s.Y[i.shadowResolution.value]),i.shadowIntensity.isDefault()||(n.shadowIntensity=i.shadowIntensity.value)),t.lights=t.lights||[];const o=t.lights.length;return t.lights.push(n),o}}r.typeName="CVDirectionalLight",r.type="directional",r.text="Directional Light",r.icon="sun"},2566:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var n=i(4640),s=i(3423),r=i(2997),o=i(8172),a=i(9616),l=i(3889);const c=[[-1,0,0,0],[0,-1,0,0],[0,0,-1,0],[1,0,0,0],[0,1,0,0],[0,0,1,0]],h=new n.Pq0(0,-1,0),u=new n.Zcv(h,.8);class d extends s.Ay{constructor(){super(...arguments),this.ins=this.addInputs(d.ins),this.plane=null,this.axisIndex=-1}get settingProperties(){return[this.ins.enabled,this.ins.color]}get snapshotProperties(){return[this.ins.enabled,this.ins.axis,this.ins.position,this.ins.inverted]}create(){super.create();const t=this.getGraphComponent(o.A);this.ins.boundingBox.linkFrom(t.outs.boundingBox),this.graph.components.on(a.A,this.onModelComponent,this)}dispose(){this.graph.components.off(a.A,this.onModelComponent,this),super.dispose()}update(t){const e=this.ins;if(e.axis.changed){const t=e.axis.getValidatedValue();t===this.axisIndex?e.inverted.setValue(!e.inverted.value):(e.inverted.setValue(!1),this.axisIndex=t)}if(!e.enabled.value&&!e.enabled.changed)return!1;const i=e.axis.getValidatedValue(),n=e.inverted.value,s=i+(n?3:0),r=this.ins.boundingBox.value;if(!r)return!0;this.plane=c[s];const o=r.min.getComponent(i),l=r.max.getComponent(i),d=1-e.position.value;this.plane[3]=n?d*(l-o)-l:l-d*(l-o);const p=this.getGraphComponents(a.A);return h.set(this.plane[0],this.plane[1],this.plane[2]),u.set(h,this.plane[3]),p.forEach(t=>{if(t.ins.slicerEnabled.value){t.object3D.traverse(e=>{if(e.isMesh){const i=e.material;this.updateMaterial(t,i)}})}}),!0}fromData(t){t=t||{},this.ins.setValues({enabled:t.enabled||!1,axis:r.Tm[t.axis]||r.Tm.X,position:t.position||0,inverted:t.inverted||!1,color:t.color||[0,.61,.87]})}toData(){const t=this.ins;return{enabled:t.enabled.value,axis:r.Tm[t.axis.getValidatedValue()],position:t.position.value,inverted:t.inverted.value,color:t.color.value}}updateMaterial(t,e){const i=this.ins;if(i.enabled.changed){const t=i.enabled.value;this.getMainComponent(l.A).views.forEach(t=>t.renderer.localClippingEnabled=i.enabled.value),e.defines.CUT_PLANE=t,(t||null==e.userData.sideCache)&&(e.userData.sideCache=e.side),e.side=t?n.$EB:e.userData.sideCache,t&&(e.clippingPlanes=[u])}e.userData.shader.uniforms.cutPlaneColor.value.fromArray(i.color.value)}onModelComponent(t){const e=t.object;t.add?(e.outs.variant.on("value",this.refreshMaterial,this),e.on("model-load",this.refreshMaterial,this)):t.remove&&(e.off("model-load",this.refreshMaterial,this),e.outs.variant.off("value",this.refreshMaterial,this))}refreshMaterial(){this.ins.enabled.set()}}d.typeName="CVSlicer",d.text="Slicer",d.icon="",d.ins={enabled:s.gK.Boolean("Slice.Enabled"),axis:s.gK.Enum("Slice.Axis",r.Tm),position:s.gK.Number("Slice.Position",{min:0,max:1,preset:.5}),inverted:s.gK.Boolean("Slice.Inverted"),color:s.gK.ColorRGB("Slice.Color",[0,.61,.87]),boundingBox:s.gK.Object("Scene.BoundingBox",n.NRn)}},2610:(t,e,i)=>{"use strict";let n=i(6613),s=i(301),r=i(7616),o=i(8093),a=i(7129),l=i(6216),c=i(8227),{isClean:h,my:u}=i(3963);i(4376);const d={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},p={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},f={Once:!0,postcssPlugin:!0,prepare:!0};function g(t){return"object"==typeof t&&"function"==typeof t.then}function m(t){let e=!1,i=d[t.type];return"decl"===t.type?e=t.prop.toLowerCase():"atrule"===t.type&&(e=t.name.toLowerCase()),e&&t.append?[i,i+"-"+e,0,i+"Exit",i+"Exit-"+e]:e?[i,i+"-"+e,i+"Exit",i+"Exit-"+e]:t.append?[i,0,i+"Exit"]:[i,i+"Exit"]}function A(t){let e;return e="document"===t.type?["Document",0,"DocumentExit"]:"root"===t.type?["Root",0,"RootExit"]:m(t),{eventIndex:0,events:e,iterator:0,node:t,visitorIndex:0,visitors:[]}}function v(t){return t[h]=!1,t.nodes&&t.nodes.forEach(t=>v(t)),t}let y={};class b{get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}constructor(t,e,i){let s;if(this.stringified=!1,this.processed=!1,"object"!=typeof e||null===e||"root"!==e.type&&"document"!==e.type)if(e instanceof b||e instanceof a)s=v(e.root),e.map&&(void 0===i.map&&(i.map={}),i.map.inline||(i.map.inline=!1),i.map.prev=e.map);else{let t=o;i.syntax&&(t=i.syntax.parse),i.parser&&(t=i.parser),t.parse&&(t=t.parse);try{s=t(e,i)}catch(t){this.processed=!0,this.error=t}s&&!s[u]&&n.rebuild(s)}else s=v(e);this.result=new a(t,s,i),this.helpers={...y,postcss:y,result:this.result},this.plugins=this.processor.plugins.map(t=>"object"==typeof t&&t.prepare?{...t,...t.prepare(this.result)}:t)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(t){return this.async().catch(t)}finally(t){return this.async().then(t,t)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(t,e){let i=this.result.lastPlugin;try{e&&e.addToError(t),this.error=t,"CssSyntaxError"!==t.name||t.plugin?i.postcssVersion:(t.plugin=i.postcssPlugin,t.setMessage())}catch(t){console&&console.error&&console.error(t)}return t}prepareVisitors(){this.listeners={};let t=(t,e,i)=>{this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push([t,i])};for(let e of this.plugins)if("object"==typeof e)for(let i in e){if(!p[i]&&/^[A-Z]/.test(i))throw new Error(`Unknown event ${i} in ${e.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!f[i])if("object"==typeof e[i])for(let n in e[i])t(e,"*"===n?i:i+"-"+n.toLowerCase(),e[i][n]);else"function"==typeof e[i]&&t(e,i,e[i])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let t=0;t<this.plugins.length;t++){let e=this.plugins[t],i=this.runOnRoot(e);if(g(i))try{await i}catch(t){throw this.handleError(t)}}if(this.prepareVisitors(),this.hasListener){let t=this.result.root;for(;!t[h];){t[h]=!0;let e=[A(t)];for(;e.length>0;){let t=this.visitTick(e);if(g(t))try{await t}catch(t){let i=e[e.length-1].node;throw this.handleError(t,i)}}}if(this.listeners.OnceExit)for(let[e,i]of this.listeners.OnceExit){this.result.lastPlugin=e;try{if("document"===t.type){let e=t.nodes.map(t=>i(t,this.helpers));await Promise.all(e)}else await i(t,this.helpers)}catch(t){throw this.handleError(t)}}}return this.processed=!0,this.stringify()}runOnRoot(t){this.result.lastPlugin=t;try{if("object"==typeof t&&t.Once){if("document"===this.result.root.type){let e=this.result.root.nodes.map(e=>t.Once(e,this.helpers));return g(e[0])?Promise.all(e):e}return t.Once(this.result.root,this.helpers)}if("function"==typeof t)return t(this.result.root,this.result)}catch(t){throw this.handleError(t)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let t=this.result.opts,e=c;t.syntax&&(e=t.syntax.stringify),t.stringifier&&(e=t.stringifier),e.stringify&&(e=e.stringify);let i=new r(e,this.result.root,this.result.opts).generate();return this.result.css=i[0],this.result.map=i[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let t of this.plugins){if(g(this.runOnRoot(t)))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let t=this.result.root;for(;!t[h];)t[h]=!0,this.walkSync(t);if(this.listeners.OnceExit)if("document"===t.type)for(let e of t.nodes)this.visitSync(this.listeners.OnceExit,e);else this.visitSync(this.listeners.OnceExit,t)}return this.result}then(t,e){return this.async().then(t,e)}toString(){return this.css}visitSync(t,e){for(let[i,n]of t){let t;this.result.lastPlugin=i;try{t=n(e,this.helpers)}catch(t){throw this.handleError(t,e.proxyOf)}if("root"!==e.type&&"document"!==e.type&&!e.parent)return!0;if(g(t))throw this.getAsyncError()}}visitTick(t){let e=t[t.length-1],{node:i,visitors:n}=e;if("root"!==i.type&&"document"!==i.type&&!i.parent)return void t.pop();if(n.length>0&&e.visitorIndex<n.length){let[t,s]=n[e.visitorIndex];e.visitorIndex+=1,e.visitorIndex===n.length&&(e.visitors=[],e.visitorIndex=0),this.result.lastPlugin=t;try{return s(i.toProxy(),this.helpers)}catch(t){throw this.handleError(t,i)}}if(0!==e.iterator){let n,s=e.iterator;for(;n=i.nodes[i.indexes[s]];)if(i.indexes[s]+=1,!n[h])return n[h]=!0,void t.push(A(n));e.iterator=0,delete i.indexes[s]}let s=e.events;for(;e.eventIndex<s.length;){let t=s[e.eventIndex];if(e.eventIndex+=1,0===t)return void(i.nodes&&i.nodes.length&&(i[h]=!0,e.iterator=i.getIterator()));if(this.listeners[t])return void(e.visitors=this.listeners[t])}t.pop()}walkSync(t){t[h]=!0;let e=m(t);for(let i of e)if(0===i)t.nodes&&t.each(t=>{t[h]||this.walkSync(t)});else{let e=this.listeners[i];if(e&&this.visitSync(e,t.toProxy()))return}}warnings(){return this.sync().warnings()}}b.registerPostcss=t=>{y=t},t.exports=b,b.default=b,l.registerLazyResult(b),s.registerLazyResult(b)},2642:(t,e,i)=>{"use strict";var n=i(4640),s=i(6763),r=i(8337),o=i(5532),a=(i(9498),i(9521)),l=i(3198),c=i(3534),h=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};const u=new o.Ay,d=new n.Pq0(0,0,0),p=new n.Pq0,f=new n.Pq0,g=new n.Pq0,m=new n.Pq0;class A extends a.Ay{constructor(t){super(t),this.adaptive=!0,this.offset=new n.YJl,this.offset.matrixAutoUpdate=!1,this.add(this.offset),this.anchorMesh=new n.eaF(new n.LoY,new n.V9B),this.anchorMesh.frustumCulled=!1,this.anchorMesh.matrixAutoUpdate=!1,this.offset.add(this.anchorMesh),this.update()}dispose(){var t,e;this.offset=null,null===(t=this.anchorMesh)||void 0===t||t.geometry.dispose(),(null===(e=this.anchorMesh)||void 0===e?void 0:e.material).dispose(),this.anchorMesh=null,super.dispose()}update(){const t=this.annotation.data;this.anchorMesh.scale.setScalar(t.scale),this.anchorMesh.position.y=t.offset,this.anchorMesh.updateMatrix(),super.update()}renderHTMLElement(t,e,i){super.renderHTMLElement(t,e,i,this.anchorMesh,d);const n=this.anchorMesh;p.set(0,0,0),p.applyMatrix4(n.modelViewMatrix),f.set(0,1,0),f.applyMatrix4(n.modelViewMatrix),g.copy(f).sub(p).normalize(),m.set(0,0,1),this.viewAngle=g.angleTo(m);const s=r.A.scaleLimit(this.viewAngle*r.A.RAD2DEG,90,100,1,0),o=this.annotation.data.visible?s:0;t.setOpacity(o);const a=this.annotation.data,l=a.visible;this.offset.visible=l,this.adaptive!==this.isAdaptive&&(this.isAdaptive||(t.truncated=!1,t.classList.remove("sv-short"),t.requestUpdate()),this.adaptive=this.isAdaptive),this.setVisible(!this.isBehindCamera(this.offset,i)&&l&&this.annotation.data.visible),this.getVisible()||t.setVisible(this.getVisible()),this.adaptive&&!this.isAnimating&&a.expanded&&(t.truncated||(t.classList.contains("sv-expanded")?(this.originalHeight=t.offsetHeight,this.originalWidth=t.offsetWidth):t.requestUpdate().then(()=>{this.originalHeight=t.offsetHeight,this.originalWidth=t.offsetWidth,this.checkTruncate(t,e)})),this.checkTruncate(t,e))}createHTMLElement(){return new v(this)}checkTruncate(t,e){t.getBoundingClientRect().left,e.left;const i=t.getBoundingClientRect().top-e.top+this.originalHeight>=e.height;i!==t.truncated?(t.truncated=i,t.requestUpdate().then(()=>{this.checkBounds(t,e)})):this.checkBounds(t,e)}checkBounds(t,e){const i=t.getBoundingClientRect().left-e.left,n=t.getBoundingClientRect().top-e.top;i+t.offsetWidth>=e.width&&!t.classList.contains("sv-align-right")?(t.classList.add("sv-align-right"),t.requestUpdate()):i+t.offsetWidth<e.width&&t.classList.contains("sv-align-right")&&(t.classList.remove("sv-align-right"),t.requestUpdate()),n+t.offsetHeight>=e.height&&!t.classList.contains("sv-align-bottom")?(t.classList.add("sv-align-bottom"),t.requestUpdate()):n+t.offsetHeight<e.height&&t.classList.contains("sv-align-bottom")&&(t.classList.remove("sv-align-bottom"),t.requestUpdate())}}A.typeName="Circle",l.A.registerType(A);let v=class extends a.sf{constructor(t){super(t),this.isExpanded=void 0,this.onClickMarker=this.onClickMarker.bind(this),this.onClickArticle=this.onClickArticle.bind(this),this.onClickAudio=this.onClickAudio.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyDownArticle=this.onKeyDownArticle.bind(this),this.onClickOverlay=this.onClickOverlay.bind(this),this.addEventListener("keydown",this.onKeyDown),this.markerElement=this.appendElement("div"),this.markerElement.classList.add("sv-marker"),this.markerElement.addEventListener("click",this.onClickMarker),this.markerElement.setAttribute("tabindex","0"),this.contentElement=this.appendElement("div"),this.contentElement.classList.add("sv-annotation-body"),this.contentElement.style.display="none"}setVisible(t){this.style.display=t?"flex":"none"}firstConnected(){super.firstConnected(),this.classList.add("sv-circle-annotation")}updated(t){super.updated(t);const e=this.sprite.annotation,i=e.data,n=!this.overlayed&&this.truncated&&(i.imageUri||i.articleId||e.lead.length>0),r=this.sprite.audioManager;this.markerElement.innerText=i.marker;const o=s.qy`
            ${this.isOverlayed?null:s.qy`<div class="sv-title">${e.title}</div>`}
            ${i.imageUri&&!n?s.qy`<div><img alt="${e.imageAltText}" src="${this.sprite.assetManager.getAssetUrl(i.imageUri)}">${e.imageCredit?s.qy`<div class="sv-img-credit">${e.imageCredit}</div>`:null}</div>`:null}
            ${n?null:s.qy`<div class="sv-content"><p>${(0,c._)(e.lead)}</p></div>`}
            ${i.audioId&&!this.isOverlayed?s.qy`<div id="audio_container" @pointerdown=${this.onClickAudio}></div>`:null}
            ${i.articleId&&!n?s.qy`<ff-button inline id="read-more" text="Read more..." icon="document" @keydown=${this.onKeyDownArticle} @pointerdown=${this.onClickArticle}></ff-button>`:null}
            ${n?s.qy`<ff-button inline id="more-info" text="+more info" @pointerdown=${this.onClickOverlay}></ff-button>`:null}`;if((0,s.XX)(o,this.contentElement),u.fromArray(i.color),this.markerElement.style.borderColor=u.toString(),this.isExpanded&&(this.contentElement.style.height="auto"),this.isExpanded!==i.expanded&&!this.overlayed)if(this.isExpanded=i.expanded,this.isExpanded){if(i.audioId){const t=this.querySelector("#audio_container");t.firstChild&&t.removeChild(t.firstChild),t.append(r.getPlayerById(i.audioId))}this.classList.add("sv-expanded"),this.contentElement.style.display="block",this.contentElement.style.height="auto"}else this.classList.remove("sv-expanded"),this.contentElement.style.display="none",r.activeId==i.audioId&&this.sprite.audioManager.stop();this.isExpanded&&(this.contentElement.style.removeProperty("transform"),this.classList.contains("sv-align-right")&&!this.overlayed&&(this.contentElement.style.transform=`translateX(-${this.offsetWidth}px)`),this.classList.contains("sv-align-bottom")&&!this.overlayed&&(this.contentElement.style.transform=`translateY(-${this.offsetHeight-this.markerElement.offsetHeight}px)`));const a=this.querySelector(".sv-audio-view");if(i.audioId&&!this.overlayed)if(i.expanded){const t=this.querySelector("#audio_container");a&&t.removeChild(a),t.append(r.getPlayerById(i.audioId))}else!i.expanded&&a&&r.activeId==i.audioId&&r.stop()}onClickMarker(t){this.contentElement.style.display="block",t.stopPropagation(),this.sprite.emitClickEvent()}onClickArticle(t){t.stopPropagation(),this.sprite.emitLinkEvent(this.sprite.annotation.data.articleId)}onClickOverlay(t){t.stopPropagation();const e=this.contentElement;this.overlayed=!0,this.showOverlay(e)}onClickAudio(t){t.stopPropagation()}onKeyDown(t){if("Space"===t.code||"Enter"===t.code){"more-info"===t.target.id?this.onClickOverlay(t):this.sprite.emitClickEvent()}}onKeyDownArticle(t){if("Space"===t.code||"Enter"===t.code){"read-more"===t.target.id&&this.onClickArticle(t)}}};v=h([(0,s.EM)("sv-circle-annotation")],v)},2645:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:i(6241).validateUnion,error:{message:"must match a schema in anyOf"}};e.default=n},2652:(t,e,i)=>{"use strict";i.d(e,{A:()=>g});var n=i(4640),s=i(3423),r=i(3889),o=i(2997),a=i(7297),l=i(9616),c=i(3350),h=i(8604),u=i(9337),d=i(2791),p=i(3051),f=i(1721);class g extends s.Ay{constructor(){super(...arguments),this._rootElement=null,this._needsAnnoFocus=!1,this.ins=this.addInputs(g.ins),this.outs=this.addOutputs(g.outs)}get settingProperties(){return[this.ins.annotationsVisible,this.ins.activeTags,this.ins.sortedTags,this.ins.radioTags,this.ins.shader,this.ins.toneMapping,this.ins.exposure,this.ins.gamma,this.ins.isWallMountAR,this.ins.arScale]}get snapshotProperties(){return[this.ins.annotationsVisible,this.ins.activeAnnotation,this.ins.activeTags,this.ins.shader,this.ins.variant,this.ins.exposure]}get analytics(){return this.getMainComponent(h.A)}get renderer(){return this.getMainComponent(r.A)}get ar(){return this.getMainComponent(d.A)}get rootElement(){return this._rootElement}set rootElement(t){this._rootElement=t}create(){super.create(),this.graph.components.on(l.A,this.onModelComponent,this),this.graph.components.on(c.A,this.onAnnotationsComponent,this),this.graph.components.on(u.A,this.onLanguageComponent,this),this.ar.ins.wallMount.linkFrom(this.ins.isWallMountAR),this.ar.ins.arScale.linkFrom(this.ins.arScale)}dispose(){this.graph.components.off(l.A,this.onModelComponent,this),this.graph.components.off(c.A,this.onAnnotationsComponent,this),this.graph.components.off(u.A,this.onLanguageComponent,this),super.dispose()}update(t){const e=this.ins;if(e.variant.changed){const t=e.variant.getOptionText();this.getGraphComponents(l.A).forEach(e=>{e.ins.variant.setOption(t)}),e.shader.setValue(0)}if(e.shader.changed){const t=e.shader.getValidatedValue();this.getGraphComponents(l.A).forEach(e=>e.ins.shader.setValue(t))}if(e.exposure.changed&&this.renderer.ins.exposure.setValue(e.exposure.value),e.toneMapping.changed){this.renderer.views.forEach(t=>t.renderer.toneMapping=e.toneMapping.value?n.aJ8:n.y_p);const t=this.renderer.activeScene;t&&t.traverse(t=>{const e=t;e.isMesh&&(Array.isArray(e.material)?e.material.forEach(t=>t.needsUpdate=!0):e.material.needsUpdate=!0)})}if(e.gamma.changed,e.quality.changed){const t=e.quality.getValidatedValue();this.getGraphComponents(l.A).forEach(e=>e.ins.quality.setValue(t))}if(e.activeAnnotation.changed){const t=e.activeAnnotation.value;this.getGraphComponents(c.A).forEach(e=>e.setActiveAnnotationById(t))}if(e.annotationExit.changed&&e.annotationsVisible.setValue(!1),e.annotationsVisible.changed){const t=e.annotationsVisible.value;this.getGraphComponents(c.A).forEach(e=>e.ins.visible.setValue(t));const i=this.getGraphComponent(f.A);if(i&&e.annotationFocus.value){const t=i.tours.ins;this._needsAnnoFocus=e.annotationsVisible.value&&!t.enabled.value,e.annotationFocus.setValue(!1)}}if(e.activeTags.changed){const t=e.activeTags.value;this.getGraphComponents(c.A).forEach(e=>e.ins.activeTags.setValue(t)),this.getGraphComponents(l.A).forEach(e=>e.ins.activeTags.setValue(t))}return e.sortedTags.changed&&this.refreshTagCloud(),!0}tock(){if(this._needsAnnoFocus){let t=null;if(this.outs.tagCloud.value.length>0){t=this.rootElement.shadowRoot.querySelector(".sv-tag-buttons").getElementsByClassName("ff-button")[0]}else{t=this.rootElement.shadowRoot.querySelector("ff-viewport-overlay").querySelector('[tabindex="0"]')}t&&t.focus(),this._needsAnnoFocus=!1}return!1}fromData(t){const e=this.ins;e.copyValues({shader:o.gw[t.shader]||o.gw.Default,exposure:void 0!==t.exposure?t.exposure:e.exposure.schema.preset,toneMapping:t.toneMapping||!1,gamma:void 0!==t.gamma?t.gamma:e.gamma.schema.preset,isWallMountAR:t.isWallMountAR||!1,arScale:t.arScale||1,annotationsVisible:!!t.annotationsVisible,activeTags:t.activeTags||"",sortedTags:t.sortedTags||"",radioTags:void 0!==t.radioTags?!!t.radioTags:e.radioTags.schema.preset})}toData(){const t=this.ins,e={shader:o.gw[t.shader.value],exposure:t.exposure.value,toneMapping:t.toneMapping.value,gamma:t.gamma.value,isWallMountAR:t.isWallMountAR.value,arScale:t.arScale.value};return t.annotationsVisible.value&&(e.annotationsVisible=!0),t.activeTags.value&&(e.activeTags=t.activeTags.value),t.sortedTags.value&&(e.sortedTags=t.sortedTags.value),t.radioTags.value&&(e.radioTags=t.radioTags.value),e}refreshTagCloud(){const t=new Set;this.getGraphComponents(l.A).forEach(e=>{e.ins.tags.value.split(",").map(t=>t.trim()).filter(t=>t).forEach(e=>t.add(e))});this.getGraphComponents(c.A).forEach(e=>{e.getAnnotations().forEach(e=>{e.tags.forEach(e=>{t.add(e)})})});const e=Array.from(t),i=this.ins.sortedTags.value.split(",").map(t=>t.trim()).filter(t=>t);e.sort((t,e)=>{const n=i.indexOf(t),s=i.indexOf(e);return n<s?-1:n>s?1:0}),this.outs.tagCloud.setValue(e.join(", ")),this.ins.activeTags.set(),this.ins.annotationsVisible.set()}onAnnotationClick(t){const e=t.annotation?t.annotation.id:"";this.ins.activeAnnotation.setValue(e),this.rootElement.dispatchEvent(new CustomEvent("annotation-active",{detail:e}))}onModelComponent(t){const e=t.object;t.add?(e.on("tag-update",this.refreshTagCloud,this),e.on("model-load",this.onModelLoad,this)):t.remove&&(e.off("tag-update",this.refreshTagCloud,this),e.off("model-load",this.onModelLoad,this))}onAnnotationsComponent(t){const e=t.object;t.add?(e.on("tag-update",this.refreshTagCloud,this),e.on("active-tag-update",this.focusTags,this),e.on("click",this.onAnnotationClick,this),e.ins.visible.setValue(this.ins.annotationsVisible.value)):t.remove&&(e.off("tag-update",this.refreshTagCloud,this),e.off("active-tag-update",this.focusTags,this),e.off("click",this.onAnnotationClick,this))}onLanguageComponent(t){const e=t.object;t.add?e.on("tag-update",this.refreshTagCloud,this):t.remove&&e.off("tag-update",this.refreshTagCloud,this)}onModelLoad(t){this.rootElement.dispatchEvent(new CustomEvent("model-load",{detail:a.a9[t.quality]})),this.refreshTagCloud();const e=new Set(this.ins.variant.schema.options);this.getGraphComponents(l.A).forEach(t=>{t.ins.variant.schema.options.forEach(e.add,e)}),this.ins.variant.setOptions([...e])}focusTags(){const t=this.ins,e=this.getGraphComponent(f.A);if(e&&e.tours.ins.enabled.value)return;const i=this.rootElement.shadowRoot.querySelector("ff-viewport-overlay"),n=(0,p.R)(i);t.annotationFocus.value&&n.length>0&&(n[0].focus(),t.annotationFocus.setValue(!1))}}g.typeName="CVViewer",g.text="Viewer",g.icon="",g.ins={annotationsVisible:s.gK.Boolean("Annotations.Visible"),annotationExit:s.gK.Event("Annotations.Exit"),annotationFocus:s.gK.Boolean("Annotations.Focus",!1),activeAnnotation:s.gK.String("Annotations.ActiveId"),activeTags:s.gK.String("Tags.Active"),sortedTags:s.gK.String("Tags.Sorted"),radioTags:s.gK.Boolean("Tags.Radio"),shader:s.gK.Enum("Renderer.Shader",o.gw),variant:s.gK.Option("Renderer.Variant",[],0),toneMapping:s.gK.Boolean("Renderer.ToneMapping",!1),exposure:s.gK.Number("Renderer.Exposure",1),gamma:s.gK.Number("Renderer.Gamma",2),quality:s.gK.Enum("Models.Quality",a.a9,a.a9.High),isWallMountAR:s.gK.Boolean("AR.IsWallMount",!1),arScale:s.gK.Number("AR.Scale",1)},g.outs={tagCloud:s.gK.String("Tags.Cloud")}},2654:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>g,Gz:()=>n,P:()=>s});var n,s,r=i(3074),o=i(9163),a=i(8424),l=i(5676),c=i(2997),h=i(8172),u=i(161),d=i(2791);!function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Top=2]="Top",t[t.Bottom=3]="Bottom",t[t.Front=4]="Front",t[t.Back=5]="Back",t[t.None=6]="None"}(n||(n={})),function(t){t[t.Orbit=0]="Orbit",t[t.Zoom=1]="Zoom",t[t.Pan=2]="Pan"}(s||(s={}));const p=[];p[n.Left]=[0,-90,0],p[n.Right]=[0,90,0],p[n.Front]=[0,0,0],p[n.Back]=[0,180,0],p[n.Top]=[-90,0,0],p[n.Bottom]=[90,0,0];const f=function(t,e){for(let i=0,n=t.length;i<n;++i)t[i]=null===t[i]?e:t[i];return t};class g extends r.Ay{constructor(t,e){super(t,e),this.ins=this.addInputs(g.ins),this._controller=new o.A,this._scene=null,this._modelBoundingBox=null,this._hasChanged=!1,this._hasZoomed=!1,this._isAutoZooming=!1,this._autoRotationStartTime=null,this._initYOrbit=null,this._scene=this.scene}get settingProperties(){return[this.ins.enabled,this.ins.mode,this.ins.orbit,this.ins.offset,this.ins.autoZoom,this.ins.autoRotation,this.ins.autoRotationSpeed,this.ins.lightsFollowCamera,this.ins.minOrbit,this.ins.minOffset,this.ins.maxOrbit,this.ins.maxOffset]}get snapshotProperties(){return[this.ins.orbit,this.ins.offset]}get assetManager(){return this.getMainComponent(u.A)}get sceneNode(){return this.getSystemComponent(h.A)}get arManager(){return this.getSystemComponent(d.A)}create(){super.create(),this.system.on(["pointer-down","pointer-up","pointer-move"],this.onPointer,this),this.system.on("wheel",this.onTrigger,this),this.system.on("keydown",this.onKeyboard,this),this.assetManager.outs.completed.on("value",this.onLoadingCompleted,this),this.sceneNode.outs.boundingRadius.on("value",this.onBoundsChange,this)}dispose(){this.sceneNode.outs.boundingRadius.on("value",this.onBoundsChange,this),this.assetManager.outs.completed.off("value",this.onLoadingCompleted,this),this.system.off(["pointer-down","pointer-up","pointer-move"],this.onPointer,this),this.system.off("wheel",this.onTrigger,this),this.system.off("keydown",this.onKeyboard,this),super.dispose()}update(){const t=this.ins,e=this._controller,i=this._scene.activeCameraComponent,s=i?i.camera:null,{projection:r,preset:l,orbit:u,offset:d}=t;if(i&&r.changed&&(s.setProjection(r.getValidatedValue()),i.ins.projection.setValue(r.value,!0),s.isOrthographicCamera||(s.size=i.ins.size.value,s.far=i.ins.far.value,s.updateProjectionMatrix())),l.changed&&l.value!==n.None&&u.setValue(p[l.getValidatedValue()].slice()),t.mode.changed)switch(t.mode.value){case c.Kd.Orbit:e.controllerMode=o.d.Orbit;break;case c.Kd.Fly:e.controllerMode=o.d.Fly;break;case c.Kd.Walk:e.controllerMode=o.d.Walk}if(t.lightsFollowCamera.changed){const e=this.getLightTransform();e&&(t.lightsFollowCamera.value?(e.ins.order.setValue(a.I8.ZXY),e.ins.rotation.reset(),e.ins.rotation.linkFrom(u,1,1)):(e.ins.rotation.unlinkFrom(u,1,1),e.ins.rotation.reset()))}const{minOrbit:f,minOffset:g,maxOrbit:m,maxOffset:A}=t;if((u.changed||d.changed)&&(e.orbit.fromArray(u.value),e.offset.fromArray(d.value)),(f.changed||g.changed||m.changed||A.changed)&&(e.minOrbit.fromArray(f.value),e.minOffset.fromArray(g.value),e.maxOrbit.fromArray(m.value),e.maxOffset.fromArray(A.value)),s&&t.zoomExtents.changed){const t=this.getGraphComponent(h.A);t.models.some(t=>t.outs.updated.changed)&&t.update(null),this._modelBoundingBox=t.outs.boundingBox.value,(!this._isAutoZooming||this.ins.autoZoom.value&&!this._modelBoundingBox.isEmpty())&&(e.camera&&(i.camera.aspect=e.camera.aspect),e.camera=i.camera,e.zoomExtents(this._modelBoundingBox),this._hasZoomed=!0),this._isAutoZooming=!1}return t.autoRotation.changed&&(this._autoRotationStartTime=t.autoRotation.value?performance.now():null),t.promptActive.changed&&!this._autoRotationStartTime&&(this._initYOrbit=e.orbit.y,this._autoRotationStartTime=t.promptActive.value?performance.now():null),!0}tick(){const t=this.ins,e=this._scene.activeCameraComponent;if(!t.enabled.value||!e)return;e.ins.projection.value!=t.projection.value&&t.projection.setValue(e.ins.projection.value);const i=this._controller;i.camera=e.camera;const s=e.transform,r=this.changed||t.autoRotation.value||t.promptActive.value;if((t.autoRotation.value||t.promptActive.value)&&this._autoRotationStartTime){const e=performance.now(),n=.001*(e-this._autoRotationStartTime);if(t.autoRotation.value)i.orbit.y=(i.orbit.y+t.autoRotationSpeed.value*n)%360,this._autoRotationStartTime=e;else{const t=this.arManager.shadowRoot.getElementById("prompt");if(t){const e=2,s=1.5,r=2*s,o=.2*s;let a=n%(r+e);a>r&&a<r+e?(t.style.opacity=a<r+o?""+(1-(a-r)/o):"0.0",a=0):a<o&&(t.style.opacity=a<o?""+a/o:"1.0");const l=20*Math.sin(a/s*Math.PI);i.orbit.y=this._initYOrbit+l,t.style.transform=`translateX(${-4*l}px)`}}}return!!i.updateCamera(s.object3D,r)&&(i.orbit.toArray(t.orbit.value),t.orbit.set(!0),i.offset.toArray(t.offset.value),t.offset.set(!0),t.preset.value===n.None||t.preset.changed||t.preset.setValue(n.None,!0),!t.isInUse.value&&this._hasChanged&&t.isInUse.setValue(!0),s?s.setPropertiesFromMatrix():e.setPropertiesFromMatrix(),!0)}preRender(t){this._modelBoundingBox&&t.viewport.zoomExtents(this._modelBoundingBox)}setChanged(t){this._hasChanged=t}tock(){return this._modelBoundingBox=null,!1}fromData(t){const e=(t=t||{}).orbit||{orbit:[-25,-25,0],offset:[0,0,100],minOrbit:[-90,-1/0,-1/0],minOffset:[-1/0,-1/0,.1],maxOrbit:[90,1/0,1/0],maxOffset:[1/0,1/0,1/0]};this.ins.copyValues({enabled:!!t.enabled,autoZoom:!!t.autoZoom,autoRotation:!!t.autoRotation,lightsFollowCamera:!!t.lightsFollowCamera,mode:c.Kd[t.type]||c.Kd.Orbit,orbit:e.orbit,offset:e.offset,minOrbit:f(e.minOrbit,-1/0),maxOrbit:f(e.maxOrbit,1/0),minOffset:f(e.minOffset,-1/0),maxOffset:f(e.maxOffset,1/0)})}toData(){const t=this.ins,e={};return e.enabled=t.enabled.value,e.autoZoom=t.autoZoom.value,e.autoRotation=t.autoRotation.value,e.lightsFollowCamera=t.lightsFollowCamera.value,e.type=c.Kd[t.mode.value],e.orbit={orbit:t.orbit.cloneValue(),offset:t.offset.cloneValue(),minOrbit:t.minOrbit.cloneValue(),maxOrbit:t.maxOrbit.cloneValue(),minOffset:t.minOffset.cloneValue(),maxOffset:t.maxOffset.cloneValue()},e}getLightTransform(){const t=this.graph.findNodeByName("Lights");return t&&t.getComponent(a.Ay,!0)}onPointer(t){const e=t.viewport;e.camera||(this.ins.enabled.value&&this._scene.activeCameraComponent&&("pointer-down"===t.type&&"None"!==window.getSelection().type&&window.getSelection().removeAllRanges(),this._controller.setViewportSize(e.width,e.height),this._controller.onPointer(t),t.stopPropagation=!0),this._hasChanged=!0)}onTrigger(t){const e=t.viewport;e.camera||(this.ins.enabled.value&&this._scene.activeCameraComponent&&(this._controller.setViewportSize(e.width,e.height),this._controller.onTrigger(t),t.stopPropagation=!0),this._hasChanged=!0)}onKeyboard(t){const e=t.viewport;e.camera||(this.ins.enabled.value&&this._scene.activeCameraComponent&&(t.key.includes("Arrow")&&(t.ctrlKey?this.ins.keyNavActive.setValue(s.Zoom):t.shiftKey?this.ins.keyNavActive.setValue(s.Pan):this.ins.keyNavActive.setValue(s.Orbit)),this._controller.setViewportSize(e.width,e.height),this._controller.onKeypress(t)&&t.originalEvent.preventDefault(),t.stopPropagation=!0),this._hasChanged=!0)}onLoadingCompleted(t){!this.ins.autoZoom.value||this._hasChanged&&this._hasZoomed||(this.ins.zoomExtents.set(),this._isAutoZooming=!0)}onBoundsChange(){this._controller.boundsRadius=this.sceneNode.outs.boundingRadius.value}}g.typeName="CVOrbitNavigation",g.text="Orbit Navigation",g.icon="",g.ins={enabled:r.gK.Boolean("Settings.Enabled",!0),pointerEnabled:r.gK.Boolean("Settings.PointerEnabled",!0),promptEnabled:r.gK.Boolean("Settings.PromptEnabled",!0),isInUse:r.gK.Boolean("Camera.IsInUse",!1),preset:r.gK.Enum("Camera.ViewPreset",n,n.None),projection:r.gK.Enum("Camera.Projection",l.$R,l.$R.Perspective),lightsFollowCamera:r.gK.Boolean("Navigation.LightsFollowCam",!0),autoRotation:r.gK.Boolean("Navigation.AutoRotation",!1),autoRotationSpeed:r.gK.Number("Navigation.AutoRotationSpeed",10),mode:r.gK.Enum("Navigation.Mode",c.Kd,c.Kd.Orbit),zoomExtents:r.gK.Event("Settings.ZoomExtents"),autoZoom:r.gK.Boolean("Settings.AutoZoom",!0),orbit:r.gK.Vector3("Current.Orbit",[-25,-25,0]),offset:r.gK.Vector3("Current.Offset",[0,0,100]),minOrbit:r.gK.Vector3("Limits.Min.Orbit",[-90,-1/0,-1/0]),minOffset:r.gK.Vector3("Limits.Min.Offset",[-1/0,-1/0,.1]),maxOrbit:r.gK.Vector3("Limits.Max.Orbit",[90,1/0,1/0]),maxOffset:r.gK.Vector3("Limits.Max.Offset",[1/0,1/0,1/0]),keyNavActive:r.gK.Enum("Navigation.KeyNavActive",s),promptActive:r.gK.Boolean("Navigation.PromptActive",!1)}},2690:(t,e,i)=>{"use strict";i.d(e,{My:()=>o,kp:()=>r});const n=Math.PI,s=.5*n;var r;function o(t){return a[r[t]]}!function(t){t[t.Linear=0]="Linear",t[t.EaseQuad=1]="EaseQuad",t[t.EaseInQuad=2]="EaseInQuad",t[t.EaseOutQuad=3]="EaseOutQuad",t[t.EaseCubic=4]="EaseCubic",t[t.EaseInCubic=5]="EaseInCubic",t[t.EaseOutCubic=6]="EaseOutCubic",t[t.EaseQuart=7]="EaseQuart",t[t.EaseInQuart=8]="EaseInQuart",t[t.EaseOutQuart=9]="EaseOutQuart",t[t.EaseQuint=10]="EaseQuint",t[t.EaseInQuint=11]="EaseInQuint",t[t.EaseOutQuint=12]="EaseOutQuint",t[t.EaseSine=13]="EaseSine",t[t.EaseInSine=14]="EaseInSine",t[t.EaseOutSine=15]="EaseOutSine"}(r||(r={}));const a={Linear:function(t){return t},EaseQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},EaseInQuad:function(t){return t*t},EaseOutQuad:function(t){return t*(2-t)},EaseCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},EaseInCubic:function(t){return t*t*t},EaseOutCubic:function(t){return--t*t*t+1},EaseQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},EaseInQuart:function(t){return t*t*t*t},EaseOutQuart:function(t){return 1- --t*t*t*t},EaseQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},EaseInQuint:function(t){return t*t*t*t*t},EaseOutQuint:function(t){return 1+--t*t*t*t*t},EaseSine:function(t){return-.5*(Math.cos(t*n)-1)},EaseInSine:function(t){return 1-Math.cos(t*s)},EaseOutSine:function(t){return Math.sin(t*s)}}},2704:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});class n{static makeZeros(){return new n(0,0)}static makeOnes(){return new n(1,1)}static makeUnitX(){return new n(1,0)}static makeUnitY(){return new n(0,1)}static makeCopy(t){return new n(t.x,t.y)}static makeFromScalar(t){return new n(t,t)}static makeFromArray(t){return new n(t[0],t[1])}static toString(t){return`[${t.x}, ${t.y}]`}constructor(t,e){this.x=t||0,this.y=e||0}copy(t){return this.x=t.x,this.y=t.y,this}set(t,e){return this.x=t,this.y=e,this}setFromScalar(t){return this.x=t,this.y=t,this}setFromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}setZeros(){return this.x=0,this.y=0,this}setOnes(){return this.x=1,this.y=1,this}setUnitX(){return this.x=1,this.y=0,this}setUnitY(){return this.x=0,this.y=1,this}add(t){return this.x+=t.x,this.y+=t.y,this}sub(t){return this.x-=t.x,this.y-=t.y,this}mul(t){return this.x*=t.x,this.y*=t.y,this}div(t){return this.x/=t.x,this.y/=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}subScalar(t){return this.x-=t,this.y-=t,this}mulScalar(t){return this.x*=t,this.y*=t,this}divScalar(t){return this.x/=t,this.y/=t,this}translate(t,e){return this.x+=t,this.y+=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),n=this.x,s=this.y;return this.x=e*n-i*s,this.y=i*n+e*s,this}scale(t,e){return this.x*=t,this.y*=e,this}invert(){return this.x=1/this.x,this.y=1/this.y,this}negate(){return this.x=-this.x,this.y=-this.y,this}normalize(){const t=1/Math.sqrt(this.x*this.x+this.y*this.y);return this.x*=t,this.y*=t,this}dot(t){return this.x*t.x+this.y*t.y}length(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}lengthSquared(){const t=this.x,e=this.y;return t*t+e*e}distanceTo(t){const e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)}angle(){return Math.atan2(this.y,this.x)}angleTo(t){const e=this.x,i=this.y,n=t.x,s=t.y;return Math.acos((e*n+i*s)/(Math.sqrt(e*e+i*i)+Math.sqrt(n*n+s*s)))}min(){return this.x<this.y?this.x:this.y}max(){return this.x>this.y?this.x:this.y}isZero(){return 0===this.x&&0===this.y}clone(){return new n(this.x,this.y)}toArray(t,e){return t?(void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t):[this.x,this.y]}toString(){return n.toString(this)}}n.zeros=new n(0,0),n.ones=new n(1,1),n.unitX=new n(1,0),n.unitY=new n(0,1)},2709:(t,e,i)=>{"use strict";var n,s=i(6763),r=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let o=n=class extends s.Ay{constructor(){super(),this.direction="horizontal",this.width=5,this.margin=20,this.detached=!1,this._isActive=!1,this._offset=0,this._position=0,this.addEventListener("pointerdown",t=>this.onPointerDown(t)),this.addEventListener("pointermove",t=>this.onPointerMove(t)),this.addEventListener("pointerup",t=>this.onPointerUpOrCancel(t)),this.addEventListener("pointercancel",t=>this.onPointerUpOrCancel(t))}get position(){return this._position}isHorizontal(){return"horizontal"===this.direction}update(t){super.update(t);const e=this.isHorizontal(),i=this.width;this.setStyle({padding:e?`0 ${i}px`:`${i}px 0`,margin:e?`0 ${-i}px`:-i+"px 0",cursor:e?"col-resize":"row-resize"})}firstUpdated(){this.classList.add("ff-splitter"),this.setAttribute("touch-action","none"),this.setStyle({position:"relative",display:"block",zIndex:"1",touchAction:"none"})}onPointerDown(t){if(t.isPrimary){t.stopPropagation(),t.preventDefault(),this._isActive=!0,this.setPointerCapture(t.pointerId);const e=this.getBoundingClientRect();this._offset=this.isHorizontal()?e.left+.5*e.width-t.clientX:e.top+.5*e.height-t.clientY}}onPointerMove(t){if(t.isPrimary&&this._isActive){t.stopPropagation(),t.preventDefault();const e=this.parentElement;if(!e)return;const i=e.getBoundingClientRect(),s=this.isHorizontal(),r=s?i.width:i.height;let o=this._offset+(s?t.clientX-i.left:t.clientY-i.top),a=o/r;if(!this.detached){const t=this.previousElementSibling,i=this.nextElementSibling;if(t instanceof HTMLElement&&i instanceof HTMLElement){const l=Array.from(e.children);let c=0,h=r,u=!1;l.forEach(e=>{if(e instanceof n)return;if(e===t||e===i)return void(u=!0);const r=e.getBoundingClientRect(),o=s?r.width:r.height;h-=o,u||(c+=o)});const d=this.margin,p=h-d;o-=c,o=o<d?d:o>p?p:o;const f=(h-o)/r;a=o/r,t.style.flexBasis=(100*a).toFixed(3)+"%",i.style.flexBasis=(100*f).toFixed(3)+"%",setTimeout(()=>window.dispatchEvent(new CustomEvent("resize")),0)}}this._position=a,this.dispatchEvent(new CustomEvent(n.changeEvent,{detail:{direction:this.direction,position:this._position,isDragging:!0}}))}}onPointerUpOrCancel(t){t.isPrimary&&(t.preventDefault(),this._isActive=!1,this._position>0&&(t.stopPropagation(),this.dispatchEvent(new CustomEvent(n.changeEvent,{detail:{direction:this.direction,position:this._position,isDragging:!1}}))))}};o.changeEvent="ff-splitter-change",r([(0,s.MZ)({type:String})],o.prototype,"direction",void 0),r([(0,s.MZ)({type:Number})],o.prototype,"width",void 0),r([(0,s.MZ)({type:Number})],o.prototype,"margin",void 0),r([(0,s.MZ)({type:Boolean})],o.prototype,"detached",void 0),o=n=r([(0,s.EM)("ff-splitter")],o)},2719:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decodeXMLStrict=e.decodeHTML5Strict=e.decodeHTML4Strict=e.decodeHTML5=e.decodeHTML4=e.decodeHTMLAttribute=e.decodeHTMLStrict=e.decodeHTML=e.decodeXML=e.DecodingMode=e.EntityDecoder=e.encodeHTML5=e.encodeHTML4=e.encodeNonAsciiHTML=e.encodeHTML=e.escapeText=e.escapeAttribute=e.escapeUTF8=e.escape=e.encodeXML=e.encode=e.decodeStrict=e.decode=e.EncodingMode=e.EntityLevel=void 0;var n,s,r=i(9585),o=i(3657),a=i(2948);function l(t,e){if(void 0===e&&(e=n.XML),("number"==typeof e?e:e.level)===n.HTML){var i="object"==typeof e?e.mode:void 0;return(0,r.decodeHTML)(t,i)}return(0,r.decodeXML)(t)}!function(t){t[t.XML=0]="XML",t[t.HTML=1]="HTML"}(n=e.EntityLevel||(e.EntityLevel={})),function(t){t[t.UTF8=0]="UTF8",t[t.ASCII=1]="ASCII",t[t.Extensive=2]="Extensive",t[t.Attribute=3]="Attribute",t[t.Text=4]="Text"}(s=e.EncodingMode||(e.EncodingMode={})),e.decode=l,e.decodeStrict=function(t,e){var i;void 0===e&&(e=n.XML);var s="number"==typeof e?{level:e}:e;return null!==(i=s.mode)&&void 0!==i||(s.mode=r.DecodingMode.Strict),l(t,s)},e.encode=function(t,e){void 0===e&&(e=n.XML);var i="number"==typeof e?{level:e}:e;return i.mode===s.UTF8?(0,a.escapeUTF8)(t):i.mode===s.Attribute?(0,a.escapeAttribute)(t):i.mode===s.Text?(0,a.escapeText)(t):i.level===n.HTML?i.mode===s.ASCII?(0,o.encodeNonAsciiHTML)(t):(0,o.encodeHTML)(t):(0,a.encodeXML)(t)};var c=i(2948);Object.defineProperty(e,"encodeXML",{enumerable:!0,get:function(){return c.encodeXML}}),Object.defineProperty(e,"escape",{enumerable:!0,get:function(){return c.escape}}),Object.defineProperty(e,"escapeUTF8",{enumerable:!0,get:function(){return c.escapeUTF8}}),Object.defineProperty(e,"escapeAttribute",{enumerable:!0,get:function(){return c.escapeAttribute}}),Object.defineProperty(e,"escapeText",{enumerable:!0,get:function(){return c.escapeText}});var h=i(3657);Object.defineProperty(e,"encodeHTML",{enumerable:!0,get:function(){return h.encodeHTML}}),Object.defineProperty(e,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return h.encodeNonAsciiHTML}}),Object.defineProperty(e,"encodeHTML4",{enumerable:!0,get:function(){return h.encodeHTML}}),Object.defineProperty(e,"encodeHTML5",{enumerable:!0,get:function(){return h.encodeHTML}});var u=i(9585);Object.defineProperty(e,"EntityDecoder",{enumerable:!0,get:function(){return u.EntityDecoder}}),Object.defineProperty(e,"DecodingMode",{enumerable:!0,get:function(){return u.DecodingMode}}),Object.defineProperty(e,"decodeXML",{enumerable:!0,get:function(){return u.decodeXML}}),Object.defineProperty(e,"decodeHTML",{enumerable:!0,get:function(){return u.decodeHTML}}),Object.defineProperty(e,"decodeHTMLStrict",{enumerable:!0,get:function(){return u.decodeHTMLStrict}}),Object.defineProperty(e,"decodeHTMLAttribute",{enumerable:!0,get:function(){return u.decodeHTMLAttribute}}),Object.defineProperty(e,"decodeHTML4",{enumerable:!0,get:function(){return u.decodeHTML}}),Object.defineProperty(e,"decodeHTML5",{enumerable:!0,get:function(){return u.decodeHTML}}),Object.defineProperty(e,"decodeHTML4Strict",{enumerable:!0,get:function(){return u.decodeHTMLStrict}}),Object.defineProperty(e,"decodeHTML5Strict",{enumerable:!0,get:function(){return u.decodeHTMLStrict}}),Object.defineProperty(e,"decodeXMLStrict",{enumerable:!0,get:function(){return u.decodeXML}})},2791:(t,e,i)=>{"use strict";i.d(e,{A:()=>I});var n=i(3423),s=i(3889),r=i(8424),o=i(9309),a=i(6773),l=i(4640),c=i(3715),h=i(8172),u=i(1721),d=i(3675),p=i(1572),f=i(9616),g=i(161);class m extends l.ZyN{constructor(t,e,i){super(),this.shadowMaterial=new l.q2,this.boundingBox=new l.NRn,this.size=new l.Pq0,this.isAnimated=!1,this.needsUpdate=!1,this.intensity=0,this.castShadow=!0,this.frustumCulled=!1,this.floor=new l.eaF(new l.bdM,this.shadowMaterial),this.floor.rotateX(-Math.PI/2),this.floor.receiveShadow=!0,this.floor.castShadow=!1,this.floor.frustumCulled=!1,this.add(this.floor),this.shadow.camera.up.set(0,0,1),e.add(this),this.target=e,this.setModel(t,i)}setModel(t,e){this.boundingBox.copy(t.outs.boundingBox.value),t.outs.boundingBox.value.getSize(this.size);const{boundingBox:i,size:n}=this;if(this.isAnimated){const t=2*Math.max(n.x,n.y,n.z);n.y=t,i.expandByVector(n.subScalar(t).multiplyScalar(-.5)),i.max.y=i.min.y+t,n.set(t,t,t)}const s=.001*n.y;this.position.y=i.max.y+s,i.getCenter(this.floor.position),this.setSoftness(e)}setSoftness(t){const e=Math.pow(2,9-3*t);this.setMapSize(e)}setMapSize(t){const{camera:e,mapSize:i,map:n}=this.shadow,{size:s,boundingBox:r}=this;null!=n&&(n.dispose(),this.shadow.map=null),this.isAnimated&&(t*=2);const o=Math.floor(s.x>s.z?t:t*s.x/s.z),a=Math.floor(s.x>s.z?t*s.z/s.x:t);i.set(o,a);const l=2.5*s.x/o,c=2.5*s.z/a;e.left=-r.max.x-l,e.right=-r.min.x+l,e.bottom=r.min.z-c,e.top=r.max.z+c,this.setScaleAndOffset(e.zoom,0),this.shadow.updateMatrices(this),this.floor.scale.set(s.x+2*l,s.z+2*c,1),this.needsUpdate=!0}setIntensity(t){this.shadowMaterial.opacity=t,t>0?(this.visible=!0,this.floor.visible=!0):(this.visible=!1,this.floor.visible=!1)}getIntensity(){return this.shadowMaterial.opacity}setRotation(t){this.shadow.camera.up.set(Math.sin(t),0,Math.cos(t)),this.shadow.updateMatrices(this)}setScaleAndOffset(t,e){const i=this.size.y,n=1/t,s=.001*i;this.floor.position.y=2*s-i+e*n;const{camera:r}=this.shadow;r.zoom=t,r.near=0,r.far=i*t-e,r.projectionMatrix.makeOrthographic(r.left*t,r.right*t,r.top*t,r.bottom*t,r.near,r.far),r.projectionMatrixInverse.copy(r.projectionMatrix).invert(),this.shadow.updateMatrices(this)}updateMatrices(){this.shadow.updateMatrices(this)}dispose(){const{floor:t,shadowMaterial:e}=this;t.geometry.dispose(),e.dispose(),this.floor=null,this.shadowMaterial=null}}var A=i(2552),v=i(2997),y=i(8604),b=i(8313);const _=new l.kn4,x=new l.Pq0,w=new l.I9Y,E=new l.Pq0,C=new l.NRn,S=new l.PTz;class I extends n.Ay{constructor(){super(...arguments),this._shadowRoot=null,this._arCodeImage=null,this.ins=this.addInputs(I.ins),this.outs=this.addOutputs(I.outs),this.arLink=document.createElement("a"),this.raycaster=new l.tBo,this.initialHitTestSource=null,this.inputSource=null,this.transientHitTestSource=null,this.refSpace=null,this.frame=null,this.vScene=null,this.camera=null,this.cameraParent=null,this.cachedView=null,this.cachedQuality=null,this.cachedNearPlane=0,this.cachedFarPlane=0,this.xrCamera=null,this.hitPlane=null,this.selectionRing=null,this.session=null,this.setup=null,this.originalUnits=null,this.isTranslating=!1,this.isRotating=!1,this.isScaling=!1,this.lastDragValueX=0,this.lastDragValueY=0,this.totalDrag=0,this.lastScale=0,this.lastHitPosition=new l.Pq0,this.lastFrameTime=0,this.targetOpacity=0,this.modelFloorOffset=0,this.optimalCameraDistance=0,this.shadow=null,this.lightTransform=null,this.lightsToReset=[],this.featuresToReset=[],this.annotationsAtLaunch=!1,this.scaleDisplay=null,this.updateScale=!1,this.placementRotation=new l.PTz,this.onSessionEnded=()=>{this.outs.isPresenting.setValue(!1);const t=this.renderer.views[0].renderer;this.resetScene(),t.shadowMap.autoUpdate=!0;const e=this.initialHitTestSource;null!=e&&(e.cancel(),this.initialHitTestSource=null);const i=this.transientHitTestSource;null!=i&&(i.cancel(),this.transientHitTestSource=null),this.refSpace=null,this.frame=null,this.inputSource=null,this.xrCamera=null,this.cachedView=null,this.vScene=null,this.cachedView=null,this.camera=null;const n=this.session;n&&(n.removeEventListener("end",this.onSessionEnded),n.removeEventListener("selectstart",this.onSelectStart),n.removeEventListener("selectend",this.onSelectEnd),this.session=null),this.setup.reader.ins.enabled.off("value",this.endSession,this),t.setAnimationLoop(null),t.xr.enabled=!1,this.outs.isPlaced.setValue(!1),this.setup.navigation.ins.enabled.setValue(!0),this.renderer.views[0].render()},this.render=(t,e)=>{this.frame=e;const i=this.renderer.views[0].renderer,{camera:n,xrCamera:s,refSpace:r,initialHitTestSource:o,vScene:a,sceneNode:l,shadow:c,lastFrameTime:h}=this;if(!e||!e.getViewerPose(r))return;if(!s&&this.session){const t=i.xr.getCamera();return void(this.xrCamera=t.cameras[0])}if(s&&(i.xr.updateCamera(n),n.updateMatrixWorld(!0),n.projectionMatrix.fromArray(s.projectionMatrix.elements),n.projectionMatrixInverse.copy(s.projectionMatrix).invert()),null!=o&&s){const t=a.scene,{position:e}=t,i=2*l.outs.boundingRadius.value+s.near;s.projectionMatrixInverse.copy(s.projectionMatrix).invert();const r=n.getWorldDirection(x);t.rotation.y=Math.atan2(-r.x,-r.z),e.copy(n.position).add(r.multiplyScalar(i)),this.shadow.setRotation(t.rotation.y),t.updateMatrix(),t.updateMatrixWorld()}if(this.setInitialPosition(e),this.handleInput(e),this.outs.isPlaced.value){const e=t-h;this.updateOpacity(e,this.targetOpacity),this.lastFrameTime=t}const u=i.getContext();if(u.depthMask(!1),u.clear(u.DEPTH_BUFFER_BIT),u.depthMask(!0),c.needsUpdate&&(i.shadowMap.needsUpdate=!0,c.needsUpdate=!1),this.updateScale){const t=a.scene,e=this.scaleDisplay;x.copy(t.position);const i=this.renderer.views[0].viewports[0].width,n=this.renderer.views[0].viewports[0].height,r=i/2,o=n/2,l=i-e.clientWidth,c=n-e.clientHeight;x.project(s),x.x=Math.min(Math.max(x.x*r+r,0),l),x.y=Math.min(Math.max(-x.y*o+o,0),c),e.style.left=x.x.toString()+"px",e.style.top=x.y.toString()+"px",e.innerText=Math.round(100*t.scale.x).toString()+"%"}i.render(a.scene,n)},this.onSelectStart=t=>{const e=this.vScene.scene,i=this.transientHitTestSource;if(null==i)return;this.targetOpacity=.5;const n=this.frame.getHitTestResultsForTransientInput(i);if(1===n.length){this.inputSource=t.inputSource;const{axes:e}=this.inputSource.gamepad,i=this.raycaster;w.set(e[0],-e[1]),i.setFromCamera(w,this.xrCamera);const n=i.intersectObject(this.hitPlane);n.length>0?(this.isTranslating=!0,this.lastHitPosition.copy(n[0].point)):!1===this.ins.wallMount.value&&(this.isRotating=!0),this.lastDragValueX=e[0],this.lastDragValueY=e[1]}else 2===n.length&&(this.isScaling=!0,this.lastScale=this.getFingerSeparation(n)/e.scale.x)},this.onSelectEnd=()=>{this.targetOpacity=0,this.totalDrag=0,this.isTranslating=!1,this.isRotating=!1,this.isScaling=!1,this.scaleDisplay.classList.remove("sv-show"),this.inputSource=null}}get renderer(){return this.getMainComponent(s.A)}get pulse(){return this.getMainComponent(o.A)}get sceneNode(){return this.getSystemComponent(h.A)}get analytics(){return this.system.getMainComponent(y.A)}get assetManager(){return this.getMainComponent(g.A)}get shadowRoot(){return this._shadowRoot}set shadowRoot(t){this._shadowRoot=t}get arCodeImage(){const t=document.documentURI;if(null==this._arCodeImage&&t.includes(".si.edu")&&t.includes("3d-api")){const e=t.split("/").pop().split(":").pop();36==e.length&&(this._arCodeImage="https://3d-api.si.edu/voyager/"+e+"/qrcode")}return this._arCodeImage}create(){super.create(),this.system.components.on(b.A,this.onMetaComponent,this)}dispose(){this.system.components.off(b.A,this.onMetaComponent,this),super.dispose()}update(){const{ins:t,outs:e}=this;if(t.enabled.changed){let i=t.enabled.value;i&&(c.al?(this.launchWebXR(),this.analytics.sendProperty("AR_Enabled","WebXR")):c.Ni?(this.launchSceneViewer(),this.analytics.sendProperty("AR_Enabled","SceneViewer")):c.pz&&c.UN?(this.launchQuickLook(),this.analytics.sendProperty("AR_Enabled","QuickLook")):(i=!1,this.analytics.sendProperty("AR_Enabled","Unavailable"),a.Ay.show("AR unavailable on this platform.","warning"))),e.enabled.setValue(i)}return!0}launchWebXR(){var t,e,i;const n=null===(t=this.renderer)||void 0===t?void 0:t.views[0].renderer,s=this.vScene=null===(e=this.renderer)||void 0===e?void 0:e.activeSceneComponent,r=this.camera=null==s?void 0:s.activeCamera;this.cameraParent=r.parent;if(!(this.setup=this.getSystemComponent(u.A)))return!1;const o=null===(i=this.sceneNode)||void 0===i?void 0:i.getGraphComponents(f.A);let l=null;for(const t of o)if(l=t.derivatives.get(p.UH.Web3D,p.a9.AR),null!=l)break;l&&(this.setup.navigation.setChanged(!0),this.cachedQuality=o[0].ins.quality.value,o.forEach(t=>{t.ins.quality.setValue(p.a9.AR)}),n.setAnimationLoop((t,e)=>this.render(t,e)),navigator.xr.requestSession("immersive-ar",{requiredFeatures:["hit-test"],optionalFeatures:["dom-overlay"],domOverlay:{root:this.shadowRoot.querySelector("ff-viewport-overlay")}}).then(t=>this.onSessionStarted(n,t)).catch(t=>{console.log("Error starting session: "+t),a.Ay.show("AR available but blocked. Please check your browser settings.","warning")}))}async onSessionStarted(t,e){const i=this.renderer.views[0].renderer.getContext();await i.makeXRCompatible(),e.updateRenderState({baseLayer:new XRWebGLLayer(e,i,{alpha:!0})}),this.setupScene(),t.shadowMap.autoUpdate=!1,t.xr.enabled=!0,t.xr.setReferenceSpaceType("local"),t.xr.setSession(e),await e.addEventListener("end",this.onSessionEnded),this.refSpace=await e.requestReferenceSpace("local");const n=await e.requestReferenceSpace("viewer");t.xr.cameraAutoUpdate=!1;const s=20*Math.PI/180,r=!0===this.ins.wallMount.value?void 0:new XRRay(new DOMPoint(0,0,0),{x:0,y:-Math.sin(s),z:-Math.cos(s)});e.requestHitTestSource({space:n,offsetRay:r}).then(t=>{this.initialHitTestSource=t}),this.outs.isPresenting.setValue(!0),this.session=e,this.lastFrameTime=performance.now(),this.setup.reader.ins.enabled.on("value",this.endSession,this)}endSession(){this.session&&this.session.end()}setupScene(){const{cameraParent:t,setup:e,featuresToReset:i}=this,n=this.sceneNode;t&&t.remove(this.camera),this.setup.background.ins.visible.setValue(!1),this.setup.navigation.ins.enabled.setValue(!1);const s=n.graph.findNodeByName("Lights");(this.lightTransform=s.getComponent(r.Ay,!0)).ins.rotation.reset();const o=this.scaleDisplay=document.createElement("div");o.classList.add("sv-scale-annotation"),this.shadowRoot.querySelector("ff-viewport-overlay").appendChild(o),i.push(e.floor.ins.visible.value?1:0),i.push(e.grid.ins.visible.value?1:0),i.push(e.tape.ins.visible.value?1:0),i.push(e.slicer.ins.enabled.value?1:0),i.push(e.viewer.ins.shader.value),this.annotationsAtLaunch=e.viewer.ins.annotationsVisible.value,e.floor.ins.visible.setValue(!1),e.grid.ins.visible.setValue(!1),e.tape.ins.visible.setValue(!1),e.slicer.ins.enabled.setValue(!1),e.viewer.ins.shader.value!==v.gw.Default&&e.viewer.ins.shader.setValue(v.gw.Default),e.viewer.ins.annotationsVisible.setValue(!1);(this.originalUnits=n.ins.units.getValidatedValue())!=d.uj.m&&this.sceneNode.ins.units.setValue(d.uj.m);n.getGraphComponents(A.A).forEach(t=>{t.ins.shadowEnabled.value&&(t.ins.shadowEnabled.setValue(!1),this.lightsToReset.push(t))}),this.pulse.pulse(Date.now()),n.update(null);(this.shadow=new m(this.sceneNode,this.vScene.scene,.5)).setIntensity(0),C.copy(this.sceneNode.outs.boundingBox.value),C.getSize(x),this.cachedNearPlane=this.camera.near,this.cachedFarPlane=this.camera.far,this.vScene.activeCameraComponent.ins.near.setValue(.01),this.vScene.activeCameraComponent.ins.far.setValue(1e3)}resetScene(){const{camera:t,cameraParent:e,setup:i,featuresToReset:n}=this,s=this.vScene.scene;e&&e.add(t),t.position.set(0,0,0),t.rotation.set(0,0,0),this.vScene.activeCameraComponent.ins.near.setValue(this.cachedNearPlane),this.vScene.activeCameraComponent.ins.far.setValue(this.cachedFarPlane),t.updateMatrix(),this.lightTransform.object3D.rotation.set(0,0,0),this.lightTransform.object3D.updateMatrix(),this.sceneNode.ins.units.setValue(this.originalUnits),s.position.setScalar(0),s.rotation.y=0,s.scale.setScalar(1),s.updateMatrix(),s.updateMatrixWorld(!0),n.reverse(),i.floor.ins.visible.setValue(!!n.pop()),i.grid.ins.visible.setValue(!!n.pop()),i.tape.ins.visible.setValue(!!n.pop()),i.slicer.ins.enabled.setValue(!!n.pop());const r=n.pop();r!==v.gw.Default&&i.viewer.ins.shader.setValue(r),this.lightsToReset.forEach(t=>{t.ins.shadowEnabled.setValue(!0)}),this.lightsToReset.length=0,i.background.ins.visible.setValue(!0);this.sceneNode.getGraphComponents(f.A).forEach(t=>{t.ins.quality.setValue(this.cachedQuality)});const o=this.selectionRing;null!=o&&(s.remove(o),o.geometry.dispose(),o.material.dispose(),this.selectionRing=null);const a=this.hitPlane;null!=a&&(s.remove(a),a.geometry.dispose(),a.material.dispose(),this.hitPlane=null),this.scaleDisplay.remove();const l=this.shadow;null!=l&&(s.remove(l),l.dispose(),this.shadow=null),t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix()}setInitialPosition(t){const e=this.initialHitTestSource;if(null==e)return;const i=t.getHitTestResults(e);if(0==i.length)return;const n=i[0],s=this.getHitPoint(n);if(null==s)return;this.placeModel(s),e.cancel(),this.initialHitTestSource=null;const{session:r}=t;r.addEventListener("selectstart",this.onSelectStart),r.addEventListener("selectend",this.onSelectEnd),r.requestHitTestSourceForTransientInput({profile:"generic-touchscreen"}).then(t=>{this.transientHitTestSource=t})}getHitPoint(t){const e=t.getPose(this.refSpace);if(null==e)return null;const i=_.fromArray(e.transform.matrix),n=i.elements[5]>.75;if(!0===this.ins.wallMount.value&&!n){const t=this.vScene.scene;t.rotation.y=Math.atan2(i.elements[4],i.elements[6]),t.updateMatrix()}return n!==this.ins.wallMount.value?E.setFromMatrixPosition(i):null}handleInput(t){const e=this.transientHitTestSource;if(null==e)return;if(!this.isTranslating&&!this.isScaling&&!this.isRotating)return;const i=t.getHitTestResultsForTransientInput(e),n=this.vScene.scene,s=n.scale.x;if(this.isScaling)if(i.length<2)this.isScaling=!1,this.scaleDisplay.classList.remove("sv-show"),this.scaleDisplay.addEventListener("transitionend",()=>{this.updateScale=!1},{once:!0});else{let t=this.getFingerSeparation(i)/this.lastScale;t=t>.9&&t<1.1?1:t,this.scaleScene(n,t),this.scaleDisplay.classList.add("sv-show"),this.updateScale=!0}else{if(2===i.length)return this.isTranslating=!1,this.isRotating=!1,this.isScaling=!0,void(this.lastScale=this.getFingerSeparation(i)/s);if(this.isRotating){const t=this.inputSource.gamepad.axes[0];n.rotation.y+=1.5*(t-this.lastDragValueX),n.updateMatrix(),this.sceneRotateHelper(),this.lastDragValueX=t}else if(this.isTranslating){const t=this.inputSource.gamepad.axes,e=t[0]-this.lastDragValueX,s=t[1]-this.lastDragValueY;this.totalDrag+=Math.hypot(e,s),i.forEach(t=>{if(this.totalDrag<.01||t.inputSource!==this.inputSource||t.results.length<1)return;const e=this.getHitPoint(t.results[0]);null!=e&&(x.copy(e),x.sub(this.lastHitPosition),n.position.add(x),n.updateMatrix(),n.updateMatrixWorld(),this.lastHitPosition.copy(e),this.updateBoundingBox())}),this.shadow.updateMatrices()}}}getFingerSeparation(t){const e=t[0].inputSource.gamepad.axes,i=t[1].inputSource.gamepad.axes,n=i[0]-e[0],s=i[1]-e[1];return Math.sqrt(n*n+s*s)}placeModel(t){const e=this.vScene.scene,i=.15/this.ins.arScale.value,n=!0===this.ins.wallMount.value,{min:s,max:r}=C,o=this.sceneNode.outs.boundingRadius.value,a=Math.max(1.25*(r.x-s.x),i),c=n?Math.max(1.25*(r.y-s.y),i):Math.max(1.25*(r.z-s.z),i),h=(s.x+r.x)/2,u=(s.z+r.z)/2,d=(s.y+r.y)/2,p=n?0:-Math.PI/2;this.lastHitPosition.copy(t);const f=this.hitPlane=new l.eaF(new l.bdM(a,c),new l.V9B);f.position.set(h,n?d:s.y,n?s.z:u),f.rotation.set(p,0,0),f.visible=!1,e.add(f),this.placementRotation.copy(e.quaternion);const g=new l.ypk,m=new l.ypk,A=a>c?.025*a:.025*c;this.roundedRect(g,-a/2,-c/2,a,c,.5*A),this.roundedRect(m,-a/2+A,-c/2+A,a-2*A,c-2*A,.4*A),g.holes.push(m);let v=new l.MSw(g);const y=this.selectionRing=new l.eaF(v,new l.V9B({side:l.$EB,opacity:0}));y.position.set(h,n?d:s.y,n?s.z:u),y.rotation.set(p,0,0),y.material.transparent=!0,y.visible=!1,e.add(y),this.modelFloorOffset=s.y,e.position.set(t.x,n?t.y:t.y-s.y,t.z),e.updateMatrix(),e.updateMatrixWorld(!0),this.updateBoundingBox(),this.pulse.pulse(Date.now()),this.shadow.updateMatrices(),this.shadow.setIntensity(!0===this.ins.wallMount.value?0:.3),this.setup.viewer.ins.annotationsVisible.setValue(this.annotationsAtLaunch),1===this.ins.arScale.value||n||this.renderer.views[0].renderer.render(e,this.shadow.shadow.camera),this.scaleScene(this.vScene.scene,this.ins.arScale.value);const b=this.camera.position.clone(),_=t.clone().sub(b);if(_.length()<o*e.scale.x){const i=_.normalize();b.sub(i.multiplyScalar(o*e.scale.x*1.5));const n=new l.RlV(b,i.normalize()),s=new l.Pq0;r.y+=10,n.intersectBox(this.sceneNode.outs.boundingBox.value,s),r.y-=10,null!=s&&(e.position.x+=t.x-s.x,e.position.z+=t.z-s.z,e.updateMatrix(),e.updateMatrixWorld(!0))}this.updateBoundingBox(),this.outs.isPlaced.setValue(!0),1!==e.scale.x&&(this.updateScale=!0,this.scaleDisplay.classList.add("sv-show"),setTimeout(()=>{this.scaleDisplay.classList.remove("sv-show"),this.scaleDisplay.addEventListener("transitionend",()=>{this.updateScale=!1},{once:!0})},1500))}launchSceneViewer(){const t=this.sceneNode.getGraphComponents(f.A),e=t.findIndex(t=>null!==t.derivatives.get(p.UH.App3D,p.a9.AR)),i=e>-1?t[e].derivatives.get(p.UH.App3D,p.a9.AR):null;if(i){const t=this.arLink,e=i.findAsset(p.iO.Model),n=`intent://arvr.google.com/scene-viewer/1.0?file=${this.assetManager.getAssetUrl(e.data.uri)}&mode=ar_only#Intent;scheme=https;package=com.google.ar.core;action=android.intent.action.VIEW;end;`;t.setAttribute("href",n),t.click()}}launchQuickLook(){const t=this.sceneNode.getGraphComponents(f.A),e=t.findIndex(t=>null!==t.derivatives.get(p.UH.iOSApp3D,p.a9.AR)),i=e>-1?t[e].derivatives.get(p.UH.iOSApp3D,p.a9.AR):null;if(i){const t=this.arLink,e=i.findAsset(p.iO.Model),n=this.assetManager.getAssetUrl(e.data.uri);t.setAttribute("rel","ar");const s=document.createElement("img");t.appendChild(s),t.setAttribute("href",n.toString()),t.click(),t.removeChild(s)}}updateBoundingBox(){this.sceneNode.ins.sceneTransformed.set()}updateOpacity(t,e){const i=this.selectionRing.material,n=i.opacity;if(e===n)return;const s=e-n;i.opacity=s>0?Math.min(n+.002*t,e):Math.max(n-.002*t,e),this.selectionRing.visible=i.opacity>0}roundedRect(t,e,i,n,s,r){t.moveTo(e,i+r),t.lineTo(e,i+s-r),t.quadraticCurveTo(e,i+s,e+r,i+s),t.lineTo(e+n-r,i+s),t.quadraticCurveTo(e+n,i+s,e+n,i+s-r),t.lineTo(e+n,i+r),t.quadraticCurveTo(e+n,i,e+n-r,i),t.lineTo(e+r,i),t.quadraticCurveTo(e,i,e,i+r)}sceneRotateHelper(){const t=this.vScene.scene;S.copy(t.quaternion),S.invert(),S.multiply(this.placementRotation),this.lightTransform.object3D.rotation.setFromQuaternion(S),this.lightTransform.object3D.updateMatrix(),this.shadow.setRotation(t.rotation.y)}scaleScene(t,e){t.scale.setScalar(e),!1===this.ins.wallMount.value&&(t.position.y=this.lastHitPosition.y-this.modelFloorOffset*t.scale.y),t.updateMatrix(),t.updateMatrixWorld(),this.shadow.setScaleAndOffset(e,0),this.updateBoundingBox()}onMetaComponent(t){const e=t.object;t.add&&e.once("load",()=>{const t=e.images.dictionary;Object.keys(t).forEach(e=>{const i=t[e];i.usage&&"ARCode"===i.usage&&(this._arCodeImage=this.assetManager.getAssetUrl(i.uri))})})}}I.typeName="CVARManager",I.text="ARManager",I.icon="",I.isSystemSingleton=!0,I.ins={enabled:n.gK.Boolean("State.Enabled"),wallMount:n.gK.Boolean("AR.wallMount",!1),arScale:n.gK.Number("AR.Scale",1)},I.outs={enabled:n.gK.Boolean("State.Enabled"),available:n.gK.Boolean("State.Available",c.yS),isPlaced:n.gK.Boolean("AR.Placed",!1),isPresenting:n.gK.Boolean("AR.Presenting",!1)}},2799:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var n=i(3423),s=(i(1860),i(4424));const r=(t,e,i)=>{let n;const s=t.children;for(let t=0,i=s.length;t<i;++t)if(n=s[t].components.has(e),n)return!0;if(i)for(let t=0,i=s.length;t<i;++t)if(n=r(s[t],e,!0),n)return!0;return!1},o=(t,e,i)=>{let n;const s=t.children;for(let t=0,i=s.length;t<i;++t)if(n=s[t].components.get(e),n)return n;if(i)for(let t=0,i=s.length;t<i;++t)if(n=o(s[t],e,!0),n)return n;return null},a=(t,e,i)=>{let n=[];const s=t.children;for(let t=0,i=s.length;t<i;++t)n=n.concat(s[t].components.getArray(e));if(i)for(let t=0,i=s.length;t<i;++t)n=n.concat(a(s[t],e,!0));return n};class l extends n.Ay{constructor(){super(...arguments),this._parent=null,this._children=[]}get parent(){return this._parent}get children(){return this._children||[]}create(){super.create(),this.graph._addRoot(this),this.node.components.on(n.Ay,this.onComponent,this)}dispose(){this.node.components.off(n.Ay,this.onComponent,this),this._children.slice().forEach(t=>t.node.dispose()),this._parent&&this._parent.removeChild(this),this.graph._removeRoot(this),super.dispose()}getRootComponent(t){let e=this;for(;e._parent;)e=e._parent;return e?e.node.components.get(t):null}getParentComponent(t,e){let i=this;for(;;){if(i=i._parent,!i){const t=this.graph.parent;i=t?t.components.get(l):void 0}if(!i)return;const n=i.node.components.get(t,!0);if(n)return n;if(!e)return}}getParentNode(t,e){let i=this;for(;;){if(i=i._parent,!i){const t=this.graph.parent;i=t?t.components.get(l):void 0}if(!i)return;const n=i.node;if(n.is(t))return n;if(!e)return}}getSiblingNode(t){return this.getSiblingNodes(t)[0]}getSiblingNodes(t){const e=this._parent;return this.graph.nodes.getArray(t).filter(t=>{const i=t.components.get(l);return(i?i._parent:null)==e})}hasChildComponents(t,e){return r(this,t,e)}getChildComponent(t,e){return o(this,t,e)}getChildComponents(t,e){return a(this,t,e)}traverseUp(t,e,i,n){if(t)if(e){const t=this.node.components.getArray();for(let e=0,i=t.length;e<i;++e)if(n(t[e]))return}else if(n(this))return;let s=this._parent;if(!s&&i){const t=this.node.graph.parent;s=t?t.getComponent(l,!0):null}s&&s.traverseUp(!0,e,i,n)}traverseDown(t,e,i,n){if(t)if(e){const t=this.node.components.getArray();for(let e=0,i=t.length;e<i;++e)if(n(t[e]))return}else if(n(this))return;if(i){const t=this.node.components.getArray(s.Ay);for(let s=0,r=t.length;s<r;++s){const r=t[s].innerRoots;for(let t=0,s=r.length;t<s;++t)r[t].traverseDown(!0,e,i,n)}}const r=this._children;for(let t=0,s=r.length;t<s;++t)r[t].traverseDown(!0,e,i,n)}propagateUp(t,e,i){this.traverseUp(!0,t,e,t=>(t.emit(i),i.stopPropagation))}propagateDown(t,e,i){this.traverseDown(!0,t,e,t=>(t.emit(i),i.stopPropagation))}addChild(t){if(t===this)throw new Error("can't add self as child");if(t._parent)throw new Error("can't add child, component has a parent");if(t.graph!==this.graph)throw new Error("can't add child, component in different graph");t._parent=this,this._children.push(t),this.graph._removeRoot(t);const e={type:"hierarchy",add:!0,remove:!1,parent:this,child:t};this.traverseUp(!0,!1,!0,t=>t.emit(e)),this.traverseDown(!1,!1,!0,t=>t.emit(e)),this.system.emit(e)}removeChild(t){if(t._parent!==this)throw new Error("component not a child of this");const e={type:"hierarchy",add:!1,remove:!0,parent:this,child:t};this.traverseUp(!0,!1,!0,t=>t.emit(e)),this.traverseDown(!1,!1,!0,t=>t.emit(e)),this.system.emit(e);const i=this._children.indexOf(t);this._children.splice(i,1),t._parent=null,this.graph._addRoot(t)}onComponent(t){if(t.object===this)return;const e={type:"child",add:t.add,remove:t.remove,component:t.object};this.traverseUp(!0,!1,!0,t=>t.emit(e))}toJSON(){const t=super.toJSON();return this._children.length>0&&(t.children=this._children.map(t=>t.id)),t}referencesFromJSON(t){super.referencesFromJSON(t);const e=this.system.components.getDictionary();t.children&&t.children.forEach(t=>{const i=e[t];this.addChild(i)})}toString(){return super.toString()+` - children: ${this.children.length}`}dump(t=""){super.dump(t),this.children.length>0&&(console.log(t+"%cChildren","color: purple"),this.children.forEach(e=>e.node.dump(t+"  ")))}}l.typeName="CHierarchy"},2867:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n,s=i(6763),r=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let o=n=class extends s.Ay{static add(t,e){if(n.templates[t])throw new Error(`icon already registered: '${t}'`);n.templates[t]=e}static getTemplateNames(){return Object.keys(n.templates)}constructor(t){super(),this.template=null,this.name=t||""}firstConnected(){this.classList.add("ff-icon")}render(){if(this.name){const t=this.constructor.templates[this.name];return t||console.warn(`icon not found: '${this.name}'`),t}return this.template?this.template:s.qy`[icon undefined]`}};o.templates={},r([(0,s.MZ)({attribute:!1})],o.prototype,"template",void 0),r([(0,s.MZ)({type:String})],o.prototype,"name",void 0),o=n=r([(0,s.EM)("ff-icon")],o);const a=o;o.add("empty",s.qy``),o.add("check",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/></svg>`),o.add("close",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"/></svg>`),o.add("grip",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M149.333 56v80c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V56c0-13.255 10.745-24 24-24h101.333c13.255 0 24 10.745 24 24zm181.334 240v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm32-240v80c0 13.255 10.745 24 24 24H488c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24zm-32 80V56c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm-205.334 56H24c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24zM0 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zm386.667-56H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zm0 160H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zM181.333 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24z"/></svg>`),o.add("up",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg>`),o.add("down",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z"/></svg>`),o.add("caret-up",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M288.662 352H31.338c-17.818 0-26.741-21.543-14.142-34.142l128.662-128.662c7.81-7.81 20.474-7.81 28.284 0l128.662 128.662c12.6 12.599 3.676 34.142-14.142 34.142z"/></svg>`),o.add("caret-down",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"/></svg>`),o.add("folder",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 128H272l-64-64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48z"/></svg>`),o.add("file",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"/></svg>`),o.add("info",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/></svg>`),o.add("warning",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></svg>`),o.add("error",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>`),o.add("prompt",s.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"/></svg>`)},2874:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}e.default=i},2902:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var n=i(3423),s=i(4146),r=i(1229);class o extends s.A{constructor(t,e){super(t,e),this.outs=this.addOutputs(o.outs),this.scope=s.X.Node}createDocument(t,e){const i=this.node.createComponent(r.A);return this.activeComponent=i,t&&i.openDocument(t,e),i}amendDocument(t,e,i){const n=this.activeComponent;if(!n)throw new Error("no active document, can't amend");return n.openDocument(t,e,i),n}refreshDocument(){this.emit({type:"active-component",previous:null,next:this.activeComponent})}appendModel(t,e){const i=this.activeComponent;if(!i)throw new Error("no active document, can't append model");return i.appendModel(t,e),i}appendGeometry(t,e,i,n,s){const r=this.activeComponent;if(!r)throw new Error("no active document, can't append geometry");return r.appendGeometry(t,e,i,n,s),r}removeActiveDocument(){const t=this.activeComponent;t&&t.dispose()}activateComponent(t){t.ins.visible.setValue(!0),t.ins.active.setValue(!0)}deactivateComponent(t){t.ins.visible.setValue(!1),t.ins.active.setValue(!1)}onActiveComponent(t,e){this.outs.activeDocument.setValue(e)}onScopedComponents(){this.outs.changedDocuments.set()}}o.typeName="CVDocumentProvider",o.componentType=r.A,o.outs={activeDocument:n.gK.Object("Documents.Active",r.A),changedDocuments:n.gK.Event("Documents.Changed")}},2948:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.escapeText=e.escapeAttribute=e.escapeUTF8=e.escape=e.encodeXML=e.getCodePoint=e.xmlReplacer=void 0,e.xmlReplacer=/["&'<>$\x80-\uFFFF]/g;var i=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);function n(t){for(var n,s="",r=0;null!==(n=e.xmlReplacer.exec(t));){var o=n.index,a=t.charCodeAt(o),l=i.get(a);void 0!==l?(s+=t.substring(r,o)+l,r=o+1):(s+="".concat(t.substring(r,o),"&#x").concat((0,e.getCodePoint)(t,o).toString(16),";"),r=e.xmlReplacer.lastIndex+=Number(55296==(64512&a)))}return s+t.substr(r)}function s(t,e){return function(i){for(var n,s=0,r="";n=t.exec(i);)s!==n.index&&(r+=i.substring(s,n.index)),r+=e.get(n[0].charCodeAt(0)),s=n.index+1;return r+i.substring(s)}}e.getCodePoint=null!=String.prototype.codePointAt?function(t,e){return t.codePointAt(e)}:function(t,e){return 55296==(64512&t.charCodeAt(e))?1024*(t.charCodeAt(e)-55296)+t.charCodeAt(e+1)-56320+65536:t.charCodeAt(e)},e.encodeXML=n,e.escape=n,e.escapeUTF8=s(/[&<>'"]/g,i),e.escapeAttribute=s(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),e.escapeText=s(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]))},2997:(t,e,i)=>{"use strict";var n,s,r,o,a;i.d(e,{Kd:()=>r,Tm:()=>a,Yf:()=>o,gw:()=>n,zZ:()=>s}),function(t){t[t.Default=0]="Default",t[t.Clay=1]="Clay",t[t.XRay=2]="XRay",t[t.Normals=3]="Normals",t[t.Wireframe=4]="Wireframe"}(n||(n={})),function(t){t[t.Solid=0]="Solid",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient"}(s||(s={})),function(t){t[t.Orbit=0]="Orbit",t[t.Fly=1]="Fly",t[t.Walk=2]="Walk"}(r||(r={})),function(t){t[t.Overlay=0]="Overlay",t[t.Left=1]="Left",t[t.Right=2]="Right"}(o||(o={})),function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"}(a||(a={}))},3019:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var n=i(3423),s=i(8313),r=i(161),o=i(9337),a=i(3675),l=i(6773),c=i(6763),h=i(8604),u=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class d extends n.Ay{constructor(){super(...arguments),this._narrationId=null,this._activeId=null,this._audioMap={},this.audioClips={},this.audioPlayer=null,this.audioView=null,this.audioViews={},this.isPlaying=!1,this.ins=this.addInputs(d.ins),this.outs=this.addOutputs(d.outs),this.onEnd=()=>{var t;const{outs:e}=this;this.isPlaying=!1,e.isPlaying.setValue(!1),null===(t=this.audioView)||void 0===t||t.requestUpdate()},this.onCueChange=t=>{const e=t.target.track.activeCues,i=e.length>0?e[0].text:"";this.ins.activeCaption.setValue(i)},this.onLoadTrack=t=>{const e=this.audioPlayer.children[0].track.cues;0===e[0].startTime&&(e[0].startTime=.01)},this.onTimeChange=t=>{this.audioView.elapsed=this.getTimeElapsed(),this.audioView.requestUpdate()}}get assetManager(){return this.getMainComponent(r.A)}get language(){return this.getGraphComponent(o.A,!0)}get analytics(){return this.system.getMainComponent(h.A)}get narrationId(){return this._narrationId||""}set narrationId(t){this._narrationId=t,this.outs.narrationEnabled.setValue(t.length>0)}get activeId(){return this._activeId||""}set activeId(t){this._activeId=t}create(){super.create(),this.graph.components.on(s.A,this.onMetaComponent,this),this.language.outs.activeLanguage.on("value",this.onLanguageChange,this)}dispose(){Object.keys(this._audioMap).forEach(t=>URL.revokeObjectURL(this._audioMap[t])),this.language.outs.activeLanguage.off("value",this.onLanguageChange,this),this.graph.components.off(s.A,this.onMetaComponent,this),super.dispose()}update(){const{ins:t,outs:e}=this;return t.playNarration.changed&&this.audioPlayer&&this._narrationId&&(e.narrationPlaying.value&&this.activeId==this._narrationId?(this.stop(),e.narrationPlaying.setValue(!1)):e.narrationPlaying.value||this.play(this._narrationId)),t.reset.changed&&(this.stop(),e.narrationPlaying.setValue(!1)),!0}getPlayerById(t){if(!this.audioViews.hasOwnProperty(t)){const e=this.audioViews[t]=new p;e.audio=this,e.audioId=t,e.requestUpdate()}return this.audioViews[t]}getAudioList(){return Object.keys(this.audioClips).map(t=>this.audioClips[t])}getAudioClip(t){return this.audioClips[t]}getAudioClipUri(t){const e=this.audioClips[t];return e?e.uris[a.aL[this.language.outs.activeLanguage.value]]:null}getClipCaptionUri(t){const e=this.audioClips[t];return e?e.captionUris[a.aL[this.language.outs.activeLanguage.value]]:null}getDuration(t){const e=this.audioClips[t],i=a.aL[this.language.outs.activeLanguage.getValidatedValue()],n=e.durations[i];if(n)return n;{const e=this.audioClips[t];return Object.keys(e.uris).forEach(n=>{const s=e.uris[n];if(s){const r=this.assetManager.getAssetUrl(s);e.durations[n]="pending";const o=new(window.AudioContext||window.webkitAudioContext),a=new XMLHttpRequest;a.open("GET",r,!0),a.responseType="arraybuffer",a.onload=()=>{if(!Object.keys(this._audioMap).includes(s)){const t=new Blob([a.response],{type:"audio/mpeg"}),e=window.URL.createObjectURL(t);this._audioMap[s]=e}o.decodeAudioData(a.response,s=>{let r=s.duration;e.durations[n]=r.toString(),n===i&&this.getPlayerById(t).requestUpdate()})},a.send()}}),"pending"}}getTimeElapsed(){return this.audioPlayer?Math.floor(this.audioPlayer.currentTime):0}setTimeElapsed(t){this.audioPlayer&&(0===this.audioPlayer.seekable.length?this.audioPlayer.addEventListener("canplay",()=>this.setTimeElapsed(t),{once:!0}):(this.audioPlayer.currentTime=t,this.audioView.elapsed=t,this.audioView.requestUpdate()))}addAudioClip(t){this.audioClips[t.id]=t,this.outs.updated.set()}removeAudioClip(t){this.isPlaying&&t==this.activeId&&this.stop(),t==this._narrationId&&(this.narrationId=""),delete this.audioClips[t]}updateAudioClip(t){this.audioClips[t].durations={},this.getDuration(t),this.outs.updated.set()}onMetaComponent(t){const e=t.object;"NVScene"===e.node.typeName&&t.add&&(this.audioClips=e.audio.dictionary,e.once("load",()=>{this.audioClips=e.audio.dictionary,Object.keys(this.audioClips).forEach(t=>{this.updateAudioClip(this.audioClips[t].id)})}))}fromData(t){const{outs:e}=this;t=t||{},this._narrationId=t.narrationId||null,e.narrationEnabled.setValue(null!=this._narrationId),this._narrationId&&!this.audioClips[this._narrationId]&&(e.narrationEnabled.setValue(!1),console.warn("Invalid narration audio ID"))}toData(){let t=null;return null!==this._narrationId&&(t={narrationId:this._narrationId}),t}play(t,e=!1){const{outs:i}=this,n=this.getAudioClipUri(t);n?(i.isPlaying.value&&this.audioPlayer.pause(),this.activeId!==t&&this.setTimeElapsed(0),this.audioView=this.audioViews[t],this.initializeClip(t),this.audioPlayer.play().then(()=>{this.activeId=t,i.isPlaying.setValue(!0),this.isPlaying=!0,i.narrationPlaying.setValue(t==this.narrationId),Object.keys(this.audioViews).forEach(t=>this.audioViews[t].requestUpdate()),this.analytics.sendProperty("Audio_Play",n)}).catch(t=>l.Ay.show(`Failed to play audio at '${this.audioPlayer.getAttribute("src")}':${t}`,"warning"))):l.Ay.show("Failed to play audio clip - no uri","warning")}pause(){var t;this.audioPlayer&&(this.outs.isPlaying.setValue(!1),this.audioPlayer.pause(),null===(t=this.audioView)||void 0===t||t.requestUpdate())}stop(){this.audioPlayer&&(this.pause(),this.setTimeElapsed(0),this.onEnd())}initializeClip(t){null===this.audioPlayer&&this.setupAudio();const e=this.audioClips[t];if(e){const t=e.uris[a.aL[this.language.outs.activeLanguage.getValidatedValue()]];this.audioPlayer.src!=this._audioMap[t]&&this.audioPlayer.setAttribute("src",this._audioMap[t]),this.audioPlayer.children[0]&&this.audioPlayer.children[0].remove();const i=e.captionUris[a.aL[this.language.outs.activeLanguage.getValidatedValue()]];if(i&&(0==this.audioPlayer.children.length||this.audioPlayer.children[0].src!=this.assetManager.getAssetUrl(i))){const t=document.createElement("track");this.audioPlayer.append(t),t.setAttribute("src",this.assetManager.getAssetUrl(i)),t.track.mode="showing",t.addEventListener("cuechange",this.onCueChange),t.addEventListener("load",this.onLoadTrack)}}}setupAudio(){if(null===this.audioPlayer){const t=this.audioPlayer=document.createElement("audio");t.onended=this.onEnd,t.setAttribute("controls",""),t.setAttribute("preload","auto"),t.addEventListener("timeupdate",this.onTimeChange),t.crossOrigin="anonymous",t.onerror=()=>{console.error(`Error ${t.error.code}; details: ${t.error.message}`)}}}onLanguageChange(){this.stop()}}d.typeName="CVAudioManager",d.text="Audio",d.icon="",d.isSystemSingleton=!0,d.ins={playNarration:n.gK.Event("Audio.PlayNarration"),reset:n.gK.Event("Audio.Reset"),activeCaption:n.gK.String("Audio.ActiveCaption"),captionsEnabled:n.gK.Boolean("Audio.CaptionsEnabled",!0)},d.outs={narrationEnabled:n.gK.Boolean("Audio.NarrationEnabled",!1),narrationPlaying:n.gK.Boolean("Audio.NarrationPlaying",!1),isPlaying:n.gK.Boolean("Audio.IsPlaying",!1),updated:n.gK.Event("Audio.Updated")};let p=class extends c.Ay{constructor(){super(),this.audio=null,this.audioId="",this.elapsed=0,this.onDrag=this.onDrag.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.addEventListener("keydown",this.onKeyDown)}firstConnected(){this.classList.add("sv-audio-view")}update(t){if(t.has("elapsed")){const t=this.querySelector("#time-slider");t&&(t.value=this.elapsed.toString())}super.update(t)}render(){const t=this.audio.outs.isPlaying.value&&this.audioId==this.audio.activeId,e=this.audio.getDuration(this.audioId),i=this.formatSeconds(this.elapsed),n="pending"==e?e:this.formatSeconds(parseInt(e));return c.qy`<ff-button title="play audio" id="play-btn" icon="${t?"pause":"triangle-right"}" @pointerdown=${t=>this.playAudio(t,this.audioId)}></ff-button><div aria-hidden="true" class="sv-timer">${i}/${n}</div><input title="audio slider" id="time-slider" @pointerdown=${this.onDrag} @change=${this.onTimeChange} type="range" min="0" max="${e}" value="${this.elapsed}" class="slider">`}playAudio(t,e){const i=this.audio;this.audio.outs.isPlaying.value&&this.audioId==this.audio.activeId?i.pause():i.play(e)}onDrag(t){t.stopPropagation()}onKeyDown(t){"Space"===t.code||"Enter"===t.code?"play-btn"==t.target.id&&this.playAudio(null,this.audioId):"ArrowUp"!==t.code&&"ArrowDown"!==t.code&&"ArrowLeft"!==t.code&&"ArrowRight"!==t.code||"time-slider"==t.target.id&&t.stopPropagation()}onTimeChange(){this.audioId==this.audio.activeId&&(this.audio.initializeClip(this.audioId),this.audio.setTimeElapsed(0|parseFloat(this.querySelector("#time-slider").value)))}formatSeconds(t){var e=new Date(0);return e.setSeconds(t),e.toISOString().substring(14,19)}};u([(0,c.MZ)({attribute:!1})],p.prototype,"audio",void 0),u([(0,c.MZ)({attribute:!1})],p.prototype,"audioId",void 0),u([(0,c.MZ)({attribute:!1})],p.prototype,"elapsed",void 0),p=u([(0,c.EM)("sv-audio-view")],p)},3051:(t,e,i)=>{"use strict";i.d(e,{R:()=>s,i:()=>r});const n='a[href], button, input, textarea, select, details,[tabindex]:not([tabindex="-1"])';function s(t){return[...t.querySelectorAll(n)].filter(t=>!t.hasAttribute("disabled")&&!!t.getClientRects().length&&"hidden"!==t.style.visibility&&!t.getAttribute("aria-hidden")&&"-1"!==t.getAttribute("tabindex"))}function r(t,e,i=!1){const n=t.findIndex(t=>t===e.target),s=t[0],r=t[t.length-1];e.preventDefault(),e.shiftKey?0===n?r.focus({preventScroll:i}):t[n-1].focus({preventScroll:i}):n===t.length-1?s.focus({preventScroll:i}):t[n+1].focus({preventScroll:i})}},3074:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>c,I8:()=>a.I8,gK:()=>s.gK});var n=i(4640),s=i(3423),r=i(7795),o=i(6436),a=i(8424);const l=new n.Pq0;class c extends s.Ay{constructor(t,e){super(t,e),this.ins=this.addInputs(c.object3DIns),this.outs=this.addOutputs(c.object3DOuts),this._object3D=null,this._isPickable=!1,this.addEvent("object"),this.node.components.on(this.parentComponentClass,this._onParent,this)}get parentComponentClass(){return this.constructor.parentComponentClass}get parentComponent(){return this.node.components.get(this.parentComponentClass,!0)}get transform(){return this.node.components.get(a.Ay,!0)}get scene(){const t=this.transform;return t?t.getParentComponent(o.A,!0):void 0}get object3D(){return this._object3D}set object3D(t){const e=this._object3D;if(e&&(e.userData.component=null,this.unregisterPickableObject3D(e,!0),e.parent&&this.onRemoveFromParent(e.parent)),this.emit({type:"object",current:e,next:t}),this._object3D=t,t){t.userData.component=this,t.matrixAutoUpdate=!1,t.visible=this.ins.visible.value,this.registerPickableObject3D(t,!0);const e=this.parentComponent;e&&this.onAddToParent(e.object3D)}}update(t){const{visible:e,pickable:i}=this.ins;return e.changed&&this._object3D&&(this._object3D.visible=e.value),i.changed&&i.value!==this._isPickable&&(this._isPickable=i.value,i.value?this.enablePointerEvents():this.disablePointerEvents()),!0}dispose(){this.object3D=null,this.ins.pickable.value&&this.disablePointerEvents(),this.node.components.off(this.parentComponentClass,this._onParent,this),super.dispose()}preRender(t){}postRender(t){}toString(){return super.toString()+(this._object3D?` - type: ${this._object3D.type}`:" - (null)")}onPointer(t){const e=this.outs;"pointer-down"===t.type?(e.pointerDown.set(),e.pointerActive.setValue(!0)):"pointer-up"===t.type&&(e.pointerUp.set(),e.pointerActive.setValue(!1)),t.stopPropagation=!0}enablePointerEvents(){this.on("pointer-down",this.onPointer,this),this.on("pointer-up",this.onPointer,this)}disablePointerEvents(){this.off("pointer-down",this.onPointer,this),this.off("pointer-up",this.onPointer,this);const t=this.outs;t.pointerActive.value&&(t.pointerUp.set(),t.pointerActive.setValue(!1))}updateTransform(){const t=this._object3D;if(!t)return;const{position:e,rotation:i,order:s,scale:r}=this.ins;if(e.changed||i.changed||s.changed||r.changed){t.position.fromArray(e.value),l.fromArray(i.value).multiplyScalar(n.cj9.DEG2RAD);const o=s.getOptionText();t.rotation.setFromVector3(l,o),t.scale.fromArray(r.value),t.updateMatrix()}return!0}onAddToParent(t){t.add(this._object3D)}onRemoveFromParent(t){t.remove(this._object3D)}addObject3D(t){this._object3D.add(t),this.registerPickableObject3D(t,!0)}removeObject3D(t){this.unregisterPickableObject3D(t,!0),this._object3D.remove(t)}registerPickableObject3D(t,e){r.A.add(t,e)}unregisterPickableObject3D(t,e){r.A.remove(t,e)}_onParent(t){this._object3D&&!this._object3D.parent&&t.add&&this.onAddToParent(t.object.object3D)}}c.typeName="CObject3D",c.parentComponentClass=a.Ay,c.object3DIns={visible:s.gK.Boolean("Object.Visible",!0),pickable:s.gK.Boolean("Object.Pickable")},c.object3DOuts={pointerDown:s.gK.Event("Pointer.Down"),pointerUp:s.gK.Event("Pointer.Up"),pointerActive:s.gK.Boolean("Pointer.Active")},c.transformIns=a.Ay.transformIns,c.prototype.preRender=null,c.prototype.postRender=null},3104:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(t){t.Tag="tag",t.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))},3151:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const n=i(5265),s=i(7988);function r(t,e=t.schema){const{opts:i,self:n}=t;if(!i.strictSchema)return;if("boolean"==typeof e)return;const s=n.RULES.keywords;for(const i in e)s[i]||f(t,`unknown keyword: "${i}"`)}function o(t,e){if("boolean"==typeof t)return!t;for(const i in t)if(e[i])return!0;return!1}function a(t){return"number"==typeof t?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}function l(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function c({mergeNames:t,mergeToName:e,mergeValues:i,resultToName:s}){return(r,o,a,l)=>{const c=void 0===a?o:a instanceof n.Name?(o instanceof n.Name?t(r,o,a):e(r,o,a),a):o instanceof n.Name?(e(r,a,o),o):i(o,a);return l!==n.Name||c instanceof n.Name?c:s(r,c)}}function h(t,e){if(!0===e)return t.var("props",!0);const i=t.var("props",n._`{}`);return void 0!==e&&u(t,i,e),i}function u(t,e,i){Object.keys(i).forEach(i=>t.assign(n._`${e}${(0,n.getProperty)(i)}`,!0))}e.toHash=function(t){const e={};for(const i of t)e[i]=!0;return e},e.alwaysValidSchema=function(t,e){return"boolean"==typeof e?e:0===Object.keys(e).length||(r(t,e),!o(e,t.self.RULES.all))},e.checkUnknownRules=r,e.schemaHasRules=o,e.schemaHasRulesButRef=function(t,e){if("boolean"==typeof t)return!t;for(const i in t)if("$ref"!==i&&e.all[i])return!0;return!1},e.schemaRefOrVal=function({topSchemaRef:t,schemaPath:e},i,s,r){if(!r){if("number"==typeof i||"boolean"==typeof i)return i;if("string"==typeof i)return n._`${i}`}return n._`${t}${e}${(0,n.getProperty)(s)}`},e.unescapeFragment=function(t){return l(decodeURIComponent(t))},e.escapeFragment=function(t){return encodeURIComponent(a(t))},e.escapeJsonPointer=a,e.unescapeJsonPointer=l,e.eachItem=function(t,e){if(Array.isArray(t))for(const i of t)e(i);else e(t)},e.mergeEvaluated={props:c({mergeNames:(t,e,i)=>t.if(n._`${i} !== true && ${e} !== undefined`,()=>{t.if(n._`${e} === true`,()=>t.assign(i,!0),()=>t.assign(i,n._`${i} || {}`).code(n._`Object.assign(${i}, ${e})`))}),mergeToName:(t,e,i)=>t.if(n._`${i} !== true`,()=>{!0===e?t.assign(i,!0):(t.assign(i,n._`${i} || {}`),u(t,i,e))}),mergeValues:(t,e)=>!0===t||{...t,...e},resultToName:h}),items:c({mergeNames:(t,e,i)=>t.if(n._`${i} !== true && ${e} !== undefined`,()=>t.assign(i,n._`${e} === true ? true : ${i} > ${e} ? ${i} : ${e}`)),mergeToName:(t,e,i)=>t.if(n._`${i} !== true`,()=>t.assign(i,!0===e||n._`${i} > ${e} ? ${i} : ${e}`)),mergeValues:(t,e)=>!0===t||Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})},e.evaluatedPropsToName=h,e.setEvaluated=u;const d={};var p;function f(t,e,i=t.opts.strictSchema){if(i){if(e=`strict mode: ${e}`,!0===i)throw new Error(e);t.self.logger.warn(e)}}e.useFunc=function(t,e){return t.scopeValue("func",{ref:e,code:d[e.code]||(d[e.code]=new s._Code(e.code))})},function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"}(p=e.Type||(e.Type={})),e.getErrorPath=function(t,e,i){if(t instanceof n.Name){const s=e===p.Num;return i?s?n._`"[" + ${t} + "]"`:n._`"['" + ${t} + "']"`:s?n._`"/" + ${t}`:n._`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return i?(0,n.getProperty)(t).toString():"/"+a(t)},e.checkStrictMode=f},3164:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n=i(2222),s=i(8172),r=i(1721),o=i(8313);class a extends n.A{get setup(){return this.components.get(r.A,!0)}createComponents(){this.createComponent(s.A),this.createComponent(r.A),this.createComponent(o.A)}fromDocument(t,e,i){const s=t.scenes[e];s.name&&(this.name=s.name),this.scene.fromDocument(t,s),isFinite(s.meta)&&(this.meta.fromDocument(t,s),i.set(`meta/${s.meta}`,this.meta)),isFinite(s.setup)&&this.setup.fromDocument(t,e,i);const r=s.nodes;if(r&&r.forEach(e=>{const s=this.graph.createCustomNode(n.A);this.transform.addChild(s.transform),s.fromDocument(t,e,i)}),isFinite(s.setup)){const e=t.setups[s.setup];e.snapshots&&this.setup.snapshots.fromData(e.snapshots,i)}}toDocument(t,e,i){t.scenes=t.scenes||[];const s=t.scenes.length,r={units:"cm"};t.scenes.push(r),this.name&&(r.name=this.name),this.scene.toDocument(t,r);return this.transform.children.map(t=>t.node).filter(t=>t.is(n.A)).forEach(n=>{if(n.hasNodeComponents(i)){const s=n.toDocument(t,e,i);r.nodes=r.nodes||[],r.nodes.push(s)}}),i&&!i.setup||(this.meta&&(r.meta=this.meta.toDocument(t,r),e.set(this.meta,`meta/${r.meta}`)),this.setup&&this.setup.toDocument(t,s,e)),s}}a.typeName="NVScene"},3172:(t,e,i)=>{"use strict";let n=i(50),s=i(1352),r=i(8227),{isClean:o,my:a}=i(3963);function l(t,e){let i=new t.constructor;for(let n in t){if(!Object.prototype.hasOwnProperty.call(t,n))continue;if("proxyCache"===n)continue;let s=t[n],r=typeof s;"parent"===n&&"object"===r?e&&(i[n]=e):"source"===n?i[n]=s:Array.isArray(s)?i[n]=s.map(t=>l(t,i)):("object"===r&&null!==s&&(s=l(s)),i[n]=s)}return i}function c(t,e){if(e&&void 0!==e.offset)return e.offset;let i=1,n=1,s=0;for(let r=0;r<t.length;r++){if(n===e.line&&i===e.column){s=r;break}"\n"===t[r]?(i=1,n+=1):i+=1}return s}class h{get proxyOf(){return this}constructor(t={}){this.raws={},this[o]=!1,this[a]=!0;for(let e in t)if("nodes"===e){this.nodes=[];for(let i of t[e])"function"==typeof i.clone?this.append(i.clone()):this.append(i)}else this[e]=t[e]}addToError(t){if(t.postcssNode=this,t.stack&&this.source&&/\n\s{4}at /.test(t.stack)){let e=this.source;t.stack=t.stack.replace(/\n\s{4}at /,`$&${e.input.from}:${e.start.line}:${e.start.column}$&`)}return t}after(t){return this.parent.insertAfter(this,t),this}assign(t={}){for(let e in t)this[e]=t[e];return this}before(t){return this.parent.insertBefore(this,t),this}cleanRaws(t){delete this.raws.before,delete this.raws.after,t||delete this.raws.between}clone(t={}){let e=l(this);for(let i in t)e[i]=t[i];return e}cloneAfter(t={}){let e=this.clone(t);return this.parent.insertAfter(this,e),e}cloneBefore(t={}){let e=this.clone(t);return this.parent.insertBefore(this,e),e}error(t,e={}){if(this.source){let{end:i,start:n}=this.rangeBy(e);return this.source.input.error(t,{column:n.column,line:n.line},{column:i.column,line:i.line},e)}return new n(t)}getProxyProcessor(){return{get:(t,e)=>"proxyOf"===e?t:"root"===e?()=>t.root().toProxy():t[e],set:(t,e,i)=>(t[e]===i||(t[e]=i,"prop"!==e&&"value"!==e&&"name"!==e&&"params"!==e&&"important"!==e&&"text"!==e||t.markDirty()),!0)}}markClean(){this[o]=!0}markDirty(){if(this[o]){this[o]=!1;let t=this;for(;t=t.parent;)t[o]=!1}}next(){if(!this.parent)return;let t=this.parent.index(this);return this.parent.nodes[t+1]}positionBy(t={}){let e=this.source.start;if(t.index)e=this.positionInside(t.index);else if(t.word){let i="document"in this.source.input?this.source.input.document:this.source.input.css,n=i.slice(c(i,this.source.start),c(i,this.source.end)).indexOf(t.word);-1!==n&&(e=this.positionInside(n))}return e}positionInside(t){let e=this.source.start.column,i=this.source.start.line,n="document"in this.source.input?this.source.input.document:this.source.input.css,s=c(n,this.source.start),r=s+t;for(let t=s;t<r;t++)"\n"===n[t]?(e=1,i+=1):e+=1;return{column:e,line:i,offset:r}}prev(){if(!this.parent)return;let t=this.parent.index(this);return this.parent.nodes[t-1]}rangeBy(t={}){let e="document"in this.source.input?this.source.input.document:this.source.input.css,i={column:this.source.start.column,line:this.source.start.line,offset:c(e,this.source.start)},n=this.source.end?{column:this.source.end.column+1,line:this.source.end.line,offset:"number"==typeof this.source.end.offset?this.source.end.offset:c(e,this.source.end)+1}:{column:i.column+1,line:i.line,offset:i.offset+1};if(t.word){let s=e.slice(c(e,this.source.start),c(e,this.source.end)).indexOf(t.word);-1!==s&&(i=this.positionInside(s),n=this.positionInside(s+t.word.length))}else t.start?i={column:t.start.column,line:t.start.line,offset:c(e,t.start)}:t.index&&(i=this.positionInside(t.index)),t.end?n={column:t.end.column,line:t.end.line,offset:c(e,t.end)}:"number"==typeof t.endIndex?n=this.positionInside(t.endIndex):t.index&&(n=this.positionInside(t.index+1));return(n.line<i.line||n.line===i.line&&n.column<=i.column)&&(n={column:i.column+1,line:i.line,offset:i.offset+1}),{end:n,start:i}}raw(t,e){return(new s).raw(this,t,e)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...t){if(this.parent){let e=this,i=!1;for(let n of t)n===this?i=!0:i?(this.parent.insertAfter(e,n),e=n):this.parent.insertBefore(e,n);i||this.remove()}return this}root(){let t=this;for(;t.parent&&"document"!==t.parent.type;)t=t.parent;return t}toJSON(t,e){let i={},n=null==e;e=e||new Map;let s=0;for(let t in this){if(!Object.prototype.hasOwnProperty.call(this,t))continue;if("parent"===t||"proxyCache"===t)continue;let n=this[t];if(Array.isArray(n))i[t]=n.map(t=>"object"==typeof t&&t.toJSON?t.toJSON(null,e):t);else if("object"==typeof n&&n.toJSON)i[t]=n.toJSON(null,e);else if("source"===t){if(null==n)continue;let r=e.get(n.input);null==r&&(r=s,e.set(n.input,s),s++),i[t]={end:n.end,inputId:r,start:n.start}}else i[t]=n}return n&&(i.inputs=[...e.keys()].map(t=>t.toJSON())),i}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(t=r){t.stringify&&(t=t.stringify);let e="";return t(this,t=>{e+=t}),e}warn(t,e,i={}){let n={node:this};for(let t in i)n[t]=i[t];return t.warn(e,n)}}t.exports=h,h.default=h},3198:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});class n{static registerType(t){if(this.types[t.typeName])throw new Error(`Annotation type '${t.typeName}' already registered.`);this.types[t.typeName]=t}static registerDefaultType(t){this.defaultType=t}static get typeNames(){return[this.defaultTypeName,...Object.keys(this.types).sort()]}static get defaultTypeName(){return this.defaultType.typeName}static getType(t){const e=this.types[t]||this.defaultType;if(!e)throw new Error(`type '${t}' not registered and no default type set.`);return e}static createInstance(t,e,i){return"Circle"===(e=e||t.data.style)?new(this.getType(e))(t,i):new(this.getType(e))(t)}}n.types={},n.defaultType=null},3210:(t,e,i)=>{"use strict";let n=i(1024),s=i(9623),r=i(8290),o=i(8262),a=i(6842),l=i(6216),c=i(7114);function h(t,e){if(Array.isArray(t))return t.map(t=>h(t));let{inputs:i,...u}=t;if(i){e=[];for(let t of i){let i={...t,__proto__:o.prototype};i.map&&(i.map={...i.map,__proto__:a.prototype}),e.push(i)}}if(u.nodes&&(u.nodes=t.nodes.map(t=>h(t,e))),u.source){let{inputId:t,...i}=u.source;u.source=i,null!=t&&(u.source.input=e[t])}if("root"===u.type)return new l(u);if("decl"===u.type)return new r(u);if("rule"===u.type)return new c(u);if("comment"===u.type)return new s(u);if("atrule"===u.type)return new n(u);throw new Error("Unknown node type: "+t.type)}t.exports=h,h.default=h},3211:(t,e)=>{"use strict";function i(t,e){return e.rules.some(e=>n(t,e))}function n(t,e){var i;return void 0!==t[e.keyword]||(null===(i=e.definition.implements)||void 0===i?void 0:i.some(e=>void 0!==t[e]))}Object.defineProperty(e,"__esModule",{value:!0}),e.shouldUseRule=e.shouldUseGroup=e.schemaHasRulesForType=void 0,e.schemaHasRulesForType=function({schema:t,self:e},n){const s=e.RULES.types[n];return s&&!0!==s&&i(t,s)},e.shouldUseGroup=i,e.shouldUseRule=n},3215:()=>{},3270:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3151),s={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:i}){void 0===e.if&&(0,n.checkStrictMode)(i,`"${t}" without "if" is ignored`)}};e.default=s},3275:(t,e,i)=>{"use strict";i.d(e,{A:()=>a,t:()=>n});var n,s=i(6763),r=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};!function(t){t[t.TopLeft=0]="TopLeft",t[t.TopCenter=1]="TopCenter",t[t.TopRight=2]="TopRight",t[t.BottomLeft=3]="BottomLeft",t[t.BottomCenter=4]="BottomCenter",t[t.BottomRight=5]="BottomRight"}(n||(n={}));let o=class extends s.Ay{constructor(){super(),this.labels=[],this.labels.push({},{},{},{},{},{})}setLabel(t,e,i,n){this.labels[t][e]={text:i,className:n},this.requestUpdate()}unsetLabel(t,e){delete this.labels[t][e],this.requestUpdate()}firstConnected(){this.classList.add("ff-container","ff-viewport-overlay")}render(){const t=this.labels;return s.qy`<div class="ff-row">
            <div class="ff-labels ff-top-left">${Object.keys(t[n.TopLeft]).map(e=>{const i=t[n.TopLeft][e];return s.qy`<div class=${"ff-label "+i.className||0}>${i.text}</div>`})}</div>
            <div class="ff-labels ff-top-center">${Object.keys(t[n.TopCenter]).map(e=>{const i=t[n.TopCenter][e];return s.qy`<div class=${"ff-label "+i.className||0}>${i.text}</div>`})}</div>
            <div class="ff-labels ff-top-right">${Object.keys(t[n.TopRight]).map(e=>{const i=t[n.TopRight][e];return s.qy`<div class=${"ff-label "+i.className||0}>${i.text}</div>`})}</div>
        </div><div class="ff-row">
            <div class="ff-labels ff-bottom-left">${Object.keys(t[n.BottomLeft]).map(e=>{const i=t[n.BottomLeft][e];return s.qy`<div class=${"ff-label "+i.className||0}>${i.text}</div>`})}</div>
            <div class="ff-labels ff-bottom-center">${Object.keys(t[n.BottomCenter]).map(e=>{const i=t[n.BottomCenter][e];return s.qy`<div class=${"ff-label "+i.className||0}>${i.text}</div>`})}</div>
            <div class="ff-labels ff-bottom-right">${Object.keys(t[n.BottomRight]).map(e=>{const i=t[n.BottomRight][e];return s.qy`<div class=${"ff-label "+i.className||0}>${i.text}</div>`})}</div>
        </div>`}};o=r([(0,s.EM)("ff-viewport-overlay")],o);const a=o},3331:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});const n=Symbol("Publisher private data"),s=Symbol("Publisher strict option");class r{constructor(t){const e=!t||t.knownEvents;this[n]={[s]:e}}on(t,e,i){if(Array.isArray(t))return void t.forEach(t=>{this.on(t,e,i)});if(!e)throw new Error("missing callback function");let r=this[n][t];if(!r){if(this[n][s])throw new Error(`can't subscribe; unknown event: '${t}'`);r=this[n][t]=[]}let o={callback:e,context:i};r.push(o)}addEventListener(t,e,i){this.on(t,e,i)}once(t,e,i){if(Array.isArray(t))return void t.forEach(t=>{this.once(t,e,i)});const n=s=>{this.off(t,n,i),e.call(i,s)};n.cb=e,this.on(t,n,i)}off(t,e,i){if("object"==typeof t){if(Array.isArray(t))t.forEach(t=>{this.off(t,e,i)});else{const e=this[n];for(let i=0,n=Object.keys(e).length;i<n;++i){const i=e[t],n=[];for(let e=0,s=i.length;e<s;++e){const s=i[e];t&&s.context!==t&&n.push(s)}e[t]=n}}return}const s=this[n][t];if(!s)throw new Error(`can't unsubscribe; unknown event type: '${t}'`);const r=[];for(let t=0,n=s.length;t<n;++t){const n=s[t];(e&&e!==n.callback&&e!==n.callback.cb||i&&i!==n.context)&&r.push(n)}this[n][t]=r}removeEventListener(t,e,i){this.off(t,e,i)}emit(t,e){let i,r;if("string"==typeof t?(i=t,r=e):(i=t.type,r=t),!i)throw new Error(`empty or invalid event type: '${i}'`);const o=this[n],a=o[i];if(!a){if(o[s])throw new Error(`can't emit; unknown event type: '${i}'`);return!1}for(let t=0,e=a.length;t<e;++t){const e=a[t];e.context?e.callback.call(e.context,r):e.callback(r)}return 0!=a.length}addEvent(t){this[n][t]||(this[n][t]=[])}addEvents(...t){t.forEach(t=>{this[n][t]||(this[n][t]=[])})}hasEvent(t){return!!this[n][t]}listEvents(){return Object.getOwnPropertyNames(this[n])}}},3350:(t,e,i)=>{"use strict";i.d(e,{A:()=>x});var n=i(3423),s=i(4949),r=i(3074),o=i(3889),a=i(9616),l=i(8313),c=i(7801),h=i(9519),u=i(7832),d=i(3198),p=(i(7891),i(8415),i(2642),i(2791)),f=i(9337),g=i(3675),m=i(3600),A=i(3019),v=i(161),y=i(4085),b=i(9309),_=i(8172);class x extends r.Ay{get model(){return this.getComponent(a.A)}get meta(){return this.getComponent(l.A,!0)}get reader(){return this.getGraphComponent(c.Ay,!0)}get language(){return this.getGraphComponent(f.A,!0)}get audio(){return this.getGraphComponent(A.A,!0)}get snapshots(){return this.getGraphComponent(y.A,!0)}get articles(){const t=this.meta;return t?t.articles:null}get arManager(){return this.system.getMainComponent(p.A)}get assetManager(){return this.system.getMainComponent(v.A)}get renderer(){return this.getMainComponent(o.A)}get assetReader(){return this.getMainComponent(m.A)}get activeAnnotation(){return this._activeAnnotation}set activeAnnotation(t){if(t!==this._activeAnnotation){const e=this._activeAnnotation;e&&(e.set("expanded",!1),this.updateSprite(e)),this._activeAnnotation=t,t&&(t.set("expanded",!0),this.updateSprite(t),this._activeView&&(this._truncateLock=!0,this._activeView=!1));const i=this.ins;i.marker.setValue(t?t.data.marker:"",!0),i.title.setValue(t?t.title:"",!0),i.lead.setValue(t?t.lead:"",!0),i.tags.setValue(t?t.tags.join(", "):"",!0),i.style.setOption(t?t.data.style:d.A.defaultTypeName,!0),i.scale.setValue(t?100*t.data.scale*(0,h.A)(this.model.ins.localUnits.getValidatedValue(),g.uj.m):1,!0),i.offset.setValue(t?100*t.data.offset*(0,h.A)(this.model.ins.localUnits.getValidatedValue(),g.uj.m):0,!0),i.tilt.setValue(t?t.data.tilt:0,!0),i.azimuth.setValue(t?t.data.azimuth:0,!0),i.color.setValue(t?t.data.color.slice():[1,1,1],!0);const n=this.reader.articles;if(n.length){const e=n.map(t=>t.article.title);e.unshift("(none)"),i.article.setOptions(e);const s=t?n.find(e=>e.article.id===t.data.articleId):null;i.article.setValue(s?n.indexOf(s)+1:0,!0)}else i.article.setOptions(["(none)"]),i.article.setValue(0);i.audioId.setValue(t?t.data.audioId:null,!0),i.image.setValue(t?t.data.imageUri:"",!0),i.imageCredit.setValue(t?t.imageCredit:"",!0),i.imageAltText.setValue(t?t.imageAltText:"",!0),this.emit({type:"annotation-update",annotation:t})}}get hasAnnotations(){return Object.keys(this._annotations).length>0}constructor(t,e){super(t,e),this.ins=this.addInputs(x.ins),this._activeAnnotation=null,this._annotations={},this._viewports=new Set,this._sprites={},this._truncateLock=!1,this._activeView=!1,this._hasNewActiveTags=!1,this.addEvents("active-annotation","group"),this.onSpriteClick=this.onSpriteClick.bind(this),this.onSpriteLink=this.onSpriteLink.bind(this),this.on("pointer-up",this.onPointerUp,this),this.system.on("pointer-up",this.onSystemPointerUp,this),this.arManager.outs.isPresenting.on("value",this.handleARStateChange,this),this.language.outs.activeLanguage.on("value",this.updateLanguage,this),this.object3D=new s.A,this.object3D.name="AnnotationView"}setActiveAnnotationById(t){this.activeAnnotation=this._annotations[t]}update(t){super.update(t);const e=this.ins,i=this.object3D,n=this.activeAnnotation;if(e.unitScale.changed&&(i.scale.setScalar(e.unitScale.value),i.updateMatrix()),e.activeTags.changed){const t=e.activeTags.value.split(",").map(t=>t.trim()).filter(t=>t);for(const e in this._annotations){const i=this._annotations[e],n=i.tags;let s=0===n.length;t.forEach(t=>{n.indexOf(t)>=0&&(s=!0,this._hasNewActiveTags=!0)}),i.set("visible",s),this.updateSprite(i)}}if(e.visible.changed&&i.setVisible(e.visible.value),n){if(e.marker.changed&&n.set("marker",e.marker.value),e.title.changed&&(n.title=e.title.value),e.lead.changed&&(n.lead=e.lead.value),e.tags.changed&&(n.tags=e.tags.value.split(",").map(t=>t.trim()).filter(t=>t),this.emit({type:"tag-update"})),e.style.changed&&(n.set("style",e.style.getOptionText()),this.createSprite(n)),e.scale.changed&&n.set("scale",e.scale.value*(0,h.A)(g.uj.m,this.model.ins.localUnits.getValidatedValue())*.01),e.offset.changed&&n.set("offset",e.offset.value*(0,h.A)(g.uj.m,this.model.ins.localUnits.getValidatedValue())*.01),e.tilt.changed&&n.set("tilt",e.tilt.value),e.azimuth.changed&&n.set("azimuth",e.azimuth.value),e.color.changed&&n.set("color",e.color.value.slice()),e.image.changed&&n.set("imageUri",e.image.value),e.imageCredit.changed&&(n.imageCredit=e.imageCredit.value),e.imageAltText.changed&&(n.imageAltText=e.imageAltText.value),e.article.changed){const t=this.reader.articles,i=t&&t[e.article.getValidatedValue()-1];n.set("articleId",i?i.article.id:"")}e.audioId.changed&&n.set("audioId",e.audioId.value),this.updateSprite(n),this.emit({type:"annotation-update",annotation:n})}return!0}tock(){if(this.updated)return!0}postRender(t){const e=t.viewport;this._viewports.has(e)||(e.on("dispose",this.onViewportDispose,this),this._viewports.add(e));if(this.object3D.render(e.overlay,t.camera),this._truncateLock){const t=this.activeAnnotation.data,e=this._sprites[t.id];this.snapshots.outs.tweening.value&&(e.isAnimating=!0,this.snapshots.outs.tweening.once("value",()=>{e.isAnimating=!1},this)),this._truncateLock=!1}this._hasNewActiveTags&&(this.emit({type:"active-tag-update"}),this._hasNewActiveTags=!1)}dispose(){this.object3D.dispose(),this.off("pointer-up",this.onPointerUp,this),this.system.off("pointer-up",this.onSystemPointerUp,this),this.arManager.outs.isPresenting.off("value",this.handleARStateChange,this),this.language.outs.activeLanguage.off("value",this.updateLanguage,this),this._viewports.forEach(t=>t.off("dispose",this.onViewportDispose,this)),this._viewports.clear(),super.dispose()}getAnnotations(){return Object.keys(this._annotations).map(t=>this._annotations[t])}getAnnotationById(t){return this._annotations[t]}addAnnotation(t){this._annotations[t.id]=t,this.createSprite(t),Object.keys(t.data.titles).forEach(t=>{this.language.addLanguage(g.aL[t])}),Object.keys(t.data.leads).forEach(t=>{this.language.addLanguage(g.aL[t])}),this.changed=!0}removeAnnotation(t){const e=Object.keys(this._annotations);if(delete this._annotations[t.id],this.removeSprite(t),t===this.activeAnnotation){const i=Math.min(e.indexOf(t.id)+1,e.length-1);this.activeAnnotation=i<0?null:this._annotations[e[i]],t.tags.length>0&&this.emit({type:"tag-update"})}this.changed=!0}updateAnnotation(t,e){e&&this.updateSprite(t),this.changed=!0}getSprite(t){return this._sprites[t.id]}toJSON(){const t=super.toJSON(),e=this.toData();return e&&(t.data=e),t}fromJSON(t){t.data&&this.fromData(t.data)}toData(){const t=Object.keys(this._annotations);return 0===t.length?null:t.map(t=>this._annotations[t].toJSON())}fromData(t){const e=this.language.outs.activeLanguage.value;t.forEach(t=>{let i=new u.A(t);i.language=e,this.addAnnotation(i)}),this.emit({type:"tag-update"})}handleARStateChange(){for(const t in this._annotations){const e=this._annotations[t];this._sprites[e.id].isAdaptive=!this.arManager.outs.isPresenting.value}}onPointerUp(t){if(t.isDragging)return;let e=t.object3D;for(;e&&!e.isHTMLSprite;)e=e.parent;const i=e&&e.annotation;i&&(this.emit({type:"click",sprite:e,annotation:i}),t.stopPropagation=!0)}onSystemPointerUp(t){t.isDragging||this.emit({type:"click",sprite:null,annotation:null})}onViewportDispose(t){this.object3D.disposeHTMLElements(t.viewport.overlay)}onSpriteClick(t){this.emit(t);const e=t.annotation;if(e&&e.data.viewId.length&&!this.arManager.outs.isPresenting.value){this.normalizeViewOrbit(e.data.viewId);const t=this.snapshots.getTargetProperties().findIndex(t=>"ActiveId"==t.name);if(t>=0){this.snapshots.getState(e.data.viewId).values[t]=e.data.id}const i=this.getMainComponent(b.A);this.snapshots.tweenTo(e.data.viewId,i.context.secondsElapsed),this._activeView=!0}}onSpriteLink(t){this.reader&&(this.reader.ins.articleId.setValue(t.annotation.data.articleId),this.reader.ins.enabled.setValue(!0),this.reader.ins.focus.setValue(!0))}createSprite(t){this.removeSprite(t);const e=d.A.createInstance(t);e.addEventListener("click",this.onSpriteClick),e.addEventListener("link",this.onSpriteLink),e.assetManager=this.assetManager,e.audioManager=this.audio,this._sprites[t.id]=e,this.object3D.add(e),this.registerPickableObject3D(e,!0)}removeSprite(t){const e=this._sprites[t.id];e&&(e.removeEventListener("click",this.onSpriteClick),e.removeEventListener("link",this.onSpriteLink),e.dispose(),this._sprites[t.id]=void 0,this.object3D.remove(e),this.unregisterPickableObject3D(e,!0))}updateSprite(t){const e=this._sprites[t.id];e&&e.update()}updateLanguage(){if(!this.getComponent(a.A,!0))return;const t=this.ins,e=this._activeAnnotation,i=this.language;this.getAnnotations().forEach(t=>{t.language=i.outs.activeLanguage.value}),t.activeTags.set();for(const t in this._annotations){const e=this._annotations[t],i=this._sprites[e.id];i&&i.update()}t.title.setValue(e?e.title:"",!0),t.lead.setValue(e?e.lead:"",!0),t.tags.setValue(e?e.tags.join(", "):""),t.imageCredit.setValue(e?e.imageCredit:"",!0),t.imageAltText.setValue(e?e.imageAltText:"",!0);const n=this.reader.articles.map(t=>t.article.title);n.unshift("(none)"),t.article.setOptions(n)}normalizeViewOrbit(t){const e=this.snapshots.getTargetProperties().findIndex(t=>"Orbit"==t.name),i=this.snapshots.getState(t),n=this.snapshots.getCurrentValues()[e];let s=0;n.forEach((t,n)=>{const r=Math.round((t-i.values[e][n])/360);i.values[e][n]+=360*r,s+=Math.abs(t-i.values[e][n])});const r=this.getGraphComponent(_.A).outs.boundingRadius.value,o=this.snapshots.getTargetProperties().findIndex(t=>"Offset"==t.name),a=this.snapshots.getCurrentValues()[o],l=i.values[o],c=Math.sqrt(Math.pow(l[0]-a[0],2)+Math.pow(l[1]-a[1],2)+Math.pow(l[2]-a[2],2));i.duration=Math.min(Math.max(s/180,c/r,.3),1.5)}}x.typeName="CVAnnotationView",x.ins={unitScale:n.gK.Number("Transform.UnitScale",{preset:1,precision:5}),activeTags:n.gK.String("Tags.Active"),title:n.gK.String("Annotation.Title"),lead:n.gK.String("Annotation.Lead"),marker:n.gK.String("Annotation.Marker"),tags:n.gK.String("Annotation.Tags"),style:n.gK.Option("Annotation.Style",d.A.typeNames),scale:n.gK.Scale("Annotation.Scale",{preset:1,precision:3}),offset:n.gK.Number("Annotation.Offset",{preset:0,precision:3}),article:n.gK.Option("Annotation.Article",[]),image:n.gK.String("Annotation.Image"),imageCredit:n.gK.String("Image.Credit"),imageAltText:n.gK.String("Image.AltText"),audioId:n.gK.String("Annotation.AudioID"),tilt:n.gK.Number("Annotation.Tilt"),azimuth:n.gK.Number("Annotation.Azimuth"),color:n.gK.ColorRGB("Annotation.Color")}},3365:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n=i(1071),s=i(3423),r=i(2902);class o extends s.Ay{constructor(){super(...arguments),this.activeDocument=null}get documentProvider(){return this.getGraphComponent(r.A)}startObserving(){const t=this.documentProvider;t.on("active-component",this.onActiveDocumentEvent,this),t.activeComponent&&(this.activeDocument=t.activeComponent,this.onActiveDocument(null,t.activeComponent))}stopObserving(){const t=this.documentProvider;t.off("active-component",this.onActiveDocumentEvent,this),t.activeComponent&&(this.activeDocument=null,this.onActiveDocument(t.activeComponent,null))}onActiveDocument(t,e){}onActiveDocumentEvent(t){this.activeDocument=t.next,this.onActiveDocument(t.previous,t.next)}}o.typeName="CVDocumentObserver";class a extends o{constructor(){super(...arguments),this.activeNode=null}get nodeProvider(){return this.getGraphComponent(n.A)}startObserving(){super.startObserving();const t=this.nodeProvider;t.on("active-node",this.onActiveNodeEvent,this),t.activeNode&&(this.activeNode=t.activeNode,this.onActiveNode(null,t.activeNode))}stopObserving(){const t=this.nodeProvider;t.off("active-node",this.onActiveNodeEvent,this),t.activeNode&&(this.activeNode=null,this.onActiveNode(t.activeNode,null)),super.stopObserving()}onActiveNode(t,e){}onActiveNodeEvent(t){this.activeNode=t.next,this.onActiveNode(t.previous,t.next)}}a.typeName="CVNodeObserver"},3407:(t,e)=>{"use strict";e.OK=200,e.lf=302,e.hB=401},3423:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>c,gK:()=>s.gK});var n=i(3331),s=i(9733),r=i(449);class o extends n.A{constructor(t){super(),this.addEvent("property"),this.linkable=t,this.properties=[]}get customProperties(){return this.properties.filter(t=>t.custom)}dispose(){this.unlinkAllProperties()}isInputGroup(){return this===this.linkable.ins}isOutputGroup(){return this===this.linkable.outs}createProperties(t,e){return Object.keys(t).forEach((i,n)=>{const s=void 0===e?void 0:e+n,r=t[i];this.createProperty(r.path,r.schema,i,s)}),this}createProperty(t,e,i,n){const r=new s.Ay(t,e);return this.addProperty(r,i,n),r}createCustomProperty(t,e,i){const n=new s.Ay(t,e,!0);return this.addCustomProperty(n,i),n}addCustomProperty(t,e){const i=(0,r.A)(5);this.addProperty(t,i,e)}addProperty(t,e,i){if(t.group)throw new Error("can't add, property already part of a group");if(this[e])throw new Error(`key '${e}' already exists in group`);t._group=this,t._key=e,void 0===i?this.properties.push(t):this.properties.splice(i,0,t),this[e]=t,this.emit({type:"property",add:!0,remove:!1,property:t})}removeProperty(t){if(t.group!==this)throw new Error("can't remove, property not in this group");if(t.hasLinks())throw new Error("can't remove, property has links");if(this[t.key]!==t)throw new Error(`property key '${t.key}' not found in group`);this.properties.slice(this.properties.indexOf(t),1),delete this[t.key],t._group=null,t._key="",this.emit({type:"property",add:!1,remove:!0,property:t})}getProperty(t){const e=this[t];if(!e)throw new Error(`no property found with key '${t}'`);return e}getKeys(t=!1){const e=[];return this.properties.forEach(i=>{(t||"object"!==i.type)&&e.push(i.key)}),e}getValues(t=!1){const e=[];return this.properties.map(i=>{(t||"object"!==i.type)&&e.push(i.value)}),e}cloneValues(t=!1){const e=[];return this.properties.map(i=>{(t||"object"!==i.type)&&e.push(i.cloneValue())}),e}setValues(t){Object.keys(t).forEach(e=>this.getProperty(e).value=t[e])}copyValues(t){Object.keys(t).forEach(e=>this.getProperty(e).copyValue(t[e]))}unlinkAllProperties(){this.properties.forEach(t=>t.unlink())}toJSON(){let t=null;return this.properties.forEach(e=>{const i=e.toJSON();i&&(t=t||{},t[e.key]=i)}),t}fromJSON(t){Object.keys(t).forEach(e=>{const i=t[e];if(i.schema){const t=new s.Ay(i.path,i.schema,!0);this.addProperty(t,e)}})}linksFromJSON(t,e){Object.keys(t).forEach(i=>{this[i].fromJSON(t[i],e)})}}class a{constructor(t,e,i,n){this.typeName=c.getTypeName(e),this.didAdd=i,this.willRemove=n,this._registry=t,t.on(this.typeName,this.onComponent,this),this.component=t.get(e,!0),this.component&&i&&i(this.component)}dispose(){this._registry.off(this.typeName,this.onComponent,this),this.component=null,this.didAdd=null,this.willRemove=null}onComponent(t){t.add?(this.component=t.object,this.didAdd&&this.didAdd(t.object)):t.remove&&(this.willRemove&&this.willRemove(t.object),this.component=null)}}class l{constructor(t,e){this._typeName=e?c.getTypeName(e):null,this._id=e instanceof c?e.id:void 0,this._system=t}get component(){return this._id&&this._system.components.getById(this._id)||null}set component(t){if(t&&this._typeName&&!(t instanceof this._system.registry.getType(this._typeName)))throw new Error(`can't assign component of class '${t.constructor.name||"unknown"}' to link of class '${this._typeName}'`);this._id=t?t.id:void 0}}i(1860);class c extends n.A{static getTypeName(t){return"function"==typeof t?t.typeName:"object"==typeof t?t.constructor.typeName:t||c.typeName}constructor(t,e){super({knownEvents:!1}),this.ins=new o(this),this.outs=new o(this),this.changed=!0,this.updated=!1,this._name="",this._tags=new Set,this._trackers=[],this.node=t,this.id=e}create(){this.node._addComponent(this),this.graph.isActive&&this.activate&&this.activate()}dispose(){this.graph.isActive&&this.deactivate&&this.deactivate(),this.emit({type:"dispose",component:this}),this.ins.dispose(),this.outs.dispose(),this._trackers.forEach(t=>t.dispose()),this.node&&(this.node._removeComponent(this),this.node=null)}get isNodeSingleton(){return this.constructor.isNodeSingleton}get isGraphSingleton(){return this.constructor.isGraphSingleton}get isSystemSingleton(){return this.constructor.isSystemSingleton}get typeName(){return this.constructor.typeName}get displayTypeName(){const t=this.typeName;return"Component"===t?t:t.substr(1)}get text(){return this.constructor.text}get icon(){return this.constructor.icon}get name(){return this._name}get displayName(){return this._name||this.text||this.displayTypeName}set name(t){this._name=t,this.emit({type:"change",component:this,what:"name"})}get tags(){return this._tags}addTag(t){this._tags.has(t)||(this._tags.add(t),this.node._addComponentTag(t,this))}removeTag(t){this._tags.has(t)&&(this._tags.delete(t),this.node._removeComponentTag(t,this))}get graph(){return this.node.graph}get system(){return this.node.system}get components(){return this.node.components}get isActive(){return this.graph.isActive}getComponent(t,e=!1){return this.node.components.get(t,e)}getComponents(t){return this.node.components.getArray(t)}getComponentsByTag(t){return this.node.components.getByTag(t)}createComponent(t){return this.node.createComponent(t)}getOrCreateComponent(t){return this.node.components.get(t,!0)||this.node.createComponent(t)}hasComponent(t){return this.node.components.has(t)}getGraphComponent(t,e=!1){return this.node.graph.components.get(t,e)}getGraphComponents(t){return this.node.graph.components.getArray(t)}getGraphComponentsByTag(t){return this.node.graph.components.getByTag(t)}hasGraphComponent(t){return this.node.graph.components.has(t)}getMainComponent(t,e=!1){return this.node.system.graph.components.get(t,e)}getMainComponents(t){return this.node.system.graph.components.getArray(t)}getMainComponentsByTag(t){return this.node.system.graph.components.getByTag(t)}hasMainComponent(t){return this.node.system.graph.components.has(t)}getSystemComponent(t,e=!1){return this.node.system.components.get(t,e)}getSystemComponents(t){return this.node.system.components.getArray(t)}getSystemComponentsByTag(t){return this.node.system.components.getByTag(t)}hasSystemComponent(t){return this.node.system.components.has(t)}getComponentById(t){return this.node.system.components.getById(t)}getNode(t,e=!1){return this.node.graph.nodes.get(t,e)}getNodes(t){return this.node.graph.nodes.getArray(t)}getNodesByTag(t){return this.node.graph.nodes.getByTag(t)}hasNode(t){return this.node.graph.nodes.has(t)}getMainNode(t,e=!1){return this.node.system.graph.nodes.get(t,e)}getMainNodes(t){return this.node.system.graph.nodes.getArray(t)}getMainNodesByTag(t){return this.node.system.graph.nodes.getByTag(t)}hasMainNode(t){return this.node.system.graph.nodes.has(t)}getSystemNode(t,e=!1){return this.node.system.nodes.get(t,e)}getSystemNodes(t){return this.node.system.nodes.getArray(t)}getSystemNodesByTag(t){return this.node.system.nodes.getByTag(t)}hasSystemNode(t){return this.node.system.nodes.has(t)}getNodeById(t){return this.node.system.nodes.getById(t)}activate(){}update(t){throw new Error("this should never be called")}tick(t){throw new Error("this should never be called")}tock(t){throw new Error("this should never be called")}deactivate(){}requestSort(){this.graph.requestSort()}is(t){const e=c.getTypeName(t);let i=this;do{if(i=Object.getPrototypeOf(i),i.constructor.typeName===e)return!0}while(i.constructor.typeName!==c.typeName);return!1}unlinkAllProperties(){this.ins.unlinkAllProperties(),this.outs.unlinkAllProperties()}resetChanged(){this.changed=!1;const t=this.ins.properties;for(let e=0,i=t.length;e<i;++e)t[e].changed=!1;const e=this.outs.properties;for(let t=0,i=e.length;t<i;++t)e[t].changed=!1}trackComponent(t,e,i){const n=new a(this.node.components,t,e,i);return this._trackers.push(n),n}referenceComponent(t){return new l(this.system,t)}toString(){return`${this.typeName}${this.name?" ("+this.name+")":""}`}dump(t=""){console.log(t+`%cComponent '${this.typeName}' (${this.displayName})`,"color: green"),this.ins.properties.forEach(e=>e.dump(t+"  IN  ")),this.outs.properties.forEach(e=>e.dump(t+"  OUT "))}toJSON(){let t={};const e=this.ins.toJSON();e&&(t.ins=e);const i=this.outs.toJSON();return i&&(t.outs=i),t}fromJSON(t){t.ins&&this.ins.fromJSON(t.ins),t.outs&&this.outs.fromJSON(t.outs)}referencesFromJSON(t){const e=this.system.components.getDictionary();t.ins&&this.ins.linksFromJSON(t.ins,e),t.outs&&this.outs.linksFromJSON(t.outs,e)}addCustomInput(t,e,i){return this.changed=!0,this.ins.createCustomProperty(t,e,i)}allowCustomInput(t){return!1}addCustomOutput(t,e,i){return this.outs.createCustomProperty(t,e,i)}allowCustomOutput(t){return!1}addInputs(t,e){return this.ins.createProperties(t,e)}addOutputs(t,e){return this.outs.createProperties(t,e)}}c.typeName="Component",c.text="",c.icon="",c.isNodeSingleton=!0,c.isGraphSingleton=!1,c.isSystemSingleton=!1,c.prototype.activate=null,c.prototype.update=null,c.prototype.tick=null,c.prototype.tock=null,c.prototype.deactivate=null},3534:(t,e,i)=>{"use strict";i.d(e,{_:()=>o});var n=i(3869),s=i(4743);const r=new WeakMap,o=(0,s.u$)(t=>e=>{if(!(e instanceof s.Qh))throw new Error("unsafeHTML can only be used in text bindings");const i=r.get(e);if(void 0!==i&&(0,n.sO)(t)&&t===i.value&&e.value===i.fragment)return;const o=document.createElement("template");o.innerHTML=t;const a=document.importNode(o.content,!0);e.setValue(a),r.set(e,{value:t,fragment:a})})},3567:t=>{t.exports=function(t){return!(!t||"string"==typeof t)&&(t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))}},3570:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(6241),s=i(5265),r={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:t})=>s.str`must match pattern "${t}"`,params:({schemaCode:t})=>s._`{pattern: ${t}}`},code(t){const{data:e,$data:i,schema:r,schemaCode:o,it:a}=t,l=a.opts.unicodeRegExp?"u":"",c=i?s._`(new RegExp(${o}, ${l}))`:(0,n.usePattern)(t,r);t.fail$data(s._`!${c}.test(${e})`)}};e.default=r},3600:(t,e,i)=>{"use strict";i.d(e,{P:()=>Te,A:()=>Be});var n=i(3423);class s{constructor(t){this._loadingManager=t}async getJSON(t){return this._loadingManager.itemStart(t),fetch(t,{headers:{Accept:"application/json"}}).then(e=>{if(!e.ok)throw this._loadingManager.itemError(t),this._loadingManager.itemEnd(t),new Error(`failed to fetch from '${t}', status: ${e.status} ${e.statusText}`);return this._loadingManager.itemEnd(t),e.json()})}async getText(t){return fetch(t,{headers:{Accept:t.endsWith(".html")?"text/html":"text/plain"}}).then(e=>{if(!e.ok)throw new Error(`failed to fetch from '${t}', status: ${e.status} ${e.statusText}`);return e.text()})}}var r=i(4640);const o=new WeakMap;class a extends r.aHM{constructor(t){super(t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(t){return this.decoderPath=t,this}setDecoderConfig(t){return this.decoderConfig=t,this}setWorkerLimit(t){return this.workerLimit=t,this}load(t,e,i,n){const s=new r.Y9S(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,t=>{this.parse(t,e,n)},i,n)}parse(t,e,i=()=>{}){this.decodeDracoFile(t,e,null,null,r.er$,i).catch(i)}decodeDracoFile(t,e,i,n,s=r.Zr2,o=()=>{}){const a={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s};return this.decodeGeometry(t,a).then(e).catch(o)}decodeGeometry(t,e){const i=JSON.stringify(e);if(o.has(t)){const e=o.get(t);if(e.key===i)return e.promise;if(0===t.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n;const s=this.workerNextTaskID++,r=t.byteLength,a=this._getWorker(s,r).then(i=>(n=i,new Promise((i,r)=>{n._callbacks[s]={resolve:i,reject:r},n.postMessage({type:"decode",id:s,taskConfig:e,buffer:t},[t])}))).then(t=>this._createGeometry(t.geometry));return a.catch(()=>!0).then(()=>{n&&s&&this._releaseTask(n,s)}),o.set(t,{key:i,promise:a}),a}_createGeometry(t){const e=new r.LoY;t.index&&e.setIndex(new r.THS(t.index.array,1));for(let i=0;i<t.attributes.length;i++){const n=t.attributes[i],s=n.name,o=n.array,a=n.itemSize,l=new r.THS(o,a);"color"===s&&(this._assignVertexColorSpace(l,n.vertexColorSpace),l.normalized=o instanceof Float32Array==!1),e.setAttribute(s,l)}return e}_assignVertexColorSpace(t,e){if(e!==r.er$)return;const i=new r.Q1f;for(let e=0,n=t.count;e<n;e++)i.fromBufferAttribute(t,e),r.ppV.colorSpaceToWorking(i,r.er$),t.setXYZ(e,i.r,i.g,i.b)}_loadLibrary(t,e){const i=new r.Y9S(this.manager);return i.setPath(this.decoderPath),i.setResponseType(e),i.setWithCredentials(this.withCredentials),new Promise((e,n)=>{i.load(t,e,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const t="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,e=[];return t?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then(e=>{const i=e[0];t||(this.decoderConfig.wasmBinary=e[1]);const n=l.toString(),s=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(t,e){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const t=new Worker(this.workerSourceURL);t._callbacks={},t._taskCosts={},t._taskLoad=0,t.postMessage({type:"init",decoderConfig:this.decoderConfig}),t.onmessage=function(e){const i=e.data;switch(i.type){case"decode":t._callbacks[i.id].resolve(i);break;case"error":t._callbacks[i.id].reject(i);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+i.type+'"')}},this.workerPool.push(t)}else this.workerPool.sort(function(t,e){return t._taskLoad>e._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[t]=e,i._taskLoad+=e,i})}_releaseTask(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]}debug(){console.log("Task load: ",this.workerPool.map(t=>t._taskLoad))}dispose(){for(let t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function l(){let t,e;function i(t,e,i,n,s,r){const o=r.num_components(),a=i.num_points()*o,l=a*s.BYTES_PER_ELEMENT,c=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32}}(t,s),h=t._malloc(l);e.GetAttributeDataArrayForAllPoints(i,r,c,l,h);const u=new s(t.HEAPF32.buffer,h,a).slice();return t._free(h),{name:n,array:u,itemSize:o}}onmessage=function(n){const s=n.data;switch(s.type){case"init":t=s.decoderConfig,e=new Promise(function(e){t.onModuleLoaded=function(t){e({draco:t})},DracoDecoderModule(t)});break;case"decode":const n=s.buffer,r=s.taskConfig;e.then(t=>{const e=t.draco,o=new e.Decoder;try{const t=function(t,e,n,s){const r=s.attributeIDs,o=s.attributeTypes;let a,l;const c=e.GetEncodedGeometryType(n);if(c===t.TRIANGULAR_MESH)a=new t.Mesh,l=e.DecodeArrayToMesh(n,n.byteLength,a);else{if(c!==t.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new t.PointCloud,l=e.DecodeArrayToPointCloud(n,n.byteLength,a)}if(!l.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const h={index:null,attributes:[]};for(const n in r){const l=self[o[n]];let c,u;if(s.useUniqueIDs)u=r[n],c=e.GetAttributeByUniqueId(a,u);else{if(u=e.GetAttributeId(a,t[r[n]]),-1===u)continue;c=e.GetAttribute(a,u)}const d=i(t,e,a,n,l,c);"color"===n&&(d.vertexColorSpace=s.vertexColorSpace),h.attributes.push(d)}c===t.TRIANGULAR_MESH&&(h.index=function(t,e,i){const n=i.num_faces(),s=3*n,r=4*s,o=t._malloc(r);e.GetTrianglesUInt32Array(i,r,o);const a=new Uint32Array(t.HEAPF32.buffer,o,s).slice();return t._free(o),{array:a,itemSize:1}}(t,e,a));return t.destroy(a),h}(e,o,new Int8Array(n),r),a=t.attributes.map(t=>t.array.buffer);t.index&&a.push(t.index.array.buffer),self.postMessage({type:"decode",id:s.id,geometry:t},a)}catch(t){console.error(t),self.postMessage({type:"error",id:s.id,error:t.message})}finally{e.destroy(o)}})}}}var c=function(){var t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),e=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if("object"!=typeof WebAssembly)return{supported:!1};var i,n=WebAssembly.validate(t)?"b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q;Aekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq;t9tqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk;h8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhwcbhDinaDae9pmeawaeaD9RaDawfae6Egqcsfgoc9WGgkci2hxakcethmaocl4cifcd4hPabaDad2fhscbhzdnincehHalhOcbhAdninaraO9RaP6miavcj;cbfaAak2fhCaOaPfhlcbhidnakc;ab6mbaral9Rc;Gb6mbcbhoinaCaofhidndndndndnaOaoco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklbalczfhlkdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklzalczfhlkdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklaalczfhlkdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalclfaYpQbfaXc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalcwfaYpQbfaXc:q:yjjbfRbbfhlxekaialpbbbpkl8Walczfhlkaoc;abfhiaocjefak0meaihoaral9Rc;Fb0mbkkdndnaiak9pmbaici4hoinaral9RcK6mdaCaifhXdndndndndnaOaico4fRbbaocoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpklbxikaXalpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaXalpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaXalpbbbpklbalczfhlkaocdfhoaiczfgiak6mbkkalTmbaAci6hHalhOaAcefgohAaoclSmdxekkcbhlaHceGmdkdnakTmbavcjdfazfhiavazfpbdbhYcbhXinaiavcj;cbfaXfgopblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLaoakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEaoamfpblbg3cep9Ta3aQp9op9Hp9rg3aoaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfhiaXczfgXak6mbkkazclfgzad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfhDc9:hoalmexikkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk;uzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:EPliuo97eue978Jjjjjbca9Rhidndnadcl9hmbdnaec98GglTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalae9pmeaiaeciGgvcdtgdVcbczad9R;8kbaiabalcdtfglad;8qbbdnavTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkalaiad;8qbbskdnaec98GgxTmbcbhvabhdinadczfglalpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oawaopmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgvax6mbkkaxae9pmbaiaeciGgvcitgdfcbcaad9R;8kbaiabaxcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oawaopmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalae9pmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbhdabheinaeaepbbbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepkbbaeczfheadclfgdav6mbkkdnaval9pmbaialciGgdcdtgeVcbc;abae9R;8kbaiabavcdtfgvae;8qbbdnadTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepklbkavaiae;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz9Tbb":"b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q;iekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq:P8Yqdbk;3sezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhDcbhqinaqae9pmeaDaeaq9RaqaDfae6Egkcsfgocl4cifcd4hxdndndndnaoc9WGgmTmbcbhPcehsawcjdfhzalhHinaraH9Rax6midnaraHaxfgl9RcK6mbczhoinawcj;cbfaogifgoc9WfhOdndndndndnaHaic9WfgAco4fRbbaAci4coG4ciGPlbedibkaO9cb83ibaOcwf9cb83ibxikaOalRblalRbbgAco4gCaCciSgCE86bbaocGfalclfaCfgORbbaAcl4ciGgCaCciSgCE86bbaocVfaOaCfgORbbaAcd4ciGgCaCciSgCE86bbaoc7faOaCfgORbbaAciGgAaAciSgAE86bbaoctfaOaAfgARbbalRbegOco4gCaCciSgCE86bbaoc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc93faAaCfgARbbaOciGgOaOciSgOE86bbaoc94faAaOfgARbbalRbdgOco4gCaCciSgCE86bbaoc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc97faAaCfgARbbaOciGgOaOciSgOE86bbaoc98faAaOfgORbbalRbiglco4gAaAciSgAE86bbaoc99faOaAfgORbbalcl4ciGgAaAciSgAE86bbaoc9:faOaAfgORbbalcd4ciGgAaAciSgAE86bbaocufaOaAfgoRbbalciGglalciSglE86bbaoalfhlxdkaOalRbwalRbbgAcl4gCaCcsSgCE86bbaocGfalcwfaCfgORbbaAcsGgAaAcsSgAE86bbaocVfaOaAfgORbbalRbegAcl4gCaCcsSgCE86bbaoc7faOaCfgORbbaAcsGgAaAcsSgAE86bbaoctfaOaAfgORbbalRbdgAcl4gCaCcsSgCE86bbaoc91faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc4faOaAfgORbbalRbigAcl4gCaCcsSgCE86bbaoc93faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc94faOaAfgORbbalRblgAcl4gCaCcsSgCE86bbaoc95faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc96faOaAfgORbbalRbvgAcl4gCaCcsSgCE86bbaoc97faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc98faOaAfgORbbalRbogAcl4gCaCcsSgCE86bbaoc99faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc9:faOaAfgORbbalRbrglcl4gAaAcsSgAE86bbaocufaOaAfgoRbbalcsGglalcsSglE86bbaoalfhlxekaOal8Pbb83bbaOcwfalcwf8Pbb83bbalczfhlkdnaiam9pmbaiczfhoaral9RcL0mekkaiam6mialTmidnakTmbawaPfRbbhOcbhoazhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkkazcefhzaPcefgPad6hsalhHaPad9hmexvkkcbhlasceGmdxikalaxad2fhCdnakTmbcbhHcehsawcjdfhminaral9Rax6mialTmdalaxfhlawaHfRbbhOcbhoamhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkamcefhmaHcefgHad6hsaHad9hmbkaChlxikcbhocehsinaral9Rax6mdalTmealaxfhlaocefgoad6hsadao9hmbkaChlxdkcbhlasceGTmekc9:hoxikabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqalmbkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;ebf8Kjjjjbaok;yzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;siliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabavcefciGaiVcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:Ohkxekcjjjj94hkkabavcdfciGaiVcetfak87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:Ohqxekcjjjj94hqkabavcufciGaiVcetfaq87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohqxekcjjjj94hqkabavciGaiVcetfaq87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2geTmbinababydbgdcwtcw91:Yadce91cjjj;8ifcjjj98G::NUdbabclfhbaecufgembkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaiczfhiaeczfheadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklz9Kbb",s=WebAssembly.instantiate(r(n),{}).then(function(t){(i=t.instance).exports.__wasm_call_ctors()});function r(t){for(var i=new Uint8Array(t.length),n=0;n<t.length;++n){var s=t.charCodeAt(n);i[n]=s>96?s-97:s>64?s-39:s+4}var r=0;for(n=0;n<t.length;++n)i[r++]=i[n]<60?e[i[n]]:64*(i[n]-60)+i[++n];return i.buffer.slice(0,r)}function o(t,e,n,s,r,o){var a=i.exports.sbrk,l=n+3&-4,c=a(l*s),h=a(r.length),u=new Uint8Array(i.exports.memory.buffer);u.set(r,h);var d=t(c,n,s,h,r.length);if(0==d&&o&&o(c,l,s),e.set(u.subarray(c,c+n*s)),a(c-a(0)),0!=d)throw new Error("Malformed buffer data: "+d)}var a={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},l={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},c=[],h=0;function u(t){var e={object:new Worker(t),pending:0,requests:{}};return e.object.onmessage=function(t){var i=t.data;e.pending-=i.count,e.requests[i.id][i.action](i.value),delete e.requests[i.id]},e}function d(t){for(var e="var instance; var ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(r(n))+"]), {}).then(function(result) { instance = result.instance; instance.exports.__wasm_call_ctors(); });self.onmessage = workerProcess;"+o.toString()+p.toString(),i=new Blob([e],{type:"text/javascript"}),s=URL.createObjectURL(i),a=0;a<t;++a)c[a]=u(s);URL.revokeObjectURL(s)}function p(t){s.then(function(){var e=t.data;try{var n=new Uint8Array(e.count*e.size);o(i.exports[e.mode],n,e.count,e.size,e.source,i.exports[e.filter]),self.postMessage({id:e.id,count:e.count,action:"resolve",value:n},[n.buffer])}catch(t){self.postMessage({id:e.id,count:e.count,action:"reject",value:t})}})}return{ready:s,supported:!0,useWorkers:function(t){d(t)},decodeVertexBuffer:function(t,e,n,s,r){o(i.exports.meshopt_decodeVertexBuffer,t,e,n,s,i.exports[a[r]])},decodeIndexBuffer:function(t,e,n,s){o(i.exports.meshopt_decodeIndexBuffer,t,e,n,s)},decodeIndexSequence:function(t,e,n,s){o(i.exports.meshopt_decodeIndexSequence,t,e,n,s)},decodeGltfBuffer:function(t,e,n,s,r,c){o(i.exports[l[r]],t,e,n,s,i.exports[a[c]])},decodeGltfBufferAsync:function(t,e,n,r,u){return c.length>0?function(t,e,i,n,s){for(var r=c[0],o=1;o<c.length;++o)c[o].pending<r.pending&&(r=c[o]);return new Promise(function(o,a){var l=new Uint8Array(i),c=h++;r.pending+=t,r.requests[c]={resolve:o,reject:a},r.object.postMessage({id:c,count:t,size:e,source:l,mode:n,filter:s},[l.buffer])})}(t,e,n,l[r],a[u]):s.then(function(){var s=new Uint8Array(t*e);return o(i.exports[l[r]],s,t,e,n,i.exports[a[u]]),s})}}}();function h(t,e){if(e===r.RJ4)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===r.rYR||e===r.O49){let i=t.getIndex();if(null===i){const e=[],n=t.getAttribute("position");if(void 0===n)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(let t=0;t<n.count;t++)e.push(t);t.setIndex(e),i=t.getIndex()}const n=i.count-2,s=[];if(e===r.rYR)for(let t=1;t<=n;t++)s.push(i.getX(0)),s.push(i.getX(t)),s.push(i.getX(t+1));else for(let t=0;t<n;t++)t%2==0?(s.push(i.getX(t)),s.push(i.getX(t+1)),s.push(i.getX(t+2))):(s.push(i.getX(t+2)),s.push(i.getX(t+1)),s.push(i.getX(t)));s.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=t.clone();return o.setIndex(s),o.clearGroups(),o}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}class u extends r.aHM{constructor(t){super(t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new A(t)}),this.register(function(t){return new v(t)}),this.register(function(t){return new I(t)}),this.register(function(t){return new M(t)}),this.register(function(t){return new T(t)}),this.register(function(t){return new b(t)}),this.register(function(t){return new _(t)}),this.register(function(t){return new x(t)}),this.register(function(t){return new w(t)}),this.register(function(t){return new m(t)}),this.register(function(t){return new E(t)}),this.register(function(t){return new y(t)}),this.register(function(t){return new S(t)}),this.register(function(t){return new C(t)}),this.register(function(t){return new f(t)}),this.register(function(t){return new B(t)}),this.register(function(t){return new R(t)})}load(t,e,i,n){const s=this;let o;if(""!==this.resourcePath)o=this.resourcePath;else if(""!==this.path){const e=r.r6x.extractUrlBase(t);o=r.r6x.resolveURL(e,this.path)}else o=r.r6x.extractUrlBase(t);this.manager.itemStart(t);const a=function(e){n?n(e):console.error(e),s.manager.itemError(t),s.manager.itemEnd(t)},l=new r.Y9S(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(t,function(i){try{s.parse(i,o,function(i){e(i),s.manager.itemEnd(t)},a)}catch(t){a(t)}},i,a)}setDRACOLoader(t){return this.dracoLoader=t,this}setKTX2Loader(t){return this.ktx2Loader=t,this}setMeshoptDecoder(t){return this.meshoptDecoder=t,this}register(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this}unregister(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}parse(t,e,i,n){let s;const r={},o={},a=new TextDecoder;if("string"==typeof t)s=JSON.parse(t);else if(t instanceof ArrayBuffer){if(a.decode(new Uint8Array(t,0,4))===P){try{r[p.KHR_BINARY_GLTF]=new N(t)}catch(t){return void(n&&n(t))}s=JSON.parse(r[p.KHR_BINARY_GLTF].content)}else s=JSON.parse(a.decode(t))}else s=t;if(void 0===s.asset||s.asset.version[0]<2)return void(n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new at(s,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let t=0;t<this.pluginCallbacks.length;t++){const e=this.pluginCallbacks[t](l);e.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[e.name]=e,r[e.name]=!0}if(s.extensionsUsed)for(let t=0;t<s.extensionsUsed.length;++t){const e=s.extensionsUsed[t],i=s.extensionsRequired||[];switch(e){case p.KHR_MATERIALS_UNLIT:r[e]=new g;break;case p.KHR_DRACO_MESH_COMPRESSION:r[e]=new O(s,this.dracoLoader);break;case p.KHR_TEXTURE_TRANSFORM:r[e]=new k;break;case p.KHR_MESH_QUANTIZATION:r[e]=new U;break;default:i.indexOf(e)>=0&&void 0===o[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}l.setExtensions(r),l.setPlugins(o),l.parse(i,n)}parseAsync(t,e){const i=this;return new Promise(function(n,s){i.parse(t,e,n,s)})}}function d(){let t={};return{get:function(e){return t[e]},add:function(e,i){t[e]=i},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const p={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class f{constructor(t){this.parser=t,this.name=p.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const t=this.parser,e=this.parser.json.nodes||[];for(let i=0,n=e.length;i<n;i++){const n=e[i];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&t._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(t){const e=this.parser,i="light:"+t;let n=e.cache.get(i);if(n)return n;const s=e.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[t];let a;const l=new r.Q1f(16777215);void 0!==o.color&&l.setRGB(o.color[0],o.color[1],o.color[2],r.Zr2);const c=void 0!==o.range?o.range:0;switch(o.type){case"directional":a=new r.ZyN(l),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new r.HiM(l),a.distance=c;break;case"spot":a=new r.nCl(l),a.distance=c,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,a.angle=o.spot.outerConeAngle,a.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return a.position.set(0,0,0),et(a,o),void 0!==o.intensity&&(a.intensity=o.intensity),a.name=e.createUniqueName(o.name||"light_"+t),n=Promise.resolve(a),e.cache.add(i,n),n}getDependency(t,e){if("light"===t)return this._loadLight(e)}createNodeAttachment(t){const e=this,i=this.parser,n=i.json.nodes[t],s=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===s?null:this._loadLight(s).then(function(t){return i._getNodeRef(e.cache,s,t)})}}class g{constructor(){this.name=p.KHR_MATERIALS_UNLIT}getMaterialType(){return r.V9B}extendParams(t,e,i){const n=[];t.color=new r.Q1f(1,1,1),t.opacity=1;const s=e.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const e=s.baseColorFactor;t.color.setRGB(e[0],e[1],e[2],r.Zr2),t.opacity=e[3]}void 0!==s.baseColorTexture&&n.push(i.assignTexture(t,"map",s.baseColorTexture,r.er$))}return Promise.all(n)}}class m{constructor(t){this.parser=t,this.name=p.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(t,e){const i=this.parser.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=i.extensions[this.name].emissiveStrength;return void 0!==n&&(e.emissiveIntensity=n),Promise.resolve()}}class A{constructor(t){this.parser=t,this.name=p.KHR_MATERIALS_CLEARCOAT}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?r.uSd:null}extendMaterialParams(t,e){const i=this.parser,n=i.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],o=n.extensions[this.name];if(void 0!==o.clearcoatFactor&&(e.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(e,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(e.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(e,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(e,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const t=o.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new r.I9Y(t,t)}return Promise.all(s)}}class v{constructor(t){this.parser=t,this.name=p.KHR_MATERIALS_DISPERSION}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?r.uSd:null}extendMaterialParams(t,e){const i=this.parser.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=i.extensions[this.name];return e.dispersion=void 0!==n.dispersion?n.dispersion:0,Promise.resolve()}}class y{constructor(t){this.parser=t,this.name=p.KHR_MATERIALS_IRIDESCENCE}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?r.uSd:null}extendMaterialParams(t,e){const i=this.parser,n=i.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return void 0!==r.iridescenceFactor&&(e.iridescence=r.iridescenceFactor),void 0!==r.iridescenceTexture&&s.push(i.assignTexture(e,"iridescenceMap",r.iridescenceTexture)),void 0!==r.iridescenceIor&&(e.iridescenceIOR=r.iridescenceIor),void 0===e.iridescenceThicknessRange&&(e.iridescenceThicknessRange=[100,400]),void 0!==r.iridescenceThicknessMinimum&&(e.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),void 0!==r.iridescenceThicknessMaximum&&(e.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),void 0!==r.iridescenceThicknessTexture&&s.push(i.assignTexture(e,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(s)}}class b{constructor(t){this.parser=t,this.name=p.KHR_MATERIALS_SHEEN}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?r.uSd:null}extendMaterialParams(t,e){const i=this.parser,n=i.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[];e.sheenColor=new r.Q1f(0,0,0),e.sheenRoughness=0,e.sheen=1;const o=n.extensions[this.name];if(void 0!==o.sheenColorFactor){const t=o.sheenColorFactor;e.sheenColor.setRGB(t[0],t[1],t[2],r.Zr2)}return void 0!==o.sheenRoughnessFactor&&(e.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(e,"sheenColorMap",o.sheenColorTexture,r.er$)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(e,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class _{constructor(t){this.parser=t,this.name=p.KHR_MATERIALS_TRANSMISSION}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?r.uSd:null}extendMaterialParams(t,e){const i=this.parser,n=i.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return void 0!==r.transmissionFactor&&(e.transmission=r.transmissionFactor),void 0!==r.transmissionTexture&&s.push(i.assignTexture(e,"transmissionMap",r.transmissionTexture)),Promise.all(s)}}class x{constructor(t){this.parser=t,this.name=p.KHR_MATERIALS_VOLUME}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?r.uSd:null}extendMaterialParams(t,e){const i=this.parser,n=i.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],o=n.extensions[this.name];e.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(e,"thicknessMap",o.thicknessTexture)),e.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return e.attenuationColor=(new r.Q1f).setRGB(a[0],a[1],a[2],r.Zr2),Promise.all(s)}}class w{constructor(t){this.parser=t,this.name=p.KHR_MATERIALS_IOR}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?r.uSd:null}extendMaterialParams(t,e){const i=this.parser.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=i.extensions[this.name];return e.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}}class E{constructor(t){this.parser=t,this.name=p.KHR_MATERIALS_SPECULAR}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?r.uSd:null}extendMaterialParams(t,e){const i=this.parser,n=i.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],o=n.extensions[this.name];e.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(e,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return e.specularColor=(new r.Q1f).setRGB(a[0],a[1],a[2],r.Zr2),void 0!==o.specularColorTexture&&s.push(i.assignTexture(e,"specularColorMap",o.specularColorTexture,r.er$)),Promise.all(s)}}class C{constructor(t){this.parser=t,this.name=p.EXT_MATERIALS_BUMP}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?r.uSd:null}extendMaterialParams(t,e){const i=this.parser,n=i.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return e.bumpScale=void 0!==r.bumpFactor?r.bumpFactor:1,void 0!==r.bumpTexture&&s.push(i.assignTexture(e,"bumpMap",r.bumpTexture)),Promise.all(s)}}class S{constructor(t){this.parser=t,this.name=p.KHR_MATERIALS_ANISOTROPY}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?r.uSd:null}extendMaterialParams(t,e){const i=this.parser,n=i.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return void 0!==r.anisotropyStrength&&(e.anisotropy=r.anisotropyStrength),void 0!==r.anisotropyRotation&&(e.anisotropyRotation=r.anisotropyRotation),void 0!==r.anisotropyTexture&&s.push(i.assignTexture(e,"anisotropyMap",r.anisotropyTexture)),Promise.all(s)}}class I{constructor(t){this.parser=t,this.name=p.KHR_TEXTURE_BASISU}loadTexture(t){const e=this.parser,i=e.json,n=i.textures[t];if(!n.extensions||!n.extensions[this.name])return null;const s=n.extensions[this.name],r=e.options.ktx2Loader;if(!r){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,s.source,r)}}class M{constructor(t){this.parser=t,this.name=p.EXT_TEXTURE_WEBP}loadTexture(t){const e=this.name,i=this.parser,n=i.json,s=n.textures[t];if(!s.extensions||!s.extensions[e])return null;const r=s.extensions[e],o=n.images[r.source];let a=i.textureLoader;if(o.uri){const t=i.options.manager.getHandler(o.uri);null!==t&&(a=t)}return i.loadTextureImage(t,r.source,a)}}class T{constructor(t){this.parser=t,this.name=p.EXT_TEXTURE_AVIF}loadTexture(t){const e=this.name,i=this.parser,n=i.json,s=n.textures[t];if(!s.extensions||!s.extensions[e])return null;const r=s.extensions[e],o=n.images[r.source];let a=i.textureLoader;if(o.uri){const t=i.options.manager.getHandler(o.uri);null!==t&&(a=t)}return i.loadTextureImage(t,r.source,a)}}class B{constructor(t){this.name=p.EXT_MESHOPT_COMPRESSION,this.parser=t}loadBufferView(t){const e=this.parser.json,i=e.bufferViews[t];if(i.extensions&&i.extensions[this.name]){const t=i.extensions[this.name],n=this.parser.getDependency("buffer",t.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return n.then(function(e){const i=t.byteOffset||0,n=t.byteLength||0,r=t.count,o=t.byteStride,a=new Uint8Array(e,i,n);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(r,o,a,t.mode,t.filter).then(function(t){return t.buffer}):s.ready.then(function(){const e=new ArrayBuffer(r*o);return s.decodeGltfBuffer(new Uint8Array(e),r,o,a,t.mode,t.filter),e})})}return null}}class R{constructor(t){this.name=p.EXT_MESH_GPU_INSTANCING,this.parser=t}createNodeMesh(t){const e=this.parser.json,i=e.nodes[t];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const n=e.meshes[i.mesh];for(const t of n.primitives)if(t.mode!==Q.TRIANGLES&&t.mode!==Q.TRIANGLE_STRIP&&t.mode!==Q.TRIANGLE_FAN&&void 0!==t.mode)return null;const s=i.extensions[this.name].attributes,o=[],a={};for(const t in s)o.push(this.parser.getDependency("accessor",s[t]).then(e=>(a[t]=e,a[t])));return o.length<1?null:(o.push(this.parser.createNodeMesh(t)),Promise.all(o).then(t=>{const e=t.pop(),i=e.isGroup?e.children:[e],n=t[0].count,s=[];for(const t of i){const e=new r.kn4,i=new r.Pq0,o=new r.PTz,l=new r.Pq0(1,1,1),c=new r.ZLX(t.geometry,t.material,n);for(let t=0;t<n;t++)a.TRANSLATION&&i.fromBufferAttribute(a.TRANSLATION,t),a.ROTATION&&o.fromBufferAttribute(a.ROTATION,t),a.SCALE&&l.fromBufferAttribute(a.SCALE,t),c.setMatrixAt(t,e.compose(i,o,l));for(const e in a)if("_COLOR_0"===e){const t=a[e];c.instanceColor=new r.uWO(t.array,t.itemSize,t.normalized)}else"TRANSLATION"!==e&&"ROTATION"!==e&&"SCALE"!==e&&t.geometry.setAttribute(e,a[e]);r.B69.prototype.copy.call(c,t),this.parser.assignFinalMaterial(c),s.push(c)}return e.isGroup?(e.clear(),e.add(...s),e):s[0]}))}}const P="glTF",L=1313821514,D=5130562;class N{constructor(t){this.name=p.KHR_BINARY_GLTF,this.content=null,this.body=null;const e=new DataView(t,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==P)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,s=new DataView(t,12);let r=0;for(;r<n;){const e=s.getUint32(r,!0);r+=4;const n=s.getUint32(r,!0);if(r+=4,n===L){const n=new Uint8Array(t,12+r,e);this.content=i.decode(n)}else if(n===D){const i=12+r;this.body=t.slice(i,i+e)}r+=e}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class O{constructor(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=p.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}decodePrimitive(t,e){const i=this.json,n=this.dracoLoader,s=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,a={},l={},c={};for(const t in o){const e=$[t]||t.toLowerCase();a[e]=o[t]}for(const e in t.attributes){const n=$[e]||e.toLowerCase();if(void 0!==o[e]){const s=i.accessors[t.attributes[e]],r=j[s.componentType];c[n]=r.name,l[n]=!0===s.normalized}}return e.getDependency("bufferView",s).then(function(t){return new Promise(function(e,i){n.decodeDracoFile(t,function(t){for(const e in t.attributes){const i=t.attributes[e],n=l[e];void 0!==n&&(i.normalized=n)}e(t)},a,c,r.Zr2,i)})})}}class k{constructor(){this.name=p.KHR_TEXTURE_TRANSFORM}extendTexture(t,e){return void 0!==e.texCoord&&e.texCoord!==t.channel||void 0!==e.offset||void 0!==e.rotation||void 0!==e.scale?(t=t.clone(),void 0!==e.texCoord&&(t.channel=e.texCoord),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),t.needsUpdate=!0,t):t}}class U{constructor(){this.name=p.KHR_MESH_QUANTIZATION}}class F extends r.lGw{constructor(t,e,i,n){super(t,e,i,n)}copySampleValue_(t){const e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,s=t*n*3+n;for(let t=0;t!==n;t++)e[t]=i[s+t];return e}interpolate_(t,e,i,n){const s=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=n-e,h=(i-e)/c,u=h*h,d=u*h,p=t*l,f=p-l,g=-2*d+3*u,m=d-u,A=1-g,v=m-u+h;for(let t=0;t!==o;t++){const e=r[f+t+o],i=r[f+t+a]*c,n=r[p+t+o],l=r[p+t]*c;s[t]=A*e+v*i+g*n+m*l}return s}}const z=new r.PTz;class V extends F{interpolate_(t,e,i,n){const s=super.interpolate_(t,e,i,n);return z.fromArray(s).normalize().toArray(s),s}}const Q={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},j={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},G={9728:r.hxR,9729:r.k6q,9984:r.pHI,9985:r.kRr,9986:r.Cfg,9987:r.$_I},H={33071:r.ghU,33648:r.kTW,10497:r.GJx},q={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},W={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},K={CUBICSPLINE:void 0,LINEAR:r.PJ3,STEP:r.ljd},X="OPAQUE",Y="MASK",J="BLEND";function Z(t){return void 0===t.DefaultMaterial&&(t.DefaultMaterial=new r._4j({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:r.hB5})),t.DefaultMaterial}function tt(t,e,i){for(const n in i.extensions)void 0===t[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=i.extensions[n])}function et(t,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function it(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(let i=0,n=e.weights.length;i<n;i++)t.morphTargetInfluences[i]=e.weights[i];if(e.extras&&Array.isArray(e.extras.targetNames)){const i=e.extras.targetNames;if(t.morphTargetInfluences.length===i.length){t.morphTargetDictionary={};for(let e=0,n=i.length;e<n;e++)t.morphTargetDictionary[i[e]]=e}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function nt(t){let e;const i=t.extensions&&t.extensions[p.KHR_DRACO_MESH_COMPRESSION];if(e=i?"draco:"+i.bufferView+":"+i.indices+":"+st(i.attributes):t.indices+":"+st(t.attributes)+":"+t.mode,void 0!==t.targets)for(let i=0,n=t.targets.length;i<n;i++)e+=":"+st(t.targets[i]);return e}function st(t){let e="";const i=Object.keys(t).sort();for(let n=0,s=i.length;n<s;n++)e+=i[n]+":"+t[i[n]]+";";return e}function rt(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const ot=new r.kn4;class at{constructor(t={},e={}){this.json=t,this.extensions={},this.plugins={},this.options=e,this.cache=new d,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,n=-1,s=!1,o=-1;if("undefined"!=typeof navigator){const t=navigator.userAgent;i=!0===/^((?!chrome|android).)*safari/i.test(t);const e=t.match(/Version\/(\d+)/);n=i&&e?parseInt(e[1],10):-1,s=t.indexOf("Firefox")>-1,o=s?t.match(/Firefox\/([0-9]+)\./)[1]:-1}"undefined"==typeof createImageBitmap||i&&n<17||s&&o<98?this.textureLoader=new r.Tap(this.options.manager):this.textureLoader=new r.Kzg(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new r.Y9S(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(t){this.extensions=t}setPlugins(t){this.plugins=t}parse(t,e){const i=this,n=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(t){return t._markDefs&&t._markDefs()}),Promise.all(this._invokeAll(function(t){return t.beforeRoot&&t.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(e){const r={scene:e[0][n.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:n.asset,parser:i,userData:{}};return tt(s,r,n),et(r,n),Promise.all(i._invokeAll(function(t){return t.afterRoot&&t.afterRoot(r)})).then(function(){for(const t of r.scenes)t.updateMatrixWorld();t(r)})}).catch(e)}_markDefs(){const t=this.json.nodes||[],e=this.json.skins||[],i=this.json.meshes||[];for(let i=0,n=e.length;i<n;i++){const n=e[i].joints;for(let e=0,i=n.length;e<i;e++)t[n[e]].isBone=!0}for(let e=0,n=t.length;e<n;e++){const n=t[e];void 0!==n.mesh&&(this._addNodeRef(this.meshCache,n.mesh),void 0!==n.skin&&(i[n.mesh].isSkinnedMesh=!0)),void 0!==n.camera&&this._addNodeRef(this.cameraCache,n.camera)}}_addNodeRef(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)}_getNodeRef(t,e,i){if(t.refs[e]<=1)return i;const n=i.clone(),s=(t,e)=>{const i=this.associations.get(t);null!=i&&this.associations.set(e,i);for(const[i,n]of t.children.entries())s(n,e.children[i])};return s(i,n),n.name+="_instance_"+t.uses[e]++,n}_invokeOne(t){const e=Object.values(this.plugins);e.push(this);for(let i=0;i<e.length;i++){const n=t(e[i]);if(n)return n}return null}_invokeAll(t){const e=Object.values(this.plugins);e.unshift(this);const i=[];for(let n=0;n<e.length;n++){const s=t(e[n]);s&&i.push(s)}return i}getDependency(t,e){const i=t+":"+e;let n=this.cache.get(i);if(!n){switch(t){case"scene":n=this.loadScene(e);break;case"node":n=this._invokeOne(function(t){return t.loadNode&&t.loadNode(e)});break;case"mesh":n=this._invokeOne(function(t){return t.loadMesh&&t.loadMesh(e)});break;case"accessor":n=this.loadAccessor(e);break;case"bufferView":n=this._invokeOne(function(t){return t.loadBufferView&&t.loadBufferView(e)});break;case"buffer":n=this.loadBuffer(e);break;case"material":n=this._invokeOne(function(t){return t.loadMaterial&&t.loadMaterial(e)});break;case"texture":n=this._invokeOne(function(t){return t.loadTexture&&t.loadTexture(e)});break;case"skin":n=this.loadSkin(e);break;case"animation":n=this._invokeOne(function(t){return t.loadAnimation&&t.loadAnimation(e)});break;case"camera":n=this.loadCamera(e);break;default:if(n=this._invokeOne(function(i){return i!=this&&i.getDependency&&i.getDependency(t,e)}),!n)throw new Error("Unknown type: "+t)}this.cache.add(i,n)}return n}getDependencies(t){let e=this.cache.get(t);if(!e){const i=this,n=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(n.map(function(e,n){return i.getDependency(t,n)})),this.cache.add(t,e)}return e}loadBuffer(t){const e=this.json.buffers[t],i=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[p.KHR_BINARY_GLTF].body);const n=this.options;return new Promise(function(t,s){i.load(r.r6x.resolveURL(e.uri,n.path),t,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))})})}loadBufferView(t){const e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then(function(t){const i=e.byteLength||0,n=e.byteOffset||0;return t.slice(n,n+i)})}loadAccessor(t){const e=this,i=this.json,n=this.json.accessors[t];if(void 0===n.bufferView&&void 0===n.sparse){const t=q[n.type],e=j[n.componentType],i=!0===n.normalized,s=new e(n.count*t);return Promise.resolve(new r.THS(s,t,i))}const s=[];return void 0!==n.bufferView?s.push(this.getDependency("bufferView",n.bufferView)):s.push(null),void 0!==n.sparse&&(s.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(s).then(function(t){const s=t[0],o=q[n.type],a=j[n.componentType],l=a.BYTES_PER_ELEMENT,c=l*o,h=n.byteOffset||0,u=void 0!==n.bufferView?i.bufferViews[n.bufferView].byteStride:void 0,d=!0===n.normalized;let p,f;if(u&&u!==c){const t=Math.floor(h/u),i="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+t+":"+n.count;let c=e.cache.get(i);c||(p=new a(s,t*u,n.count*u/l),c=new r.eB$(p,u/l),e.cache.add(i,c)),f=new r.eHs(c,o,h%u/l,d)}else p=null===s?new a(n.count*o):new a(s,h,n.count*o),f=new r.THS(p,o,d);if(void 0!==n.sparse){const e=q.SCALAR,i=j[n.sparse.indices.componentType],l=n.sparse.indices.byteOffset||0,c=n.sparse.values.byteOffset||0,h=new i(t[1],l,n.sparse.count*e),u=new a(t[2],c,n.sparse.count*o);null!==s&&(f=new r.THS(f.array.slice(),f.itemSize,f.normalized)),f.normalized=!1;for(let t=0,e=h.length;t<e;t++){const e=h[t];if(f.setX(e,u[t*o]),o>=2&&f.setY(e,u[t*o+1]),o>=3&&f.setZ(e,u[t*o+2]),o>=4&&f.setW(e,u[t*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}f.normalized=d}return f})}loadTexture(t){const e=this.json,i=this.options,n=e.textures[t].source,s=e.images[n];let r=this.textureLoader;if(s.uri){const t=i.manager.getHandler(s.uri);null!==t&&(r=t)}return this.loadTextureImage(t,n,r)}loadTextureImage(t,e,i){const n=this,s=this.json,o=s.textures[t],a=s.images[e],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(e,i).then(function(e){e.flipY=!1,e.name=o.name||a.name||"",""===e.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(e.name=a.uri);const i=(s.samplers||{})[o.sampler]||{};return e.magFilter=G[i.magFilter]||r.k6q,e.minFilter=G[i.minFilter]||r.$_I,e.wrapS=H[i.wrapS]||r.GJx,e.wrapT=H[i.wrapT]||r.GJx,e.generateMipmaps=!e.isCompressedTexture&&e.minFilter!==r.hxR&&e.minFilter!==r.k6q,n.associations.set(e,{textures:t}),e}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(t,e){const i=this,n=this.json,s=this.options;if(void 0!==this.sourceCache[t])return this.sourceCache[t].then(t=>t.clone());const o=n.images[t],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=i.getDependency("bufferView",o.bufferView).then(function(t){c=!0;const e=new Blob([t],{type:o.mimeType});return l=a.createObjectURL(e),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(t){return new Promise(function(i,n){let o=i;!0===e.isImageBitmapLoader&&(o=function(t){const e=new r.gPd(t);e.needsUpdate=!0,i(e)}),e.load(r.r6x.resolveURL(t,s.path),o,void 0,n)})}).then(function(t){var e;return!0===c&&a.revokeObjectURL(l),et(t,o),t.userData.mimeType=o.mimeType||((e=o.uri).search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/)?"image/jpeg":e.search(/\.webp($|\?)/i)>0||0===e.search(/^data\:image\/webp/)?"image/webp":e.search(/\.ktx2($|\?)/i)>0||0===e.search(/^data\:image\/ktx2/)?"image/ktx2":"image/png"),t}).catch(function(t){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),t});return this.sourceCache[t]=h,h}assignTexture(t,e,i,n){const s=this;return this.getDependency("texture",i.index).then(function(r){if(!r)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((r=r.clone()).channel=i.texCoord),s.extensions[p.KHR_TEXTURE_TRANSFORM]){const t=void 0!==i.extensions?i.extensions[p.KHR_TEXTURE_TRANSFORM]:void 0;if(t){const e=s.associations.get(r);r=s.extensions[p.KHR_TEXTURE_TRANSFORM].extendTexture(r,t),s.associations.set(r,e)}}return void 0!==n&&(r.colorSpace=n),t[e]=r,r})}assignFinalMaterial(t){const e=t.geometry;let i=t.material;const n=void 0===e.attributes.tangent,s=void 0!==e.attributes.color,o=void 0===e.attributes.normal;if(t.isPoints){const t="PointsMaterial:"+i.uuid;let e=this.cache.get(t);e||(e=new r.BH$,r.imn.prototype.copy.call(e,i),e.color.copy(i.color),e.map=i.map,e.sizeAttenuation=!1,this.cache.add(t,e)),i=e}else if(t.isLine){const t="LineBasicMaterial:"+i.uuid;let e=this.cache.get(t);e||(e=new r.mrM,r.imn.prototype.copy.call(e,i),e.color.copy(i.color),e.map=i.map,this.cache.add(t,e)),i=e}if(n||s||o){let t="ClonedMaterial:"+i.uuid+":";n&&(t+="derivative-tangents:"),s&&(t+="vertex-colors:"),o&&(t+="flat-shading:");let e=this.cache.get(t);e||(e=i.clone(),s&&(e.vertexColors=!0),o&&(e.flatShading=!0),n&&(e.normalScale&&(e.normalScale.y*=-1),e.clearcoatNormalScale&&(e.clearcoatNormalScale.y*=-1)),this.cache.add(t,e),this.associations.set(e,this.associations.get(i))),i=e}t.material=i}getMaterialType(){return r._4j}loadMaterial(t){const e=this,i=this.json,n=this.extensions,s=i.materials[t];let o;const a={},l=[];if((s.extensions||{})[p.KHR_MATERIALS_UNLIT]){const t=n[p.KHR_MATERIALS_UNLIT];o=t.getMaterialType(),l.push(t.extendParams(a,s,e))}else{const i=s.pbrMetallicRoughness||{};if(a.color=new r.Q1f(1,1,1),a.opacity=1,Array.isArray(i.baseColorFactor)){const t=i.baseColorFactor;a.color.setRGB(t[0],t[1],t[2],r.Zr2),a.opacity=t[3]}void 0!==i.baseColorTexture&&l.push(e.assignTexture(a,"map",i.baseColorTexture,r.er$)),a.metalness=void 0!==i.metallicFactor?i.metallicFactor:1,a.roughness=void 0!==i.roughnessFactor?i.roughnessFactor:1,void 0!==i.metallicRoughnessTexture&&(l.push(e.assignTexture(a,"metalnessMap",i.metallicRoughnessTexture)),l.push(e.assignTexture(a,"roughnessMap",i.metallicRoughnessTexture))),o=this._invokeOne(function(e){return e.getMaterialType&&e.getMaterialType(t)}),l.push(Promise.all(this._invokeAll(function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,a)})))}!0===s.doubleSided&&(a.side=r.$EB);const c=s.alphaMode||X;if(c===J?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,c===Y&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==r.V9B&&(l.push(e.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new r.I9Y(1,1),void 0!==s.normalTexture.scale)){const t=s.normalTexture.scale;a.normalScale.set(t,t)}if(void 0!==s.occlusionTexture&&o!==r.V9B&&(l.push(e.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==r.V9B){const t=s.emissiveFactor;a.emissive=(new r.Q1f).setRGB(t[0],t[1],t[2],r.Zr2)}return void 0!==s.emissiveTexture&&o!==r.V9B&&l.push(e.assignTexture(a,"emissiveMap",s.emissiveTexture,r.er$)),Promise.all(l).then(function(){const i=new o(a);return s.name&&(i.name=s.name),et(i,s),e.associations.set(i,{materials:t}),s.extensions&&tt(n,i,s),i})}createUniqueName(t){const e=r.Nwf.sanitizeNodeName(t||"");return e in this.nodeNamesUsed?e+"_"+ ++this.nodeNamesUsed[e]:(this.nodeNamesUsed[e]=0,e)}loadGeometries(t){const e=this,i=this.extensions,n=this.primitiveCache;function s(t){return i[p.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then(function(i){return lt(i,t,e)})}const o=[];for(let i=0,a=t.length;i<a;i++){const a=t[i],l=nt(a),c=n[l];if(c)o.push(c.promise);else{let t;t=a.extensions&&a.extensions[p.KHR_DRACO_MESH_COMPRESSION]?s(a):lt(new r.LoY,a,e),n[l]={primitive:a,promise:t},o.push(t)}}return Promise.all(o)}loadMesh(t){const e=this,i=this.json,n=this.extensions,s=i.meshes[t],o=s.primitives,a=[];for(let t=0,e=o.length;t<e;t++){const e=void 0===o[t].material?Z(this.cache):this.getDependency("material",o[t].material);a.push(e)}return a.push(e.loadGeometries(o)),Promise.all(a).then(function(i){const a=i.slice(0,i.length-1),l=i[i.length-1],c=[];for(let i=0,u=l.length;i<u;i++){const u=l[i],d=o[i];let p;const f=a[i];if(d.mode===Q.TRIANGLES||d.mode===Q.TRIANGLE_STRIP||d.mode===Q.TRIANGLE_FAN||void 0===d.mode)p=!0===s.isSkinnedMesh?new r.I46(u,f):new r.eaF(u,f),!0===p.isSkinnedMesh&&p.normalizeSkinWeights(),d.mode===Q.TRIANGLE_STRIP?p.geometry=h(p.geometry,r.O49):d.mode===Q.TRIANGLE_FAN&&(p.geometry=h(p.geometry,r.rYR));else if(d.mode===Q.LINES)p=new r.DXC(u,f);else if(d.mode===Q.LINE_STRIP)p=new r.N1A(u,f);else if(d.mode===Q.LINE_LOOP)p=new r.FCc(u,f);else{if(d.mode!==Q.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);p=new r.ONl(u,f)}Object.keys(p.geometry.morphAttributes).length>0&&it(p,s),p.name=e.createUniqueName(s.name||"mesh_"+t),et(p,s),d.extensions&&tt(n,p,d),e.assignFinalMaterial(p),c.push(p)}for(let i=0,n=c.length;i<n;i++)e.associations.set(c[i],{meshes:t,primitives:i});if(1===c.length)return s.extensions&&tt(n,c[0],s),c[0];const u=new r.YJl;s.extensions&&tt(n,u,s),e.associations.set(u,{meshes:t});for(let t=0,e=c.length;t<e;t++)u.add(c[t]);return u})}loadCamera(t){let e;const i=this.json.cameras[t],n=i[i.type];if(n)return"perspective"===i.type?e=new r.ubm(r.cj9.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===i.type&&(e=new r.qUd(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),i.name&&(e.name=this.createUniqueName(i.name)),et(e,i),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(t){const e=this.json.skins[t],i=[];for(let t=0,n=e.joints.length;t<n;t++)i.push(this._loadNodeShallow(e.joints[t]));return void 0!==e.inverseBindMatrices?i.push(this.getDependency("accessor",e.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(t){const i=t.pop(),n=t,s=[],o=[];for(let t=0,a=n.length;t<a;t++){const a=n[t];if(a){s.push(a);const e=new r.kn4;null!==i&&e.fromArray(i.array,16*t),o.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[t])}return new r.EAD(s,o)})}loadAnimation(t){const e=this.json,i=this,n=e.animations[t],s=n.name?n.name:"animation_"+t,o=[],a=[],l=[],c=[],h=[];for(let t=0,e=n.channels.length;t<e;t++){const e=n.channels[t],i=n.samplers[e.sampler],s=e.target,r=s.node,u=void 0!==n.parameters?n.parameters[i.input]:i.input,d=void 0!==n.parameters?n.parameters[i.output]:i.output;void 0!==s.node&&(o.push(this.getDependency("node",r)),a.push(this.getDependency("accessor",u)),l.push(this.getDependency("accessor",d)),c.push(i),h.push(s))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(h)]).then(function(t){const e=t[0],n=t[1],o=t[2],a=t[3],l=t[4],c=[];for(let t=0,s=e.length;t<s;t++){const s=e[t],r=n[t],h=o[t],u=a[t],d=l[t];if(void 0===s)continue;s.updateMatrix&&s.updateMatrix();const p=i._createAnimationTracks(s,r,h,u,d);if(p)for(let t=0;t<p.length;t++)c.push(p[t])}return new r.tz3(s,void 0,c)})}createNodeMesh(t){const e=this.json,i=this,n=e.nodes[t];return void 0===n.mesh?null:i.getDependency("mesh",n.mesh).then(function(t){const e=i._getNodeRef(i.meshCache,n.mesh,t);return void 0!==n.weights&&e.traverse(function(t){if(t.isMesh)for(let e=0,i=n.weights.length;e<i;e++)t.morphTargetInfluences[e]=n.weights[e]}),e})}loadNode(t){const e=this,i=this.json.nodes[t],n=e._loadNodeShallow(t),s=[],r=i.children||[];for(let t=0,i=r.length;t<i;t++)s.push(e.getDependency("node",r[t]));const o=void 0===i.skin?Promise.resolve(null):e.getDependency("skin",i.skin);return Promise.all([n,Promise.all(s),o]).then(function(t){const e=t[0],i=t[1],n=t[2];null!==n&&e.traverse(function(t){t.isSkinnedMesh&&t.bind(n,ot)});for(let t=0,n=i.length;t<n;t++)e.add(i[t]);return e})}_loadNodeShallow(t){const e=this.json,i=this.extensions,n=this;if(void 0!==this.nodeCache[t])return this.nodeCache[t];const s=e.nodes[t],o=s.name?n.createUniqueName(s.name):"",a=[],l=n._invokeOne(function(e){return e.createNodeMesh&&e.createNodeMesh(t)});return l&&a.push(l),void 0!==s.camera&&a.push(n.getDependency("camera",s.camera).then(function(t){return n._getNodeRef(n.cameraCache,s.camera,t)})),n._invokeAll(function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)}).forEach(function(t){a.push(t)}),this.nodeCache[t]=Promise.all(a).then(function(e){let a;if(a=!0===s.isBone?new r.$Kf:e.length>1?new r.YJl:1===e.length?e[0]:new r.B69,a!==e[0])for(let t=0,i=e.length;t<i;t++)a.add(e[t]);if(s.name&&(a.userData.name=s.name,a.name=o),et(a,s),s.extensions&&tt(i,a,s),void 0!==s.matrix){const t=new r.kn4;t.fromArray(s.matrix),a.applyMatrix4(t)}else void 0!==s.translation&&a.position.fromArray(s.translation),void 0!==s.rotation&&a.quaternion.fromArray(s.rotation),void 0!==s.scale&&a.scale.fromArray(s.scale);if(n.associations.has(a)){if(void 0!==s.mesh&&n.meshCache.refs[s.mesh]>1){const t=n.associations.get(a);n.associations.set(a,{...t})}}else n.associations.set(a,{});return n.associations.get(a).nodes=t,a}),this.nodeCache[t]}loadScene(t){const e=this.extensions,i=this.json.scenes[t],n=this,s=new r.YJl;i.name&&(s.name=n.createUniqueName(i.name)),et(s,i),i.extensions&&tt(e,s,i);const o=i.nodes||[],a=[];for(let t=0,e=o.length;t<e;t++)a.push(n.getDependency("node",o[t]));return Promise.all(a).then(function(t){for(let e=0,i=t.length;e<i;e++)s.add(t[e]);return n.associations=(t=>{const e=new Map;for(const[t,i]of n.associations)(t instanceof r.imn||t instanceof r.gPd)&&e.set(t,i);return t.traverse(t=>{const i=n.associations.get(t);null!=i&&e.set(t,i)}),e})(s),s})}_createAnimationTracks(t,e,i,n,s){const o=[],a=t.name?t.name:t.uuid,l=[];let c;switch(W[s.path]===W.weights?t.traverse(function(t){t.morphTargetInfluences&&l.push(t.name?t.name:t.uuid)}):l.push(a),W[s.path]){case W.weights:c=r.Hit;break;case W.rotation:c=r.MBL;break;case W.translation:case W.scale:c=r.RiT;break;default:if(1===i.itemSize)c=r.Hit;else c=r.RiT}const h=void 0!==n.interpolation?K[n.interpolation]:r.PJ3,u=this._getArrayFromAccessor(i);for(let t=0,i=l.length;t<i;t++){const i=new c(l[t]+"."+W[s.path],e.array,u,h);"CUBICSPLINE"===n.interpolation&&this._createCubicSplineTrackInterpolant(i),o.push(i)}return o}_getArrayFromAccessor(t){let e=t.array;if(t.normalized){const t=rt(e.constructor),i=new Float32Array(e.length);for(let n=0,s=e.length;n<s;n++)i[n]=e[n]*t;e=i}return e}_createCubicSplineTrackInterpolant(t){t.createInterpolant=function(t){return new(this instanceof r.MBL?V:F)(this.times,this.values,this.getValueSize()/3,t)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function lt(t,e,i){const n=e.attributes,s=[];function o(e,n){return i.getDependency("accessor",e).then(function(e){t.setAttribute(n,e)})}for(const e in n){const i=$[e]||e.toLowerCase();i in t.attributes||s.push(o(n[e],i))}if(void 0!==e.indices&&!t.index){const n=i.getDependency("accessor",e.indices).then(function(e){t.setIndex(e)});s.push(n)}return r.ppV.workingColorSpace!==r.Zr2&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${r.ppV.workingColorSpace}" not supported.`),et(t,e),function(t,e,i){const n=e.attributes,s=new r.NRn;if(void 0===n.POSITION)return;{const t=i.json.accessors[n.POSITION],e=t.min,o=t.max;if(void 0===e||void 0===o)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(s.set(new r.Pq0(e[0],e[1],e[2]),new r.Pq0(o[0],o[1],o[2])),t.normalized){const e=rt(j[t.componentType]);s.min.multiplyScalar(e),s.max.multiplyScalar(e)}}const o=e.targets;if(void 0!==o){const t=new r.Pq0,e=new r.Pq0;for(let n=0,s=o.length;n<s;n++){const s=o[n];if(void 0!==s.POSITION){const n=i.json.accessors[s.POSITION],r=n.min,o=n.max;if(void 0!==r&&void 0!==o){if(e.setX(Math.max(Math.abs(r[0]),Math.abs(o[0]))),e.setY(Math.max(Math.abs(r[1]),Math.abs(o[1]))),e.setZ(Math.max(Math.abs(r[2]),Math.abs(o[2]))),n.normalized){const t=rt(j[n.componentType]);e.multiplyScalar(t)}t.max(e)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(t)}t.boundingBox=s;const a=new r.iyt;s.getCenter(a.center),a.radius=s.min.distanceTo(s.max)/2,t.boundingSphere=a}(t,e,i),Promise.all(s).then(function(){return void 0!==e.targets?function(t,e,i){let n=!1,s=!1,r=!1;for(let t=0,i=e.length;t<i;t++){const i=e[t];if(void 0!==i.POSITION&&(n=!0),void 0!==i.NORMAL&&(s=!0),void 0!==i.COLOR_0&&(r=!0),n&&s&&r)break}if(!n&&!s&&!r)return Promise.resolve(t);const o=[],a=[],l=[];for(let c=0,h=e.length;c<h;c++){const h=e[c];if(n){const e=void 0!==h.POSITION?i.getDependency("accessor",h.POSITION):t.attributes.position;o.push(e)}if(s){const e=void 0!==h.NORMAL?i.getDependency("accessor",h.NORMAL):t.attributes.normal;a.push(e)}if(r){const e=void 0!==h.COLOR_0?i.getDependency("accessor",h.COLOR_0):t.attributes.color;l.push(e)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(e){const i=e[0],o=e[1],a=e[2];return n&&(t.morphAttributes.position=i),s&&(t.morphAttributes.normal=o),r&&(t.morphAttributes.color=a),t.morphTargetsRelative=!0,t})}(t,e.targets,i):t})}class ct{constructor(t=4){this.pool=t,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0,this.workerCreator=null}_initWorker(t){if(!this.workers[t]){const e=this.workerCreator();e.addEventListener("message",this._onMessage.bind(this,t)),this.workers[t]=e}}_getIdleWorker(){for(let t=0;t<this.pool;t++)if(!(this.workerStatus&1<<t))return t;return-1}_onMessage(t,e){const i=this.workersResolve[t];if(i&&i(e),this.queue.length){const{resolve:e,msg:i,transfer:n}=this.queue.shift();this.workersResolve[t]=e,this.workers[t].postMessage(i,n)}else this.workerStatus^=1<<t}setWorkerCreator(t){this.workerCreator=t}setWorkerLimit(t){this.pool=t}postMessage(t,e){return new Promise(i=>{const n=this._getIdleWorker();-1!==n?(this._initWorker(n),this.workerStatus|=1<<n,this.workersResolve[n]=i,this.workers[n].postMessage(t,e)):this.queue.push({resolve:i,msg:t,transfer:e})})}dispose(){this.workers.forEach(t=>t.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const ht=9,ut=15,dt=16,pt=22,ft=37,gt=43,mt=76,At=83,vt=97,yt=100,bt=103,_t=109,xt=131,wt=132,Et=133,Ct=134,St=137,It=138,Mt=141,Tt=142,Bt=145,Rt=146,Pt=148,Lt=152,Dt=157,Nt=158,Ot=165,kt=166,Ut=1000066e3;class Ft{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class zt{constructor(t,e,i,n){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(t.buffer,t.byteOffset+e,i),this._littleEndian=n,this._offset=0}_nextUint8(){const t=this._dataView.getUint8(this._offset);return this._offset+=1,t}_nextUint16(){const t=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,t}_nextUint32(){const t=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,t}_nextUint64(){const t=this._dataView.getUint32(this._offset,this._littleEndian)+2**32*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,t}_nextInt32(){const t=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,t}_nextUint8Array(t){const e=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,t);return this._offset+=t,e}_skip(t){return this._offset+=t,this}_scan(t,e){void 0===e&&(e=0);const i=this._offset;let n=0;for(;this._dataView.getUint8(this._offset)!==e&&n<t;)n++,this._offset++;return n<t&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+i,n)}}new Uint8Array([0]);const Vt=[171,75,84,88,32,50,48,187,13,10,26,10];function Qt(t){return(new TextDecoder).decode(t)}let jt,Gt,Ht;const qt={env:{emscripten_notify_memory_growth:function(t){Ht=new Uint8Array(Gt.exports.memory.buffer)}}};class $t{init(){return jt||(jt="undefined"!=typeof fetch?fetch("data:application/wasm;base64,"+Wt).then(t=>t.arrayBuffer()).then(t=>WebAssembly.instantiate(t,qt)).then(this._init):WebAssembly.instantiate(Buffer.from(Wt,"base64"),qt).then(this._init),jt)}_init(t){Gt=t.instance,qt.env.emscripten_notify_memory_growth(0)}decode(t,e=0){if(!Gt)throw new Error("ZSTDDecoder: Await .init() before decoding.");const i=t.byteLength,n=Gt.exports.malloc(i);Ht.set(t,n),e=e||Number(Gt.exports.ZSTD_findDecompressedSize(n,i));const s=Gt.exports.malloc(e),r=Gt.exports.ZSTD_decompress(s,e,n,i),o=Ht.slice(s,s+r);return Gt.exports.free(n),Gt.exports.free(s),o}}const Wt="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ",Kt="display-p3",Xt=(r.KLL,r.VxR,r.VxR,new WeakMap);let Yt,Jt=0;class Zt extends r.aHM{constructor(t){super(t),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new ct,this.workerSourceURL="",this.workerConfig=null,"undefined"!=typeof MSC_TRANSCODER&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(t){return this.transcoderPath=t,this}setWorkerLimit(t){return this.workerPool.setWorkerLimit(t),this}async detectSupportAsync(t){return this.workerConfig={astcSupported:await t.hasFeatureAsync("texture-compression-astc"),astcHDRSupported:!1,etc1Supported:await t.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await t.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await t.hasFeatureAsync("texture-compression-bc"),bptcSupported:await t.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await t.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport(t){return!0===t.isWebGPURenderer?this.workerConfig={astcSupported:t.hasFeature("texture-compression-astc"),astcHDRSupported:!1,etc1Supported:t.hasFeature("texture-compression-etc1"),etc2Supported:t.hasFeature("texture-compression-etc2"),dxtSupported:t.hasFeature("texture-compression-bc"),bptcSupported:t.hasFeature("texture-compression-bptc"),pvrtcSupported:t.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:t.extensions.has("WEBGL_compressed_texture_astc"),astcHDRSupported:t.extensions.has("WEBGL_compressed_texture_astc")&&t.extensions.get("WEBGL_compressed_texture_astc").getSupportedProfiles().includes("hdr"),etc1Supported:t.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:t.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:t.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:t.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:t.extensions.has("WEBGL_compressed_texture_pvrtc")||t.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}init(){if(!this.transcoderPending){const t=new r.Y9S(this.manager);t.setPath(this.transcoderPath),t.setWithCredentials(this.withCredentials);const e=t.loadAsync("basis_transcoder.js"),i=new r.Y9S(this.manager);i.setPath(this.transcoderPath),i.setResponseType("arraybuffer"),i.setWithCredentials(this.withCredentials);const n=i.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([e,n]).then(([t,e])=>{const i=Zt.BasisWorker.toString(),n=["/* constants */","let _EngineFormat = "+JSON.stringify(Zt.EngineFormat),"let _EngineType = "+JSON.stringify(Zt.EngineType),"let _TranscoderFormat = "+JSON.stringify(Zt.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(Zt.BasisFormat),"/* basis_transcoder.js */",t,"/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n])),this.transcoderBinary=e,this.workerPool.setWorkerCreator(()=>{const t=new Worker(this.workerSourceURL),e=this.transcoderBinary.slice(0);return t.postMessage({type:"init",config:this.workerConfig,transcoderBinary:e},[e]),t})}),Jt>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),Jt++}return this.transcoderPending}load(t,e,i,n){if(null===this.workerConfig)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const s=new r.Y9S(this.manager);s.setPath(this.path),s.setCrossOrigin(this.crossOrigin),s.setWithCredentials(this.withCredentials),s.setResponseType("arraybuffer"),s.load(t,t=>{this.parse(t,e,n)},i,n)}parse(t,e,i){if(null===this.workerConfig)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");if(Xt.has(t)){return Xt.get(t).promise.then(e).catch(i)}this._createTexture(t).then(t=>e?e(t):null).catch(i)}_createTextureFrom(t,e){const{type:i,error:n,data:{faces:s,width:o,height:a,format:l,type:c,dfdFlags:h}}=t;if("error"===i)return Promise.reject(n);let u;if(6===e.faceCount)u=new r.c5h(s,l,c);else{const t=s[0].mipmaps;u=e.layerCount>1?new r.iOZ(t,o,a,e.layerCount,l,c):new r.FvD(t,o,a,l,c)}return u.minFilter=1===s[0].mipmaps.length?r.k6q:r.$_I,u.magFilter=r.k6q,u.generateMipmaps=!1,u.needsUpdate=!0,u.colorSpace=ne(e),u.premultiplyAlpha=!!(1&h),u}async _createTexture(t,e={}){const i=function(t){const e=new Uint8Array(t.buffer,t.byteOffset,Vt.length);if(e[0]!==Vt[0]||e[1]!==Vt[1]||e[2]!==Vt[2]||e[3]!==Vt[3]||e[4]!==Vt[4]||e[5]!==Vt[5]||e[6]!==Vt[6]||e[7]!==Vt[7]||e[8]!==Vt[8]||e[9]!==Vt[9]||e[10]!==Vt[10]||e[11]!==Vt[11])throw new Error("Missing KTX 2.0 identifier.");const i=new Ft,n=17*Uint32Array.BYTES_PER_ELEMENT,s=new zt(t,Vt.length,n,!0);i.vkFormat=s._nextUint32(),i.typeSize=s._nextUint32(),i.pixelWidth=s._nextUint32(),i.pixelHeight=s._nextUint32(),i.pixelDepth=s._nextUint32(),i.layerCount=s._nextUint32(),i.faceCount=s._nextUint32();const r=s._nextUint32();i.supercompressionScheme=s._nextUint32();const o=s._nextUint32(),a=s._nextUint32(),l=s._nextUint32(),c=s._nextUint32(),h=s._nextUint64(),u=s._nextUint64(),d=new zt(t,Vt.length+n,3*r*8,!0);for(let e=0;e<r;e++)i.levels.push({levelData:new Uint8Array(t.buffer,t.byteOffset+d._nextUint64(),d._nextUint64()),uncompressedByteLength:d._nextUint64()});const p=new zt(t,o,a,!0),f={vendorId:p._skip(4)._nextUint16(),descriptorType:p._nextUint16(),versionNumber:p._nextUint16(),descriptorBlockSize:p._nextUint16(),colorModel:p._nextUint8(),colorPrimaries:p._nextUint8(),transferFunction:p._nextUint8(),flags:p._nextUint8(),texelBlockDimension:[p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8()],bytesPlane:[p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8()],samples:[]},g=(f.descriptorBlockSize/4-6)/4;for(let t=0;t<g;t++){const e={bitOffset:p._nextUint16(),bitLength:p._nextUint8(),channelType:p._nextUint8(),samplePosition:[p._nextUint8(),p._nextUint8(),p._nextUint8(),p._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&e.channelType?(e.sampleLower=p._nextInt32(),e.sampleUpper=p._nextInt32()):(e.sampleLower=p._nextUint32(),e.sampleUpper=p._nextUint32()),f.samples[t]=e}i.dataFormatDescriptor.length=0,i.dataFormatDescriptor.push(f);const m=new zt(t,l,c,!0);for(;m._offset<c;){const t=m._nextUint32(),e=m._scan(t),n=Qt(e);if(i.keyValue[n]=m._nextUint8Array(t-e.byteLength-1),n.match(/^ktx/i)){const t=Qt(i.keyValue[n]);i.keyValue[n]=t.substring(0,t.lastIndexOf("\0"))}m._skip(t%4?4-t%4:0)}if(u<=0)return i;const A=new zt(t,h,u,!0),v=A._nextUint16(),y=A._nextUint16(),b=A._nextUint32(),_=A._nextUint32(),x=A._nextUint32(),w=A._nextUint32(),E=[];for(let t=0;t<r;t++)E.push({imageFlags:A._nextUint32(),rgbSliceByteOffset:A._nextUint32(),rgbSliceByteLength:A._nextUint32(),alphaSliceByteOffset:A._nextUint32(),alphaSliceByteLength:A._nextUint32()});const C=h+A._offset,S=C+b,I=S+_,M=I+x,T=new Uint8Array(t.buffer,t.byteOffset+C,b),B=new Uint8Array(t.buffer,t.byteOffset+S,_),R=new Uint8Array(t.buffer,t.byteOffset+I,x),P=new Uint8Array(t.buffer,t.byteOffset+M,w);return i.globalData={endpointCount:v,selectorCount:y,imageDescs:E,endpointsData:T,selectorsData:B,tablesData:R,extendedData:P},i}(new Uint8Array(t)),n=i.vkFormat===Ut&&167===i.dataFormatDescriptor[0].colorModel;if(!(0===i.vkFormat||n&&!this.workerConfig.astcHDRSupported))return async function(t){const{vkFormat:e}=t;if(void 0===ee[e])throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let i;2===t.supercompressionScheme&&(Yt||(Yt=new Promise(async t=>{const e=new $t;await e.init(),t(e)})),i=await Yt);const n=[];for(let s=0;s<t.levels.length;s++){const o=Math.max(1,t.pixelWidth>>s),a=Math.max(1,t.pixelHeight>>s),l=t.pixelDepth?Math.max(1,t.pixelDepth>>s):0,c=t.levels[s];let h,u;if(0===t.supercompressionScheme)h=c.levelData;else{if(2!==t.supercompressionScheme)throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");h=i.decode(c.levelData,c.uncompressedByteLength)}u=ie[e]===r.RQf?new Float32Array(h.buffer,h.byteOffset,h.byteLength/Float32Array.BYTES_PER_ELEMENT):ie[e]===r.ix0?new Uint16Array(h.buffer,h.byteOffset,h.byteLength/Uint16Array.BYTES_PER_ELEMENT):h,n.push({data:u,width:o,height:a,depth:l})}let s;if(te.has(ee[e]))s=0===t.pixelDepth?new r.GYF(n[0].data,t.pixelWidth,t.pixelHeight):new r.dYF(n[0].data,t.pixelWidth,t.pixelHeight,t.pixelDepth);else{if(t.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");s=new r.FvD(n,t.pixelWidth,t.pixelHeight),s.minFilter=1===n.length?r.k6q:r.$_I,s.magFilter=r.k6q}return s.mipmaps=n,s.type=ie[e],s.format=ee[e],s.colorSpace=ne(t),s.needsUpdate=!0,Promise.resolve(s)}(i);const s=e,o=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:t,taskConfig:s},[t])).then(t=>this._createTextureFrom(t.data,i));return Xt.set(t,{promise:o}),o}dispose(){this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),Jt--}}Zt.BasisFormat={ETC1S:0,UASTC:1,UASTC_HDR:2},Zt.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16,BC6H:22,RGB_HALF:24,RGBA_HALF:25},Zt.EngineFormat={RGBAFormat:r.GWd,RGBA_ASTC_4x4_Format:r.qa3,RGB_BPTC_UNSIGNED_Format:r.W9U,RGBA_BPTC_Format:r.Fn,RGBA_ETC2_EAC_Format:r.KDk,RGBA_PVRTC_4BPPV1_Format:r.HXV,RGBA_S3TC_DXT5_Format:r.BXX,RGB_ETC1_Format:r.CVz,RGB_ETC2_Format:r.Riy,RGB_PVRTC_4BPPV1_Format:r.k6Q,RGBA_S3TC_DXT1_Format:r.Nz6},Zt.EngineType={UnsignedByteType:r.OUM,HalfFloatType:r.ix0,FloatType:r.RQf},Zt.BasisWorker=function(){let t,e,i;const n=_EngineFormat,s=_EngineType,r=_TranscoderFormat,o=_BasisFormat;self.addEventListener("message",function(n){const r=n.data;switch(r.type){case"init":t=r.config,a=r.transcoderBinary,e=new Promise(t=>{i={wasmBinary:a,onRuntimeInitialized:t},BASIS(i)}).then(()=>{i.initializeBasis(),void 0===i.KTX2File&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")});break;case"transcode":e.then(()=>{try{const{faces:e,buffers:n,width:a,height:u,hasAlpha:d,format:p,type:f,dfdFlags:g}=function(e){const n=new i.KTX2File(new Uint8Array(e));function r(){n.close(),n.delete()}if(!n.isValid())throw r(),new Error("THREE.KTX2Loader:\tInvalid or unsupported .ktx2 file");let a;if(n.isUASTC())a=o.UASTC;else if(n.isETC1S())a=o.ETC1S;else{if(!n.isHDR())throw new Error("THREE.KTX2Loader: Unknown Basis encoding");a=o.UASTC_HDR}const u=n.getWidth(),d=n.getHeight(),p=n.getLayers()||1,f=n.getLevels(),g=n.getFaces(),m=n.getHasAlpha(),A=n.getDFDFlags(),{transcoderFormat:v,engineFormat:y,engineType:b}=function(e,i,n,s){const r=l[e];for(let o=0;o<r.length;o++){const a=r[o];if(a.if&&!t[a.if])continue;if(!a.basisFormat.includes(e))continue;if(s&&a.transcoderFormat.length<2)continue;if(a.needsPowerOfTwo&&(!c(i)||!c(n)))continue;return{transcoderFormat:a.transcoderFormat[s?1:0],engineFormat:a.engineFormat[s?1:0],engineType:a.engineType[0]}}throw new Error("THREE.KTX2Loader: Failed to identify transcoding target.")}(a,u,d,m);if(!u||!d||!f)throw r(),new Error("THREE.KTX2Loader:\tInvalid texture");if(!n.startTranscoding())throw r(),new Error("THREE.KTX2Loader: .startTranscoding failed");const _=[],x=[];for(let t=0;t<g;t++){const e=[];for(let i=0;i<f;i++){const o=[];let a,l;for(let e=0;e<p;e++){const c=n.getImageLevelInfo(i,e,t);0!==t||0!==i||0!==e||c.origWidth%4==0&&c.origHeight%4==0||console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),f>1?(a=c.origWidth,l=c.origHeight):(a=c.width,l=c.height);let h=new Uint8Array(n.getImageTranscodedSizeInBytes(i,e,0,v));const u=n.transcodeImage(h,i,e,t,v,0,-1,-1);if(b===s.HalfFloatType&&(h=new Uint16Array(h.buffer,h.byteOffset,h.byteLength/Uint16Array.BYTES_PER_ELEMENT)),!u)throw r(),new Error("THREE.KTX2Loader: .transcodeImage failed.");o.push(h)}const c=h(o);e.push({data:c,width:a,height:l}),x.push(c.buffer)}_.push({mipmaps:e,width:u,height:d,format:y,type:b})}return r(),{faces:_,buffers:x,width:u,height:d,hasAlpha:m,dfdFlags:A,format:y,type:b}}(r.buffer);self.postMessage({type:"transcode",id:r.id,data:{faces:e,width:a,height:u,hasAlpha:d,format:p,type:f,dfdFlags:g}},n)}catch(t){console.error(t),self.postMessage({type:"error",id:r.id,error:t.message})}})}var a});const a=[{if:"astcSupported",basisFormat:[o.UASTC],transcoderFormat:[r.ASTC_4x4,r.ASTC_4x4],engineFormat:[n.RGBA_ASTC_4x4_Format,n.RGBA_ASTC_4x4_Format],engineType:[s.UnsignedByteType],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[r.BC7_M5,r.BC7_M5],engineFormat:[n.RGBA_BPTC_Format,n.RGBA_BPTC_Format],engineType:[s.UnsignedByteType],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[r.BC1,r.BC3],engineFormat:[n.RGBA_S3TC_DXT1_Format,n.RGBA_S3TC_DXT5_Format],engineType:[s.UnsignedByteType],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[r.ETC1,r.ETC2],engineFormat:[n.RGB_ETC2_Format,n.RGBA_ETC2_EAC_Format],engineType:[s.UnsignedByteType],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[r.ETC1],engineFormat:[n.RGB_ETC1_Format],engineType:[s.UnsignedByteType],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[r.PVRTC1_4_RGB,r.PVRTC1_4_RGBA],engineFormat:[n.RGB_PVRTC_4BPPV1_Format,n.RGBA_PVRTC_4BPPV1_Format],engineType:[s.UnsignedByteType],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0},{if:"bptcSupported",basisFormat:[o.UASTC_HDR],transcoderFormat:[r.BC6H],engineFormat:[n.RGB_BPTC_UNSIGNED_Format],engineType:[s.HalfFloatType],priorityHDR:1,needsPowerOfTwo:!1},{basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[r.RGBA32,r.RGBA32],engineFormat:[n.RGBAFormat,n.RGBAFormat],engineType:[s.UnsignedByteType,s.UnsignedByteType],priorityETC1S:100,priorityUASTC:100,needsPowerOfTwo:!1},{basisFormat:[o.UASTC_HDR],transcoderFormat:[r.RGBA_HALF],engineFormat:[n.RGBAFormat],engineType:[s.HalfFloatType],priorityHDR:100,needsPowerOfTwo:!1}],l={[o.ETC1S]:a.filter(t=>t.basisFormat.includes(o.ETC1S)).sort((t,e)=>t.priorityUASTC-e.priorityUASTC),[o.UASTC]:a.filter(t=>t.basisFormat.includes(o.UASTC)).sort((t,e)=>t.priorityUASTC-e.priorityUASTC),[o.UASTC_HDR]:a.filter(t=>t.basisFormat.includes(o.UASTC_HDR)).sort((t,e)=>t.priorityHDR-e.priorityHDR)};function c(t){return t<=2||!(t&t-1)&&0!==t}function h(t){if(1===t.length)return t[0];let e=0;for(let i=0;i<t.length;i++){e+=t[i].byteLength}const i=new Uint8Array(e);let n=0;for(let e=0;e<t.length;e++){const s=t[e];i.set(s,n),n+=s.byteLength}return i}};const te=new Set([r.GWd,r.paN,r.VT0]),ee={[_t]:r.GWd,[vt]:r.GWd,[ft]:r.GWd,[gt]:r.GWd,[bt]:r.paN,[At]:r.paN,[dt]:r.paN,[pt]:r.paN,[yt]:r.VT0,[mt]:r.VT0,[ut]:r.VT0,[ht]:r.VT0,[Pt]:r.Riy,[Lt]:r.KDk,[Ut]:r.qa3,[Nt]:r.qa3,[Dt]:r.qa3,[kt]:r.Qrf,[Ot]:r.Qrf,[Et]:r.Nz6,[Ct]:r.Nz6,[xt]:r.IE4,[wt]:r.IE4,[It]:r.jR7,[St]:r.jR7,[Tt]:r.BXX,[Mt]:r.BXX,[Rt]:r.Fn,[Bt]:r.Fn},ie={[_t]:r.RQf,[vt]:r.ix0,[ft]:r.OUM,[gt]:r.OUM,[bt]:r.RQf,[At]:r.ix0,[dt]:r.OUM,[pt]:r.OUM,[yt]:r.RQf,[mt]:r.ix0,[ut]:r.OUM,[ht]:r.OUM,[Pt]:r.OUM,[Lt]:r.OUM,[Ut]:r.ix0,[kt]:r.OUM,[Ot]:r.OUM};function ne(t){const e=t.dataFormatDescriptor[0];return 1===e.colorPrimaries?2===e.transferFunction?r.er$:r.Zr2:10===e.colorPrimaries?2===e.transferFunction?Kt:"display-p3-linear":(0===e.colorPrimaries||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${e.colorPrimaries}"`),r.jf0)}var se=i(6351),re=i(7229);class oe{set dracoPath(t){this.customDracoPath=t,null!==this.gltfLoader.dracoLoader&&this.gltfLoader.dracoLoader.setDecoderPath(this.customDracoPath)}setAssetPath(t){t=t.endsWith("/")?t.slice(0,-1):t,this.customDracoPath||(this.dracoPath=`${t}/js/draco/`),this.gltfLoader.ktx2Loader.setTranscoderPath(`${t}/js/basis/`)}constructor(t,e){this.loading={},this.customDracoPath=null,this.loadingManager=t;const i=new a;i.setDecoderPath(Te+"/js/draco/"),this.renderer=e,this.gltfLoader=new u(t),this.gltfLoader.setDRACOLoader(i),this.gltfLoader.setMeshoptDecoder(c);const n=new Zt(t);n.setTranscoderPath(Te+"/js/basis/"),this.gltfLoader.setKTX2Loader(n),setTimeout(()=>{n.detectSupport(this.renderer.views[0].renderer)},0)}dispose(){this.gltfLoader.dracoLoader.dispose(),this.gltfLoader.ktx2Loader.dispose(),this.gltfLoader.setDRACOLoader(null),this.gltfLoader.setKTX2Loader(null),this.gltfLoader=null}isValid(t){const e=t.split(".").pop().toLowerCase();return oe.extensions.indexOf(e)>=0}isValidMimeType(t){return oe.mimeTypes.indexOf(t)>=0}get(t,{signal:e}={}){this.loadingManager.itemStart(t);let i=r.r6x.extractUrlBase(t);return this.loadModel(t,{signal:e}).then(t=>this.gltfLoader.parseAsync(t,i)).then(t=>{if(t.userData.gltfExtensions){const e=t.userData.gltfExtensions.KHR_materials_variants;if(e){const i=t.parser;t.scene.userData.variants=e.variants,t.scene.userData.variants.variantMaterials={},t.scene.userData.parser=i}}return this.createModelGroup(t,{signal:e})}).catch(e=>{throw this.loadingManager.itemError(t),e}).finally(()=>this.loadingManager.itemEnd(t))}async loadModel(t,{signal:e}={}){if(e){const i=()=>{var i,n;const s=null!==(n=null===(i=this.loading[t])||void 0===i?void 0:i.listeners.findIndex(t=>t.signal===e))&&void 0!==n?n:-1;if(-1==s)return;const{onerror:r}=this.loading[t].listeners.splice(s,1)[0];r(new DOMException(e.reason,"AbortError")),0==this.loading[t].listeners.length&&this.loading[t].abortController.abort()};e.addEventListener("abort",i)}if(!this.loading[t]){const{listeners:e,abortController:{signal:i}}=this.loading[t]={listeners:[],abortController:new AbortController};fetch(t,{signal:i}).then(t=>{if(!t.ok)throw new Error(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`);return t.arrayBuffer()}).finally(()=>{delete this.loading[t]}).then(t=>{i.aborted||e.forEach(({onload:e})=>e(t))},t=>{e.forEach(({onerror:e})=>e(t)),"AbortError"!=t.name&&"ABORT_ERR"!=t.name&&console.error(t)})}return new Promise((i,n)=>{this.loading[t].listeners.push({onload:i,onerror:n,signal:e})})}async createModelGroup(t,{signal:e}={}){if(e.aborted)throw new DOMException(e.reason,"AbortError");const i=t.scene;i.traverse(e=>{if("Mesh"===e.type){const i=e;if(i.castShadow=!0,i.animations=t.animations,"MeshBasicMaterial"===i.material.type){const t=i.material,e=new r._4j;e.color=t.color,e.opacity=t.opacity,e.transparent=t.opacity<1||!!t.alphaMap,e.map=t.map,e.shadowSide=t.shadowSide,i.material=e}const n=i.material;n.map&&(n.map.colorSpace=r.er$),i.geometry.computeBoundingBox(),(0,re.zv)(n),n.userData.paramCopy={},(0,re.AG)(n),n.flatShading&&(i.geometry.computeVertexNormals(),n.flatShading=!1,console.warn("Normals unavailable so they have been calculated. For best outcomes, please provide normals with geometry.")),n.userData.objectSpaceNormals&&n.normalMap&&(n.normalMapType=r.vyJ,n.needsUpdate=!0)}});try{if(await this.renderer.views[0].renderer.compileAsync(i,this.renderer.activeCamera,this.renderer.activeScene),e.aborted)throw new DOMException(e.reason,"AbortError")}catch(t){try{(0,se.nZ)(i)}catch(t){console.warn("Failed to dispose of cancelled glTF scene",t)}throw t}return i}}oe.extensions=["gltf","glb"],oe.mimeTypes=["model/gltf+json","model/gltf-binary"];const ae=/^[og]\s*(.+)?/,le=/^mtllib /,ce=/^usemtl /,he=/^usemap /,ue=/\s+/,de=new r.Pq0,pe=new r.Pq0,fe=new r.Pq0,ge=new r.Pq0,me=new r.Pq0,Ae=new r.Q1f;function ve(){const t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==e);const i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(t,e){const i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);const n={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==i?i.smooth:this.smooth,groupStart:void 0!==i?i.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){const e={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){const e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(let t=this.materials.length-1;t>=0;t--)this.materials[t].groupCount<=0&&this.materials.splice(t,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},i&&i.name&&"function"==typeof i.clone){const t=i.clone(0);t.inherited=!0,this.object.materials.push(t)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){const i=parseInt(t,10);return 3*(i>=0?i-1:i+e/3)},parseNormalIndex:function(t,e){const i=parseInt(t,10);return 3*(i>=0?i-1:i+e/3)},parseUVIndex:function(t,e){const i=parseInt(t,10);return 2*(i>=0?i-1:i+e/2)},addVertex:function(t,e,i){const n=this.vertices,s=this.object.geometry.vertices;s.push(n[t+0],n[t+1],n[t+2]),s.push(n[e+0],n[e+1],n[e+2]),s.push(n[i+0],n[i+1],n[i+2])},addVertexPoint:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,i){const n=this.normals,s=this.object.geometry.normals;s.push(n[t+0],n[t+1],n[t+2]),s.push(n[e+0],n[e+1],n[e+2]),s.push(n[i+0],n[i+1],n[i+2])},addFaceNormal:function(t,e,i){const n=this.vertices,s=this.object.geometry.normals;de.fromArray(n,t),pe.fromArray(n,e),fe.fromArray(n,i),me.subVectors(fe,pe),ge.subVectors(de,pe),me.cross(ge),me.normalize(),s.push(me.x,me.y,me.z),s.push(me.x,me.y,me.z),s.push(me.x,me.y,me.z)},addColor:function(t,e,i){const n=this.colors,s=this.object.geometry.colors;void 0!==n[t]&&s.push(n[t+0],n[t+1],n[t+2]),void 0!==n[e]&&s.push(n[e+0],n[e+1],n[e+2]),void 0!==n[i]&&s.push(n[i+0],n[i+1],n[i+2])},addUV:function(t,e,i){const n=this.uvs,s=this.object.geometry.uvs;s.push(n[t+0],n[t+1]),s.push(n[e+0],n[e+1]),s.push(n[i+0],n[i+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,i,n,s,r,o,a,l){const c=this.vertices.length;let h=this.parseVertexIndex(t,c),u=this.parseVertexIndex(e,c),d=this.parseVertexIndex(i,c);if(this.addVertex(h,u,d),this.addColor(h,u,d),void 0!==o&&""!==o){const t=this.normals.length;h=this.parseNormalIndex(o,t),u=this.parseNormalIndex(a,t),d=this.parseNormalIndex(l,t),this.addNormal(h,u,d)}else this.addFaceNormal(h,u,d);if(void 0!==n&&""!==n){const t=this.uvs.length;h=this.parseUVIndex(n,t),u=this.parseUVIndex(s,t),d=this.parseUVIndex(r,t),this.addUV(h,u,d),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const e=this.vertices.length;for(let i=0,n=t.length;i<n;i++){const n=this.parseVertexIndex(t[i],e);this.addVertexPoint(n),this.addColor(n)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";const i=this.vertices.length,n=this.uvs.length;for(let e=0,n=t.length;e<n;e++)this.addVertexLine(this.parseVertexIndex(t[e],i));for(let t=0,i=e.length;t<i;t++)this.addUVLine(this.parseUVIndex(e[t],n))}};return t.startObject("",!1),t}class ye extends r.aHM{constructor(t){super(t),this.materials=null}load(t,e,i,n){const s=this,o=new r.Y9S(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(i){try{e(s.parse(i))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}},i,n)}setMaterials(t){return this.materials=t,this}parse(t){const e=new ve;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));const i=t.split("\n");let n=[];for(let t=0,s=i.length;t<s;t++){const s=i[t].trimStart();if(0===s.length)continue;const o=s.charAt(0);if("#"!==o)if("v"===o){const t=s.split(ue);switch(t[0]){case"v":e.vertices.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),t.length>=7?(Ae.setRGB(parseFloat(t[4]),parseFloat(t[5]),parseFloat(t[6]),r.er$),e.colors.push(Ae.r,Ae.g,Ae.b)):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]));break;case"vt":e.uvs.push(parseFloat(t[1]),parseFloat(t[2]))}}else if("f"===o){const t=s.slice(1).trim().split(ue),i=[];for(let e=0,n=t.length;e<n;e++){const n=t[e];if(n.length>0){const t=n.split("/");i.push(t)}}const n=i[0];for(let t=1,s=i.length-1;t<s;t++){const s=i[t],r=i[t+1];e.addFace(n[0],s[0],r[0],n[1],s[1],r[1],n[2],s[2],r[2])}}else if("l"===o){const t=s.substring(1).trim().split(" ");let i=[];const n=[];if(-1===s.indexOf("/"))i=t;else for(let e=0,s=t.length;e<s;e++){const s=t[e].split("/");""!==s[0]&&i.push(s[0]),""!==s[1]&&n.push(s[1])}e.addLineGeometry(i,n)}else if("p"===o){const t=s.slice(1).trim().split(" ");e.addPointGeometry(t)}else if(null!==(n=ae.exec(s))){const t=(" "+n[0].slice(1).trim()).slice(1);e.startObject(t)}else if(ce.test(s))e.object.startMaterial(s.substring(7).trim(),e.materialLibraries);else if(le.test(s))e.materialLibraries.push(s.substring(7).trim());else if(he.test(s))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===o){if(n=s.split(" "),n.length>1){const t=n[1].trim().toLowerCase();e.object.smooth="0"!==t&&"off"!==t}else e.object.smooth=!0;const t=e.object.currentMaterial();t&&(t.smooth=e.object.smooth)}else{if("\0"===s)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+s+'"')}}e.finalize();const s=new r.YJl;s.materialLibraries=[].concat(e.materialLibraries);if(!0===!(1===e.objects.length&&0===e.objects[0].geometry.vertices.length))for(let t=0,i=e.objects.length;t<i;t++){const i=e.objects[t],n=i.geometry,o=i.materials,a="Line"===n.type,l="Points"===n.type;let c=!1;if(0===n.vertices.length)continue;const h=new r.LoY;h.setAttribute("position",new r.qtW(n.vertices,3)),n.normals.length>0&&h.setAttribute("normal",new r.qtW(n.normals,3)),n.colors.length>0&&(c=!0,h.setAttribute("color",new r.qtW(n.colors,3))),!0===n.hasUVIndices&&h.setAttribute("uv",new r.qtW(n.uvs,2));const u=[];for(let t=0,i=o.length;t<i;t++){const i=o[t],n=i.name+"_"+i.smooth+"_"+c;let s=e.materials[n];if(null!==this.materials)if(s=this.materials.create(i.name),!a||!s||s instanceof r.mrM){if(l&&s&&!(s instanceof r.BH$)){const t=new r.BH$({size:10,sizeAttenuation:!1});r.imn.prototype.copy.call(t,s),t.color.copy(s.color),t.map=s.map,s=t}}else{const t=new r.mrM;r.imn.prototype.copy.call(t,s),t.color.copy(s.color),s=t}void 0===s&&(s=a?new r.mrM:l?new r.BH$({size:1,sizeAttenuation:!1}):new r.tXL,s.name=i.name,s.flatShading=!i.smooth,s.vertexColors=c,e.materials[n]=s),u.push(s)}let d;if(u.length>1){for(let t=0,e=o.length;t<e;t++){const e=o[t];h.addGroup(e.groupStart,e.groupCount,t)}d=a?new r.DXC(h,u):l?new r.ONl(h,u):new r.eaF(h,u)}else d=a?new r.DXC(h,u[0]):l?new r.ONl(h,u[0]):new r.eaF(h,u[0]);d.name=i.name,s.add(d)}else if(e.vertices.length>0){const t=new r.BH$({size:1,sizeAttenuation:!1}),i=new r.LoY;i.setAttribute("position",new r.qtW(e.vertices,3)),e.colors.length>0&&void 0!==e.colors[0]&&(i.setAttribute("color",new r.qtW(e.colors,3)),t.vertexColors=!0);const n=new r.ONl(i,t);s.add(n)}return s}}const be=new r.Q1f;class _e extends r.aHM{constructor(t){super(t),this.propertyNameMapping={},this.customPropertyMapping={}}load(t,e,i,n){const s=this,o=new r.Y9S(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(i){try{e(s.parse(i))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}},i,n)}setPropertyNameMapping(t){this.propertyNameMapping=t}setCustomPropertyNameMapping(t){this.customPropertyMapping=t}parse(t){function e(t,e=0){let i="";const n=/^ply([\s\S]*)end_header(\r\n|\r|\n)/.exec(t);null!==n&&(i=n[1]);const s={comments:[],elements:[],headerLength:e,objInfo:""},r=i.split(/\r\n|\r|\n/);let o;function a(t,e){const i={type:t[0]};return"list"===i.type?(i.name=t[3],i.countType=t[1],i.itemType=t[2]):i.name=t[1],i.name in e&&(i.name=e[i.name]),i}for(let t=0;t<r.length;t++){let e=r[t];if(e=e.trim(),""===e)continue;const i=e.split(/\s+/),n=i.shift();switch(e=i.join(" "),n){case"format":s.format=i[0],s.version=i[1];break;case"comment":s.comments.push(e);break;case"element":void 0!==o&&s.elements.push(o),o={},o.name=i[0],o.count=parseInt(i[1]),o.properties=[];break;case"property":o.properties.push(a(i,p.propertyNameMapping));break;case"obj_info":s.objInfo=e;break;default:console.log("unhandled",n,i)}}return void 0!==o&&s.elements.push(o),s}function i(t,e){switch(e){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(t);case"float":case"double":case"float32":case"float64":return parseFloat(t)}}function n(t,e){const n={};for(let s=0;s<t.length;s++){if(e.empty())return null;if("list"===t[s].type){const r=[],o=i(e.next(),t[s].countType);for(let n=0;n<o;n++){if(e.empty())return null;r.push(i(e.next(),t[s].itemType))}n[t[s].name]=r}else n[t[s].name]=i(e.next(),t[s].type)}return n}function s(){const t={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[],faceVertexColors:[]};for(const e of Object.keys(p.customPropertyMapping))t[e]=[];return t}function o(t){const e=t.map(t=>t.name);function i(t){for(let i=0,n=t.length;i<n;i++){const n=t[i];if(e.includes(n))return n}return null}return{attrX:i(["x","px","posx"])||"x",attrY:i(["y","py","posy"])||"y",attrZ:i(["z","pz","posz"])||"z",attrNX:i(["nx","normalx"]),attrNY:i(["ny","normaly"]),attrNZ:i(["nz","normalz"]),attrS:i(["s","u","texture_u","tx"]),attrT:i(["t","v","texture_v","ty"]),attrR:i(["red","diffuse_red","r","diffuse_r"]),attrG:i(["green","diffuse_green","g","diffuse_g"]),attrB:i(["blue","diffuse_blue","b","diffuse_b"])}}function a(t,e){const i=s();let r,a;r=null!==(a=/end_header\s+(\S[\s\S]*\S|\S)\s*$/.exec(t))?a[1].split(/\s+/):[];const h=new xe(r);t:for(let t=0;t<e.elements.length;t++){const s=e.elements[t],r=o(s.properties);for(let t=0;t<s.count;t++){const t=n(s.properties,h);if(!t)break t;c(i,s.name,t,r)}}return l(i)}function l(t){let e=new r.LoY;t.indices.length>0&&e.setIndex(t.indices),e.setAttribute("position",new r.qtW(t.vertices,3)),t.normals.length>0&&e.setAttribute("normal",new r.qtW(t.normals,3)),t.uvs.length>0&&e.setAttribute("uv",new r.qtW(t.uvs,2)),t.colors.length>0&&e.setAttribute("color",new r.qtW(t.colors,3)),(t.faceVertexUvs.length>0||t.faceVertexColors.length>0)&&(e=e.toNonIndexed(),t.faceVertexUvs.length>0&&e.setAttribute("uv",new r.qtW(t.faceVertexUvs,2)),t.faceVertexColors.length>0&&e.setAttribute("color",new r.qtW(t.faceVertexColors,3)));for(const i of Object.keys(p.customPropertyMapping))t[i].length>0&&e.setAttribute(i,new r.qtW(t[i],p.customPropertyMapping[i].length));return e.computeBoundingSphere(),e}function c(t,e,i,n){if("vertex"===e){t.vertices.push(i[n.attrX],i[n.attrY],i[n.attrZ]),null!==n.attrNX&&null!==n.attrNY&&null!==n.attrNZ&&t.normals.push(i[n.attrNX],i[n.attrNY],i[n.attrNZ]),null!==n.attrS&&null!==n.attrT&&t.uvs.push(i[n.attrS],i[n.attrT]),null!==n.attrR&&null!==n.attrG&&null!==n.attrB&&(be.setRGB(i[n.attrR]/255,i[n.attrG]/255,i[n.attrB]/255,r.er$),t.colors.push(be.r,be.g,be.b));for(const e of Object.keys(p.customPropertyMapping))for(const n of p.customPropertyMapping[e])t[e].push(i[n])}else if("face"===e){const e=i.vertex_indices||i.vertex_index,s=i.texcoord;3===e.length?(t.indices.push(e[0],e[1],e[2]),s&&6===s.length&&(t.faceVertexUvs.push(s[0],s[1]),t.faceVertexUvs.push(s[2],s[3]),t.faceVertexUvs.push(s[4],s[5]))):4===e.length&&(t.indices.push(e[0],e[1],e[3]),t.indices.push(e[1],e[2],e[3])),null!==n.attrR&&null!==n.attrG&&null!==n.attrB&&(be.setRGB(i[n.attrR]/255,i[n.attrG]/255,i[n.attrB]/255,r.er$),t.faceVertexColors.push(be.r,be.g,be.b),t.faceVertexColors.push(be.r,be.g,be.b),t.faceVertexColors.push(be.r,be.g,be.b))}}function h(t,e){const i={};let n=0;for(let s=0;s<e.length;s++){const r=e[s],o=r.valueReader;if("list"===r.type){const e=[],s=r.countReader.read(t+n);n+=r.countReader.size;for(let i=0;i<s;i++)e.push(o.read(t+n)),n+=o.size;i[r.name]=e}else i[r.name]=o.read(t+n),n+=o.size}return[i,n]}function u(t,e,i){function n(t,e,i){switch(e){case"int8":case"char":return{read:e=>t.getInt8(e),size:1};case"uint8":case"uchar":return{read:e=>t.getUint8(e),size:1};case"int16":case"short":return{read:e=>t.getInt16(e,i),size:2};case"uint16":case"ushort":return{read:e=>t.getUint16(e,i),size:2};case"int32":case"int":return{read:e=>t.getInt32(e,i),size:4};case"uint32":case"uint":return{read:e=>t.getUint32(e,i),size:4};case"float32":case"float":return{read:e=>t.getFloat32(e,i),size:4};case"float64":case"double":return{read:e=>t.getFloat64(e,i),size:8}}}for(let s=0,r=t.length;s<r;s++){const r=t[s];"list"===r.type?(r.countReader=n(e,r.countType,i),r.valueReader=n(e,r.itemType,i)):r.valueReader=n(e,r.type,i)}}let d;const p=this;if(t instanceof ArrayBuffer){const i=new Uint8Array(t),{headerText:n,headerLength:r}=function(t){let e=0,i=!0,n="";const s=[],r=(new TextDecoder).decode(t.subarray(0,5)),o=/^ply\r\n/.test(r);do{const r=String.fromCharCode(t[e++]);"\n"!==r&&"\r"!==r?n+=r:("end_header"===n&&(i=!1),""!==n&&(s.push(n),n=""))}while(i&&e<t.length);return!0===o&&e++,{headerText:s.join("\r")+"\r",headerLength:e}}(i),p=e(n,r);if("ascii"===p.format){d=a((new TextDecoder).decode(i),p)}else d=function(t,e){const i=s(),n="binary_little_endian"===e.format,r=new DataView(t,e.headerLength);let a,d=0;for(let t=0;t<e.elements.length;t++){const s=e.elements[t],l=s.properties,p=o(l);u(l,r,n);for(let t=0;t<s.count;t++){a=h(d,l),d+=a[1];const t=a[0];c(i,s.name,t,p)}}return l(i)}(t,p)}else d=a(t,e(t));return d}}class xe{constructor(t){this.arr=t,this.i=0}empty(){return this.i>=this.arr.length}next(){return this.arr[this.i++]}}class we{constructor(t){this.objLoader=new ye(t),this.plyLoader=new _e(t)}isValid(t){const e=t.split(".").pop().toLowerCase();return we.extensions.indexOf(e)>=0}get(t){const e=t.split(".").pop().toLowerCase();return new Promise((i,n)=>{if("obj"===e)this.objLoader.load(t,e=>{const s=e.children[0].geometry;return s&&"Geometry"===s.type||"BufferGeometry"===s.type?i(s):n(new Error(`Can't parse geometry from '${t}'`))});else{if("ply"!==e)throw new Error(`Can't load geometry, unknown extension: '${e}' in '${t}'`);this.plyLoader.load(t,e=>e&&"Geometry"===e.type||"BufferGeometry"===e.type?i(e):n(new Error(`Can't parse geometry from '${t}'`)))}})}}we.extensions=["obj","ply"];class Ee extends r.BRH{constructor(t){super(t),this.type=r.ix0}parse(t){const e=function(t,e){switch(t){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(e||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(e||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(e||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(e||""))}},i=function(t,e,i){e=e||1024;let n=t.pos,s=-1,r=0,o="",a=String.fromCharCode.apply(null,new Uint16Array(t.subarray(n,n+128)));for(;0>(s=a.indexOf("\n"))&&r<e&&n<t.byteLength;)o+=a,r+=a.length,n+=128,a+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(n,n+128)));return-1<s&&(!1!==i&&(t.pos+=r+s+1),o+a.slice(0,s))},n=function(t,e,i,n){const s=t[e+3],r=Math.pow(2,s-128)/255;i[n+0]=t[e+0]*r,i[n+1]=t[e+1]*r,i[n+2]=t[e+2]*r,i[n+3]=1},s=function(t,e,i,n){const s=t[e+3],o=Math.pow(2,s-128)/255;i[n+0]=r.GxU.toHalfFloat(Math.min(t[e+0]*o,65504)),i[n+1]=r.GxU.toHalfFloat(Math.min(t[e+1]*o,65504)),i[n+2]=r.GxU.toHalfFloat(Math.min(t[e+2]*o,65504)),i[n+3]=r.GxU.toHalfFloat(1)},o=new Uint8Array(t);o.pos=0;const a=function(t){const n=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,r=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,a={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;for((t.pos>=t.byteLength||!(l=i(t)))&&e(1,"no header found"),(c=l.match(/^#\?(\S+)/))||e(3,"bad initial token"),a.valid|=1,a.programtype=c[1],a.string+=l+"\n";l=i(t),!1!==l;)if(a.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(n))&&(a.gamma=parseFloat(c[1])),(c=l.match(s))&&(a.exposure=parseFloat(c[1])),(c=l.match(r))&&(a.valid|=2,a.format=c[1]),(c=l.match(o))&&(a.valid|=4,a.height=parseInt(c[1],10),a.width=parseInt(c[2],10)),2&a.valid&&4&a.valid)break}else a.comments+=l+"\n";return 2&a.valid||e(3,"missing format specifier"),4&a.valid||e(3,"missing image size specifier"),a}(o),l=a.width,c=a.height,h=function(t,i,n){const s=i;if(s<8||s>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);s!==(t[2]<<8|t[3])&&e(3,"wrong scanline width");const r=new Uint8Array(4*i*n);r.length||e(4,"unable to allocate buffer space");let o=0,a=0;const l=4*s,c=new Uint8Array(4),h=new Uint8Array(l);let u=n;for(;u>0&&a<t.byteLength;){a+4>t.byteLength&&e(1),c[0]=t[a++],c[1]=t[a++],c[2]=t[a++],c[3]=t[a++],2==c[0]&&2==c[1]&&(c[2]<<8|c[3])==s||e(3,"bad rgbe scanline format");let i,n=0;for(;n<l&&a<t.byteLength;){i=t[a++];const s=i>128;if(s&&(i-=128),(0===i||n+i>l)&&e(3,"bad scanline data"),s){const e=t[a++];for(let t=0;t<i;t++)h[n++]=e}else h.set(t.subarray(a,a+i),n),n+=i,a+=i}const d=s;for(let t=0;t<d;t++){let e=0;r[o]=h[t+e],e+=s,r[o+1]=h[t+e],e+=s,r[o+2]=h[t+e],e+=s,r[o+3]=h[t+e],o+=4}u--}return r}(o.subarray(o.pos),l,c);let u,d,p;switch(this.type){case r.RQf:p=h.length/4;const t=new Float32Array(4*p);for(let e=0;e<p;e++)n(h,4*e,t,4*e);u=t,d=r.RQf;break;case r.ix0:p=h.length/4;const e=new Uint16Array(4*p);for(let t=0;t<p;t++)s(h,4*t,e,4*t);u=e,d=r.ix0;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:l,height:c,data:u,header:a.string,gamma:a.gamma,exposure:a.exposure,type:d}}setDataType(t){return this.type=t,this}load(t,e,i,n){return super.load(t,function(t,i){switch(t.type){case r.RQf:case r.ix0:t.colorSpace=r.Zr2,t.minFilter=r.k6q,t.magFilter=r.k6q,t.generateMipmaps=!1,t.flipY=!0}e&&e(t,i)},i,n)}}class Ce{constructor(t){this.textureLoader=new r.Tap(t),this.hdriLoader=new Ee(t)}isValid(t){const e=t.split(".").pop().toLowerCase();return Ce.extensions.indexOf(e)>=0}isValidMimeType(t){return Ce.mimeTypes.indexOf(t)>=0}get(t){return new Promise((e,i)=>{t.endsWith(".hdr")?this.hdriLoader.load(t,t=>{e(t)},null,t=>{console.error(t),i(new Error(t.message))}):this.textureLoader.load(t,t=>{e(t)},null,t=>{console.error(t),i(new Error(t.message))})})}getImmediate(t){return this.textureLoader.load(t,null,null,t=>{console.error(t)})}}Ce.extensions=["jpg","png"],Ce.mimeTypes=["image/jpeg","image/png"];class Se{constructor(t){this._customFontPath=null,this._loadingManager=t,this._textureLoader=new r.Tap(t),this._cache={}}set fontPath(t){this._customFontPath=t}get fontPath(){return this._customFontPath}get(t){return this._cache[t]}async load(t){if(this._cache[t])return Promise.resolve(this._cache[t]);this._loadingManager.itemStart(t);const e=this.fontPath,i=e?e+t+".json":Te+t+".json",n=e?e+t+".png":Te+t+".png",s=fetch(i,{headers:{Accept:"application/json"}}).then(e=>{if(!e.ok)throw this._loadingManager.itemError(t),new Error(`failed to load bitmap font descriptor: '${i}', status: ${e.status} ${e.statusText}`);return e.json()}),r=new Promise((t,e)=>{this._textureLoader.load(n,i=>i?t(i):e(new Error(`failed to load font texture from '${n}'`)))});return Promise.all([s,r]).then(e=>{const i={descriptor:e[0],texture:e[1]};return this._cache[t]=i,this._loadingManager.itemEnd(t),i})}}var Ie=i(161),Me=i(3889);const Te="https://cdn.jsdelivr.net/gh/smithsonian/dpo-voyager@latest/assets/";class Be extends n.Ay{constructor(t,e){super(t,e),this.systemAssetPath=null;const i=this.assetManager.loadingManager;this.fileLoader=new s(i),this.modelLoader=new oe(i,this.renderer),this.geometryLoader=new we(i),this.textureLoader=new Ce(i),this.fontReader=new Se(i)}dispose(){this.modelLoader.dispose(),super.dispose()}get assetManager(){return this.getMainComponent(Ie.A)}get renderer(){return this.getMainComponent(Me.A)}setDracoPath(t){this.modelLoader.dracoPath=t}setSystemAssetPath(t){this.fontReader.fontPath=t,this.systemAssetPath=t,this.modelLoader.setAssetPath(t)}getSystemAssetUrl(t){return(this.systemAssetPath||Te)+t}async getJSON(t){const e=this.assetManager.getAssetUrl(t);return this.fileLoader.getJSON(e)}async getText(t){const e=this.assetManager.getAssetUrl(t);return this.fileLoader.getText(e)}async getModel(t,{signal:e}={}){const i=this.assetManager.getAssetUrl(t);return this.modelLoader.get(i,{signal:e})}async getGeometry(t){const e=this.assetManager.getAssetUrl(t);return this.geometryLoader.get(e)}async getTexture(t){const e=this.assetManager.getAssetUrl(t);return this.textureLoader.get(e)}async getFont(t){const e=this.assetManager.getAssetUrl(t);return this.fontReader.load(e)}async getSystemTexture(t){const e=this.getSystemAssetUrl(t);return this.textureLoader.get(e)}async getSystemJSON(t){const e=this.getSystemAssetUrl(t);return this.fileLoader.getJSON(e)}}Be.typeName="CVAssetReader",Be.text="AssetReader",Be.icon="",Be.isSystemSingleton=!0},3627:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var n=i(3331);const s=[];class r extends n.A{static getTypeName(t){return"function"==typeof t?t.typeName:"object"==typeof t?t.constructor.typeName:t}constructor(t){super({knownEvents:!1});const e=t.typeName;if(!e)throw new Error("root type must have a 'typeName' member");this._rootTypeName=e,this._objLists={[this._rootTypeName]:[]},this._objTags={},this._objDict={}}add(t){const e=t.id;if("string"==typeof e){if(void 0!==this._objDict[e])throw new Error("object already registered");this._objDict[e]=t}let i,n=t;const s=this._rootTypeName,r={type:"",add:!0,remove:!1,object:t};do{n=Object.getPrototypeOf(n),i=n.constructor.typeName,i&&((this._objLists[i]||(this._objLists[i]=[])).push(t),r.type=i,this.emit(r))}while(i!==s)}remove(t){const e=t.id;if("string"==typeof e){if(this._objDict[e]!==t)throw new Error("object not registered");delete this._objDict[e]}let i,n=t;const s=this._rootTypeName,r={type:"",add:!1,remove:!0,object:t};do{if(n=Object.getPrototypeOf(n),i=n.constructor.typeName,i){r.type=i;const e=this._objLists[i];e.splice(e.indexOf(t),1),this.emit(r)}}while(i!==s)}addByTag(t,e){if(!t||"tag"===t)throw new Error("illegal tag name");(this._objTags[t]||(this._objTags[t]=[])).push(e);const i={type:"tag",add:!0,remove:!1,object:e,tag:t};this.emit(i),i.type=t,this.emit(i)}removeByTag(t,e){if(!t||"tag"===t)throw new Error("illegal tag name");const i=this._objTags[t];if(i){const n=i.indexOf(e);if(n>=0){const s={type:"tag",add:!1,remove:!0,object:e,tag:t};return this.emit(s),s.type=t,this.emit(s),i.splice(n,1),!0}}return!1}clear(){this.cloneArray().forEach(t=>this.remove(t))}get length(){return this._objLists[this._rootTypeName].length}count(t){const e=this._objLists[this.getTypeName(t)];return e?e.length:0}has(t){if("function"==typeof t){const e=this._objLists[t.typeName];return!!e&&e.length>0}if("string"==typeof t){const e=this._objLists[t];return!!e&&e.length>0}const e=this._objLists[t.constructor.typeName];return e&&e.indexOf(t)>=0}contains(t){const e=t.id;if("string"==typeof e)return!!this._objDict[e];const i=this._objLists[t.constructor.typeName];return i&&i.indexOf(t)>=0}get(t,e=!1){const i=this.getTypeName(t),n=this._objLists[i],s=n?n[0]:void 0;if(!e&&!s)throw new Error(`no instances of class '${i}' in object registry`);return s}getArray(t){return this._objLists[this.getTypeName(t)]||s}cloneArray(t){return this.getArray(t).slice()}getById(t){return this._objDict[t]}getDictionary(){return this._objDict}getByTag(t){return this._objTags[t]||s}on(t,e,i){super.on(this.getTypeName(t),e,i)}once(t,e,i){super.once(this.getTypeName(t),e,i)}off(t,e,i){super.off(this.getTypeName(t),e,i)}getTypeName(t){return"function"==typeof t?t.typeName:"object"==typeof t?t.constructor.typeName:t||this._rootTypeName}}},3644:(t,e,i)=>{"use strict";i.d(e,{A:()=>j});var n=i(3423),s=i(5240),r=i(4640),o=i(6351);const a=new r.Pq0,l=new r.kn4;class c extends r.DXC{constructor(t,e){e=Object.assign({},c.defaultProps,e);const i=new r.NRn;i.makeEmpty(),(0,o.g6)(t,i);const n=e.length,s=[i.min.x,i.min.y,i.min.z],a=[i.max.x,i.max.y,i.max.z],l=[(a[0]-s[0])*n,(a[1]-s[1])*n,(a[2]-s[2])*n];let h,u,d=isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2]);d&&e.axes?(h=[0,0,0,n,0,0,0,0,0,0,0,0,0,n,0,0,0,0,0,0,0,0,0,n,0,0,0],u=[.65,.23,.29,.65,.23,.29,.65,.23,.29,.43,.63,.11,.43,.63,.11,.43,.63,.11,.25,.3,.88,.25,.3,.88,.25,.3,.88]):h=d?[s[0],s[1],s[2],s[0]+l[0],s[1],s[2],s[0],s[1],s[2],s[0],s[1]+l[1],s[2],s[0],s[1],s[2],s[0],s[1],s[2]+l[2],a[0],s[1],s[2],a[0]-l[0],s[1],s[2],a[0],s[1],s[2],a[0],s[1]+l[1],s[2],a[0],s[1],s[2],a[0],s[1],s[2]+l[2],s[0],a[1],s[2],s[0]+l[0],a[1],s[2],s[0],a[1],s[2],s[0],a[1]-l[1],s[2],s[0],a[1],s[2],s[0],a[1],s[2]+l[2],s[0],s[1],a[2],s[0]+l[0],s[1],a[2],s[0],s[1],a[2],s[0],s[1]+l[1],a[2],s[0],s[1],a[2],s[0],s[1],a[2]-l[2],s[0],a[1],a[2],s[0]+l[0],a[1],a[2],s[0],a[1],a[2],s[0],a[1]-l[1],a[2],s[0],a[1],a[2],s[0],a[1],a[2]-l[2],a[0],s[1],a[2],a[0]-l[0],s[1],a[2],a[0],s[1],a[2],a[0],s[1]+l[1],a[2],a[0],s[1],a[2],a[0],s[1],a[2]-l[2],a[0],a[1],s[2],a[0]-l[0],a[1],s[2],a[0],a[1],s[2],a[0],a[1]-l[1],s[2],a[0],a[1],s[2],a[0],a[1],s[2]+l[2],a[0],a[1],a[2],a[0]-l[0],a[1],a[2],a[0],a[1],a[2],a[0],a[1]-l[1],a[2],a[0],a[1],a[2],a[0],a[1],a[2]-l[2]]:[-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1,0,0,1];const p=new r.LoY;p.setAttribute("position",new r.qtW(h,3)),u&&p.setAttribute("color",new r.qtW(u,3));super(p,new r.mrM({color:e.color,vertexColors:!!u,toneMapped:!1,depthTest:!1})),this.renderOrder=1}update(){}dispose(){this.geometry.dispose(),this.material.dispose()}static expandBoundingBox(t,e,i){const n=t.geometry;if(void 0!==n){let s=t;for(l.identity();s&&s!==e;)l.premultiply(s.matrix),s=s.parent;if(n.isGeometry){const t=n.vertices;for(let e=0,n=t.length;e<n;++e)a.copy(t[e]).applyMatrix4(l),i.expandByPoint(a)}else if(n.isBufferGeometry){const t=n.attributes.position;if(void 0!==t)for(let e=0,n=t.count;e<n;++e)a.fromBufferAttribute(t,e).applyMatrix4(l),i.expandByPoint(a)}}const s=t.children;for(let t=0,n=s.length;t<n;++t)c.expandBoundingBox(s[t],e,i)}}c.defaultProps={color:new r.Q1f("#ffd633"),length:.25,axes:!1};const h=new r.NRn,u=new r.Pq0;class d extends r.CmU{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new r.qtW([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new r.qtW([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(t){const e=this.attributes.instanceStart,i=this.attributes.instanceEnd;return void 0!==e&&(e.applyMatrix4(t),i.applyMatrix4(t),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(t){let e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));const i=new r.LuO(e,6,1);return this.setAttribute("instanceStart",new r.eHs(i,3,0)),this.setAttribute("instanceEnd",new r.eHs(i,3,3)),this.instanceCount=this.attributes.instanceStart.count,this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(t){let e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));const i=new r.LuO(e,6,1);return this.setAttribute("instanceColorStart",new r.eHs(i,3,0)),this.setAttribute("instanceColorEnd",new r.eHs(i,3,3)),this}fromWireframeGeometry(t){return this.setPositions(t.attributes.position.array),this}fromEdgesGeometry(t){return this.setPositions(t.attributes.position.array),this}fromMesh(t){return this.fromWireframeGeometry(new r.XJ7(t.geometry)),this}fromLineSegments(t){const e=t.geometry;return this.setPositions(e.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new r.NRn);const t=this.attributes.instanceStart,e=this.attributes.instanceEnd;void 0!==t&&void 0!==e&&(this.boundingBox.setFromBufferAttribute(t),h.setFromBufferAttribute(e),this.boundingBox.union(h))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new r.iyt),null===this.boundingBox&&this.computeBoundingBox();const t=this.attributes.instanceStart,e=this.attributes.instanceEnd;if(void 0!==t&&void 0!==e){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let n=0;for(let s=0,r=t.count;s<r;s++)u.fromBufferAttribute(t,s),n=Math.max(n,i.distanceToSquared(u)),u.fromBufferAttribute(e,s),n=Math.max(n,i.distanceToSquared(u));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}}var p=i(9979);p.fCn.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new r.I9Y(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},p.zkh.line={uniforms:r.LlO.merge([p.fCn.common,p.fCn.fog,p.fCn.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tworldStart = start.xyz;\n\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t#else\n\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );\n\t\t\t\tvec3 worldUp = normalize( cross( worldDir, tmpFwd ) );\n\t\t\t\tvec3 worldFwd = cross( worldDir, worldUp );\n\t\t\t\tworldPos = position.y < 0.5 ? start: end;\n\n\t\t\t\t// height offset\n\t\t\t\tfloat hw = linewidth * 0.5;\n\t\t\t\tworldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// cap extension\n\t\t\t\t\tworldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;\n\n\t\t\t\t\t// add width to the box\n\t\t\t\t\tworldPos.xyz += worldFwd * hw;\n\n\t\t\t\t\t// endcaps\n\t\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\t\tworldPos.xyz -= worldFwd * 2.0 * hw;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x /= aspect;\n\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\toffset += - dir;\n\n\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\toffset += dir;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth;\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t// select end\n\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset *= clip.w;\n\n\t\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tfloat alpha = opacity;\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <colorspace_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class f extends r.BKk{constructor(t){super({type:"LineMaterial",uniforms:r.LlO.clone(p.zkh.line.uniforms),vertexShader:p.zkh.line.vertexShader,fragmentShader:p.zkh.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(t)}get color(){return this.uniforms.diffuse.value}set color(t){this.uniforms.diffuse.value=t}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(t){!0===t?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(t){this.uniforms.linewidth&&(this.uniforms.linewidth.value=t)}get dashed(){return"USE_DASH"in this.defines}set dashed(t){!0===t!==this.dashed&&(this.needsUpdate=!0),!0===t?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(t){this.uniforms.dashScale.value=t}get dashSize(){return this.uniforms.dashSize.value}set dashSize(t){this.uniforms.dashSize.value=t}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(t){this.uniforms.dashOffset.value=t}get gapSize(){return this.uniforms.gapSize.value}set gapSize(t){this.uniforms.gapSize.value=t}get opacity(){return this.uniforms.opacity.value}set opacity(t){this.uniforms&&(this.uniforms.opacity.value=t)}get resolution(){return this.uniforms.resolution.value}set resolution(t){this.uniforms.resolution.value.copy(t)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(t){this.defines&&(!0===t!==this.alphaToCoverage&&(this.needsUpdate=!0),!0===t?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const g=new r.IUQ,m=new r.Pq0,A=new r.Pq0,v=new r.IUQ,y=new r.IUQ,b=new r.IUQ,_=new r.Pq0,x=new r.kn4,w=new r.cZY,E=new r.Pq0,C=new r.NRn,S=new r.iyt,I=new r.IUQ;let M,T;function B(t,e,i){return I.set(0,0,-e,1).applyMatrix4(t.projectionMatrix),I.multiplyScalar(1/I.w),I.x=T/i.width,I.y=T/i.height,I.applyMatrix4(t.projectionMatrixInverse),I.multiplyScalar(1/I.w),Math.abs(Math.max(I.x,I.y))}class R extends r.eaF{constructor(t=new d,e=new f({color:16777215*Math.random()})){super(t,e),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const t=this.geometry,e=t.attributes.instanceStart,i=t.attributes.instanceEnd,n=new Float32Array(2*e.count);for(let t=0,s=0,r=e.count;t<r;t++,s+=2)m.fromBufferAttribute(e,t),A.fromBufferAttribute(i,t),n[s]=0===s?0:n[s-1],n[s+1]=n[s]+m.distanceTo(A);const s=new r.LuO(n,2,1);return t.setAttribute("instanceDistanceStart",new r.eHs(s,1,0)),t.setAttribute("instanceDistanceEnd",new r.eHs(s,1,1)),this}raycast(t,e){const i=this.material.worldUnits,n=t.camera;null!==n||i||console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=void 0!==t.params.Line2&&t.params.Line2.threshold||0;M=t.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;let c,h;if(T=l.linewidth+s,null===a.boundingSphere&&a.computeBoundingSphere(),S.copy(a.boundingSphere).applyMatrix4(o),i)c=.5*T;else{c=B(n,Math.max(n.near,S.distanceToPoint(M.origin)),l.resolution)}if(S.radius+=c,!1!==M.intersectsSphere(S)){if(null===a.boundingBox&&a.computeBoundingBox(),C.copy(a.boundingBox).applyMatrix4(o),i)h=.5*T;else{h=B(n,Math.max(n.near,C.distanceToPoint(M.origin)),l.resolution)}C.expandByScalar(h),!1!==M.intersectsBox(C)&&(i?function(t,e){const i=t.matrixWorld,n=t.geometry,s=n.attributes.instanceStart,o=n.attributes.instanceEnd;for(let a=0,l=Math.min(n.instanceCount,s.count);a<l;a++){w.start.fromBufferAttribute(s,a),w.end.fromBufferAttribute(o,a),w.applyMatrix4(i);const n=new r.Pq0,l=new r.Pq0;M.distanceSqToSegment(w.start,w.end,l,n),l.distanceTo(n)<.5*T&&e.push({point:l,pointOnLine:n,distance:M.origin.distanceTo(l),object:t,face:null,faceIndex:a,uv:null,uv1:null})}}(this,e):function(t,e,i){const n=e.projectionMatrix,s=t.material.resolution,o=t.matrixWorld,a=t.geometry,l=a.attributes.instanceStart,c=a.attributes.instanceEnd,h=Math.min(a.instanceCount,l.count),u=-e.near;M.at(1,b),b.w=1,b.applyMatrix4(e.matrixWorldInverse),b.applyMatrix4(n),b.multiplyScalar(1/b.w),b.x*=s.x/2,b.y*=s.y/2,b.z=0,_.copy(b),x.multiplyMatrices(e.matrixWorldInverse,o);for(let e=0,a=h;e<a;e++){if(v.fromBufferAttribute(l,e),y.fromBufferAttribute(c,e),v.w=1,y.w=1,v.applyMatrix4(x),y.applyMatrix4(x),v.z>u&&y.z>u)continue;if(v.z>u){const t=v.z-y.z,e=(v.z-u)/t;v.lerp(y,e)}else if(y.z>u){const t=y.z-v.z,e=(y.z-u)/t;y.lerp(v,e)}v.applyMatrix4(n),y.applyMatrix4(n),v.multiplyScalar(1/v.w),y.multiplyScalar(1/y.w),v.x*=s.x/2,v.y*=s.y/2,y.x*=s.x/2,y.y*=s.y/2,w.start.copy(v),w.start.z=0,w.end.copy(y),w.end.z=0;const a=w.closestPointToPointParameter(_,!0);w.at(a,E);const h=r.cj9.lerp(v.z,y.z,a),d=h>=-1&&h<=1,p=_.distanceTo(E)<.5*T;if(d&&p){w.start.fromBufferAttribute(l,e),w.end.fromBufferAttribute(c,e),w.start.applyMatrix4(o),w.end.applyMatrix4(o);const n=new r.Pq0,s=new r.Pq0;M.distanceSqToSegment(w.start,w.end,s,n),i.push({point:s,pointOnLine:n,distance:M.origin.distanceTo(s),object:t,face:null,faceIndex:e,uv:null,uv1:null})}}}(this,n,e))}}onBeforeRender(t){const e=this.material.uniforms;e&&e.resolution&&(t.getViewport(g),this.material.uniforms.resolution.value.set(g.z,g.w))}}class P extends R{constructor(t,e){const i=Object.assign({},P.defaultProps,e);let n="number"==typeof t?t:(()=>{const e=new r.NRn;return e.makeEmpty(),(0,o.g6)(t,e),(e.isEmpty()?1:e.getBoundingSphere(new r.iyt).radius)*i.length})();const s=4===i.colors.length?i.colors[0]:null;let a=[0,0,0,n,0,0,0,0,0,0,n,0,0,0,0,0,0,n],l=[];for(let t of i.colors.slice(-3)){let e=t.toArray();l.push(...e,...e)}const c=new d;c.setPositions(a),c.setColors(l);if(super(c,new f({vertexColors:!0,toneMapped:!1,depthTest:i.depthTest,worldUnits:!1,linewidth:i.width})),s){const t=new r.LoY;t.setAttribute("position",new r.qtW([0,0,0],3));const e=new r.BH$({size:i.width+1,toneMapped:!1,color:s,sizeAttenuation:!1,depthTest:i.depthTest});this.originPoint=new r.ONl(t,e),this.originPoint.renderOrder=2,this.add(this.originPoint)}this.renderOrder=2,this.update()}update(){}dispose(){this.originPoint&&(this.remove(this.originPoint),this.originPoint.geometry.dispose(),this.originPoint.material.dispose()),this.geometry.dispose(),this.material.dispose()}}P.defaultProps={length:.15,width:2,depthTest:!1,colors:[new r.Q1f(16766515),new r.Q1f(10894154),new r.Q1f(7315996),new r.Q1f(3113953)]};class L extends r.B69{constructor(t,e=1){super(),this.type="LightHelper",this.light=t,this.material=new r.mrM({opacity:.8,transparent:!0,toneMapped:!1}),this.material.color=this.light.color,this.source=new r.DXC(new r.XJ7(new r.Gu$(e/10,8,4)),this.material),this.add(this.source)}update(){}dispose(){this.source.geometry.dispose(),this.material.dispose()}}class D extends d{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(t){const e=t.length-3,i=new Float32Array(2*e);for(let n=0;n<e;n+=3)i[2*n]=t[n],i[2*n+1]=t[n+1],i[2*n+2]=t[n+2],i[2*n+3]=t[n+3],i[2*n+4]=t[n+4],i[2*n+5]=t[n+5];return super.setPositions(i),this}setColors(t){const e=t.length-3,i=new Float32Array(2*e);for(let n=0;n<e;n+=3)i[2*n]=t[n],i[2*n+1]=t[n+1],i[2*n+2]=t[n+2],i[2*n+3]=t[n+3],i[2*n+4]=t[n+4],i[2*n+5]=t[n+5];return super.setColors(i),this}setFromPoints(t){const e=t.length-1,i=new Float32Array(6*e);for(let n=0;n<e;n++)i[6*n]=t[n].x,i[6*n+1]=t[n].y,i[6*n+2]=t[n].z||0,i[6*n+3]=t[n+1].x,i[6*n+4]=t[n+1].y,i[6*n+5]=t[n+1].z||0;return super.setPositions(i),this}fromLine(t){const e=t.geometry;return this.setPositions(e.attributes.position.array),this}}class N extends R{constructor(t=new D,e=new f({color:16777215*Math.random()})){super(t,e),this.isLine2=!0,this.type="Line2"}}class O extends L{constructor(t,e){super(t,e),this.type="DirectionalLightHelper",this.targetMaterial=new f({opacity:.8,transparent:!0,toneMapped:!1,depthTest:!1,worldUnits:!1,linewidth:2}),this.targetMaterial.color=this.light.color,this.target=new N((new D).setPositions([0,0,0,...t.target.position.toArray()]),this.targetMaterial),this.target.scale.setScalar(1),this.target.matrixAutoUpdate=!1,this.target.renderOrder=2,this.add(this.target)}update(){super.update(),this.light.parent&&(this.target.scale.setScalar(this.light.parent.position.length()/this.light.parent.scale.y),this.target.updateMatrix())}dispose(){this.target.geometry.dispose(),super.dispose()}}class k extends r.B69{constructor(t,e=1){super(),this.type="AmbientLightHelper",this.light=t,this.geometry=new r.Gu$(e/2,8,4,0,2*Math.PI,0,Math.PI/2),this.upper=new r.eaF(this.geometry,new r.V9B({opacity:.4,transparent:!0,toneMapped:!1,side:r.$EB})),this.upper.receiveShadow=!1,console.log("Color",t.color),this.upper.material.color=t.color,this.add(this.upper),this.lower=new r.eaF(this.geometry,new r.V9B({opacity:.4,transparent:!0,toneMapped:!1,side:r.$EB})),this.lower.rotateX(Math.PI),this.lower.updateMatrix(),this.lower.material.color="groundColor"in t?t.groundColor:t.color,this.add(this.lower),this.position.set(0,-1,0)}update(){}dispose(){this.geometry.dispose(),this.upper.material.dispose(),this.lower.material.dispose()}}class U extends r.B69{constructor(t){super(),this.type="RectLightHelper",this.light=t;const e=new f({opacity:.8,transparent:!0,toneMapped:!1,worldUnits:!1,linewidth:2});e.color=this.light.color,this.lines=new R((new d).setPositions([0,0,0,0,0,-1,5,-5,0,5,5,0,5,5,0,-5,5,0,-5,5,0,-5,-5,0,-5,-5,0,5,-5,0]),e),this.add(this.lines);const i=[null,null,null,null,new r.V9B({opacity:.1,transparent:!0,toneMapped:!1,side:r.hB5}),new r.V9B({opacity:.4,transparent:!0,toneMapped:!1,side:r.hB5})];i[4].color=i[5].color=t.color,this.area=new r.eaF(new r.iNn(10,10,0),i),this.add(this.area)}update(){}dispose(){this.lines.geometry.dispose(),this.area.geometry.dispose(),this.lines.material.dispose();let t=this.area.material;t[4].dispose(),t[5].dispose()}}var F=i(3074),z=i(8424);const V=[[O,"DirectionalLight"],[class extends L{constructor(t){super(t,.6),this.type="PointLightHelper",this.distance=new r.eaF(new r.Gu$(1),new r.V9B({opacity:.15,transparent:!0})),this.distance.material.color=t.color,this.distance.matrixAutoUpdate=!1,this.add(this.distance)}update(){super.update(),this.distance.scale.setScalar(this.light.distance/this.light.parent.scale.y),this.distance.updateMatrix()}dispose(){this.distance.geometry.dispose(),this.distance.material.dispose(),super.dispose()}},"PointLight"],[class extends O{constructor(t){super(t,.6),this.type="SpotLightHelper",this.targetMaterial.depthTest=!0,this.cone=new r.DXC(new r.XJ7(new r.qFE(1,1,16,1,!0)),this.material),this.cone.matrixAutoUpdate=!1,this.cone.position.set(0,-.5*length,0),this.cone.updateMatrix(),this.add(this.cone)}update(){let t=this.light.distance/this.light.parent.scale.y||this.light.shadow.camera.far,e=Math.min(Math.tan(this.light.angle),1e3)*t;this.cone.scale.set(e,t,e),this.cone.position.set(0,-.5*t,0),this.cone.updateMatrix(),super.update()}dispose(){this.cone.geometry.dispose(),super.dispose()}},"SpotLight"],[k,"HemisphereLight"],[k,"AmbientLight"],[U,"RectAreaLight"]],Q={viewportPicking:n.gK.Boolean("Viewport.Picking",!0),viewportBrackets:n.gK.Boolean("Viewport.Brackets",!0)};class j extends s.A{constructor(){super(...arguments),this.ins=this.addInputs(Q),this._brackets_map=new Map,this._axes_map=new Map}create(){super.create(),this.system.on("pointer-up",this.onPointerUp,this)}dispose(){this.system.off("pointer-up",this.onPointerUp,this),super.dispose()}update(){if(this.ins.viewportBrackets.changed){for(let t of this._brackets_map.values())t.visible=this.ins.viewportBrackets.value;for(let t of this._axes_map.values())t.visible=this.ins.viewportBrackets.value}return!0}onSelectNode(t,e){super.onSelectNode(t,e);const i="NVScene"===t.typeName?t.getComponent(z.Ay,!0):t.getComponent(F.Ay,!0);i&&this.updateBracket(i,e)}onSelectComponent(t,e){super.onSelectComponent(t,e),(t instanceof F.Ay||t instanceof z.Ay)&&this.updateBracket(t,e)}onPointerUp(t){this.ins.viewportPicking.value&&t.isPrimary&&!t.isDragging&&(t.component?this.selectComponent(t.component,t.ctrlKey):t.ctrlKey||this.clearSelection())}tick(t){for(let t of this._brackets_map.values())t.update();return!1}updateBracket(t,e){var i;if(!t)return;const n=t.object3D,s=t.transform;if(e){if(n){let e;if(n.isLight){let t=null===(i=V.find(([t,e])=>e===n.type))||void 0===i?void 0:i[0];t&&(n.updateMatrix(),e=new t(n),e.updateWorldMatrix(!0,!1))}e||(e=new c(n)),n.add(e),this._brackets_map.set(t,e),e.visible=this.ins.viewportBrackets.value}if(s&&s.object3D!=n){let t=new P(s.object3D);this._axes_map.set(s,t),s.object3D.add(t),t.visible=this.ins.viewportBrackets.value}}else{if(n){const e=this._brackets_map.get(t);e&&(this._brackets_map.delete(t),e.removeFromParent(),e.dispose())}if(s){const t=this._axes_map.get(s);t&&(this._axes_map.delete(s),t.removeFromParent(),t.dispose())}}this.changed=!0}}j.typeName="CPickSelection"},3657:function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.encodeNonAsciiHTML=e.encodeHTML=void 0;var s=n(i(6345)),r=i(2948),o=/[\t\n!-,./:-@[-`\f{-}$\x80-\uFFFF]/g;function a(t,e){for(var i,n="",o=0;null!==(i=t.exec(e));){var a=i.index;n+=e.substring(o,a);var l=e.charCodeAt(a),c=s.default.get(l);if("object"==typeof c){if(a+1<e.length){var h=e.charCodeAt(a+1),u="number"==typeof c.n?c.n===h?c.o:void 0:c.n.get(h);if(void 0!==u){n+=u,o=t.lastIndex+=1;continue}}c=c.v}if(void 0!==c)n+=c,o=a+1;else{var d=(0,r.getCodePoint)(e,a);n+="&#x".concat(d.toString(16),";"),o=t.lastIndex+=Number(d!==l)}}return n+e.substr(o)}e.encodeHTML=function(t){return a(o,t)},e.encodeNonAsciiHTML=function(t){return a(r.xmlReplacer,t)}},3675:(t,e,i)=>{"use strict";var n,s,r;i.d(e,{BX:()=>r,Nm:()=>o,aL:()=>s,uj:()=>n}),function(t){t[t.mm=0]="mm",t[t.cm=1]="cm",t[t.m=2]="m",t[t.km=3]="km",t[t.in=4]="in",t[t.ft=5]="ft",t[t.yd=6]="yd",t[t.mi=7]="mi"}(n||(n={})),function(t){t[t.EN=0]="EN",t[t.ES=1]="ES",t[t.DE=2]="DE",t[t.NL=3]="NL",t[t.JA=4]="JA",t[t.FR=5]="FR",t[t.IT=6]="IT",t[t.HAW=7]="HAW",t[t.AR=8]="AR"}(s||(s={})),function(t){t.EN="English",t.ES="Spanish (Español)",t.DE="German (Deutsch)",t.NL="Dutch (Nederlands)",t.JA="Japanese (日本語)",t.FR="French (Français)",t.IT="Italian (Italiano)",t.HAW="Hawaiian (ʻŌlelo Hawaiʻi)",t.AR="Arabic (العربية)"}(r||(r={}));const o="EN"},3715:(t,e,i)=>{"use strict";i.d(e,{Ni:()=>l,UN:()=>a,al:()=>n,pz:()=>r,yS:()=>s});const n=null!=navigator.xr&&null!=self.XRSession&&null!=navigator.xr.isSessionSupported&&self.XRSession.prototype.requestHitTestSource,s=(()=>{const t=navigator.userAgent||navigator.vendor||self.opera;let e=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e})(),r=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!self.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,o=Boolean(window.webkit&&window.webkit.messageHandlers),a=(()=>{if(r){if(o)return Boolean(/CriOS\/|EdgiOS\/|FxiOS\/|GSA\/|DuckDuckGo\//.test(navigator.userAgent));{const t=document.createElement("a");return Boolean(t.relList&&t.relList.supports&&t.relList.supports("ar"))}}return!1})(),l=(/\bCrOS\b/.test(navigator.userAgent),/android/i.test(navigator.userAgent))},3745:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuoteType=void 0;var n,s,r,o=i(9585);function a(t){return t===n.Space||t===n.NewLine||t===n.Tab||t===n.FormFeed||t===n.CarriageReturn}function l(t){return t===n.Slash||t===n.Gt||a(t)}function c(t){return t>=n.Zero&&t<=n.Nine}!function(t){t[t.Tab=9]="Tab",t[t.NewLine=10]="NewLine",t[t.FormFeed=12]="FormFeed",t[t.CarriageReturn=13]="CarriageReturn",t[t.Space=32]="Space",t[t.ExclamationMark=33]="ExclamationMark",t[t.Number=35]="Number",t[t.Amp=38]="Amp",t[t.SingleQuote=39]="SingleQuote",t[t.DoubleQuote=34]="DoubleQuote",t[t.Dash=45]="Dash",t[t.Slash=47]="Slash",t[t.Zero=48]="Zero",t[t.Nine=57]="Nine",t[t.Semi=59]="Semi",t[t.Lt=60]="Lt",t[t.Eq=61]="Eq",t[t.Gt=62]="Gt",t[t.Questionmark=63]="Questionmark",t[t.UpperA=65]="UpperA",t[t.LowerA=97]="LowerA",t[t.UpperF=70]="UpperF",t[t.LowerF=102]="LowerF",t[t.UpperZ=90]="UpperZ",t[t.LowerZ=122]="LowerZ",t[t.LowerX=120]="LowerX",t[t.OpeningSquareBracket=91]="OpeningSquareBracket"}(n||(n={})),function(t){t[t.Text=1]="Text",t[t.BeforeTagName=2]="BeforeTagName",t[t.InTagName=3]="InTagName",t[t.InSelfClosingTag=4]="InSelfClosingTag",t[t.BeforeClosingTagName=5]="BeforeClosingTagName",t[t.InClosingTagName=6]="InClosingTagName",t[t.AfterClosingTagName=7]="AfterClosingTagName",t[t.BeforeAttributeName=8]="BeforeAttributeName",t[t.InAttributeName=9]="InAttributeName",t[t.AfterAttributeName=10]="AfterAttributeName",t[t.BeforeAttributeValue=11]="BeforeAttributeValue",t[t.InAttributeValueDq=12]="InAttributeValueDq",t[t.InAttributeValueSq=13]="InAttributeValueSq",t[t.InAttributeValueNq=14]="InAttributeValueNq",t[t.BeforeDeclaration=15]="BeforeDeclaration",t[t.InDeclaration=16]="InDeclaration",t[t.InProcessingInstruction=17]="InProcessingInstruction",t[t.BeforeComment=18]="BeforeComment",t[t.CDATASequence=19]="CDATASequence",t[t.InSpecialComment=20]="InSpecialComment",t[t.InCommentLike=21]="InCommentLike",t[t.BeforeSpecialS=22]="BeforeSpecialS",t[t.SpecialStartSequence=23]="SpecialStartSequence",t[t.InSpecialTag=24]="InSpecialTag",t[t.BeforeEntity=25]="BeforeEntity",t[t.BeforeNumericEntity=26]="BeforeNumericEntity",t[t.InNamedEntity=27]="InNamedEntity",t[t.InNumericEntity=28]="InNumericEntity",t[t.InHexEntity=29]="InHexEntity"}(s||(s={})),function(t){t[t.NoValue=0]="NoValue",t[t.Unquoted=1]="Unquoted",t[t.Single=2]="Single",t[t.Double=3]="Double"}(r=e.QuoteType||(e.QuoteType={}));var h={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])},u=function(){function t(t,e){var i=t.xmlMode,n=void 0!==i&&i,r=t.decodeEntities,a=void 0===r||r;this.cbs=e,this.state=s.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=s.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=n,this.decodeEntities=a,this.entityTrie=n?o.xmlDecodeTree:o.htmlDecodeTree}return t.prototype.reset=function(){this.state=s.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=s.Text,this.currentSequence=void 0,this.running=!0,this.offset=0},t.prototype.write=function(t){this.offset+=this.buffer.length,this.buffer=t,this.parse()},t.prototype.end=function(){this.running&&this.finish()},t.prototype.pause=function(){this.running=!1},t.prototype.resume=function(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()},t.prototype.getIndex=function(){return this.index},t.prototype.getSectionStart=function(){return this.sectionStart},t.prototype.stateText=function(t){t===n.Lt||!this.decodeEntities&&this.fastForwardTo(n.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=s.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&t===n.Amp&&(this.state=s.BeforeEntity)},t.prototype.stateSpecialStartSequence=function(t){var e=this.sequenceIndex===this.currentSequence.length;if(e?l(t):(32|t)===this.currentSequence[this.sequenceIndex]){if(!e)return void this.sequenceIndex++}else this.isSpecial=!1;this.sequenceIndex=0,this.state=s.InTagName,this.stateInTagName(t)},t.prototype.stateInSpecialTag=function(t){if(this.sequenceIndex===this.currentSequence.length){if(t===n.Gt||a(t)){var e=this.index-this.currentSequence.length;if(this.sectionStart<e){var i=this.index;this.index=e,this.cbs.ontext(this.sectionStart,e),this.index=i}return this.isSpecial=!1,this.sectionStart=e+2,void this.stateInClosingTagName(t)}this.sequenceIndex=0}(32|t)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:0===this.sequenceIndex?this.currentSequence===h.TitleEnd?this.decodeEntities&&t===n.Amp&&(this.state=s.BeforeEntity):this.fastForwardTo(n.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=Number(t===n.Lt)},t.prototype.stateCDATASequence=function(t){t===h.Cdata[this.sequenceIndex]?++this.sequenceIndex===h.Cdata.length&&(this.state=s.InCommentLike,this.currentSequence=h.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=s.InDeclaration,this.stateInDeclaration(t))},t.prototype.fastForwardTo=function(t){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===t)return!0;return this.index=this.buffer.length+this.offset-1,!1},t.prototype.stateInCommentLike=function(t){t===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===h.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=s.Text):0===this.sequenceIndex?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):t!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)},t.prototype.isTagStartChar=function(t){return this.xmlMode?!l(t):function(t){return t>=n.LowerA&&t<=n.LowerZ||t>=n.UpperA&&t<=n.UpperZ}(t)},t.prototype.startSpecial=function(t,e){this.isSpecial=!0,this.currentSequence=t,this.sequenceIndex=e,this.state=s.SpecialStartSequence},t.prototype.stateBeforeTagName=function(t){if(t===n.ExclamationMark)this.state=s.BeforeDeclaration,this.sectionStart=this.index+1;else if(t===n.Questionmark)this.state=s.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(t)){var e=32|t;this.sectionStart=this.index,this.xmlMode||e!==h.TitleEnd[2]?this.state=this.xmlMode||e!==h.ScriptEnd[2]?s.InTagName:s.BeforeSpecialS:this.startSpecial(h.TitleEnd,3)}else t===n.Slash?this.state=s.BeforeClosingTagName:(this.state=s.Text,this.stateText(t))},t.prototype.stateInTagName=function(t){l(t)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=s.BeforeAttributeName,this.stateBeforeAttributeName(t))},t.prototype.stateBeforeClosingTagName=function(t){a(t)||(t===n.Gt?this.state=s.Text:(this.state=this.isTagStartChar(t)?s.InClosingTagName:s.InSpecialComment,this.sectionStart=this.index))},t.prototype.stateInClosingTagName=function(t){(t===n.Gt||a(t))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=s.AfterClosingTagName,this.stateAfterClosingTagName(t))},t.prototype.stateAfterClosingTagName=function(t){(t===n.Gt||this.fastForwardTo(n.Gt))&&(this.state=s.Text,this.baseState=s.Text,this.sectionStart=this.index+1)},t.prototype.stateBeforeAttributeName=function(t){t===n.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=s.InSpecialTag,this.sequenceIndex=0):this.state=s.Text,this.baseState=this.state,this.sectionStart=this.index+1):t===n.Slash?this.state=s.InSelfClosingTag:a(t)||(this.state=s.InAttributeName,this.sectionStart=this.index)},t.prototype.stateInSelfClosingTag=function(t){t===n.Gt?(this.cbs.onselfclosingtag(this.index),this.state=s.Text,this.baseState=s.Text,this.sectionStart=this.index+1,this.isSpecial=!1):a(t)||(this.state=s.BeforeAttributeName,this.stateBeforeAttributeName(t))},t.prototype.stateInAttributeName=function(t){(t===n.Eq||l(t))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=s.AfterAttributeName,this.stateAfterAttributeName(t))},t.prototype.stateAfterAttributeName=function(t){t===n.Eq?this.state=s.BeforeAttributeValue:t===n.Slash||t===n.Gt?(this.cbs.onattribend(r.NoValue,this.index),this.state=s.BeforeAttributeName,this.stateBeforeAttributeName(t)):a(t)||(this.cbs.onattribend(r.NoValue,this.index),this.state=s.InAttributeName,this.sectionStart=this.index)},t.prototype.stateBeforeAttributeValue=function(t){t===n.DoubleQuote?(this.state=s.InAttributeValueDq,this.sectionStart=this.index+1):t===n.SingleQuote?(this.state=s.InAttributeValueSq,this.sectionStart=this.index+1):a(t)||(this.sectionStart=this.index,this.state=s.InAttributeValueNq,this.stateInAttributeValueNoQuotes(t))},t.prototype.handleInAttributeValue=function(t,e){t===e||!this.decodeEntities&&this.fastForwardTo(e)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(e===n.DoubleQuote?r.Double:r.Single,this.index),this.state=s.BeforeAttributeName):this.decodeEntities&&t===n.Amp&&(this.baseState=this.state,this.state=s.BeforeEntity)},t.prototype.stateInAttributeValueDoubleQuotes=function(t){this.handleInAttributeValue(t,n.DoubleQuote)},t.prototype.stateInAttributeValueSingleQuotes=function(t){this.handleInAttributeValue(t,n.SingleQuote)},t.prototype.stateInAttributeValueNoQuotes=function(t){a(t)||t===n.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(r.Unquoted,this.index),this.state=s.BeforeAttributeName,this.stateBeforeAttributeName(t)):this.decodeEntities&&t===n.Amp&&(this.baseState=this.state,this.state=s.BeforeEntity)},t.prototype.stateBeforeDeclaration=function(t){t===n.OpeningSquareBracket?(this.state=s.CDATASequence,this.sequenceIndex=0):this.state=t===n.Dash?s.BeforeComment:s.InDeclaration},t.prototype.stateInDeclaration=function(t){(t===n.Gt||this.fastForwardTo(n.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=s.Text,this.sectionStart=this.index+1)},t.prototype.stateInProcessingInstruction=function(t){(t===n.Gt||this.fastForwardTo(n.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=s.Text,this.sectionStart=this.index+1)},t.prototype.stateBeforeComment=function(t){t===n.Dash?(this.state=s.InCommentLike,this.currentSequence=h.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=s.InDeclaration},t.prototype.stateInSpecialComment=function(t){(t===n.Gt||this.fastForwardTo(n.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=s.Text,this.sectionStart=this.index+1)},t.prototype.stateBeforeSpecialS=function(t){var e=32|t;e===h.ScriptEnd[3]?this.startSpecial(h.ScriptEnd,4):e===h.StyleEnd[3]?this.startSpecial(h.StyleEnd,4):(this.state=s.InTagName,this.stateInTagName(t))},t.prototype.stateBeforeEntity=function(t){this.entityExcess=1,this.entityResult=0,t===n.Number?this.state=s.BeforeNumericEntity:t===n.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=s.InNamedEntity,this.stateInNamedEntity(t))},t.prototype.stateInNamedEntity=function(t){if(this.entityExcess+=1,this.trieIndex=(0,o.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,t),this.trieIndex<0)return this.emitNamedEntity(),void this.index--;this.trieCurrent=this.entityTrie[this.trieIndex];var e=this.trieCurrent&o.BinTrieFlags.VALUE_LENGTH;if(e){var i=(e>>14)-1;if(this.allowLegacyEntity()||t===n.Semi){var s=this.index-this.entityExcess+1;s>this.sectionStart&&this.emitPartial(this.sectionStart,s),this.entityResult=this.trieIndex,this.trieIndex+=i,this.entityExcess=0,this.sectionStart=this.index+1,0===i&&this.emitNamedEntity()}else this.trieIndex+=i}},t.prototype.emitNamedEntity=function(){if(this.state=this.baseState,0!==this.entityResult)switch((this.entityTrie[this.entityResult]&o.BinTrieFlags.VALUE_LENGTH)>>14){case 1:this.emitCodePoint(this.entityTrie[this.entityResult]&~o.BinTrieFlags.VALUE_LENGTH);break;case 2:this.emitCodePoint(this.entityTrie[this.entityResult+1]);break;case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}},t.prototype.stateBeforeNumericEntity=function(t){(32|t)===n.LowerX?(this.entityExcess++,this.state=s.InHexEntity):(this.state=s.InNumericEntity,this.stateInNumericEntity(t))},t.prototype.emitNumericEntity=function(t){var e=this.index-this.entityExcess-1;e+2+Number(this.state===s.InHexEntity)!==this.index&&(e>this.sectionStart&&this.emitPartial(this.sectionStart,e),this.sectionStart=this.index+Number(t),this.emitCodePoint((0,o.replaceCodePoint)(this.entityResult))),this.state=this.baseState},t.prototype.stateInNumericEntity=function(t){t===n.Semi?this.emitNumericEntity(!0):c(t)?(this.entityResult=10*this.entityResult+(t-n.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},t.prototype.stateInHexEntity=function(t){t===n.Semi?this.emitNumericEntity(!0):c(t)?(this.entityResult=16*this.entityResult+(t-n.Zero),this.entityExcess++):!function(t){return t>=n.UpperA&&t<=n.UpperF||t>=n.LowerA&&t<=n.LowerF}(t)?(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--):(this.entityResult=16*this.entityResult+((32|t)-n.LowerA+10),this.entityExcess++)},t.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===s.Text||this.baseState===s.InSpecialTag)},t.prototype.cleanup=function(){this.running&&this.sectionStart!==this.index&&(this.state===s.Text||this.state===s.InSpecialTag&&0===this.sequenceIndex?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):this.state!==s.InAttributeValueDq&&this.state!==s.InAttributeValueSq&&this.state!==s.InAttributeValueNq||(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))},t.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running},t.prototype.parse=function(){for(;this.shouldContinue();){var t=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case s.Text:this.stateText(t);break;case s.SpecialStartSequence:this.stateSpecialStartSequence(t);break;case s.InSpecialTag:this.stateInSpecialTag(t);break;case s.CDATASequence:this.stateCDATASequence(t);break;case s.InAttributeValueDq:this.stateInAttributeValueDoubleQuotes(t);break;case s.InAttributeName:this.stateInAttributeName(t);break;case s.InCommentLike:this.stateInCommentLike(t);break;case s.InSpecialComment:this.stateInSpecialComment(t);break;case s.BeforeAttributeName:this.stateBeforeAttributeName(t);break;case s.InTagName:this.stateInTagName(t);break;case s.InClosingTagName:this.stateInClosingTagName(t);break;case s.BeforeTagName:this.stateBeforeTagName(t);break;case s.AfterAttributeName:this.stateAfterAttributeName(t);break;case s.InAttributeValueSq:this.stateInAttributeValueSingleQuotes(t);break;case s.BeforeAttributeValue:this.stateBeforeAttributeValue(t);break;case s.BeforeClosingTagName:this.stateBeforeClosingTagName(t);break;case s.AfterClosingTagName:this.stateAfterClosingTagName(t);break;case s.BeforeSpecialS:this.stateBeforeSpecialS(t);break;case s.InAttributeValueNq:this.stateInAttributeValueNoQuotes(t);break;case s.InSelfClosingTag:this.stateInSelfClosingTag(t);break;case s.InDeclaration:this.stateInDeclaration(t);break;case s.BeforeDeclaration:this.stateBeforeDeclaration(t);break;case s.BeforeComment:this.stateBeforeComment(t);break;case s.InProcessingInstruction:this.stateInProcessingInstruction(t);break;case s.InNamedEntity:this.stateInNamedEntity(t);break;case s.BeforeEntity:this.stateBeforeEntity(t);break;case s.InHexEntity:this.stateInHexEntity(t);break;case s.InNumericEntity:this.stateInNumericEntity(t);break;default:this.stateBeforeNumericEntity(t)}this.index++}this.cleanup()},t.prototype.finish=function(){this.state===s.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()},t.prototype.handleTrailingData=function(){var t=this.buffer.length+this.offset;this.state===s.InCommentLike?this.currentSequence===h.CdataEnd?this.cbs.oncdata(this.sectionStart,t,0):this.cbs.oncomment(this.sectionStart,t,0):this.state===s.InNumericEntity&&this.allowLegacyEntity()||this.state===s.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===s.InTagName||this.state===s.BeforeAttributeName||this.state===s.BeforeAttributeValue||this.state===s.AfterAttributeName||this.state===s.InAttributeName||this.state===s.InAttributeValueSq||this.state===s.InAttributeValueDq||this.state===s.InAttributeValueNq||this.state===s.InClosingTagName||this.cbs.ontext(this.sectionStart,t)},t.prototype.emitPartial=function(t,e){this.baseState!==s.Text&&this.baseState!==s.InSpecialTag?this.cbs.onattribdata(t,e):this.cbs.ontext(t,e)},t.prototype.emitCodePoint=function(t){this.baseState!==s.Text&&this.baseState!==s.InSpecialTag?this.cbs.onattribentity(t):this.cbs.ontextentity(t)},t}();e.default=u},3751:(t,e,i)=>{"use strict";var n=i(6763),s=(i(8738),i(4019)),r=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let o=class extends s.A{constructor(){super(...arguments),this.type="number",this.min=void 0,this.max=void 0}firstConnected(){super.firstConnected(),this.classList.add("sv-property-slider")}update(t){if(t.has("property")){const e=t.get("property");e&&e.off("value",this.onUpdate,this),this.property&&this.property.on("value",this.onUpdate,this)}super.update(t)}render(){const t=this.property,e=this.name||t.name,i=t.getValidatedValue(),s=isFinite(this.min)?this.min:t.schema.min,r=isFinite(this.max)?this.max:t.schema.max,o=(i-s)/(r-s);return n.qy`<label id="${e}-label" class="ff-label ff-off">${e}</label>
            <ff-linear-slider class="${"true"===this.ariaDisabled?"ff-off":"ff-on"}" aria-labelledby="${e}-label" aria-valuemin=${s.toString()} aria-valuemax=${r.toString()} aria-valuenow=${i.toFixed(3)} role="slider" .value=${o} @keydown=${this.onKeyDown} @change=${this.onSliderChange}></ff-linear-slider>`}onSliderChange(t){const e=this.property,i=isFinite(this.min)?this.min:e.schema.min,n=isFinite(this.max)?this.max:e.schema.max,s=i+t.detail.value*(n-i);e.setValue(s)}onKeyDown(t){const e=this.property;"ArrowRight"===t.code||"ArrowUp"===t.code||"PageUp"===t.code?e.setValue(this.clamp("PageUp"===t.code?e.value+.1:e.value+.01)):"ArrowLeft"!==t.code&&"ArrowDown"!==t.code&&"PageDown"!==t.code||e.setValue(this.clamp("PageDown"===t.code?e.value-.1:e.value-.01))}clamp(t){const e=this.property,i=isFinite(this.min)?this.min:e.schema.min,n=isFinite(this.max)?this.max:e.schema.max;return Math.min(Math.max(t,i),n)}};r([(0,n.MZ)({type:Number})],o.prototype,"min",void 0),r([(0,n.MZ)({type:Number})],o.prototype,"max",void 0),o=r([(0,n.EM)("sv-property-slider")],o)},3769:(t,e,i)=>{"use strict";var n=i(4743);const s=(0,n.u$)(t=>e=>{let i;if(e instanceof n.GP||e instanceof n.Qh)throw new Error("The `live` directive is not allowed on text or event bindings");if(e instanceof n.Yp)r(e.strings),i=e.element.hasAttribute(e.name),e.value=i;else{const{element:s,name:o,strings:a}=e.committer;if(r(a),e instanceof n.Vm){if(i=s[o],i===t)return}else e instanceof n.ab&&(i=s.getAttribute(o));if(i===String(t))return}e.setValue(t)}),r=t=>{if(2!==t.length||""!==t[0]||""!==t[1])throw new Error("`live` bindings can only contain a single expression")};var o=i(6763),a=(i(9498),i(4019)),l=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let c=class extends a.A{constructor(){super(...arguments),this.type="number",this.options=null,this.indexMap=null,this.dropdown=!1}firstConnected(){super.firstConnected(),this.classList.add("sv-property-options")}update(t){if(t.has("property")){if(!this.property)throw new Error("missing property attribute");if(!this.property.schema.options)throw new Error("not an options property");const e=t.get("property");e&&(e.off("value",this.onUpdate,this),e.off("change",this.onUpdate,this)),this.property&&(this.property.on("value",this.onUpdate,this),this.property.on("change",this.onUpdate,this))}super.update(t)}render(){return this.dropdown?this.renderDropdown():this.renderButtons()}renderDropdown(){const t=this.property,e=this.indexMap,i=this.name||t.name,n=this.options||t.schema.options,r=t.value,a=this.language;let l;return l=e?e.map(t=>o.qy`<option value=${t} ?selected=${this.isSelected(t)}>${a?a.getLocalizedString(n[t]):n[t]}</option>`):n.map((t,e)=>t?o.qy`<option value=${e} ?selected=${this.isSelected(e)}>${a?a.getLocalizedString(t):t}</option>`:null),o.qy`
            <label class="ff-label ff-off">${i}</label>
            <select ?disabled=${"true"===this.ariaDisabled} ?multiple=${t.isMulti()} .value=${s(r)} class="sv-property-field" @change=${t=>{this.property.setValue(parseInt(t.target.value))}}>
                ${l}
            </select>
        `}renderButtons(){const t=this.property,e=this.indexMap,i=this.name||t.name,n=this.options||t.schema.options,s=(t.value,this.language);let r;return r=e?e.map(t=>o.qy`<ff-button role="radio" aria-checked=${this.isSelected(t)?"true":"false"} ?selected=${this.isSelected(t)} index=${t} .text=${s?s.getLocalizedString(n[t]):n[t]} @click=${this.onButtonClick}>
                    </ff-button>`):n.map((t,e)=>t?o.qy`<ff-button role="radio" aria-checked=${this.isSelected(e)?"true":"false"} ?selected=${this.isSelected(e)} index=${e} .text=${s?s.getLocalizedString(t):t}  @click=${this.onButtonClick}>
                    </ff-button>`:null),o.qy`
            <label class="ff-label ff-off">${i}</label>
            <div class="sv-options-buttons" role="radiogroup" @keydown=${t=>this.onKeyDown(t)} title=${i} class="sv-options">
                ${r}
            </div>`}isSelected(t){return this.property.isMulti()?this.property.value.includes(t):this.property.value==t}onButtonClick(t){const e=t.target.index;if(this.property.isMulti()){let t=this.property.value.slice();-1!==t.indexOf(e)?t=t.filter(t=>t!==e):t.push(e),this.property.setValue(t)}else this.property.setValue(e)}onKeyDown(t){if("ArrowUp"===t.code||"ArrowLeft"===t.code){const e=this.getElementsByTagName("ff-button"),i=Array.from(e).findIndex(e=>t.target===e);i>0&&(e[i].setAttribute("tabIndex","-1"),e[i-1].setAttribute("tabIndex","0"),e[i-1].focus())}else if("ArrowDown"===t.code||"ArrowRight"===t.code){const e=this.getElementsByTagName("ff-button"),i=Array.from(e).findIndex(e=>t.target===e);i<e.length-1&&(e[i].setAttribute("tabIndex","-1"),e[i+1].setAttribute("tabIndex","0"),e[i+1].focus())}else"Tab"===t.code&&this.addEventListener("blur",this.tabReset,{once:!0,capture:!0})}focus(){const t=this.getElementsByTagName("ff-button");t[Math.max(Array.from(t).findIndex(t=>0===t.tabIndex),0)].focus()}tabReset(t){const e=this.getElementsByTagName("ff-button"),i=Array.from(e),n=i.findIndex(t=>0===t.tabIndex),s=i.findIndex(t=>"true"===t.getAttribute("aria-checked"));if(n!=s){e[n].setAttribute("tabIndex","-1");e[s>-1?s:0].setAttribute("tabIndex","0")}}};l([(0,o.MZ)({attribute:!1})],c.prototype,"options",void 0),l([(0,o.MZ)({attribute:!1})],c.prototype,"indexMap",void 0),l([(0,o.MZ)({type:Boolean,reflect:!0})],c.prototype,"dropdown",void 0),c=l([(0,o.EM)("sv-property-options")],c)},3770:t=>{"use strict";t.exports=JSON.parse('{"$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON AnySchema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},3818:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>o,EM:()=>n.EM,qy:()=>n.qy});var n=i(6763),s=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let r=class extends n.Ay{constructor(){super(),this.anchor=null,this.portal=null,this.position=void 0,this.align=void 0,this.justify=void 0,this.positionX=0,this.positionY=0,this.offsetX=0,this.offsetY=0,this.keepVisible=!1,this.modal=!1,this._modalPlane=null,this.onResize=this.onResize.bind(this),this.onCaptureEvent=this.onCaptureEvent.bind(this),this.onEatEvent=this.onEatEvent.bind(this)}close(){this.dispatchEvent(new CustomEvent("close"))}connected(){if(this.calculatePosition(),window.addEventListener("resize",this.onResize),this.modal){const t=this._modalPlane=this.createElement("div");t.classList.add("ff-modal-plane"),t.addEventListener("mousedown",this.onEatEvent),t.addEventListener("contextmenu",this.onEatEvent),t.addEventListener("pointerdown",this.onEatEvent),this.parentElement.appendChild(t),setTimeout(()=>t.classList.add("ff-transition"))}else document.addEventListener("mousedown",this.onCaptureEvent,{capture:!0,passive:!0})}disconnected(){window.removeEventListener("resize",this.onResize),this._modalPlane?(this._modalPlane.remove(),this._modalPlane=null):document.removeEventListener("mousedown",this.onCaptureEvent)}firstConnected(){super.firstConnected(),this.setStyle({position:"center"==this.position?"absolute":"fixed",zIndex:"1000"}),this.classList.add("ff-popup")}updated(){this.isConnected&&this.calculatePosition()}calculatePosition(){let t,e;const i=this.getBoundingClientRect();let n;if(e=this.portal?this.portal.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight},"center"===this.position)n=this.center(i,e);else if("anchor"===this.position){const s=this.anchor||this.parentElement;s&&(t=s.getBoundingClientRect(),n=this.positionToAnchor(i,t,e))}else n={x:this.positionX,y:this.positionY};this.keepVisible&&"center"!==this.position&&(n=this.keepElementVisible(n,i,e)),this.style.left=Math.round(n.x)+"px",this.style.top=Math.round(n.y)+"px"}center(t,e){return{x:Math.round(.5*(e.width-t.width)),y:Math.round(.5*(e.height-t.height))}}positionToAnchor(t,e,i){const n=this.align,s=this.justify,r=this.offsetX,o=this.offsetY,a={x:0,y:0};switch(n){case"start":a.x="start"!==s&&"end"!==s?e.left-t.width-r:e.left;break;case"end":a.x="start"!==s&&"end"!==s?e.right+r:e.right-t.width;break;case"fixed":a.x=this.positionX;break;default:a.x=e.left+.5*(e.width-t.width)}switch(s){case"start":a.y=e.top-t.height-o;break;case"end":a.y=e.bottom+o;break;case"fixed":a.y=this.positionY;break;default:a.y=e.top+.5*(e.height-t.height)}return a.x+=this.offsetX,a.y+=this.offsetY,a}keepElementVisible(t,e,i){const n=this.offsetX,s=this.offsetY;return e.width>i.width?t.x=.5*(i.width-e.width):t.x<i.left+n?t.x=i.left+n:t.x+e.width+n>i.right&&(t.x=i.right-e.width-n),e.height>i.height?t.y=.5*(i.height-e.height):t.y<i.top+s?t.y=i.top+s:t.y+e.height+s>i.bottom&&(t.y=i.bottom-e.height-s),t}onResize(){this.calculatePosition()}onCaptureEvent(t){t.target instanceof Node&&this.contains(t.target)||this.close()}onEatEvent(t){console.log("Popup.onEatEvent"),t.stopPropagation(),t.preventDefault()}};s([(0,n.MZ)({attribute:!1})],r.prototype,"anchor",void 0),s([(0,n.MZ)({attribute:!1})],r.prototype,"portal",void 0),s([(0,n.MZ)({type:String})],r.prototype,"position",void 0),s([(0,n.MZ)({type:String})],r.prototype,"align",void 0),s([(0,n.MZ)({type:String})],r.prototype,"justify",void 0),s([(0,n.MZ)({type:Number})],r.prototype,"positionX",void 0),s([(0,n.MZ)({type:Number})],r.prototype,"positionY",void 0),s([(0,n.MZ)({type:Number})],r.prototype,"offsetX",void 0),s([(0,n.MZ)({type:Number})],r.prototype,"offsetY",void 0),s([(0,n.MZ)({type:Boolean})],r.prototype,"keepVisible",void 0),s([(0,n.MZ)({type:Boolean})],r.prototype,"modal",void 0),r=s([(0,n.EM)("ff-popup")],r);const o=r},3869:(t,e,i)=>{"use strict";i.d(e,{GP:()=>v,Qh:()=>p,Vm:()=>m,Yp:()=>f,ab:()=>d,g$:()=>g,pU:()=>u,sO:()=>c});var n=i(6342),s=i(6187),r=i(1142),o=i(1757),a=i(2387),l=i(4709);const c=t=>null===t||!("object"==typeof t||"function"==typeof t),h=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class u{constructor(t,e,i){this.dirty=!0,this.element=t,this.name=e,this.strings=i,this.parts=[];for(let t=0;t<i.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new d(this)}_getValue(){const t=this.strings,e=t.length-1,i=this.parts;if(1===e&&""===t[0]&&""===t[1]){const t=i[0].value;if("symbol"==typeof t)return String(t);if("string"==typeof t||!h(t))return t}let n="";for(let s=0;s<e;s++){n+=t[s];const e=i[s];if(void 0!==e){const t=e.value;if(c(t)||!h(t))n+="string"==typeof t?t:String(t);else for(const e of t)n+="string"==typeof e?e:String(e)}}return n+=t[e],n}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class d{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===r.c||c(t)&&t===this.value||(this.value=t,(0,n.q)(t)||(this.committer.dirty=!0))}commit(){for(;(0,n.q)(this.value);){const t=this.value;this.value=r.c,t(this)}this.value!==r.c&&this.committer.commit()}}class p{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild((0,l.h5)()),this.endNode=t.appendChild((0,l.h5)())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=(0,l.h5)()),t.__insert(this.endNode=(0,l.h5)())}insertAfterPart(t){t.__insert(this.startNode=(0,l.h5)()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(null===this.startNode.parentNode)return;for(;(0,n.q)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=r.c,t(this)}const t=this.__pendingValue;t!==r.c&&(c(t)?t!==this.value&&this.__commitText(t):t instanceof a.Q?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):h(t)?this.__commitIterable(t):t===r.s?(this.value=r.s,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const e=this.startNode.nextSibling,i="string"==typeof(t=null==t?"":t)?t:String(t);e===this.endNode.previousSibling&&3===e.nodeType?e.data=i:this.__commitNode(document.createTextNode(i)),this.value=t}__commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value instanceof o.i&&this.value.template===e)this.value.update(t.values);else{const i=new o.i(e,t.processor,this.options),n=i._clone();i.update(t.values),this.__commitNode(n),this.value=i}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let i,n=0;for(const s of t)i=e[n],void 0===i&&(i=new p(this.options),e.push(i),0===n?i.appendIntoPart(this):i.insertAfterPart(e[n-1])),i.setValue(s),i.commit(),n++;n<e.length&&(e.length=n,this.clear(i&&i.endNode))}clear(t=this.startNode){(0,s.if)(this.startNode.parentNode,t.nextSibling,this.endNode)}}class f{constructor(t,e,i){if(this.value=void 0,this.__pendingValue=void 0,2!==i.length||""!==i[0]||""!==i[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=e,this.strings=i}setValue(t){this.__pendingValue=t}commit(){for(;(0,n.q)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=r.c,t(this)}if(this.__pendingValue===r.c)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=r.c}}class g extends u{constructor(t,e,i){super(t,e,i),this.single=2===i.length&&""===i[0]&&""===i[1]}_createPart(){return new m(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class m extends d{}let A=!1;(()=>{try{const t={get capture(){return A=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class v{constructor(t,e,i){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=i,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;(0,n.q)(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=r.c,t(this)}if(this.__pendingValue===r.c)return;const t=this.__pendingValue,e=this.value,i=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),s=null!=t&&(null==e||i);i&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),s&&(this.__options=y(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=r.c}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const y=t=>t&&(A?{capture:t.capture,passive:t.passive,once:t.once}:t.capture)},3889:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n,s=i(3423),r=i(9309);!function(t){t[t.Basic=0]="Basic",t[t.PCF=1]="PCF",t[t.PCFSoft=2]="PCFSoft"}(n||(n={}));const o={[n.Basic]:0,[n.PCF]:1,[n.PCFSoft]:2};class a extends s.Ay{constructor(t,e){super(t,e),this.ins=this.addInputs(a.ins),this.outs=this.addOutputs(a.outs),this.views=[],this._activeSceneComponent=null,this._forceRender=!1,this.addEvents("active-scene","active-camera")}get activeSceneComponent(){return this._activeSceneComponent}set activeSceneComponent(t){if(t!==this._activeSceneComponent){const e=this._activeSceneComponent,i=this.activeCameraComponent;e&&e.off("active-camera",this.onActiveCamera,this),t&&t.on("active-camera",this.onActiveCamera,this),this._activeSceneComponent=t;const n=this.activeCameraComponent,s={type:"active-scene",previous:e,next:t};this.emit(s);const r={type:"active-camera",previous:i,next:n};this.emit(r)}}get activeSceneGraph(){return this._activeSceneComponent?this._activeSceneComponent.graph:null}get activeScene(){return this._activeSceneComponent?this._activeSceneComponent.scene:null}get activeCameraComponent(){return this._activeSceneComponent?this._activeSceneComponent.activeCameraComponent:null}get activeCamera(){const t=this._activeSceneComponent?this._activeSceneComponent.activeCameraComponent:null;return t?t.camera:null}forceRender(){this._forceRender=!0}create(){super.create(),this.trackComponent(r.A,t=>{t.on("pulse",this.onPulse,this)},t=>{t.off("pulse",this.onPulse,this)})}update(){const t=this.ins;return t.exposure.changed&&this.views.forEach(e=>e.renderer.toneMappingExposure=t.exposure.value),t.gamma.changed,t.shadowsEnabled.changed&&this.views.forEach(e=>e.renderer.shadowMap.enabled=t.shadowsEnabled.value),t.shadowMapType.changed&&this.views.forEach(e=>e.renderer.shadowMap.type=o[t.shadowMapType.getValidatedValue()]),!0}attachView(t){if(0===this.views.length){const e=t.renderer,i=this.outs;i.maxTextureSize.setValue(e.capabilities.maxTextureSize),i.maxCubemapSize.setValue(e.capabilities.maxCubemapSize)}this.views.push(t)}detachView(t){const e=this.views.indexOf(t);if(e<0)throw new Error("render view not registered");this.views.splice(e,1)}logInfo(){this.views.forEach(t=>{console.log(t.renderer.info)})}onPulse(t){(t.systemUpdated||this._forceRender)&&(this.views.forEach(t=>{if(!t.renderer.xr.isPresenting){const e=(performance||Date).now();t.render(),this.outs.framerate.value=.9*this.outs.framerate.value+100/((performance||Date).now()-e)}}),this._forceRender=!1)}onActiveCamera(t){this.emit(t)}}a.typeName="CRenderer",a.isSystemSingleton=!0,a.ins={exposure:s.gK.Number("Shading.Exposure",1),gamma:s.gK.Number("Shading.Gamma",2),shadowsEnabled:s.gK.Boolean("Shadows.Enabled",!0),shadowMapType:s.gK.Enum("Shadows.MapType",n,n.PCF)},a.outs={maxTextureSize:s.gK.Integer("Caps.MaxTextureSize"),maxCubemapSize:s.gK.Integer("Caps.MaxCubemapSize"),framerate:s.gK.Integer("Renderer.Framerate")}},3911:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var n=i(8446),s=i(3675);class r extends n.A{constructor(){super(...arguments),this._language=s.aL[s.Nm]}static fromJSON(t){return new r(t)}toString(){return this.title}get title(){return 0===Object.keys(this.data.titles).length&&(this.data.titles[s.aL[this.language]]=this.data.title),this.data.titles[s.aL[this.language]]||"Missing content"}set title(t){this.data.titles[s.aL[this.language]]=t,this.update()}get defaultTitle(){return 0===Object.keys(this.data.titles).length&&(this.data.titles[s.aL[this.language]]=this.data.title),this.data.titles[s.aL[this.language]]||"Missing content"}titleIn(t){return 0===Object.keys(this.data.titles).length&&(this.data.titles[s.aL[this.language]]=this.data.title),this.data.titles[t]}get uri(){return 0===Object.keys(this.data.uris).length&&(this.data.uris[s.aL[this.language]]=this.data.uri),this.data.uris[s.aL[this.language]]}set uri(t){this.data.uris[s.aL[this.language]]=t,this.update()}get lead(){return 0===Object.keys(this.data.leads).length&&(this.data.leads[s.aL[this.language]]=this.data.lead),this.data.leads[s.aL[this.language]]||""}set lead(t){this.data.leads[s.aL[this.language]]=t,this.update()}get tags(){return 0===Object.keys(this.data.taglist).length&&this.data.tags.length>0&&(this.data.taglist[s.aL[this.language]]=this.data.tags),this.data.taglist[s.aL[this.language]]||[]}set tags(t){this.data.taglist[s.aL[this.language]]=t,this.update()}get language(){return this._language}set language(t){this._language=t}init(){return{id:n.A.generateId(),title:"New Article",titles:{},lead:"",leads:{},tags:[],taglist:{},uri:"",uris:{},mimeType:"",thumbnailUri:""}}deflate(t,e){e.id=t.id,Object.keys(this.data.uris).length>0?(e.uris={},Object.keys(this.data.uris).forEach(i=>{e.uris[i]=t.uris[i]})):t.uri&&(e.uri=t.uri),Object.keys(this.data.titles).length>0?(e.titles={},Object.keys(this.data.titles).forEach(i=>{e.titles[i]=t.titles[i]})):t.title&&(e.title=t.title),Object.keys(this.data.leads).length>0?(e.leads={},Object.keys(this.data.leads).forEach(i=>{e.leads[i]=t.leads[i]})):t.lead&&(e.lead=t.lead),Object.keys(this.data.taglist).length>0?(e.taglist={},Object.keys(this.data.taglist).forEach(i=>{e.taglist[i]=t.taglist[i].slice()})):t.tags.length>0&&(e.tags=t.tags.slice()),t.mimeType&&(e.mimeType=t.mimeType),t.thumbnailUri&&(e.thumbnailUri=t.thumbnailUri)}inflate(t,e){e.id=t.id,e.uri=t.uri||"",e.uris=t.uris||{},e.title=t.title||"",e.titles=t.titles||{},e.lead=t.lead||"",e.leads=t.leads||{},e.tags=t.tags||[],e.taglist=t.taglist||{},e.mimeType=t.mimeType||"",e.thumbnailUri=t.thumbnailUri||""}}},3928:t=>{"use strict";t.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},3963:t=>{"use strict";t.exports.isClean=Symbol("isClean"),t.exports.my=Symbol("my")},4019:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var n=i(6763),s=(i(9498),function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o});class r extends n.Ay{constructor(){super(...arguments),this.property=null,this.name="",this.text=null,this.language=null}firstConnected(){this.classList.add("sv-property")}update(t){if(t.has("property")){if(!this.property)throw new Error("missing property attribute");if(this.type&&this.property.type!==this.type)throw new Error(`not a ${this.type} property`);const e=t.get("property");e&&e.off("value",this.onUpdate,this),this.property&&this.property.on("value",this.onUpdate,this)}super.update(t)}}s([(0,n.MZ)({attribute:!1})],r.prototype,"property",void 0),s([(0,n.MZ)({type:String})],r.prototype,"name",void 0),s([(0,n.MZ)({attribute:!1})],r.prototype,"text",void 0),s([(0,n.MZ)({attribute:!1})],r.prototype,"language",void 0),s([(0,n.MZ)({attribute:"aria-disabled"})],r.prototype,"ariaDisabled",void 0)},4035:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:t})=>n.str`must be multiple of ${t}`,params:({schemaCode:t})=>n._`{multipleOf: ${t}}`},code(t){const{gen:e,data:i,schemaCode:s,it:r}=t,o=r.opts.multipleOfPrecision,a=e.let("res"),l=o?n._`Math.abs(Math.round(${a}) - ${a}) > 1e-${o}`:n._`${a} !== parseInt(${a})`;t.fail$data(n._`(${s} === 0 || (${a} = ${i}/${s}, ${l}))`)}};e.default=s},4038:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var n=i(2310);Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return n.KeywordCxt}});var s=i(5265);Object.defineProperty(e,"_",{enumerable:!0,get:function(){return s._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return s.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return s.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return s.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return s.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return s.CodeGen}});const r=i(2874),o=i(4507),a=i(1168),l=i(6719),c=i(5265),h=i(5391),u=i(444),d=i(3151),p=i(3770),f=["removeAdditional","useDefaults","coerceTypes"],g=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),m={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},A={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function v(t){var e,i,n,s,r,o,a,l,c,h,u,d,p,f,g,m,A,v,y,b,_,x;const w=t.strict,E=null===(e=t.code)||void 0===e?void 0:e.optimize,C=!0===E||void 0===E?1:E||0;return{strictSchema:null===(n=null!==(i=t.strictSchema)&&void 0!==i?i:w)||void 0===n||n,strictNumbers:null===(r=null!==(s=t.strictNumbers)&&void 0!==s?s:w)||void 0===r||r,strictTypes:null!==(a=null!==(o=t.strictTypes)&&void 0!==o?o:w)&&void 0!==a?a:"log",strictTuples:null!==(c=null!==(l=t.strictTuples)&&void 0!==l?l:w)&&void 0!==c?c:"log",strictRequired:null!==(u=null!==(h=t.strictRequired)&&void 0!==h?h:w)&&void 0!==u&&u,code:t.code?{...t.code,optimize:C}:{optimize:C},loopRequired:null!==(d=t.loopRequired)&&void 0!==d?d:200,loopEnum:null!==(p=t.loopEnum)&&void 0!==p?p:200,meta:null===(f=t.meta)||void 0===f||f,messages:null===(g=t.messages)||void 0===g||g,inlineRefs:null===(m=t.inlineRefs)||void 0===m||m,schemaId:null!==(A=t.schemaId)&&void 0!==A?A:"$id",addUsedSchema:null===(v=t.addUsedSchema)||void 0===v||v,validateSchema:null===(y=t.validateSchema)||void 0===y||y,validateFormats:null===(b=t.validateFormats)||void 0===b||b,unicodeRegExp:null===(_=t.unicodeRegExp)||void 0===_||_,int32range:null===(x=t.int32range)||void 0===x||x}}class y{constructor(t={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,t=this.opts={...t,...v(t)};const{es5:e,lines:i}=this.opts.code;this.scope=new c.ValueScope({scope:{},prefixes:g,es5:e,lines:i}),this.logger=function(t){if(!1===t)return S;if(void 0===t)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}(t.logger);const n=t.validateFormats;t.validateFormats=!1,this.RULES=(0,a.getRules)(),b.call(this,m,t,"NOT SUPPORTED"),b.call(this,A,t,"DEPRECATED","warn"),this._metaOpts=C.call(this),t.formats&&w.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),t.keywords&&E.call(this,t.keywords),"object"==typeof t.meta&&this.addMetaSchema(t.meta),x.call(this),t.validateFormats=n}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:t,meta:e,schemaId:i}=this.opts;let n=p;"id"===i&&(n={...p},n.id=n.$id,delete n.$id),e&&t&&this.addMetaSchema(n,n[i],!1)}defaultMeta(){const{meta:t,schemaId:e}=this.opts;return this.opts.defaultMeta="object"==typeof t?t[e]||t:void 0}validate(t,e){let i;if("string"==typeof t){if(i=this.getSchema(t),!i)throw new Error(`no schema with key or ref "${t}"`)}else i=this.compile(t);const n=i(e);return"$async"in i||(this.errors=i.errors),n}compile(t,e){const i=this._addSchema(t,e);return i.validate||this._compileSchemaEnv(i)}compileAsync(t,e){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:i}=this.opts;return n.call(this,t,e);async function n(t,e){await s.call(this,t.$schema);const i=this._addSchema(t,e);return i.validate||r.call(this,i)}async function s(t){t&&!this.getSchema(t)&&await n.call(this,{$ref:t},!0)}async function r(t){try{return this._compileSchemaEnv(t)}catch(e){if(!(e instanceof o.default))throw e;return a.call(this,e),await l.call(this,e.missingSchema),r.call(this,t)}}function a({missingSchema:t,missingRef:e}){if(this.refs[t])throw new Error(`AnySchema ${t} is loaded but ${e} cannot be resolved`)}async function l(t){const i=await c.call(this,t);this.refs[t]||await s.call(this,i.$schema),this.refs[t]||this.addSchema(i,t,e)}async function c(t){const e=this._loading[t];if(e)return e;try{return await(this._loading[t]=i(t))}finally{delete this._loading[t]}}}addSchema(t,e,i,n=this.opts.validateSchema){if(Array.isArray(t)){for(const e of t)this.addSchema(e,void 0,i,n);return this}let s;if("object"==typeof t){const{schemaId:e}=this.opts;if(s=t[e],void 0!==s&&"string"!=typeof s)throw new Error(`schema ${e} must be string`)}return e=(0,h.normalizeId)(e||s),this._checkUnique(e),this.schemas[e]=this._addSchema(t,i,e,n,!0),this}addMetaSchema(t,e,i=this.opts.validateSchema){return this.addSchema(t,e,!0,i),this}validateSchema(t,e){if("boolean"==typeof t)return!0;let i;if(i=t.$schema,void 0!==i&&"string"!=typeof i)throw new Error("$schema must be a string");if(i=i||this.opts.defaultMeta||this.defaultMeta(),!i)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const n=this.validate(i,t);if(!n&&e){const t="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(t);this.logger.error(t)}return n}getSchema(t){let e;for(;"string"==typeof(e=_.call(this,t));)t=e;if(void 0===e){const{schemaId:i}=this.opts,n=new l.SchemaEnv({schema:{},schemaId:i});if(e=l.resolveSchema.call(this,n,t),!e)return;this.refs[t]=e}return e.validate||this._compileSchemaEnv(e)}removeSchema(t){if(t instanceof RegExp)return this._removeAllSchemas(this.schemas,t),this._removeAllSchemas(this.refs,t),this;switch(typeof t){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const e=_.call(this,t);return"object"==typeof e&&this._cache.delete(e.schema),delete this.schemas[t],delete this.refs[t],this}case"object":{const e=t;this._cache.delete(e);let i=t[this.opts.schemaId];return i&&(i=(0,h.normalizeId)(i),delete this.schemas[i],delete this.refs[i]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(t){for(const e of t)this.addKeyword(e);return this}addKeyword(t,e){let i;if("string"==typeof t)i=t,"object"==typeof e&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),e.keyword=i);else{if("object"!=typeof t||void 0!==e)throw new Error("invalid addKeywords parameters");if(i=(e=t).keyword,Array.isArray(i)&&!i.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(M.call(this,i,e),!e)return(0,d.eachItem)(i,t=>T.call(this,t)),this;R.call(this,e);const n={...e,type:(0,u.getJSONTypes)(e.type),schemaType:(0,u.getJSONTypes)(e.schemaType)};return(0,d.eachItem)(i,0===n.type.length?t=>T.call(this,t,n):t=>n.type.forEach(e=>T.call(this,t,n,e))),this}getKeyword(t){const e=this.RULES.all[t];return"object"==typeof e?e.definition:!!e}removeKeyword(t){const{RULES:e}=this;delete e.keywords[t],delete e.all[t];for(const i of e.rules){const e=i.rules.findIndex(e=>e.keyword===t);e>=0&&i.rules.splice(e,1)}return this}addFormat(t,e){return"string"==typeof e&&(e=new RegExp(e)),this.formats[t]=e,this}errorsText(t=this.errors,{separator:e=", ",dataVar:i="data"}={}){return t&&0!==t.length?t.map(t=>`${i}${t.instancePath} ${t.message}`).reduce((t,i)=>t+e+i):"No errors"}$dataMetaSchema(t,e){const i=this.RULES.all;t=JSON.parse(JSON.stringify(t));for(const n of e){const e=n.split("/").slice(1);let s=t;for(const t of e)s=s[t];for(const t in i){const e=i[t];if("object"!=typeof e)continue;const{$data:n}=e.definition,r=s[t];n&&r&&(s[t]=L(r))}}return t}_removeAllSchemas(t,e){for(const i in t){const n=t[i];e&&!e.test(i)||("string"==typeof n?delete t[i]:n&&!n.meta&&(this._cache.delete(n.schema),delete t[i]))}}_addSchema(t,e,i,n=this.opts.validateSchema,s=this.opts.addUsedSchema){let r;const{schemaId:o}=this.opts;if("object"==typeof t)r=t[o];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof t)throw new Error("schema must be object or boolean")}let a=this._cache.get(t);if(void 0!==a)return a;i=(0,h.normalizeId)(r||i);const c=h.getSchemaRefs.call(this,t,i);return a=new l.SchemaEnv({schema:t,schemaId:o,meta:e,baseId:i,localRefs:c}),this._cache.set(a.schema,a),s&&!i.startsWith("#")&&(i&&this._checkUnique(i),this.refs[i]=a),n&&this.validateSchema(t,!0),a}_checkUnique(t){if(this.schemas[t]||this.refs[t])throw new Error(`schema with key or id "${t}" already exists`)}_compileSchemaEnv(t){if(t.meta?this._compileMetaSchema(t):l.compileSchema.call(this,t),!t.validate)throw new Error("ajv implementation error");return t.validate}_compileMetaSchema(t){const e=this.opts;this.opts=this._metaOpts;try{l.compileSchema.call(this,t)}finally{this.opts=e}}}function b(t,e,i,n="error"){for(const s in t){const r=s;r in e&&this.logger[n](`${i}: option ${s}. ${t[r]}`)}}function _(t){return t=(0,h.normalizeId)(t),this.schemas[t]||this.refs[t]}function x(){const t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(const e in t)this.addSchema(t[e],e)}function w(){for(const t in this.opts.formats){const e=this.opts.formats[t];e&&this.addFormat(t,e)}}function E(t){if(Array.isArray(t))this.addVocabulary(t);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const e in t){const i=t[e];i.keyword||(i.keyword=e),this.addKeyword(i)}}}function C(){const t={...this.opts};for(const e of f)delete t[e];return t}e.default=y,y.ValidationError=r.default,y.MissingRefError=o.default;const S={log(){},warn(){},error(){}};const I=/^[a-z_$][a-z0-9_$:-]*$/i;function M(t,e){const{RULES:i}=this;if((0,d.eachItem)(t,t=>{if(i.keywords[t])throw new Error(`Keyword ${t} is already defined`);if(!I.test(t))throw new Error(`Keyword ${t} has invalid name`)}),e&&e.$data&&!("code"in e)&&!("validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function T(t,e,i){var n;const s=null==e?void 0:e.post;if(i&&s)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:r}=this;let o=s?r.post:r.rules.find(({type:t})=>t===i);if(o||(o={type:i,rules:[]},r.rules.push(o)),r.keywords[t]=!0,!e)return;const a={keyword:t,definition:{...e,type:(0,u.getJSONTypes)(e.type),schemaType:(0,u.getJSONTypes)(e.schemaType)}};e.before?B.call(this,o,a,e.before):o.rules.push(a),r.all[t]=a,null===(n=e.implements)||void 0===n||n.forEach(t=>this.addKeyword(t))}function B(t,e,i){const n=t.rules.findIndex(t=>t.keyword===i);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${i} is not defined`))}function R(t){let{metaSchema:e}=t;void 0!==e&&(t.$data&&this.opts.$data&&(e=L(e)),t.validateSchema=this.compile(e,!0))}const P={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function L(t){return{anyOf:[t,P]}}},4085:(t,e,i)=>{"use strict";i.d(e,{A:()=>l,k:()=>n.k});var n=i(4222),s=i(2464),r=i(1721),o=i(9616),a=i(5659);class l extends n.A{constructor(){super(...arguments),this.targetFeatures={}}create(){super.create();const t=this.getGraphComponent(r.A);Object.keys(t.featureMap).forEach(t=>{this.targetFeatures[t]=!1}),this.targetFeatures.models=!1,this.targetFeatures.lights=!1,this.initializeTargetFeatures()}initializeTargetFeatures(){const t=this.targetFeatures;Object.keys(t).forEach(e=>t[e]=!1),t.navigation=!0,t.reader=!0,t.viewer=!0,this.updateTargets()}updateTargets(){const t=this.targetFeatures,e=this.getGraphComponent(r.A);Object.keys(t).forEach(i=>{const n=e[i],s=t[i];n&&this.updateComponentTarget(n,s)});this.getGraphComponents(o.A).forEach(e=>{this.updateComponentTarget(e.transform,!!t.models),this.updateComponentTarget(e,!!t.models)});this.getGraphComponents(s.A).forEach(e=>{this.updateComponentTarget(e.transform,!!t.lights),this.updateComponentTarget(e,!!t.lights)})}updateComponentTarget(t,e){const i=t.snapshotProperties;i&&i.forEach(t=>{if(!t.schema.event&&"object"!==t.type){const i=this.hasTargetProperty(t);e&&!i?this.addTargetProperty(t):!e&&i&&this.removeTargetProperty(t)}})}fromData(t,e){this.clear();const i=this.targetFeatures,s=Object.keys(i);t.features?s.forEach(e=>i[e]=t.features.indexOf(e)>=0):this.initializeTargetFeatures();const r=new Set;t.targets.forEach((t,i)=>{const n=t.lastIndexOf("/"),s=t.substr(0,n),o=t.substr(n+1),a=e.get(s),l=a?a.ins[o]:null;l?this.addTargetProperty(l):(console.warn(`missing snapshot target property for '${t}'`),r.add(i))}),t.states.forEach(t=>{t.id!==a.A.sceneSnapshotId&&this.setState({id:t.id,curve:void 0!==t.curve?n.k[t.curve]:n.k.EaseQuad,duration:void 0!==t.duration?t.duration:2,threshold:void 0!==t.threshold?t.threshold:.5,values:t.values.filter((t,e)=>!r.has(e))})})}toData(t){const e=this.targetFeatures,i={features:Object.keys(e).filter(t=>e[t]),targets:this.targets.map(e=>{const i=e.property.group.linkable,n=e.property.key,s=t.get(i);if(!s)throw new Error(`snapshot path not registered for component '${i.displayName}'`);return s+"/"+n}),states:Object.keys(this.states).map(t=>{const e=this.states[t],i={id:e.id,values:e.values};return e.curve!==n.k.EaseQuad&&(i.curve=n.k[e.curve]),2!==e.duration&&(i.duration=e.duration),.5!==e.threshold&&(i.threshold=e.threshold),i})};return i.targets.length>0&&i.states.length>0?i:null}}l.typeName="CVSnapshots"},4088:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var n=i(4640),s=i(3423),r=i(2464);class o extends r.A{constructor(t,e){super(t,e),this.ins=this.addInputs(o.hemiLightIns),this.object3D=new n.dth}get light(){return this.object3D}update(t){super.update(t);const e=this.light,i=this.ins;return(i.ground.changed||i.intensity.changed)&&(e.groundColor.fromArray(i.ground.value),e.intensity=i.intensity.value),!0}}o.typeName="CHemisphereLight",o.hemiLightIns={ground:s.gK.ColorRGB("Light.Ground",[.31,.31,.125])}},4106:(t,e,i)=>{"use strict";function n(t,e){return e=e||{},new Promise(function(i,n){var s=new XMLHttpRequest,r=[],o=[],a={},l=function(){return{ok:2==(s.status/100|0),statusText:s.statusText,status:s.status,url:s.responseURL,text:function(){return Promise.resolve(s.responseText)},json:function(){return Promise.resolve(s.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([s.response]))},clone:l,headers:{keys:function(){return r},entries:function(){return o},get:function(t){return a[t.toLowerCase()]},has:function(t){return t.toLowerCase()in a}}}};for(var c in s.open(e.method||"get",t,!0),s.onload=function(){s.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(t,e,i){r.push(e=e.toLowerCase()),o.push([e,i]),a[e]=a[e]?a[e]+","+i:i}),i(l())},s.onerror=n,s.withCredentials="include"==e.credentials,e.headers)s.setRequestHeader(c,e.headers[c]);s.send(e.body||null)})}i.r(e),i.d(e,{default:()=>n})},4146:(t,e,i)=>{"use strict";i.d(e,{A:()=>a,X:()=>n});var n,s=i(3423),r=i(1860),o=i(5240);!function(t){t[t.Node=0]="Node",t[t.Graph=1]="Graph",t[t.Main=2]="Main",t[t.System=3]="System"}(n||(n={}));class a extends s.Ay{constructor(){super(...arguments),this._scope=n.Node,this._scopedNode=null,this._scopedGraph=null,this._activeComponent=null}get componentType(){return this.constructor.componentType}get followComponentSelection(){return this.constructor.followComponentSelection}get followNodeSelection(){return this.constructor.followNodeSelection}get retainSelection(){return this.constructor.retainSelection}get scope(){return this._scope}set scope(t){this._scope=t,this._activeComponent&&!this.isComponentInScope(this._activeComponent)&&(this.activeComponent=null)}get scopedNode(){return this._scopedNode}set scopedNode(t){t!==this._scopedNode&&(this._scopedNode=t,this._activeComponent&&!this.isComponentInScope(this._activeComponent)&&(this.activeComponent=null),this.onScopedComponents(),this.emit({type:"scoped-components"}))}get scopedGraph(){return this._scopedGraph}set scopedGraph(t){t!==this._scopedGraph&&(this._scopedGraph=t,this._activeComponent&&!this.isComponentInScope(this._activeComponent)&&(this.activeComponent=null),this.onScopedComponents(),this.emit({type:"scoped-components"}))}get scopedComponents(){switch(this._scope){case n.Node:return(this._scopedNode||this.node).getComponents(this.componentType);case n.Graph:return(this._scopedGraph?this._scopedGraph.innerGraph:this.graph).getComponents(this.componentType);case n.Main:return this.getMainComponents(this.componentType);case n.System:return this.getSystemComponents(this.componentType)}}get activeComponent(){return this._activeComponent}set activeComponent(t){const e=this.activeComponent;if(t!==e){if(e&&this.deactivateComponent(e),t){if(!this.isComponentInScope(t))throw new Error("can't activate, component out of scope");this.activateComponent(t)}this._activeComponent=t,this.onActiveComponent(e,t),this.emit({type:"active-component",previous:e,next:t})}}get selection(){return this.getSystemComponent(o.A)}create(){super.create(),this.system.components.on(s.Ay,this.onComponent,this),this.followComponentSelection&&this.selection.selectedComponents.on(this.componentType,this.onSelectComponent,this),this.followNodeSelection&&this.selection.selectedNodes.on(r.A,this.onSelectNode,this)}dispose(){this.activeComponent&&(this.activeComponent=null),this.system.components.off(s.Ay,this.onComponent,this),this.followComponentSelection&&this.selection.selectedComponents.off(this.componentType,this.onSelectComponent,this),this.followNodeSelection&&this.selection.selectedNodes.off(r.A,this.onSelectNode,this),super.dispose()}activateComponent(t){}deactivateComponent(t){}onActiveComponent(t,e){}onScopedComponents(){}onComponent(t){t.remove&&t.object===this.activeComponent&&(this.activeComponent=null),this.isComponentInScope(t.object)&&(this.onScopedComponents(),this.emit({type:"scoped-components"}))}onSelectComponent(t){const e=t.object;this.isComponentInScope(e)&&(t.add?this.activeComponent=e:t.remove&&!this.retainSelection&&e===this.activeComponent&&(this.activeComponent=null))}onSelectNode(t){const e=t.object;if(this.isNodeInScope(e)){const i=e.getComponent(this.componentType);i&&this.onSelectComponent({type:i.typeName,object:i,add:t.add,remove:t.remove})}}isComponentInScope(t){if(!t.is(this.componentType))return!1;switch(this._scope){case n.Node:const e=this._scopedNode||this.node;return t.node===e;case n.Graph:const i=this._scopedGraph?this._scopedGraph.innerGraph:this.graph;return t.graph===i;case n.Main:return t.graph===this.system.graph;case n.System:return!0}return!1}isNodeInScope(t){switch(this._scope){case n.Node:return t===(this._scopedNode||this.node);case n.Graph:const e=this._scopedGraph?this._scopedGraph.innerGraph:this.graph;return t.graph===e;case n.Main:return t.graph===this.system.graph;case n.System:return!0}}}a.typeName="CComponentProvider",a.componentType=s.Ay,a.followComponentSelection=!0,a.followNodeSelection=!1,a.retainSelection=!0},4179:t=>{"use strict";t.exports=t=>{if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}},4200:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3151),s={keyword:"allOf",schemaType:"array",code(t){const{gen:e,schema:i,it:s}=t;if(!Array.isArray(i))throw new Error("ajv implementation error");const r=e.name("valid");i.forEach((e,i)=>{if((0,n.alwaysValidSchema)(s,e))return;const o=t.subschema({keyword:"allOf",schemaProp:i},r);t.ok(r),t.mergeEvaluated(o)})}};e.default=s},4222:(t,e,i)=>{"use strict";i.d(e,{A:()=>o,k:()=>n.kp});var n=i(2690),s=i(3423),r=i(449);class o extends s.Ay{constructor(){super(...arguments),this.ins=this.addInputs(o.ins),this.outs=this.addOutputs(o.outs),this.targets=[],this.states={},this._currentValues=null,this._targetState=null,this._startTime=0,this._easingFunction=null}getState(t){return this.states[t]}setState(t){return t.id=t.id||(0,r.A)(6),this.states[t.id]=t,t.id}deleteState(t){delete this.states[t]}clear(){this.targets.forEach(t=>t.property.off("dispose",this.onPropertyDispose,this)),this.targets.length=0,this.states={},this._currentValues=null,this._targetState=null,this._startTime=0,this._easingFunction=null}dispose(){this.clear(),super.dispose()}tweenTo(t,e){const i=this.states[t],s=this.outs;if(i)return this._targetState=i,this._currentValues=this.getCurrentValues(),this._startTime=e,this._easingFunction=(0,n.My)(i.curve),s.switched.setValue(!1),s.tweening.setValue(!0),s.start.set(),!0}update(t){const e=this.ins,i=this.states,n=e.id.value,s=i[n];if(s){if((e.tween.changed||e.recall.changed)&&(e.curve.setValue(s.curve),e.duration.setValue(s.duration),e.threshold.setValue(s.threshold)),e.tween.changed)return this.tweenTo(n,t.secondsElapsed),!0;if(e.recall.changed)return this.setValues(s.values),!0;(e.curve.changed||e.duration.changed||e.threshold.changed)&&(s.curve=e.curve.value,s.duration=e.duration.value,s.threshold=e.threshold.value),e.store.changed&&(s.values=this.getCurrentValues()),e.delete.changed&&delete i[n]}else if(n&&e.store.changed){const t={id:this.ins.id.value,curve:this.ins.curve.getValidatedValue(),duration:this.ins.duration.value,threshold:this.ins.threshold.value,values:this.getCurrentValues()};i[t.id]=t}return!0}tick(t){const e=this._targetState;if(!e)return!1;const i=this.outs,n=this._currentValues,s=this._startTime,r=t.secondsElapsed-s,o=r/e.duration;if(o<1){const t=this._easingFunction(o),s=o>=e.threshold&&!i.switched.value;this.setValues(n,e.values,t,s),i.time.setValue(r),i.completed.setValue(o),s&&(i.switched.setValue(!0),i.switch.set())}else this.setValues(n,e.values,1,!i.switched.value),i.tweening.setValue(!1),i.time.setValue(e.duration),i.completed.setValue(1),i.end.set(),i.switched.value||i.switched.setValue(!0),this._currentValues=null,this._targetState=null,this._startTime=0,this._easingFunction=null;return!0}addTargetProperty(t){if("object"===t.type||t.schema.event)throw new Error("can't add object or event properties");if(this.getTarget(t))throw new Error("can't add, target already exists");t.on("dispose",this.onPropertyDispose,this);const e="number"===t.type&&!t.schema.options,i=t.isArray();this.targets.push({property:t,isNumber:e,isArray:i});const n=this.states,s=Object.keys(n);for(let e=0,i=s.length;e<i;++e)n[s[e]].values.push(t.cloneValue());this._currentValues&&this._currentValues.push(t.cloneValue())}removeTargetProperty(t){const e=this.getTarget(t);if(!e)throw new Error("can't remove, target doesn't exist");this.removeTarget(e)}hasTargetProperty(t){return!!this.getTarget(t)}fromJSON(t){super.fromJSON(t),t.state&&this.stateFromJSON(t.state)}stateFromJSON(t){t.targets&&(this.targets=t.targets.map(t=>{const e=this.getProperty(t.id,t.key);return{property:e,isNumber:!!e&&"number"===e.type&&!e.schema.options,isArray:!!e&&e.isArray()}})),t.states&&t.states.forEach(t=>this.states[t.id]=t),this._startTime=0}toJSON(){const t=super.toJSON(),e=this.stateToJSON();return e&&(t.state=e),t}stateToJSON(){const t={},e=this.targets;e.length>0&&(t.targets=e.map(t=>({id:t.property.group.linkable.id,key:t.property.key})));const i=Object.keys(this.states);return i.length>0&&(t.states=i.map(t=>this.states[t])),t}getTargetProperties(){return this.targets.map(t=>t.property)}onPropertyDispose(t){t.property.off("dispose",this.onPropertyDispose,this);const e=this.getTarget(t.property);this.removeTarget(e)}removeTarget(t){const e=this.targets.indexOf(t);this.targets.splice(e,1),this.removeChannel(e)}removeChannel(t){const e=this.states,i=Object.keys(e);for(let n=0,s=i.length;n<s;++n)e[i[n]].values.splice(t,1);this._currentValues&&this._currentValues.splice(t,1)}getTarget(t){return this.targets.find(e=>e.property===t)}getProperty(t,e){const i=this.system.components.getById(t);return i?i.ins[e]:null}setValues(t,e,i,n){const s=this.targets;for(let r=0,o=s.length;r<o;++r){const o=s[r],a=o.property;if(o.isNumber&&e&&null!==e[r]){const n=t[r],s=e[r];if(o.isArray){let t=!1;for(let e=0,r=n.length;e<r;++e){const r=n[e]+i*(s[e]-n[e]);t=a.value[e]!==r||t,a.value[e]=r}t&&a.set()}else{const t=n+i*(s-n);t!==a.value&&a.setValue(t)}}else if(!e||n){const i=e&&null!==e[r]?e[r]:t[r];if(o.isArray){let t=!1;for(let e=0,n=i.length;e<n;++e)t=a.value[e]!==i[e]||t,a.value[e]=i[e];t&&a.set()}else i!==a.value&&a.setValue(i)}}}getCurrentValues(){const t=[],e=this.targets;for(let i=0,n=e.length;i<n;++i)t.push(e[i].property.cloneValue());return t}}o.typeName="CTweenMachine",o.ins={id:s.gK.String("Snapshot.Id"),curve:s.gK.Enum("Tween.Curve",n.kp),duration:s.gK.Number("Tween.Duration",2),threshold:s.gK.Percent("Tween.Threshold",.5),tween:s.gK.Event("Control.Tween"),recall:s.gK.Event("Control.Recall"),store:s.gK.Event("Control.Store"),delete:s.gK.Event("Control.Delete"),clear:s.gK.Event("Control.Clear")},o.outs={count:s.gK.Integer("Snapshots.Count"),tweening:s.gK.Boolean("Tween.IsTweening"),time:s.gK.Number("Tween.Time"),completed:s.gK.Percent("Tween.Completed"),switched:s.gK.Boolean("Tween.Switched"),start:s.gK.Event("Tween.Start"),switch:s.gK.Event("Tween.Switch"),end:s.gK.Event("Tween.End")}},4240:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>o,EM:()=>n.EM,MZ:()=>n.MZ,qy:()=>n.qy});var n=i(6763),s=i(1071),r=i(8177);class o extends r.Ay{constructor(){super(...arguments),this.activeNode=null}get nodeProvider(){return this.system.getMainComponent(s.A)}connected(){super.connected();const t=this.nodeProvider;t.on("active-node",this.onActiveNodeEvent,this),t.activeNode&&(this.activeNode=t.activeNode,this.onActiveNode(null,t.activeNode))}disconnected(){const t=this.nodeProvider;t.off("active-node",this.onActiveNodeEvent,this),t.activeNode&&(this.activeNode=null,this.onActiveNode(t.activeNode,null)),super.disconnected()}onActiveNode(t,e){this.requestUpdate()}onActiveNodeEvent(t){this.activeNode=t.next,this.onActiveNode(t.previous,t.next)}}},4260:(t,e,i)=>{const n=i(20),s=i(4179),{isPlainObject:r}=i(9171),o=i(5068),a=i(9038),{parse:l}=i(587),c=["img","audio","video","picture","svg","object","map","iframe","embed"],h=["script","style"];function u(t,e){t&&Object.keys(t).forEach(function(i){e(t[i],i)})}function d(t,e){return{}.hasOwnProperty.call(t,e)}function p(t,e){const i=[];return u(t,function(t){e(t)&&i.push(t)}),i}t.exports=g;const f=/^[^\0\t\n\f\r /<=>]+$/;function g(t,e,i){if(null==t)return"";"number"==typeof t&&(t=t.toString());let A="",v="";function y(t,e){const i=this;this.tag=t,this.attribs=e||{},this.tagPosition=A.length,this.text="",this.mediaChildren=[],this.updateParentNodeText=function(){if(B.length){B[B.length-1].text+=i.text}},this.updateParentNodeMediaChildren=function(){if(B.length&&c.includes(this.tag)){B[B.length-1].mediaChildren.push(this.tag)}}}(e=Object.assign({},g.defaults,e)).parser=Object.assign({},m,e.parser);const b=function(t){return!1===e.allowedTags||(e.allowedTags||[]).indexOf(t)>-1};h.forEach(function(t){b(t)&&!e.allowVulnerableTags&&console.warn(`\n\n⚠️ Your \`allowedTags\` option includes, \`${t}\`, which is inherently\nvulnerable to XSS attacks. Please remove it from \`allowedTags\`.\nOr, to disable this warning, add the \`allowVulnerableTags\` option\nand ensure you are accounting for this risk.\n\n`)});const _=e.nonTextTags||["script","style","textarea","option"];let x,w;e.allowedAttributes&&(x={},w={},u(e.allowedAttributes,function(t,e){x[e]=[];const i=[];t.forEach(function(t){"string"==typeof t&&t.indexOf("*")>=0?i.push(s(t).replace(/\\\*/g,".*")):x[e].push(t)}),i.length&&(w[e]=new RegExp("^("+i.join("|")+")$"))}));const E={},C={},S={};u(e.allowedClasses,function(t,e){if(x&&(d(x,e)||(x[e]=[]),x[e].push("class")),E[e]=t,Array.isArray(t)){const i=[];E[e]=[],S[e]=[],t.forEach(function(t){"string"==typeof t&&t.indexOf("*")>=0?i.push(s(t).replace(/\\\*/g,".*")):t instanceof RegExp?S[e].push(t):E[e].push(t)}),i.length&&(C[e]=new RegExp("^("+i.join("|")+")$"))}});const I={};let M,T,B,R,P,L,D;u(e.transformTags,function(t,e){let i;"function"==typeof t?i=t:"string"==typeof t&&(i=g.simpleTransform(t)),"*"===e?M=i:I[e]=i});let N=!1;k();const O=new n.Parser({onopentag:function(t,i){if(e.enforceHtmlBoundary&&"html"===t&&k(),L)return void D++;const n=new y(t,i);B.push(n);let s=!1;const c=!!n.text;let h;if(d(I,t)&&(h=I[t](t,i),n.attribs=i=h.attribs,void 0!==h.text&&(n.innerText=h.text),t!==h.tagName&&(n.name=t=h.tagName,P[T]=h.tagName)),M&&(h=M(t,i),n.attribs=i=h.attribs,t!==h.tagName&&(n.name=t=h.tagName,P[T]=h.tagName)),(!b(t)||"recursiveEscape"===e.disallowedTagsMode&&!function(t){for(const e in t)if(d(t,e))return!1;return!0}(R)||null!=e.nestingLimit&&T>=e.nestingLimit)&&(s=!0,R[T]=!0,"discard"!==e.disallowedTagsMode&&"completelyDiscard"!==e.disallowedTagsMode||-1!==_.indexOf(t)&&(L=!0,D=1),R[T]=!0),T++,s){if("discard"===e.disallowedTagsMode||"completelyDiscard"===e.disallowedTagsMode)return;v=A,A=""}A+="<"+t,"script"===t&&(e.allowedScriptHostnames||e.allowedScriptDomains)&&(n.innerText=""),(!x||d(x,t)||x["*"])&&u(i,function(i,s){if(!f.test(s))return void delete n.attribs[s];if(""===i&&!e.allowedEmptyAttributes.includes(s)&&(e.nonBooleanAttributes.includes(s)||e.nonBooleanAttributes.includes("*")))return void delete n.attribs[s];let c=!1;if(!x||d(x,t)&&-1!==x[t].indexOf(s)||x["*"]&&-1!==x["*"].indexOf(s)||d(w,t)&&w[t].test(s)||w["*"]&&w["*"].test(s))c=!0;else if(x&&x[t])for(const e of x[t])if(r(e)&&e.name&&e.name===s){c=!0;let t="";if(!0===e.multiple){const n=i.split(" ");for(const i of n)-1!==e.values.indexOf(i)&&(""===t?t=i:t+=" "+i)}else e.values.indexOf(i)>=0&&(t=i);i=t}if(c){if(-1!==e.allowedSchemesAppliedToAttributes.indexOf(s)&&F(t,i))return void delete n.attribs[s];if("script"===t&&"src"===s){let t=!0;try{const n=z(i);if(e.allowedScriptHostnames||e.allowedScriptDomains){const i=(e.allowedScriptHostnames||[]).find(function(t){return t===n.url.hostname}),s=(e.allowedScriptDomains||[]).find(function(t){return n.url.hostname===t||n.url.hostname.endsWith(`.${t}`)});t=i||s}}catch(e){t=!1}if(!t)return void delete n.attribs[s]}if("iframe"===t&&"src"===s){let t=!0;try{const n=z(i);if(n.isRelativeUrl)t=d(e,"allowIframeRelativeUrls")?e.allowIframeRelativeUrls:!e.allowedIframeHostnames&&!e.allowedIframeDomains;else if(e.allowedIframeHostnames||e.allowedIframeDomains){const i=(e.allowedIframeHostnames||[]).find(function(t){return t===n.url.hostname}),s=(e.allowedIframeDomains||[]).find(function(t){return n.url.hostname===t||n.url.hostname.endsWith(`.${t}`)});t=i||s}}catch(e){t=!1}if(!t)return void delete n.attribs[s]}if("srcset"===s)try{let t=a(i);if(t.forEach(function(t){F("srcset",t.url)&&(t.evil=!0)}),t=p(t,function(t){return!t.evil}),!t.length)return void delete n.attribs[s];i=p(t,function(t){return!t.evil}).map(function(t){if(!t.url)throw new Error("URL missing");return t.url+(t.w?` ${t.w}w`:"")+(t.h?` ${t.h}h`:"")+(t.d?` ${t.d}x`:"")}).join(", "),n.attribs[s]=i}catch(t){return void delete n.attribs[s]}if("class"===s){const e=E[t],r=E["*"],a=C[t],l=S[t],c=S["*"],h=[a,C["*"]].concat(l,c).filter(function(t){return t});if(!(i=V(i,e&&r?o(e,r):e||r,h)).length)return void delete n.attribs[s]}if("style"===s)if(e.parseStyleAttributes)try{const r=function(t,e){if(!e)return t;const i=t.nodes[0];let n;n=e[i.selector]&&e["*"]?o(e[i.selector],e["*"]):e[i.selector]||e["*"];n&&(t.nodes[0].nodes=i.nodes.reduce(function(t){return function(e,i){if(d(t,i.prop)){t[i.prop].some(function(t){return t.test(i.value)})&&e.push(i)}return e}}(n),[]));return t}(l(t+" {"+i+"}",{map:!1}),e.allowedStyles);if(i=function(t){return t.nodes[0].nodes.reduce(function(t,e){return t.push(`${e.prop}:${e.value}${e.important?" !important":""}`),t},[]).join(";")}(r),0===i.length)return void delete n.attribs[s]}catch(e){return"undefined"!=typeof window&&console.warn('Failed to parse "'+t+" {"+i+"}\", If you're running this in a browser, we recommend to disable style parsing: options.parseStyleAttributes: false, since this only works in a node environment due to a postcss dependency, More info: https://github.com/apostrophecms/sanitize-html/issues/547"),void delete n.attribs[s]}else if(e.allowedStyles)throw new Error("allowedStyles option cannot be used together with parseStyleAttributes: false.");A+=" "+s,i&&i.length?A+='="'+U(i,!0)+'"':e.allowedEmptyAttributes.includes(s)&&(A+='=""')}else delete n.attribs[s]}),-1!==e.selfClosing.indexOf(t)?A+=" />":(A+=">",!n.innerText||c||e.textFilter||(A+=U(n.innerText),N=!0)),s&&(A=v+U(A),v="")},ontext:function(t){if(L)return;const i=B[B.length-1];let n;if(i&&(n=i.tag,t=void 0!==i.innerText?i.innerText:t),"completelyDiscard"!==e.disallowedTagsMode||b(n))if("discard"!==e.disallowedTagsMode&&"completelyDiscard"!==e.disallowedTagsMode||"script"!==n&&"style"!==n){const i=U(t,!1);e.textFilter&&!N?A+=e.textFilter(i,n):N||(A+=i)}else A+=t;else t="";if(B.length){B[B.length-1].text+=t}},onclosetag:function(t,i){if(L){if(D--,D)return;L=!1}const n=B.pop();if(!n)return;if(n.tag!==t)return void B.push(n);L=!!e.enforceHtmlBoundary&&"html"===t,T--;const s=R[T];if(s){if(delete R[T],"discard"===e.disallowedTagsMode||"completelyDiscard"===e.disallowedTagsMode)return void n.updateParentNodeText();v=A,A=""}P[T]&&(t=P[T],delete P[T]),e.exclusiveFilter&&e.exclusiveFilter(n)?A=A.substr(0,n.tagPosition):(n.updateParentNodeMediaChildren(),n.updateParentNodeText(),-1!==e.selfClosing.indexOf(t)||i&&!b(t)&&["escape","recursiveEscape"].indexOf(e.disallowedTagsMode)>=0?s&&(A=v,v=""):(A+="</"+t+">",s&&(A=v+U(A),v=""),N=!1))}},e.parser);return O.write(t),O.end(),A;function k(){A="",T=0,B=[],R={},P={},L=!1,D=0}function U(t,i){return"string"!=typeof t&&(t+=""),e.parser.decodeEntities&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i&&(t=t.replace(/"/g,"&quot;"))),t=t.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i&&(t=t.replace(/"/g,"&quot;")),t}function F(t,i){for(i=i.replace(/[\x00-\x20]+/g,"");;){const t=i.indexOf("\x3c!--");if(-1===t)break;const e=i.indexOf("--\x3e",t+4);if(-1===e)break;i=i.substring(0,t)+i.substring(e+3)}const n=i.match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!n)return!!i.match(/^[/\\]{2}/)&&!e.allowProtocolRelative;const s=n[1].toLowerCase();return d(e.allowedSchemesByTag,t)?-1===e.allowedSchemesByTag[t].indexOf(s):!e.allowedSchemes||-1===e.allowedSchemes.indexOf(s)}function z(t){if((t=t.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//")).startsWith("relative:"))throw new Error("relative: exploit attempt");let e="relative://relative-site";for(let t=0;t<100;t++)e+=`/${t}`;const i=new URL(t,e);return{isRelativeUrl:i&&"relative-site"===i.hostname&&"relative:"===i.protocol,url:i}}function V(t,e,i){return e?(t=t.split(/\s+/)).filter(function(t){return-1!==e.indexOf(t)||i.some(function(e){return e.test(t)})}).join(" "):t}}const m={decodeEntities:!0};g.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],nonBooleanAttributes:["abbr","accept","accept-charset","accesskey","action","allow","alt","as","autocapitalize","autocomplete","blocking","charset","cite","class","color","cols","colspan","content","contenteditable","coords","crossorigin","data","datetime","decoding","dir","dirname","download","draggable","enctype","enterkeyhint","fetchpriority","for","form","formaction","formenctype","formmethod","formtarget","headers","height","hidden","high","href","hreflang","http-equiv","id","imagesizes","imagesrcset","inputmode","integrity","is","itemid","itemprop","itemref","itemtype","kind","label","lang","list","loading","low","max","maxlength","media","method","min","minlength","name","nonce","optimum","pattern","ping","placeholder","popover","popovertarget","popovertargetaction","poster","preload","referrerpolicy","rel","rows","rowspan","sandbox","scope","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","value","width","wrap","onauxclick","onafterprint","onbeforematch","onbeforeprint","onbeforeunload","onbeforetoggle","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextlost","oncontextmenu","oncontextrestored","oncopy","oncuechange","oncut","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onformdata","onhashchange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onlanguagechange","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmessageerror","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onoffline","ononline","onpagehide","onpageshow","onpaste","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreset","onresize","onrejectionhandled","onscroll","onscrollend","onsecuritypolicyviolation","onseeked","onseeking","onselect","onslotchange","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","ontoggle","onunhandledrejection","onunload","onvolumechange","onwaiting","onwheel"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"]},allowedEmptyAttributes:["alt"],selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1,parseStyleAttributes:!0},g.simpleTransform=function(t,e,i){return i=void 0===i||i,e=e||{},function(n,s){let r;if(i)for(r in e)s[r]=e[r];else s=e;return{tagName:t,attribs:s}}}},4270:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var n=i(4640),s=i(3331),r=i(5676),o=i(3275),a=i(9163);class l extends s.A{constructor(t){super(),this.next=null,this._canvasWidth=1,this._canvasHeight=1,this._overlay=null,this._camera=null,this._controller=null,this.addEvent("dispose"),this.next=null,t=t||{},this._relRect={x:t.x||0,y:t.y||0,width:t.width||1,height:t.height||1},this._absRect={x:0,y:0,width:1,height:1},t.overlay&&(this._overlay=t.overlay)}get x(){return this._absRect.x}get y(){return this._absRect.y}get width(){return this._absRect.width}get height(){return this._absRect.height}get canvasWidth(){return this._canvasWidth}get canvasHeight(){return this._canvasHeight}get camera(){return this._camera}get controller(){return this._controller}get overlay(){return this._overlay}set overlay(t){this._overlay=t,this.updateGeometry()}dispose(){this.emit({type:"dispose",viewport:this}),this._overlay&&(this._overlay.remove(),this._overlay=null)}setSize(t,e,i,n){const s=this._relRect;s.x=t,s.y=e,s.width=i,s.height=n,this.updateGeometry()}setCanvasSize(t,e){this._canvasWidth=t,this._canvasHeight=e,this.updateGeometry(),this._controller&&this._controller.setViewportSize(t,e)}setBuiltInCamera(t,e){this._camera?this._camera.setProjection(t):(this._camera=new r.Ay(t),this._camera.matrixAutoUpdate=!1),void 0!==e&&(this._camera.setPreset(e),this.overlay.setLabel(o.t.TopRight,"view",r.Gz[e],"ff-label-box"))}unsetBuiltInCamera(){this._camera=null,this._controller=null,this.overlay.unsetLabel(o.t.TopRight,"view")}enableCameraControl(t){return!t&&this._controller?this._controller=null:t&&this._camera&&(this._controller||(this._controller=new a.A(this._camera),this._controller.setViewportSize(this.width,this.height),this._controller.updateController())),this._controller}zoomExtents(t){const e=this._camera,i=this._controller;e&&i&&(i.zoomExtents(t),i.updateCamera(null,!0))}isInside(t){return this.isPointInside(t.localX,t.localY)}isPointInside(t,e){const i=this._absRect;return e=this.canvasHeight-e,t>=i.x&&t<i.x+i.width&&e>=i.y&&e<i.y+i.height}getDevicePoint(t,e,i){const s=this._absRect,r=(t-s.x)/s.width*2-1,o=(this.canvasHeight-e-s.y)/s.height*2-1;return i?i.set(r,o):new n.I9Y(r,o)}getDeviceX(t){const e=this._absRect;return(t-e.x)/e.width*2-1}getDeviceY(t){const e=this._absRect;return(this.canvasHeight-t-e.y)/e.height*2-1}updateCamera(t){let e=t;if(this._camera&&(e=this._camera,this._controller&&this._controller.updateCamera()),!e)return;const i=this._absRect,n=i.width/i.height;if(n!==e.userData.aspect)if(e.userData.aspect=n,e.isUniversalCamera||e.isPerspectiveCamera)e.aspect=n,e.updateProjectionMatrix();else if(e.isOrthographicCamera){const t=.5*(e.top-e.bottom);e.left=-t*n,e.right=t*n,e.updateProjectionMatrix()}return e}applyViewport(t){const e=this._absRect;t.setViewport(e.x,e.y,e.width,e.height),t.viewport=this}applyPickViewport(t,e){const i=this._absRect,n=e.localX-i.x,s=this.canvasHeight-e.localY-i.y;t.viewport.set(-n,-s,i.width,i.height)}toViewportEvent(t){const e=t;return e.viewport=this,e.deviceX=this.getDeviceX(t.localX),e.deviceY=this.getDeviceY(t.localY),e}onPointer(t){return!!this._controller&&this._controller.onPointer(t)}onTrigger(t){return!!this._controller&&this._controller.onTrigger(t)}onKeyboard(t){return!!this._controller&&this._controller.onKeypress(t)}toString(){return`Viewport (x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height})`}updateGeometry(){const t=this._relRect,e=this._absRect,i=this._canvasWidth,n=this._canvasHeight;e.x=Math.round(t.x*i),e.y=Math.round(t.y*n),e.width=Math.round(t.width*i),e.height=Math.round(t.height*n);const s=this._overlay;if(s){const t=this.canvasHeight-e.y-e.height;s.style.left=e.x?e.x.toFixed()+"px":"0",s.style.top=t?t.toFixed()+"px":"0",s.style.width=e.width.toFixed()+"px",s.style.height=e.height.toFixed()+"px"}}}},4340:(t,e,i)=>{"use strict";i.d(e,{j:()=>A,A:()=>v});var n=i(4640),s=i(3074);class r extends n.YJl{constructor(){super();const t=new n._4j({color:"white",metalness:1});t.transparent=!0,this.needle=new n.eaF(this.createLatheGeometry([0,0,.25,.4,.4,10]),t);const e=new n._4j({color:"#ffcd00",roughness:.8,metalness:.1});e.transparent=!0,this.handle=new n.eaF(this.createLatheGeometry([0,10,3.4,10,3.5,10.1,3.5,11,3.45,11.1,2.05,12.5,2,12.6,2,17.4,2.05,17.5,3.45,18.9,3.5,19,3.5,19.9,3.4,20,0,20]),e),this.needle.matrixAutoUpdate=!1,this.add(this.needle),this.handle.matrixAutoUpdate=!1,this.add(this.handle)}dispose(){this.remove(this.handle,this.needle),this.needle.material.dispose(),this.handle.material.dispose(),this.needle.geometry.dispose(),this.handle.geometry.dispose()}createLatheGeometry(t){const e=[];for(let i=0,s=t.length;i<s;i+=2)e.push(new n.I9Y(t[i],t[i+1]));return new n.nzx(e,16)}}var o=i(9616),a=i(8172),l=i(3675),c=i(9519),h=i(5717),u=i(7832),d=i(9640);const p=new n.dwI,f=new n.Pq0,g=new n.Pq0,m=new n.Pq0(0,1,0);var A;!function(t){t[t.SetStart=0]="SetStart",t[t.SetEnd=1]="SetEnd"}(A||(A={}));class v extends s.Ay{get settingProperties(){return[this.ins.visible]}get snapshotProperties(){return[this.ins.visible,this.ins.startPosition,this.ins.startDirection,this.ins.endPosition,this.ins.endDirection]}constructor(t,e){super(t,e),this.ins=this.addInputs(v.tapeIns),this.outs=this.addOutputs(v.tapeOuts),this.startPin=null,this.endPin=null,this.line=null,this.annotationView=null,this.label=null,this.object3D=new n.YJl,this.object3D.name="Tape",this.startPin=new r,this.startPin.matrixAutoUpdate=!1,this.startPin.visible=!1,this.endPin=new r,this.endPin.matrixAutoUpdate=!1,this.endPin.visible=!1;const i=[];i.push(new n.Pq0(0,0,0)),i.push(new n.Pq0(0,0,0));const s=(new n.LoY).setFromPoints(i),o=new n.mrM;o.depthTest=!1,o.transparent=!0,this.line=new n.N1A(s,o),this.line.visible=!1,this.line.frustumCulled=!1,this.annotationView=this.node.createComponent(d.A);const a=this.label=new u.A(void 0);a.data.style="Standard",a.data.position=[0,0,0],a.data.direction=[0,0,0],this.annotationView.ins.visible.setValue(!1),this.annotationView.addAnnotation(a),this.object3D.add(this.startPin,this.endPin,this.line)}create(){super.create();const t=this.getGraphComponent(a.A);this.ins.boundingBox.linkFrom(t.outs.boundingBox),this.ins.globalUnits.linkFrom(t.ins.units)}dispose(){this.object3D.remove(this.startPin,this.endPin,this.line),this.startPin.dispose(),this.endPin.dispose(),this.line.geometry.dispose(),this.line.material.dispose(),this.startPin=null,this.endPin=null,this.line=null,super.dispose()}update(t){const e=this.line.geometry,{startPin:i,endPin:n,line:s,ins:r}=this;if(r.enabled.changed&&r.visible.setValue(r.enabled.value),super.update(t),r.boundingBox.changed&&r.boundingBox.value){r.boundingBox.value.getSize(f);const t=.5*f.length();i.scale.setScalar(.003*t),i.updateMatrix(),n.scale.setScalar(.003*t),n.updateMatrix();const e=.05*t;this.annotationView.ins.unitScale.setValue(e),r.endPosition.set()}if(r.enabled.changed&&(r.enabled.value?(this.system.on("pointer-up",this.onPointerUp,this),this.annotationView.ins.visible.setValue(this.outs.distance.value>0)):(this.system.off("pointer-up",this.onPointerUp,this),this.annotationView.ins.visible.setValue(!1))),r.visible.changed)if(r.visible.value){const t=r.startPosition.value,e=r.endPosition.value;t[0]==e[0]&&t[1]==e[1]&&t[2]==e[2]||(i.visible=!0,n.visible=!0,s.visible=!0,this.annotationView.ins.visible.setValue(!0))}else this.annotationView.ins.visible.setValue(!1);if(r.globalUnits.changed&&this.updateUnitScale(),r.startPosition.changed||r.startDirection.changed){i.position.fromArray(r.startPosition.value),f.fromArray(r.startDirection.value),i.quaternion.setFromUnitVectors(m,f),i.updateMatrix();const t=e.attributes.position.array;t[0]=i.position.x,t[1]=i.position.y,t[2]=i.position.z,e.attributes.position.needsUpdate=!0,this.annotationView.ins.visible.setValue(!1)}if(r.endPosition.changed||r.endDirection.changed){n.position.fromArray(r.endPosition.value),f.fromArray(r.endDirection.value),n.quaternion.setFromUnitVectors(m,f),n.updateMatrix();const t=e.attributes.position.array;t[3]=n.position.x,t[4]=n.position.y,t[5]=n.position.z,e.attributes.position.needsUpdate=!0,f.fromArray(r.startPosition.value),g.fromArray(r.endPosition.value);const i=f.distanceTo(g);this.outs.distance.setValue(i);const s=this.label.data,o=1/this.annotationView.ins.unitScale.value;s.position=[o*(t[0]+t[3])/2,o*(t[1]+t[4])/2,o*(t[2]+t[5])/2];const a=this.ins.globalUnits.getOptionText();this.label.title=i.toFixed(2)+" "+a,this.annotationView.updateAnnotation(this.label,!0),i>0&&this.ins.visible.value&&this.annotationView.ins.visible.setValue(!0)}return!0}fromData(t){this.ins.copyValues({visible:t.enabled,startPosition:t.startPosition||[0,0,0],startDirection:t.startDirection||[1,0,0],endPosition:t.endPosition||[0,0,0],endDirection:t.endDirection||[1,0,0]}),this.ins.enabled.copyValue(!1)}toData(){return{enabled:this.ins.visible.cloneValue()}}onPointerUp(t){if(t.isDragging||!t.component||!t.component.is(o.A))return;const e=t.component,i=(0,h.I)(e.object3D,t.object3D),n=e.localBoundingBox.clone().applyMatrix4(i),s=t.object3D.matrixWorld;p.getNormalMatrix(s);const r=t.view.pickPosition(t,n).applyMatrix4(s),a=t.view.pickNormal(t).applyMatrix3(p).normalize(),{startPin:l,endPin:c,line:u,ins:d,outs:f}=this;f.state.value===A.SetStart?(r.toArray(d.startPosition.value),a.toArray(d.startDirection.value),d.startPosition.set(),d.startDirection.set(),l.visible=!0,c.visible=!1,u.visible=!1,f.state.setValue(A.SetEnd)):(r.toArray(d.endPosition.value),a.toArray(d.endDirection.value),d.endPosition.set(),d.endDirection.set(),l.visible=!0,c.visible=!0,u.visible=!0,f.state.setValue(A.SetStart))}updateUnitScale(){const t=this.ins,e=t.localUnits.getValidatedValue(),i=t.globalUnits.getValidatedValue();this.outs.unitScale.setValue((0,c.A)(e,i)),f.fromArray(t.startPosition.value),t.startPosition.setValue(f.multiplyScalar(this.outs.unitScale.value).toArray()),f.fromArray(t.endPosition.value),t.endPosition.setValue(f.multiplyScalar(this.outs.unitScale.value).toArray()),t.localUnits.setValue(i)}}v.typeName="CVTape",v.text="Tape",v.icon="",v.tapeIns={startPosition:s.gK.Vector3("Start.Position"),startDirection:s.gK.Vector3("Start.Direction"),endPosition:s.gK.Vector3("End.Position"),endDirection:s.gK.Vector3("End.Direction"),boundingBox:s.gK.Object("Scene.BoundingBox",n.NRn),globalUnits:s.gK.Enum("Model.GlobalUnits",l.uj,l.uj.cm),localUnits:s.gK.Enum("Model.LocalUnits",l.uj,l.uj.cm),enabled:s.gK.Boolean("Tape.Enabled",!1)},v.tapeOuts={state:s.gK.Enum("Tape.State",A),distance:s.gK.Number("Tape.Distance"),unitScale:s.gK.Number("UnitScale",{preset:1,precision:5})}},4376:t=>{"use strict";let e={};t.exports=function(t){e[t]||(e[t]=!0,"undefined"!=typeof console&&console.warn&&console.warn(t))}},4424:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>r,gK:()=>n.gK});var n=i(3423),s=i(7350);i(1860);class r extends n.Ay{constructor(t,e){super(t,e),this.ins=this.addInputs(r.graphIns),this._innerGraph=null,this._innerRoot=null,this._innerGraph=new s.A(this.system,this)}get innerGraph(){return this._innerGraph}get innerNodes(){return this._innerGraph.nodes}get innerComponents(){return this._innerGraph.components}get innerRoots(){return this._innerGraph.roots}getInnerComponent(t,e=!1){return this._innerGraph.components.get(t,e)}getInnerComponents(t){return this._innerGraph.components.getArray(t)}hasInnerComponent(t){return this._innerGraph.components.has(t)}getInnerNode(t,e=!1){return this._innerGraph.nodes.get(t,e)}getInnerNodes(t){return this._innerGraph.nodes.getArray(t)}hasInnerNode(t){return this._innerGraph.nodes.has(t)}isEmpty(){return 0===this._innerGraph.nodes.count()}update(t){const e=this.ins;if(e.active.changed){const t=e.active.value;t!==this._innerGraph.isActive&&(t?this.activateInnerGraph():this.deactivateInnerGraph())}return!0}tick(t){return this._innerGraph.tick(t)}tock(t){return this._innerGraph.tock(t)}dispose(){this._innerGraph.clear(),this._innerGraph=null,this._innerRoot=null,super.dispose()}clearInnerGraph(){this._innerGraph.clear()}fromJSON(t){super.fromJSON(t),this._innerGraph.clear(),this._innerGraph.fromJSON(t.graph)}toJSON(){const t=super.toJSON();return t.graph=this._innerGraph.toJSON(),t}dump(t=""){super.dump(t),this.innerGraph.dump(t+"  ")}onAddInnerRoot(t){}onRemoveInnerRoot(t){}activateInnerGraph(){this._innerGraph.activate()}deactivateInnerGraph(){this._innerGraph.deactivate()}}r.typeName="CGraph",r.graphIns={active:n.gK.Boolean("Graph.Active",!0)}},4482:(t,e,i)=>{"use strict";i.d(e,{A:()=>o,y:()=>n});var n,s=i(5676),r=i(4757);!function(t){t[t.Single=0]="Single",t[t.HorizontalSplit=1]="HorizontalSplit",t[t.VerticalSplit=2]="VerticalSplit",t[t.Quad=3]="Quad"}(n||(n={}));class o extends r.A{constructor(t,e,i){super(t,e,i),this._layout=n.Quad,this._horizontalSplit=.5,this._verticalSplit=.5,this.addEvent("layout"),this.layout=n.Single}set layout(t){if(t===this._layout)return;this._layout=t;const e=this.viewports;switch(this._layout){case n.Single:this.setViewportCount(1);break;case n.HorizontalSplit:case n.VerticalSplit:this.setViewportCount(2);break;case n.Quad:this.setViewportCount(4)}this.updateSplitPositions(),e[1]&&(e[1].setBuiltInCamera(s.$R.Orthographic,s.Gz.Top),e[1].enableCameraControl(!0).orientationEnabled=!1),e[2]&&(e[2].setBuiltInCamera(s.$R.Orthographic,s.Gz.Left),e[2].enableCameraControl(!0).orientationEnabled=!1),e[3]&&(e[3].setBuiltInCamera(s.$R.Orthographic,s.Gz.Front),e[3].enableCameraControl(!0).orientationEnabled=!1),this.emit({type:"layout",layout:t})}get layout(){return this._layout}set horizontalSplit(t){this._horizontalSplit=t,this.updateSplitPositions()}get horizontalSplit(){return this._horizontalSplit}set verticalSplit(t){this._verticalSplit=t,this.updateSplitPositions()}get verticalSplit(){return this._verticalSplit}updateSplitPositions(){const t=this._horizontalSplit,e=this._verticalSplit;switch(this._layout){case n.Single:this.viewports[0].setSize(0,0,1,1);break;case n.HorizontalSplit:this.viewports[0].setSize(0,0,t,1),this.viewports[1].setSize(t,0,1-t,1);break;case n.VerticalSplit:this.viewports[0].setSize(0,1-e,1,e),this.viewports[1].setSize(0,0,1,1-e);break;case n.Quad:this.viewports[0].setSize(0,1-e,t,e),this.viewports[1].setSize(t,1-e,1-t,e),this.viewports[2].setSize(0,0,t,1-e),this.viewports[3].setSize(t,0,1-t,1-e)}}}},4483:function(t,e,i){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},n.apply(this,arguments)},s=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&s(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.render=void 0;var a=o(i(2177)),l=i(2719),c=i(5911),h=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function u(t){return t.replace(/"/g,"&quot;")}var d=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function p(t,e){void 0===e&&(e={});for(var i=("length"in t?t:[t]),n="",s=0;s<i.length;s++)n+=f(i[s],e);return n}function f(t,e){switch(t.type){case a.Root:return p(t.children,e);case a.Doctype:case a.Directive:return"<".concat(t.data,">");case a.Comment:return function(t){return"\x3c!--".concat(t.data,"--\x3e")}(t);case a.CDATA:return function(t){return"<![CDATA[".concat(t.children[0].data,"]]>")}(t);case a.Script:case a.Style:case a.Tag:return function(t,e){var i;"foreign"===e.xmlMode&&(t.name=null!==(i=c.elementNames.get(t.name))&&void 0!==i?i:t.name,t.parent&&g.has(t.parent.name)&&(e=n(n({},e),{xmlMode:!1})));!e.xmlMode&&m.has(t.name)&&(e=n(n({},e),{xmlMode:"foreign"}));var s="<".concat(t.name),r=function(t,e){var i;if(t){var n=!1===(null!==(i=e.encodeEntities)&&void 0!==i?i:e.decodeEntities)?u:e.xmlMode||"utf8"!==e.encodeEntities?l.encodeXML:l.escapeAttribute;return Object.keys(t).map(function(i){var s,r,o=null!==(s=t[i])&&void 0!==s?s:"";return"foreign"===e.xmlMode&&(i=null!==(r=c.attributeNames.get(i))&&void 0!==r?r:i),e.emptyAttrs||e.xmlMode||""!==o?"".concat(i,'="').concat(n(o),'"'):i}).join(" ")}}(t.attribs,e);r&&(s+=" ".concat(r));0===t.children.length&&(e.xmlMode?!1!==e.selfClosingTags:e.selfClosingTags&&d.has(t.name))?(e.xmlMode||(s+=" "),s+="/>"):(s+=">",t.children.length>0&&(s+=p(t.children,e)),!e.xmlMode&&d.has(t.name)||(s+="</".concat(t.name,">")));return s}(t,e);case a.Text:return function(t,e){var i,n=t.data||"";!1===(null!==(i=e.encodeEntities)&&void 0!==i?i:e.decodeEntities)||!e.xmlMode&&t.parent&&h.has(t.parent.name)||(n=e.xmlMode||"utf8"!==e.encodeEntities?(0,l.encodeXML)(n):(0,l.escapeText)(n));return n}(t,e)}}e.render=p,e.default=p;var g=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),m=new Set(["svg","math"])},4484:t=>{t.exports=function(t,e){for(var i=-1,n=e.length,s=t.length;++i<n;)t[s+i]=e[i];return t}},4507:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5391);class s extends Error{constructor(t,e,i){super(i||`can't resolve reference ${e} from id ${t}`),this.missingRef=(0,n.resolveUrl)(t,e),this.missingSchema=(0,n.normalizeId)((0,n.getFullPath)(this.missingRef))}}e.default=s},4509:t=>{var e=Array.isArray;t.exports=e},4516:(t,e)=>{"use strict";function i(t){if(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.parent){var e=t.parent.children,i=e.lastIndexOf(t);i>=0&&e.splice(i,1)}t.next=null,t.prev=null,t.parent=null}Object.defineProperty(e,"__esModule",{value:!0}),e.prepend=e.prependChild=e.append=e.appendChild=e.replaceElement=e.removeElement=void 0,e.removeElement=i,e.replaceElement=function(t,e){var i=e.prev=t.prev;i&&(i.next=e);var n=e.next=t.next;n&&(n.prev=e);var s=e.parent=t.parent;if(s){var r=s.children;r[r.lastIndexOf(t)]=e,t.parent=null}},e.appendChild=function(t,e){if(i(e),e.next=null,e.parent=t,t.children.push(e)>1){var n=t.children[t.children.length-2];n.next=e,e.prev=n}else e.prev=null},e.append=function(t,e){i(e);var n=t.parent,s=t.next;if(e.next=s,e.prev=t,t.next=e,e.parent=n,s){if(s.prev=e,n){var r=n.children;r.splice(r.lastIndexOf(s),0,e)}}else n&&n.children.push(e)},e.prependChild=function(t,e){if(i(e),e.parent=t,e.prev=null,1!==t.children.unshift(e)){var n=t.children[1];n.prev=e,e.next=n}else e.next=null},e.prepend=function(t,e){i(e);var n=t.parent;if(n){var s=n.children;s.splice(s.indexOf(t),0,e)}t.prev&&(t.prev.next=e),e.parent=n,e.prev=t.prev,e.next=t,t.prev=e}},4571:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s=i(3151),r={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:t})=>n.str`must match "${t.ifClause}" schema`,params:({params:t})=>n._`{failingKeyword: ${t.ifClause}}`},code(t){const{gen:e,parentSchema:i,it:r}=t;void 0===i.then&&void 0===i.else&&(0,s.checkStrictMode)(r,'"if" without "then" and "else" is ignored');const a=o(r,"then"),l=o(r,"else");if(!a&&!l)return;const c=e.let("valid",!0),h=e.name("_valid");if(function(){const e=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},h);t.mergeEvaluated(e)}(),t.reset(),a&&l){const i=e.let("ifClause");t.setParams({ifClause:i}),e.if(h,u("then",i),u("else",i))}else a?e.if(h,u("then")):e.if((0,n.not)(h),u("else"));function u(i,s){return()=>{const r=t.subschema({keyword:i},h);e.assign(c,h),t.mergeValidEvaluated(r,c),s?e.assign(s,n._`${i}`):t.setParams({ifClause:i})}}t.pass(c,()=>t.error(!0))}};function o(t,e){const i=t.schema[e];return void 0!==i&&!(0,s.alwaysValidSchema)(t,i)}e.default=r},4640:(t,e,i)=>{"use strict";i.d(e,{$EB:()=>d,$Kf:()=>Sr,$Yl:()=>O,$_I:()=>vt,$ei:()=>w,$p8:()=>bl,A$4:()=>Es,AQS:()=>Ai,B69:()=>Hn,BH$:()=>ao,BKk:()=>Zs,BND:()=>Xl,BRH:()=>il,BXX:()=>Gt,B_h:()=>Zt,CSG:()=>Ia,CVz:()=>Kt,CWW:()=>ve,Cfg:()=>gt,CmU:()=>wl,D$Q:()=>wa,DXC:()=>ro,Dmk:()=>Bt,EAD:()=>Br,EZo:()=>g,EdD:()=>A,FCc:()=>oo,FFZ:()=>$e,FV:()=>tt,FXf:()=>b,Fn:()=>de,FvD:()=>go,G3T:()=>ye,GJx:()=>ht,GWd:()=>Lt,GYF:()=>Ir,Gu$:()=>ya,Gwm:()=>G,GxU:()=>ys,H23:()=>pe,HIg:()=>Pt,HO_:()=>Ae,HXV:()=>$t,HiM:()=>ml,Hit:()=>Va,I46:()=>Cr,I9Y:()=>hi,IE4:()=>Vt,IUQ:()=>Fi,Iit:()=>Xs,Iw4:()=>zl,Jnc:()=>o,K52:()=>H,KDk:()=>Yt,KLL:()=>Ue,KPJ:()=>Ka,KRh:()=>W,Kef:()=>ge,Kwu:()=>m,Kzg:()=>Cl,LAk:()=>it,LiQ:()=>I,LlO:()=>Js,LoY:()=>Ds,LuO:()=>Vl,MBL:()=>ja,MSw:()=>va,MW4:()=>Cs,Mjd:()=>J,Mmk:()=>Ei,N1A:()=>eo,N5j:()=>Re,NRn:()=>Gi,NTi:()=>f,Nex:()=>Yl,Nt7:()=>R,Nwf:()=>Ol,Nz6:()=>Qt,O49:()=>Te,O9p:()=>Mn,ONl:()=>po,OUM:()=>yt,Om:()=>ct,OuU:()=>T,P5j:()=>kl,PJ3:()=>xe,PPD:()=>qr,PTz:()=>ui,Pq0:()=>di,Q1f:()=>hs,QP0:()=>a,Qev:()=>Je,Qrf:()=>ie,R3r:()=>ur,RJ4:()=>Me,RQf:()=>Ct,RiT:()=>Ha,Riy:()=>Xt,RlV:()=>An,RrE:()=>N,RyA:()=>c,S$4:()=>ue,THS:()=>ws,Tap:()=>nl,TdN:()=>Xe,TiK:()=>je,TkQ:()=>Ft,U3G:()=>j,V3x:()=>Tt,V9B:()=>fs,VCu:()=>vo,VT0:()=>Ot,Vb5:()=>r,VxR:()=>ke,W9U:()=>fe,WNZ:()=>s,Wdf:()=>Ke,Wew:()=>It,Wk7:()=>l,XG_:()=>me,XIg:()=>p,XJ7:()=>ba,XrR:()=>K,Y9S:()=>tl,YHV:()=>ql,YJl:()=>cr,Yuy:()=>wt,Z58:()=>dr,ZLX:()=>Fr,ZQM:()=>kt,Zcv:()=>jr,Zr2:()=>Oe,ZyN:()=>yl,_4j:()=>Ea,_QJ:()=>re,_Ut:()=>Ys,a55:()=>ii,a5J:()=>se,aEY:()=>L,aHM:()=>Ya,aJ8:()=>nt,aMy:()=>be,aVO:()=>Ma,amv:()=>ze,b4q:()=>ar,bC7:()=>le,bCz:()=>v,bI3:()=>Pe,bdM:()=>Aa,bkx:()=>Et,brA:()=>V,bw0:()=>q,c5h:()=>Ao,c90:()=>zt,cHt:()=>xt,cZY:()=>Kl,caT:()=>$,cj9:()=>ci,czI:()=>te,dYF:()=>ji,dcC:()=>Nt,dth:()=>rl,dwI:()=>gi,e0p:()=>k,eB$:()=>pr,eHc:()=>F,eHs:()=>gr,eaF:()=>qs,eoi:()=>Ge,er$:()=>Ne,f4X:()=>S,fBL:()=>_t,g7M:()=>et,gJ2:()=>Mt,gO9:()=>y,gPd:()=>Ui,gWB:()=>qe,ghU:()=>ut,hB5:()=>h,hdd:()=>B,hgQ:()=>D,hsX:()=>u,hxR:()=>pt,hy7:()=>rt,i7d:()=>tr,iNn:()=>Ws,iOZ:()=>mo,ie2:()=>M,imn:()=>ps,ix0:()=>St,iyt:()=>cn,jR7:()=>jt,jej:()=>xi,jf0:()=>De,jzd:()=>He,k6Q:()=>Ht,k6q:()=>mt,kO0:()=>Qe,kRr:()=>At,kTW:()=>dt,kTp:()=>qt,kn4:()=>vn,kyO:()=>Y,lGu:()=>z,lGw:()=>Da,lPF:()=>yi,ljd:()=>_e,lxW:()=>Ks,lyL:()=>ae,mcG:()=>_i,mrM:()=>$r,nCl:()=>ul,nNL:()=>Z,nST:()=>_,nWS:()=>Vi,nZQ:()=>Sl,nzx:()=>ma,o6l:()=>lr,ojh:()=>E,ojs:()=>he,ov9:()=>U,pBf:()=>Wt,pHI:()=>ft,paN:()=>Ut,ppV:()=>Mi,psI:()=>ne,q2:()=>xa,qFE:()=>bo,qUd:()=>Al,qa3:()=>Jt,qad:()=>C,qq$:()=>vi,qtW:()=>Ss,r6x:()=>xl,rFo:()=>Qi,rSH:()=>ee,rYR:()=>Be,sPf:()=>n,tBo:()=>jl,tJf:()=>bt,tXL:()=>Sa,tz3:()=>qa,uB5:()=>oe,uSd:()=>Ca,uV5:()=>lt,uWO:()=>Rr,ubm:()=>sr,ure:()=>_l,vim:()=>Ve,vyJ:()=>Le,wfO:()=>at,wn6:()=>P,wrO:()=>Rt,xFO:()=>ot,xSv:()=>Q,xiE:()=>wi,y3Z:()=>ce,y_p:()=>X,ypk:()=>Fo,zD7:()=>Il,zdS:()=>Dt,zgK:()=>Tn,znC:()=>x});const n="177",s=0,r=1,o=2,a=1,l=2,c=3,h=0,u=1,d=2,p=0,f=1,g=2,m=3,A=4,v=5,y=100,b=101,_=102,x=103,w=104,E=200,C=201,S=202,I=203,M=204,T=205,B=206,R=207,P=208,L=209,D=210,N=211,O=212,k=213,U=214,F=0,z=1,V=2,Q=3,j=4,G=5,H=6,q=7,$=0,W=1,K=2,X=0,Y=1,J=2,Z=3,tt=4,et=5,it=6,nt=7,st="attached",rt=301,ot=302,at=303,lt=304,ct=306,ht=1e3,ut=1001,dt=1002,pt=1003,ft=1004,gt=1005,mt=1006,At=1007,vt=1008,yt=1009,bt=1010,_t=1011,xt=1012,wt=1013,Et=1014,Ct=1015,St=1016,It=1017,Mt=1018,Tt=1020,Bt=35902,Rt=1021,Pt=1022,Lt=1023,Dt=1026,Nt=1027,Ot=1028,kt=1029,Ut=1030,Ft=1031,zt=1033,Vt=33776,Qt=33777,jt=33778,Gt=33779,Ht=35840,qt=35841,$t=35842,Wt=35843,Kt=36196,Xt=37492,Yt=37496,Jt=37808,Zt=37809,te=37810,ee=37811,ie=37812,ne=37813,se=37814,re=37815,oe=37816,ae=37817,le=37818,ce=37819,he=37820,ue=37821,de=36492,pe=36494,fe=36495,ge=36283,me=36284,Ae=36285,ve=36286,ye=2200,be=2201,_e=2300,xe=2301,we=2302,Ee=2400,Ce=2401,Se=2402,Ie=2500,Me=0,Te=1,Be=2,Re=3201,Pe=0,Le=1,De="",Ne="srgb",Oe="srgb-linear",ke="linear",Ue="srgb",Fe=7680,ze=512,Ve=513,Qe=514,je=515,Ge=516,He=517,qe=518,$e=519,We=35044,Ke="300 es",Xe=2e3,Ye=2001;class Je{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)}hasEventListener(t,e){const i=this._listeners;return void 0!==i&&(void 0!==i[t]&&-1!==i[t].indexOf(e))}removeEventListener(t,e){const i=this._listeners;if(void 0===i)return;const n=i[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){const e=this._listeners;if(void 0===e)return;const i=e[t.type];if(void 0!==i){t.target=this;const e=i.slice(0);for(let i=0,n=e.length;i<n;i++)e[i].call(this,t);t.target=null}}}const Ze=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ti=1234567;const ei=Math.PI/180,ii=180/Math.PI;function ni(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Ze[255&t]+Ze[t>>8&255]+Ze[t>>16&255]+Ze[t>>24&255]+"-"+Ze[255&e]+Ze[e>>8&255]+"-"+Ze[e>>16&15|64]+Ze[e>>24&255]+"-"+Ze[63&i|128]+Ze[i>>8&255]+"-"+Ze[i>>16&255]+Ze[i>>24&255]+Ze[255&n]+Ze[n>>8&255]+Ze[n>>16&255]+Ze[n>>24&255]).toLowerCase()}function si(t,e,i){return Math.max(e,Math.min(i,t))}function ri(t,e){return(t%e+e)%e}function oi(t,e,i){return(1-i)*t+i*e}function ai(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function li(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}const ci={DEG2RAD:ei,RAD2DEG:ii,generateUUID:ni,clamp:si,euclideanModulo:ri,mapLinear:function(t,e,i,n,s){return n+(t-e)*(s-n)/(i-e)},inverseLerp:function(t,e,i){return t!==e?(i-t)/(e-t):0},lerp:oi,damp:function(t,e,i,n){return oi(t,e,1-Math.exp(-i*n))},pingpong:function(t,e=1){return e-Math.abs(ri(t,2*e)-e)},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(ti=t);let e=ti+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*ei},radToDeg:function(t){return t*ii},isPowerOfTwo:function(t){return!(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,i,n,s){const r=Math.cos,o=Math.sin,a=r(i/2),l=o(i/2),c=r((e+n)/2),h=o((e+n)/2),u=r((e-n)/2),d=o((e-n)/2),p=r((n-e)/2),f=o((n-e)/2);switch(s){case"XYX":t.set(a*h,l*u,l*d,a*c);break;case"YZY":t.set(l*d,a*h,l*u,a*c);break;case"ZXZ":t.set(l*u,l*d,a*h,a*c);break;case"XZX":t.set(a*h,l*f,l*p,a*c);break;case"YXY":t.set(l*p,a*h,l*f,a*c);break;case"ZYZ":t.set(l*f,l*p,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}},normalize:li,denormalize:ai};class hi{constructor(t=0,e=0){hi.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=si(this.x,t.x,e.x),this.y=si(this.y,t.y,e.y),this}clampScalar(t,e){return this.x=si(this.x,t,e),this.y=si(this.y,t,e),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(si(i,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(si(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const i=Math.cos(e),n=Math.sin(e),s=this.x-t.x,r=this.y-t.y;return this.x=s*i-r*n+t.x,this.y=s*n+r*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ui{constructor(t=0,e=0,i=0,n=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=i,this._w=n}static slerpFlat(t,e,i,n,s,r,o){let a=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3];const u=s[r+0],d=s[r+1],p=s[r+2],f=s[r+3];if(0===o)return t[e+0]=a,t[e+1]=l,t[e+2]=c,void(t[e+3]=h);if(1===o)return t[e+0]=u,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(h!==f||a!==u||l!==d||c!==p){let t=1-o;const e=a*u+l*d+c*p+h*f,i=e>=0?1:-1,n=1-e*e;if(n>Number.EPSILON){const s=Math.sqrt(n),r=Math.atan2(s,e*i);t=Math.sin(t*r)/s,o=Math.sin(o*r)/s}const s=o*i;if(a=a*t+u*s,l=l*t+d*s,c=c*t+p*s,h=h*t+f*s,t===1-o){const t=1/Math.sqrt(a*a+l*l+c*c+h*h);a*=t,l*=t,c*=t,h*=t}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=h}static multiplyQuaternionsFlat(t,e,i,n,s,r){const o=i[n],a=i[n+1],l=i[n+2],c=i[n+3],h=s[r],u=s[r+1],d=s[r+2],p=s[r+3];return t[e]=o*p+c*h+a*d-l*u,t[e+1]=a*p+c*u+l*h-o*d,t[e+2]=l*p+c*d+o*u-a*h,t[e+3]=c*p-o*h-a*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){const i=t._x,n=t._y,s=t._z,r=t._order,o=Math.cos,a=Math.sin,l=o(i/2),c=o(n/2),h=o(s/2),u=a(i/2),d=a(n/2),p=a(s/2);switch(r){case"XYZ":this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p;break;case"YXZ":this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p;break;case"ZXY":this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p;break;case"ZYX":this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p;break;case"YZX":this._x=u*c*h+l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h-u*d*p;break;case"XZY":this._x=u*c*h-l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h+u*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+r)}return!0===e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,i=e[0],n=e[4],s=e[8],r=e[1],o=e[5],a=e[9],l=e[2],c=e[6],h=e[10],u=i+o+h;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(c-a)*t,this._y=(s-l)*t,this._z=(r-n)*t}else if(i>o&&i>h){const t=2*Math.sqrt(1+i-o-h);this._w=(c-a)/t,this._x=.25*t,this._y=(n+r)/t,this._z=(s+l)/t}else if(o>h){const t=2*Math.sqrt(1+o-i-h);this._w=(s-l)/t,this._x=(n+r)/t,this._y=.25*t,this._z=(a+c)/t}else{const t=2*Math.sqrt(1+h-i-o);this._w=(r-n)/t,this._x=(s+l)/t,this._y=(a+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(si(this.dot(t),-1,1)))}rotateTowards(t,e){const i=this.angleTo(t);if(0===i)return this;const n=Math.min(1,e/i);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const i=t._x,n=t._y,s=t._z,r=t._w,o=e._x,a=e._y,l=e._z,c=e._w;return this._x=i*c+r*o+n*l-s*a,this._y=n*c+r*a+s*o-i*l,this._z=s*c+r*l+i*a-n*o,this._w=r*c-i*o-n*a-s*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const i=this._x,n=this._y,s=this._z,r=this._w;let o=r*t._w+i*t._x+n*t._y+s*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=r,this._x=i,this._y=n,this._z=s,this;const a=1-o*o;if(a<=Number.EPSILON){const t=1-e;return this._w=t*r+e*this._w,this._x=t*i+e*this._x,this._y=t*n+e*this._y,this._z=t*s+e*this._z,this.normalize(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),h=Math.sin((1-e)*c)/l,u=Math.sin(e*c)/l;return this._w=r*h+this._w*u,this._x=i*h+this._x*u,this._y=n*h+this._y*u,this._z=s*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,i){return this.copy(t).slerp(e,i)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),i=Math.random(),n=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(n*Math.sin(t),n*Math.cos(t),s*Math.sin(e),s*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class di{constructor(t=0,e=0,i=0){di.prototype.isVector3=!0,this.x=t,this.y=e,this.z=i}set(t,e,i){return void 0===i&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(fi.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(fi.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*e+s[3]*i+s[6]*n,this.y=s[1]*e+s[4]*i+s[7]*n,this.z=s[2]*e+s[5]*i+s[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,s=t.elements,r=1/(s[3]*e+s[7]*i+s[11]*n+s[15]);return this.x=(s[0]*e+s[4]*i+s[8]*n+s[12])*r,this.y=(s[1]*e+s[5]*i+s[9]*n+s[13])*r,this.z=(s[2]*e+s[6]*i+s[10]*n+s[14])*r,this}applyQuaternion(t){const e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,o=t.z,a=t.w,l=2*(r*n-o*i),c=2*(o*e-s*n),h=2*(s*i-r*e);return this.x=e+a*l+r*h-o*c,this.y=i+a*c+o*l-s*h,this.z=n+a*h+s*c-r*l,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*n,this.y=s[1]*e+s[5]*i+s[9]*n,this.z=s[2]*e+s[6]*i+s[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=si(this.x,t.x,e.x),this.y=si(this.y,t.y,e.y),this.z=si(this.z,t.z,e.z),this}clampScalar(t,e){return this.x=si(this.x,t,e),this.y=si(this.y,t,e),this.z=si(this.z,t,e),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(si(i,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const i=t.x,n=t.y,s=t.z,r=e.x,o=e.y,a=e.z;return this.x=n*a-s*o,this.y=s*r-i*a,this.z=i*o-n*r,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return pi.copy(this).projectOnVector(t),this.sub(pi)}reflect(t){return this.sub(pi.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(si(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){const n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=2*Math.random()-1,i=Math.sqrt(1-e*e);return this.x=i*Math.cos(t),this.y=e,this.z=i*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const pi=new di,fi=new ui;class gi{constructor(t,e,i,n,s,r,o,a,l){gi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,i,n,s,r,o,a,l)}set(t,e,i,n,s,r,o,a,l){const c=this.elements;return c[0]=t,c[1]=n,c[2]=o,c[3]=e,c[4]=s,c[5]=a,c[6]=i,c[7]=r,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}extractBasis(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,s=this.elements,r=i[0],o=i[3],a=i[6],l=i[1],c=i[4],h=i[7],u=i[2],d=i[5],p=i[8],f=n[0],g=n[3],m=n[6],A=n[1],v=n[4],y=n[7],b=n[2],_=n[5],x=n[8];return s[0]=r*f+o*A+a*b,s[3]=r*g+o*v+a*_,s[6]=r*m+o*y+a*x,s[1]=l*f+c*A+h*b,s[4]=l*g+c*v+h*_,s[7]=l*m+c*y+h*x,s[2]=u*f+d*A+p*b,s[5]=u*g+d*v+p*_,s[8]=u*m+d*y+p*x,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*r*c-e*o*l-i*s*c+i*o*a+n*s*l-n*r*a}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=c*r-o*l,u=o*a-c*s,d=l*s-r*a,p=e*h+i*u+n*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=h*f,t[1]=(n*l-c*i)*f,t[2]=(o*i-n*r)*f,t[3]=u*f,t[4]=(c*e-n*a)*f,t[5]=(n*s-o*e)*f,t[6]=d*f,t[7]=(i*a-l*e)*f,t[8]=(r*e-i*s)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,i,n,s,r,o){const a=Math.cos(s),l=Math.sin(s);return this.set(i*a,i*l,-i*(a*r+l*o)+r+t,-n*l,n*a,-n*(-l*r+a*o)+o+e,0,0,1),this}scale(t,e){return this.premultiply(mi.makeScale(t,e)),this}rotate(t){return this.premultiply(mi.makeRotation(-t)),this}translate(t,e){return this.premultiply(mi.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,i,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,i=t.elements;for(let t=0;t<9;t++)if(e[t]!==i[t])return!1;return!0}fromArray(t,e=0){for(let i=0;i<9;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const mi=new gi;function Ai(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function vi(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function yi(){const t=vi("canvas");return t.style.display="block",t}const bi={};function _i(t){t in bi||(bi[t]=!0,console.warn(t))}function xi(t,e,i){return new Promise(function(n,s){setTimeout(function r(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:s();break;case t.TIMEOUT_EXPIRED:setTimeout(r,i);break;default:n()}},i)})}function wi(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function Ei(t){const e=t.elements;-1===e[11]?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=1-e[14])}const Ci=(new gi).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Si=(new gi).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Ii(){const t={enabled:!0,workingColorSpace:Oe,spaces:{},convert:function(t,e,i){return!1!==this.enabled&&e!==i&&e&&i?(this.spaces[e].transfer===Ue&&(t.r=Ti(t.r),t.g=Ti(t.g),t.b=Ti(t.b)),this.spaces[e].primaries!==this.spaces[i].primaries&&(t.applyMatrix3(this.spaces[e].toXYZ),t.applyMatrix3(this.spaces[i].fromXYZ)),this.spaces[i].transfer===Ue&&(t.r=Bi(t.r),t.g=Bi(t.g),t.b=Bi(t.b)),t):t},workingToColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},colorSpaceToWorking:function(t,e){return this.convert(t,e,this.workingColorSpace)},getPrimaries:function(t){return this.spaces[t].primaries},getTransfer:function(t){return t===De?ke:this.spaces[t].transfer},getLuminanceCoefficients:function(t,e=this.workingColorSpace){return t.fromArray(this.spaces[e].luminanceCoefficients)},define:function(t){Object.assign(this.spaces,t)},_getMatrix:function(t,e,i){return t.copy(this.spaces[e].toXYZ).multiply(this.spaces[i].fromXYZ)},_getDrawingBufferColorSpace:function(t){return this.spaces[t].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(t=this.workingColorSpace){return this.spaces[t].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(e,i){return _i("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),t.workingToColorSpace(e,i)},toWorkingColorSpace:function(e,i){return _i("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),t.colorSpaceToWorking(e,i)}},e=[.64,.33,.3,.6,.15,.06],i=[.2126,.7152,.0722],n=[.3127,.329];return t.define({[Oe]:{primaries:e,whitePoint:n,transfer:ke,toXYZ:Ci,fromXYZ:Si,luminanceCoefficients:i,workingColorSpaceConfig:{unpackColorSpace:Ne},outputColorSpaceConfig:{drawingBufferColorSpace:Ne}},[Ne]:{primaries:e,whitePoint:n,transfer:Ue,toXYZ:Ci,fromXYZ:Si,luminanceCoefficients:i,outputColorSpaceConfig:{drawingBufferColorSpace:Ne}}}),t}const Mi=Ii();function Ti(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Bi(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let Ri;class Pi{static getDataURL(t,e="image/png"){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let i;if(t instanceof HTMLCanvasElement)i=t;else{void 0===Ri&&(Ri=vi("canvas")),Ri.width=t.width,Ri.height=t.height;const e=Ri.getContext("2d");t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),i=Ri}return i.toDataURL(e)}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=vi("canvas");e.width=t.width,e.height=t.height;const i=e.getContext("2d");i.drawImage(t,0,0,t.width,t.height);const n=i.getImageData(0,0,t.width,t.height),s=n.data;for(let t=0;t<s.length;t++)s[t]=255*Ti(s[t]/255);return i.putImageData(n,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*Ti(e[t]/255)):e[t]=Ti(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let Li=0;class Di{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Li++}),this.uuid=ni(),this.data=t,this.dataReady=!0,this.version=0}getSize(t){const e=this.data;return e instanceof HTMLVideoElement?t.set(e.videoWidth,e.videoHeight):null!==e?t.set(e.width,e.height,e.depth||0):t.set(0,0,0),t}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(null!==n){let t;if(Array.isArray(n)){t=[];for(let e=0,i=n.length;e<i;e++)n[e].isDataTexture?t.push(Ni(n[e].image)):t.push(Ni(n[e]))}else t=Ni(n);i.url=t}return e||(t.images[this.uuid]=i),i}}function Ni(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?Pi.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Oi=0;const ki=new di;class Ui extends Je{constructor(t=Ui.DEFAULT_IMAGE,e=Ui.DEFAULT_MAPPING,i=ut,n=ut,s=mt,r=vt,o=Lt,a=yt,l=Ui.DEFAULT_ANISOTROPY,c=De){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Oi++}),this.uuid=ni(),this.name="",this.source=new Di(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=i,this.wrapT=n,this.magFilter=s,this.minFilter=r,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new hi(0,0),this.repeat=new hi(1,1),this.center=new hi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new gi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(t&&t.depth&&t.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(ki).x}get height(){return this.source.getSize(ki).y}get depth(){return this.source.getSize(ki).z}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}setValues(t){for(const e in t){const i=t[e];if(void 0===i){console.warn(`THREE.Texture.setValues(): parameter '${e}' has value of undefined.`);continue}const n=this[e];void 0!==n?n&&i&&n.isVector2&&i.isVector2||n&&i&&n.isVector3&&i.isVector3||n&&i&&n.isMatrix3&&i.isMatrix3?n.copy(i):this[e]=i:console.warn(`THREE.Texture.setValues(): property '${e}' does not exist.`)}}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const i={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),e||(t.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ht:t.x=t.x-Math.floor(t.x);break;case ut:t.x=t.x<0?0:1;break;case dt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case ht:t.y=t.y-Math.floor(t.y);break;case ut:t.y=t.y<0?0:1;break;case dt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}Ui.DEFAULT_IMAGE=null,Ui.DEFAULT_MAPPING=300,Ui.DEFAULT_ANISOTROPY=1;class Fi{constructor(t=0,e=0,i=0,n=1){Fi.prototype.isVector4=!0,this.x=t,this.y=e,this.z=i,this.w=n}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,s=this.w,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12]*s,this.y=r[1]*e+r[5]*i+r[9]*n+r[13]*s,this.z=r[2]*e+r[6]*i+r[10]*n+r[14]*s,this.w=r[3]*e+r[7]*i+r[11]*n+r[15]*s,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,i,n,s;const r=.01,o=.1,a=t.elements,l=a[0],c=a[4],h=a[8],u=a[1],d=a[5],p=a[9],f=a[2],g=a[6],m=a[10];if(Math.abs(c-u)<r&&Math.abs(h-f)<r&&Math.abs(p-g)<r){if(Math.abs(c+u)<o&&Math.abs(h+f)<o&&Math.abs(p+g)<o&&Math.abs(l+d+m-3)<o)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,a=(d+1)/2,A=(m+1)/2,v=(c+u)/4,y=(h+f)/4,b=(p+g)/4;return t>a&&t>A?t<r?(i=0,n=.707106781,s=.707106781):(i=Math.sqrt(t),n=v/i,s=y/i):a>A?a<r?(i=.707106781,n=0,s=.707106781):(n=Math.sqrt(a),i=v/n,s=b/n):A<r?(i=.707106781,n=.707106781,s=0):(s=Math.sqrt(A),i=y/s,n=b/s),this.set(i,n,s,e),this}let A=Math.sqrt((g-p)*(g-p)+(h-f)*(h-f)+(u-c)*(u-c));return Math.abs(A)<.001&&(A=1),this.x=(g-p)/A,this.y=(h-f)/A,this.z=(u-c)/A,this.w=Math.acos((l+d+m-1)/2),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this.w=e[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=si(this.x,t.x,e.x),this.y=si(this.y,t.y,e.y),this.z=si(this.z,t.z,e.z),this.w=si(this.w,t.w,e.w),this}clampScalar(t,e){return this.x=si(this.x,t,e),this.y=si(this.y,t,e),this.z=si(this.z,t,e),this.w=si(this.w,t,e),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(si(i,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this.w=t.w+(e.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class zi extends Je{constructor(t=1,e=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:mt,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=t,this.height=e,this.depth=i.depth,this.scissor=new Fi(0,0,t,e),this.scissorTest=!1,this.viewport=new Fi(0,0,t,e);const n={width:t,height:e,depth:i.depth},s=new Ui(n);this.textures=[];const r=i.count;for(let t=0;t<r;t++)this.textures[t]=s.clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(t={}){const e={minFilter:mt,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==t.mapping&&(e.mapping=t.mapping),void 0!==t.wrapS&&(e.wrapS=t.wrapS),void 0!==t.wrapT&&(e.wrapT=t.wrapT),void 0!==t.wrapR&&(e.wrapR=t.wrapR),void 0!==t.magFilter&&(e.magFilter=t.magFilter),void 0!==t.minFilter&&(e.minFilter=t.minFilter),void 0!==t.format&&(e.format=t.format),void 0!==t.type&&(e.type=t.type),void 0!==t.anisotropy&&(e.anisotropy=t.anisotropy),void 0!==t.colorSpace&&(e.colorSpace=t.colorSpace),void 0!==t.flipY&&(e.flipY=t.flipY),void 0!==t.generateMipmaps&&(e.generateMipmaps=t.generateMipmaps),void 0!==t.internalFormat&&(e.internalFormat=t.internalFormat);for(let t=0;t<this.textures.length;t++){this.textures[t].setValues(e)}}get texture(){return this.textures[0]}set texture(t){this.textures[0]=t}set depthTexture(t){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==t&&(t.renderTarget=this),this._depthTexture=t}get depthTexture(){return this._depthTexture}setSize(t,e,i=1){if(this.width!==t||this.height!==e||this.depth!==i){this.width=t,this.height=e,this.depth=i;for(let n=0,s=this.textures.length;n<s;n++)this.textures[n].image.width=t,this.textures[n].image.height=e,this.textures[n].image.depth=i,this.textures[n].isArrayTexture=this.textures[n].image.depth>1;this.dispose()}this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.textures.length=0;for(let e=0,i=t.textures.length;e<i;e++){this.textures[e]=t.textures[e].clone(),this.textures[e].isRenderTargetTexture=!0,this.textures[e].renderTarget=this;const i=Object.assign({},t.textures[e].image);this.textures[e].source=new Di(i)}return this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.resolveDepthBuffer=t.resolveDepthBuffer,this.resolveStencilBuffer=t.resolveStencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Vi extends zi{constructor(t=1,e=1,i={}){super(t,e,i),this.isWebGLRenderTarget=!0}}class Qi extends Ui{constructor(t=null,e=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:i,depth:n},this.magFilter=pt,this.minFilter=pt,this.wrapR=ut,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class ji extends Ui{constructor(t=null,e=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:i,depth:n},this.magFilter=pt,this.minFilter=pt,this.wrapR=ut,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Gi{constructor(t=new di(1/0,1/0,1/0),e=new di(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e+=3)this.expandByPoint(qi.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,i=t.count;e<i;e++)this.expandByPoint(qi.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=qi.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const i=t.geometry;if(void 0!==i){const n=i.getAttribute("position");if(!0===e&&void 0!==n&&!0!==t.isInstancedMesh)for(let e=0,i=n.count;e<i;e++)!0===t.isMesh?t.getVertexPosition(e,qi):qi.fromBufferAttribute(n,e),qi.applyMatrix4(t.matrixWorld),this.expandByPoint(qi);else void 0!==t.boundingBox?(null===t.boundingBox&&t.computeBoundingBox(),$i.copy(t.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),$i.copy(i.boundingBox)),$i.applyMatrix4(t.matrixWorld),this.union($i)}const n=t.children;for(let t=0,i=n.length;t<i;t++)this.expandByObject(n[t],e);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,qi),qi.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(tn),en.subVectors(this.max,tn),Wi.subVectors(t.a,tn),Ki.subVectors(t.b,tn),Xi.subVectors(t.c,tn),Yi.subVectors(Ki,Wi),Ji.subVectors(Xi,Ki),Zi.subVectors(Wi,Xi);let e=[0,-Yi.z,Yi.y,0,-Ji.z,Ji.y,0,-Zi.z,Zi.y,Yi.z,0,-Yi.x,Ji.z,0,-Ji.x,Zi.z,0,-Zi.x,-Yi.y,Yi.x,0,-Ji.y,Ji.x,0,-Zi.y,Zi.x,0];return!!rn(e,Wi,Ki,Xi,en)&&(e=[1,0,0,0,1,0,0,0,1],!!rn(e,Wi,Ki,Xi,en)&&(nn.crossVectors(Yi,Ji),e=[nn.x,nn.y,nn.z],rn(e,Wi,Ki,Xi,en)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,qi).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(qi).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(Hi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Hi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Hi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Hi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Hi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Hi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Hi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Hi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Hi)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(t){return this.min.fromArray(t.min),this.max.fromArray(t.max),this}}const Hi=[new di,new di,new di,new di,new di,new di,new di,new di],qi=new di,$i=new Gi,Wi=new di,Ki=new di,Xi=new di,Yi=new di,Ji=new di,Zi=new di,tn=new di,en=new di,nn=new di,sn=new di;function rn(t,e,i,n,s){for(let r=0,o=t.length-3;r<=o;r+=3){sn.fromArray(t,r);const o=s.x*Math.abs(sn.x)+s.y*Math.abs(sn.y)+s.z*Math.abs(sn.z),a=e.dot(sn),l=i.dot(sn),c=n.dot(sn);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const on=new Gi,an=new di,ln=new di;class cn{constructor(t=new di,e=-1){this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const i=this.center;void 0!==e?i.copy(e):on.setFromPoints(t).getCenter(i);let n=0;for(let e=0,s=t.length;e<s;e++)n=Math.max(n,i.distanceToSquared(t[e]));return this.radius=Math.sqrt(n),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const i=this.center.distanceToSquared(t);return e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;an.subVectors(t,this.center);const e=an.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),i=.5*(t-this.radius);this.center.addScaledVector(an,i/t),this.radius+=i}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(ln.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(an.copy(t.center).add(ln)),this.expandByPoint(an.copy(t.center).sub(ln))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(t){return this.radius=t.radius,this.center.fromArray(t.center),this}}const hn=new di,un=new di,dn=new di,pn=new di,fn=new di,gn=new di,mn=new di;class An{constructor(t=new di,e=new di(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,hn)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=hn.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(hn.copy(this.origin).addScaledVector(this.direction,e),hn.distanceToSquared(t))}distanceSqToSegment(t,e,i,n){un.copy(t).add(e).multiplyScalar(.5),dn.copy(e).sub(t).normalize(),pn.copy(this.origin).sub(un);const s=.5*t.distanceTo(e),r=-this.direction.dot(dn),o=pn.dot(this.direction),a=-pn.dot(dn),l=pn.lengthSq(),c=Math.abs(1-r*r);let h,u,d,p;if(c>0)if(h=r*a-o,u=r*o-a,p=s*c,h>=0)if(u>=-p)if(u<=p){const t=1/c;h*=t,u*=t,d=h*(h+r*u+2*o)+u*(r*h+u+2*a)+l}else u=s,h=Math.max(0,-(r*u+o)),d=-h*h+u*(u+2*a)+l;else u=-s,h=Math.max(0,-(r*u+o)),d=-h*h+u*(u+2*a)+l;else u<=-p?(h=Math.max(0,-(-r*s+o)),u=h>0?-s:Math.min(Math.max(-s,-a),s),d=-h*h+u*(u+2*a)+l):u<=p?(h=0,u=Math.min(Math.max(-s,-a),s),d=u*(u+2*a)+l):(h=Math.max(0,-(r*s+o)),u=h>0?s:Math.min(Math.max(-s,-a),s),d=-h*h+u*(u+2*a)+l);else u=r>0?-s:s,h=Math.max(0,-(r*u+o)),d=-h*h+u*(u+2*a)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,h),n&&n.copy(un).addScaledVector(dn,u),d}intersectSphere(t,e){hn.subVectors(t.center,this.origin);const i=hn.dot(this.direction),n=hn.dot(hn)-i*i,s=t.radius*t.radius;if(n>s)return null;const r=Math.sqrt(s-n),o=i-r,a=i+r;return a<0?null:o<0?this.at(a,e):this.at(o,e)}intersectsSphere(t){return!(t.radius<0)&&this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){const i=this.distanceToPlane(t);return null===i?null:this.at(i,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,n,s,r,o,a;const l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(i=(t.min.x-u.x)*l,n=(t.max.x-u.x)*l):(i=(t.max.x-u.x)*l,n=(t.min.x-u.x)*l),c>=0?(s=(t.min.y-u.y)*c,r=(t.max.y-u.y)*c):(s=(t.max.y-u.y)*c,r=(t.min.y-u.y)*c),i>r||s>n?null:((s>i||isNaN(i))&&(i=s),(r<n||isNaN(n))&&(n=r),h>=0?(o=(t.min.z-u.z)*h,a=(t.max.z-u.z)*h):(o=(t.max.z-u.z)*h,a=(t.min.z-u.z)*h),i>a||o>n?null:((o>i||i!=i)&&(i=o),(a<n||n!=n)&&(n=a),n<0?null:this.at(i>=0?i:n,e)))}intersectsBox(t){return null!==this.intersectBox(t,hn)}intersectTriangle(t,e,i,n,s){fn.subVectors(e,t),gn.subVectors(i,t),mn.crossVectors(fn,gn);let r,o=this.direction.dot(mn);if(o>0){if(n)return null;r=1}else{if(!(o<0))return null;r=-1,o=-o}pn.subVectors(this.origin,t);const a=r*this.direction.dot(gn.crossVectors(pn,gn));if(a<0)return null;const l=r*this.direction.dot(fn.cross(pn));if(l<0)return null;if(a+l>o)return null;const c=-r*pn.dot(mn);return c<0?null:this.at(c/o,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class vn{constructor(t,e,i,n,s,r,o,a,l,c,h,u,d,p,f,g){vn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,i,n,s,r,o,a,l,c,h,u,d,p,f,g)}set(t,e,i,n,s,r,o,a,l,c,h,u,d,p,f,g){const m=this.elements;return m[0]=t,m[4]=e,m[8]=i,m[12]=n,m[1]=s,m[5]=r,m[9]=o,m[13]=a,m[2]=l,m[6]=c,m[10]=h,m[14]=u,m[3]=d,m[7]=p,m[11]=f,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new vn).fromArray(this.elements)}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){const e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,i=t.elements,n=1/yn.setFromMatrixColumn(t,0).length(),s=1/yn.setFromMatrixColumn(t,1).length(),r=1/yn.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*s,e[5]=i[5]*s,e[6]=i[6]*s,e[7]=0,e[8]=i[8]*r,e[9]=i[9]*r,e[10]=i[10]*r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,i=t.x,n=t.y,s=t.z,r=Math.cos(i),o=Math.sin(i),a=Math.cos(n),l=Math.sin(n),c=Math.cos(s),h=Math.sin(s);if("XYZ"===t.order){const t=r*c,i=r*h,n=o*c,s=o*h;e[0]=a*c,e[4]=-a*h,e[8]=l,e[1]=i+n*l,e[5]=t-s*l,e[9]=-o*a,e[2]=s-t*l,e[6]=n+i*l,e[10]=r*a}else if("YXZ"===t.order){const t=a*c,i=a*h,n=l*c,s=l*h;e[0]=t+s*o,e[4]=n*o-i,e[8]=r*l,e[1]=r*h,e[5]=r*c,e[9]=-o,e[2]=i*o-n,e[6]=s+t*o,e[10]=r*a}else if("ZXY"===t.order){const t=a*c,i=a*h,n=l*c,s=l*h;e[0]=t-s*o,e[4]=-r*h,e[8]=n+i*o,e[1]=i+n*o,e[5]=r*c,e[9]=s-t*o,e[2]=-r*l,e[6]=o,e[10]=r*a}else if("ZYX"===t.order){const t=r*c,i=r*h,n=o*c,s=o*h;e[0]=a*c,e[4]=n*l-i,e[8]=t*l+s,e[1]=a*h,e[5]=s*l+t,e[9]=i*l-n,e[2]=-l,e[6]=o*a,e[10]=r*a}else if("YZX"===t.order){const t=r*a,i=r*l,n=o*a,s=o*l;e[0]=a*c,e[4]=s-t*h,e[8]=n*h+i,e[1]=h,e[5]=r*c,e[9]=-o*c,e[2]=-l*c,e[6]=i*h+n,e[10]=t-s*h}else if("XZY"===t.order){const t=r*a,i=r*l,n=o*a,s=o*l;e[0]=a*c,e[4]=-h,e[8]=l*c,e[1]=t*h+s,e[5]=r*c,e[9]=i*h-n,e[2]=n*h-i,e[6]=o*c,e[10]=s*h+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(_n,t,xn)}lookAt(t,e,i){const n=this.elements;return Cn.subVectors(t,e),0===Cn.lengthSq()&&(Cn.z=1),Cn.normalize(),wn.crossVectors(i,Cn),0===wn.lengthSq()&&(1===Math.abs(i.z)?Cn.x+=1e-4:Cn.z+=1e-4,Cn.normalize(),wn.crossVectors(i,Cn)),wn.normalize(),En.crossVectors(Cn,wn),n[0]=wn.x,n[4]=En.x,n[8]=Cn.x,n[1]=wn.y,n[5]=En.y,n[9]=Cn.y,n[2]=wn.z,n[6]=En.z,n[10]=Cn.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,s=this.elements,r=i[0],o=i[4],a=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],p=i[2],f=i[6],g=i[10],m=i[14],A=i[3],v=i[7],y=i[11],b=i[15],_=n[0],x=n[4],w=n[8],E=n[12],C=n[1],S=n[5],I=n[9],M=n[13],T=n[2],B=n[6],R=n[10],P=n[14],L=n[3],D=n[7],N=n[11],O=n[15];return s[0]=r*_+o*C+a*T+l*L,s[4]=r*x+o*S+a*B+l*D,s[8]=r*w+o*I+a*R+l*N,s[12]=r*E+o*M+a*P+l*O,s[1]=c*_+h*C+u*T+d*L,s[5]=c*x+h*S+u*B+d*D,s[9]=c*w+h*I+u*R+d*N,s[13]=c*E+h*M+u*P+d*O,s[2]=p*_+f*C+g*T+m*L,s[6]=p*x+f*S+g*B+m*D,s[10]=p*w+f*I+g*R+m*N,s[14]=p*E+f*M+g*P+m*O,s[3]=A*_+v*C+y*T+b*L,s[7]=A*x+v*S+y*B+b*D,s[11]=A*w+v*I+y*R+b*N,s[15]=A*E+v*M+y*P+b*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[4],n=t[8],s=t[12],r=t[1],o=t[5],a=t[9],l=t[13],c=t[2],h=t[6],u=t[10],d=t[14];return t[3]*(+s*a*h-n*l*h-s*o*u+i*l*u+n*o*d-i*a*d)+t[7]*(+e*a*d-e*l*u+s*r*u-n*r*d+n*l*c-s*a*c)+t[11]*(+e*l*h-e*o*d-s*r*h+i*r*d+s*o*c-i*l*c)+t[15]*(-n*o*c-e*a*h+e*o*u+n*r*h-i*r*u+i*a*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){const n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15],A=h*g*l-f*u*l+f*a*d-o*g*d-h*a*m+o*u*m,v=p*u*l-c*g*l-p*a*d+r*g*d+c*a*m-r*u*m,y=c*f*l-p*h*l+p*o*d-r*f*d-c*o*m+r*h*m,b=p*h*a-c*f*a-p*o*u+r*f*u+c*o*g-r*h*g,_=e*A+i*v+n*y+s*b;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/_;return t[0]=A*x,t[1]=(f*u*s-h*g*s-f*n*d+i*g*d+h*n*m-i*u*m)*x,t[2]=(o*g*s-f*a*s+f*n*l-i*g*l-o*n*m+i*a*m)*x,t[3]=(h*a*s-o*u*s-h*n*l+i*u*l+o*n*d-i*a*d)*x,t[4]=v*x,t[5]=(c*g*s-p*u*s+p*n*d-e*g*d-c*n*m+e*u*m)*x,t[6]=(p*a*s-r*g*s-p*n*l+e*g*l+r*n*m-e*a*m)*x,t[7]=(r*u*s-c*a*s+c*n*l-e*u*l-r*n*d+e*a*d)*x,t[8]=y*x,t[9]=(p*h*s-c*f*s-p*i*d+e*f*d+c*i*m-e*h*m)*x,t[10]=(r*f*s-p*o*s+p*i*l-e*f*l-r*i*m+e*o*m)*x,t[11]=(c*o*s-r*h*s-c*i*l+e*h*l+r*i*d-e*o*d)*x,t[12]=b*x,t[13]=(c*f*n-p*h*n+p*i*u-e*f*u-c*i*g+e*h*g)*x,t[14]=(p*o*n-r*f*n-p*i*a+e*f*a+r*i*g-e*o*g)*x,t[15]=(r*h*n-c*o*n+c*i*a-e*h*a-r*i*u+e*o*u)*x,this}scale(t){const e=this.elements,i=t.x,n=t.y,s=t.z;return e[0]*=i,e[4]*=n,e[8]*=s,e[1]*=i,e[5]*=n,e[9]*=s,e[2]*=i,e[6]*=n,e[10]*=s,e[3]*=i,e[7]*=n,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}makeTranslation(t,e,i){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const i=Math.cos(e),n=Math.sin(e),s=1-i,r=t.x,o=t.y,a=t.z,l=s*r,c=s*o;return this.set(l*r+i,l*o-n*a,l*a+n*o,0,l*o+n*a,c*o+i,c*a-n*r,0,l*a-n*o,c*a+n*r,s*a*a+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i,n,s,r){return this.set(1,i,s,0,t,1,r,0,e,n,1,0,0,0,0,1),this}compose(t,e,i){const n=this.elements,s=e._x,r=e._y,o=e._z,a=e._w,l=s+s,c=r+r,h=o+o,u=s*l,d=s*c,p=s*h,f=r*c,g=r*h,m=o*h,A=a*l,v=a*c,y=a*h,b=i.x,_=i.y,x=i.z;return n[0]=(1-(f+m))*b,n[1]=(d+y)*b,n[2]=(p-v)*b,n[3]=0,n[4]=(d-y)*_,n[5]=(1-(u+m))*_,n[6]=(g+A)*_,n[7]=0,n[8]=(p+v)*x,n[9]=(g-A)*x,n[10]=(1-(u+f))*x,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,i){const n=this.elements;let s=yn.set(n[0],n[1],n[2]).length();const r=yn.set(n[4],n[5],n[6]).length(),o=yn.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),t.x=n[12],t.y=n[13],t.z=n[14],bn.copy(this);const a=1/s,l=1/r,c=1/o;return bn.elements[0]*=a,bn.elements[1]*=a,bn.elements[2]*=a,bn.elements[4]*=l,bn.elements[5]*=l,bn.elements[6]*=l,bn.elements[8]*=c,bn.elements[9]*=c,bn.elements[10]*=c,e.setFromRotationMatrix(bn),i.x=s,i.y=r,i.z=o,this}makePerspective(t,e,i,n,s,r,o=Xe){const a=this.elements,l=2*s/(e-t),c=2*s/(i-n),h=(e+t)/(e-t),u=(i+n)/(i-n);let d,p;if(o===Xe)d=-(r+s)/(r-s),p=-2*r*s/(r-s);else{if(o!==Ye)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);d=-r/(r-s),p=-r*s/(r-s)}return a[0]=l,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,i,n,s,r,o=Xe){const a=this.elements,l=1/(e-t),c=1/(i-n),h=1/(r-s),u=(e+t)*l,d=(i+n)*c;let p,f;if(o===Xe)p=(r+s)*h,f=-2*h;else{if(o!==Ye)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);p=s*h,f=-1*h}return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=f,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,i=t.elements;for(let t=0;t<16;t++)if(e[t]!==i[t])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}const yn=new di,bn=new vn,_n=new di(0,0,0),xn=new di(1,1,1),wn=new di,En=new di,Cn=new di,Sn=new vn,In=new ui;class Mn{constructor(t=0,e=0,i=0,n=Mn.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=i,this._order=n}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,i,n=this._order){return this._x=t,this._y=e,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,i=!0){const n=t.elements,s=n[0],r=n[4],o=n[8],a=n[1],l=n[5],c=n[9],h=n[2],u=n[6],d=n[10];switch(e){case"XYZ":this._y=Math.asin(si(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-r,s)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-si(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(si(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-r,l)):(this._y=0,this._z=Math.atan2(a,s));break;case"ZYX":this._y=Math.asin(-si(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(a,s)):(this._x=0,this._z=Math.atan2(-r,l));break;case"YZX":this._z=Math.asin(si(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-si(r,-1,1)),Math.abs(r)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===i&&this._onChangeCallback(),this}setFromQuaternion(t,e,i){return Sn.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Sn,e,i)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return In.setFromEuler(this),this.setFromQuaternion(In,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Mn.DEFAULT_ORDER="XYZ";class Tn{constructor(){this.mask=1}set(t){this.mask=1<<t>>>0}enable(t){this.mask|=1<<t}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t}disable(t){this.mask&=~(1<<t)}disableAll(){this.mask=0}test(t){return 0!==(this.mask&t.mask)}isEnabled(t){return!!(this.mask&1<<t)}}let Bn=0;const Rn=new di,Pn=new ui,Ln=new vn,Dn=new di,Nn=new di,On=new di,kn=new ui,Un=new di(1,0,0),Fn=new di(0,1,0),zn=new di(0,0,1),Vn={type:"added"},Qn={type:"removed"},jn={type:"childadded",child:null},Gn={type:"childremoved",child:null};class Hn extends Je{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Bn++}),this.uuid=ni(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Hn.DEFAULT_UP.clone();const t=new di,e=new Mn,i=new ui,n=new di(1,1,1);e._onChange(function(){i.setFromEuler(e,!1)}),i._onChange(function(){e.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new vn},normalMatrix:{value:new gi}}),this.matrix=new vn,this.matrixWorld=new vn,this.matrixAutoUpdate=Hn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Hn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Tn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Pn.setFromAxisAngle(t,e),this.quaternion.multiply(Pn),this}rotateOnWorldAxis(t,e){return Pn.setFromAxisAngle(t,e),this.quaternion.premultiply(Pn),this}rotateX(t){return this.rotateOnAxis(Un,t)}rotateY(t){return this.rotateOnAxis(Fn,t)}rotateZ(t){return this.rotateOnAxis(zn,t)}translateOnAxis(t,e){return Rn.copy(t).applyQuaternion(this.quaternion),this.position.add(Rn.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Un,t)}translateY(t){return this.translateOnAxis(Fn,t)}translateZ(t){return this.translateOnAxis(zn,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Ln.copy(this.matrixWorld).invert())}lookAt(t,e,i){t.isVector3?Dn.copy(t):Dn.set(t,e,i);const n=this.parent;this.updateWorldMatrix(!0,!1),Nn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ln.lookAt(Nn,Dn,this.up):Ln.lookAt(Dn,Nn,this.up),this.quaternion.setFromRotationMatrix(Ln),n&&(Ln.extractRotation(n.matrixWorld),Pn.setFromRotationMatrix(Ln),this.quaternion.premultiply(Pn.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(Vn),jn.child=t,this.dispatchEvent(jn),jn.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Qn),Gn.child=t,this.dispatchEvent(Gn),Gn.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Ln.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Ln.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ln),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(Vn),jn.child=t,this.dispatchEvent(jn),jn.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let i=0,n=this.children.length;i<n;i++){const n=this.children[i].getObjectByProperty(t,e);if(void 0!==n)return n}}getObjectsByProperty(t,e,i=[]){this[t]===e&&i.push(this);const n=this.children;for(let s=0,r=n.length;s<r;s++)n[s].getObjectsByProperty(t,e,i);return i}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Nn,t,On),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Nn,kn,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let i=0,n=e.length;i<n;i++){e[i].updateMatrixWorld(t)}}updateWorldMatrix(t,e){const i=this.parent;if(!0===t&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===e){const t=this.children;for(let e=0,i=t.length;e<i;e++){t[e].updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"==typeof t,i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const n={};function s(e,i){return void 0===e[i.uuid]&&(e[i.uuid]=i.toJSON(t)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.geometryInfo=this._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox?t.boundingBox.toJSON():void 0,boundingSphere:t.boundingSphere?t.boundingSphere.toJSON():void 0})),n.instanceInfo=this._instanceInfo.map(t=>({...t})),n.availableInstanceIds=this._availableInstanceIds.slice(),n.availableGeometryIds=this._availableGeometryIds.slice(),n.nextIndexStart=this._nextIndexStart,n.nextVertexStart=this._nextVertexStart,n.geometryCount=this._geometryCount,n.maxInstanceCount=this._maxInstanceCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.matricesTexture=this._matricesTexture.toJSON(t),n.indirectTexture=this._indirectTexture.toJSON(t),null!==this._colorsTexture&&(n.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(n.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(n.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=s(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const i=e.shapes;if(Array.isArray(i))for(let e=0,n=i.length;e<n;e++){const n=i[e];s(t.shapes,n)}else s(t.shapes,i)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let i=0,n=this.material.length;i<n;i++)e.push(s(t.materials,this.material[i]));n.material=e}else n.material=s(t.materials,this.material);if(this.children.length>0){n.children=[];for(let e=0;e<this.children.length;e++)n.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(let e=0;e<this.animations.length;e++){const i=this.animations[e];n.animations.push(s(t.animations,i))}}if(e){const e=r(t.geometries),n=r(t.materials),s=r(t.textures),o=r(t.images),a=r(t.shapes),l=r(t.skeletons),c=r(t.animations),h=r(t.nodes);e.length>0&&(i.geometries=e),n.length>0&&(i.materials=n),s.length>0&&(i.textures=s),o.length>0&&(i.images=o),a.length>0&&(i.shapes=a),l.length>0&&(i.skeletons=l),c.length>0&&(i.animations=c),h.length>0&&(i.nodes=h)}return i.object=n,i;function r(t){const e=[];for(const i in t){const n=t[i];delete n.metadata,e.push(n)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const i=t.children[e];this.add(i.clone())}return this}}Hn.DEFAULT_UP=new di(0,1,0),Hn.DEFAULT_MATRIX_AUTO_UPDATE=!0,Hn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const qn=new di,$n=new di,Wn=new di,Kn=new di,Xn=new di,Yn=new di,Jn=new di,Zn=new di,ts=new di,es=new di,is=new Fi,ns=new Fi,ss=new Fi;class rs{constructor(t=new di,e=new di,i=new di){this.a=t,this.b=e,this.c=i}static getNormal(t,e,i,n){n.subVectors(i,e),qn.subVectors(t,e),n.cross(qn);const s=n.lengthSq();return s>0?n.multiplyScalar(1/Math.sqrt(s)):n.set(0,0,0)}static getBarycoord(t,e,i,n,s){qn.subVectors(n,e),$n.subVectors(i,e),Wn.subVectors(t,e);const r=qn.dot(qn),o=qn.dot($n),a=qn.dot(Wn),l=$n.dot($n),c=$n.dot(Wn),h=r*l-o*o;if(0===h)return s.set(0,0,0),null;const u=1/h,d=(l*a-o*c)*u,p=(r*c-o*a)*u;return s.set(1-d-p,p,d)}static containsPoint(t,e,i,n){return null!==this.getBarycoord(t,e,i,n,Kn)&&(Kn.x>=0&&Kn.y>=0&&Kn.x+Kn.y<=1)}static getInterpolation(t,e,i,n,s,r,o,a){return null===this.getBarycoord(t,e,i,n,Kn)?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(s,Kn.x),a.addScaledVector(r,Kn.y),a.addScaledVector(o,Kn.z),a)}static getInterpolatedAttribute(t,e,i,n,s,r){return is.setScalar(0),ns.setScalar(0),ss.setScalar(0),is.fromBufferAttribute(t,e),ns.fromBufferAttribute(t,i),ss.fromBufferAttribute(t,n),r.setScalar(0),r.addScaledVector(is,s.x),r.addScaledVector(ns,s.y),r.addScaledVector(ss,s.z),r}static isFrontFacing(t,e,i,n){return qn.subVectors(i,e),$n.subVectors(t,e),qn.cross($n).dot(n)<0}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}setFromPointsAndIndices(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this}setFromAttributeAndIndices(t,e,i,n){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,i),this.c.fromBufferAttribute(t,n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return qn.subVectors(this.c,this.b),$n.subVectors(this.a,this.b),.5*qn.cross($n).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return rs.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return rs.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,i,n,s){return rs.getInterpolation(t,this.a,this.b,this.c,e,i,n,s)}containsPoint(t){return rs.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return rs.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const i=this.a,n=this.b,s=this.c;let r,o;Xn.subVectors(n,i),Yn.subVectors(s,i),Zn.subVectors(t,i);const a=Xn.dot(Zn),l=Yn.dot(Zn);if(a<=0&&l<=0)return e.copy(i);ts.subVectors(t,n);const c=Xn.dot(ts),h=Yn.dot(ts);if(c>=0&&h<=c)return e.copy(n);const u=a*h-c*l;if(u<=0&&a>=0&&c<=0)return r=a/(a-c),e.copy(i).addScaledVector(Xn,r);es.subVectors(t,s);const d=Xn.dot(es),p=Yn.dot(es);if(p>=0&&d<=p)return e.copy(s);const f=d*l-a*p;if(f<=0&&l>=0&&p<=0)return o=l/(l-p),e.copy(i).addScaledVector(Yn,o);const g=c*p-d*h;if(g<=0&&h-c>=0&&d-p>=0)return Jn.subVectors(s,n),o=(h-c)/(h-c+(d-p)),e.copy(n).addScaledVector(Jn,o);const m=1/(g+f+u);return r=f*m,o=u*m,e.copy(i).addScaledVector(Xn,r).addScaledVector(Yn,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const os={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},as={h:0,s:0,l:0},ls={h:0,s:0,l:0};function cs(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}class hs{constructor(t,e,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,i)}set(t,e,i){if(void 0===e&&void 0===i){const e=t;e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e)}else this.setRGB(t,e,i);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=Ne){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Mi.colorSpaceToWorking(this,e),this}setRGB(t,e,i,n=Mi.workingColorSpace){return this.r=t,this.g=e,this.b=i,Mi.colorSpaceToWorking(this,n),this}setHSL(t,e,i,n=Mi.workingColorSpace){if(t=ri(t,1),e=si(e,0,1),i=si(i,0,1),0===e)this.r=this.g=this.b=i;else{const n=i<=.5?i*(1+e):i+e-i*e,s=2*i-n;this.r=cs(s,n,t+1/3),this.g=cs(s,n,t),this.b=cs(s,n,t-1/3)}return Mi.colorSpaceToWorking(this,n),this}setStyle(t,e=Ne){function i(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(t)){let s;const r=n[1],o=n[2];switch(r){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,e);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,e);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const i=n[1],s=i.length;if(3===s)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,e);if(6===s)return this.setHex(parseInt(i,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=Ne){const i=os[t.toLowerCase()];return void 0!==i?this.setHex(i,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Ti(t.r),this.g=Ti(t.g),this.b=Ti(t.b),this}copyLinearToSRGB(t){return this.r=Bi(t.r),this.g=Bi(t.g),this.b=Bi(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Ne){return Mi.workingToColorSpace(us.copy(this),t),65536*Math.round(si(255*us.r,0,255))+256*Math.round(si(255*us.g,0,255))+Math.round(si(255*us.b,0,255))}getHexString(t=Ne){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Mi.workingColorSpace){Mi.workingToColorSpace(us.copy(this),e);const i=us.r,n=us.g,s=us.b,r=Math.max(i,n,s),o=Math.min(i,n,s);let a,l;const c=(o+r)/2;if(o===r)a=0,l=0;else{const t=r-o;switch(l=c<=.5?t/(r+o):t/(2-r-o),r){case i:a=(n-s)/t+(n<s?6:0);break;case n:a=(s-i)/t+2;break;case s:a=(i-n)/t+4}a/=6}return t.h=a,t.s=l,t.l=c,t}getRGB(t,e=Mi.workingColorSpace){return Mi.workingToColorSpace(us.copy(this),e),t.r=us.r,t.g=us.g,t.b=us.b,t}getStyle(t=Ne){Mi.workingToColorSpace(us.copy(this),t);const e=us.r,i=us.g,n=us.b;return t!==Ne?`color(${t} ${e.toFixed(3)} ${i.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(255*e)},${Math.round(255*i)},${Math.round(255*n)})`}offsetHSL(t,e,i){return this.getHSL(as),this.setHSL(as.h+t,as.s+e,as.l+i)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}lerpHSL(t,e){this.getHSL(as),t.getHSL(ls);const i=oi(as.h,ls.h,e),n=oi(as.s,ls.s,e),s=oi(as.l,ls.l,e);return this.setHSL(i,n,s),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,i=this.g,n=this.b,s=t.elements;return this.r=s[0]*e+s[3]*i+s[6]*n,this.g=s[1]*e+s[4]*i+s[7]*n,this.b=s[2]*e+s[5]*i+s[8]*n,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const us=new hs;hs.NAMES=os;let ds=0;class ps extends Je{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ds++}),this.uuid=ni(),this.name="",this.type="Material",this.blending=f,this.side=h,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=M,this.blendDst=T,this.blendEquation=y,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new hs(0,0,0),this.blendAlpha=0,this.depthFunc=Q,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Fe,this.stencilZFail=Fe,this.stencilZPass=Fe,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const i=t[e];if(void 0===i){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const n=this[e];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i:console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`)}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function n(t){const e=[];for(const i in t){const n=t[i];delete n.metadata,e.push(n)}return e}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(i.dispersion=this.dispersion),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapRotation&&(i.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==f&&(i.blending=this.blending),this.side!==h&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),this.blendSrc!==M&&(i.blendSrc=this.blendSrc),this.blendDst!==T&&(i.blendDst=this.blendDst),this.blendEquation!==y&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Q&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Fe&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Fe&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Fe&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),e){const e=n(t.textures),s=n(t.images);e.length>0&&(i.textures=e),s.length>0&&(i.images=s)}return i}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let i=null;if(null!==e){const t=e.length;i=new Array(t);for(let n=0;n!==t;++n)i[n]=e[n].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}class fs extends ps{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new hs(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Mn,this.combine=$,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const gs=ms();function ms(){const t=new ArrayBuffer(4),e=new Float32Array(t),i=new Uint32Array(t),n=new Uint32Array(512),s=new Uint32Array(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(n[t]=0,n[256|t]=32768,s[t]=24,s[256|t]=24):e<-14?(n[t]=1024>>-e-14,n[256|t]=1024>>-e-14|32768,s[t]=-e-1,s[256|t]=-e-1):e<=15?(n[t]=e+15<<10,n[256|t]=e+15<<10|32768,s[t]=13,s[256|t]=13):e<128?(n[t]=31744,n[256|t]=64512,s[t]=24,s[256|t]=24):(n[t]=31744,n[256|t]=64512,s[t]=13,s[256|t]=13)}const r=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let t=1;t<1024;++t){let e=t<<13,i=0;for(;!(8388608&e);)e<<=1,i-=8388608;e&=-8388609,i+=947912704,r[t]=e|i}for(let t=1024;t<2048;++t)r[t]=939524096+(t-1024<<13);for(let t=1;t<31;++t)o[t]=t<<23;o[31]=1199570944,o[32]=2147483648;for(let t=33;t<63;++t)o[t]=2147483648+(t-32<<23);o[63]=3347054592;for(let t=1;t<64;++t)32!==t&&(a[t]=1024);return{floatView:e,uint32View:i,baseTable:n,shiftTable:s,mantissaTable:r,exponentTable:o,offsetTable:a}}function As(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=si(t,-65504,65504),gs.floatView[0]=t;const e=gs.uint32View[0],i=e>>23&511;return gs.baseTable[i]+((8388607&e)>>gs.shiftTable[i])}function vs(t){const e=t>>10;return gs.uint32View[0]=gs.mantissaTable[gs.offsetTable[e]+(1023&t)]+gs.exponentTable[e],gs.floatView[0]}class ys{static toHalfFloat(t){return As(t)}static fromHalfFloat(t){return vs(t)}}const bs=new di,_s=new hi;let xs=0;class ws{constructor(t,e,i=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:xs++}),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=i,this.usage=We,this.updateRanges=[],this.gpuType=Ct,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,i){t*=this.itemSize,i*=e.itemSize;for(let n=0,s=this.itemSize;n<s;n++)this.array[t+n]=e.array[i+n];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,i=this.count;e<i;e++)_s.fromBufferAttribute(this,e),_s.applyMatrix3(t),this.setXY(e,_s.x,_s.y);else if(3===this.itemSize)for(let e=0,i=this.count;e<i;e++)bs.fromBufferAttribute(this,e),bs.applyMatrix3(t),this.setXYZ(e,bs.x,bs.y,bs.z);return this}applyMatrix4(t){for(let e=0,i=this.count;e<i;e++)bs.fromBufferAttribute(this,e),bs.applyMatrix4(t),this.setXYZ(e,bs.x,bs.y,bs.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)bs.fromBufferAttribute(this,e),bs.applyNormalMatrix(t),this.setXYZ(e,bs.x,bs.y,bs.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)bs.fromBufferAttribute(this,e),bs.transformDirection(t),this.setXYZ(e,bs.x,bs.y,bs.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let i=this.array[t*this.itemSize+e];return this.normalized&&(i=ai(i,this.array)),i}setComponent(t,e,i){return this.normalized&&(i=li(i,this.array)),this.array[t*this.itemSize+e]=i,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=ai(e,this.array)),e}setX(t,e){return this.normalized&&(e=li(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=ai(e,this.array)),e}setY(t,e){return this.normalized&&(e=li(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=ai(e,this.array)),e}setZ(t,e){return this.normalized&&(e=li(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=ai(e,this.array)),e}setW(t,e){return this.normalized&&(e=li(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,i){return t*=this.itemSize,this.normalized&&(e=li(e,this.array),i=li(i,this.array)),this.array[t+0]=e,this.array[t+1]=i,this}setXYZ(t,e,i,n){return t*=this.itemSize,this.normalized&&(e=li(e,this.array),i=li(i,this.array),n=li(n,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this}setXYZW(t,e,i,n,s){return t*=this.itemSize,this.normalized&&(e=li(e,this.array),i=li(i,this.array),n=li(n,this.array),s=li(s,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==We&&(t.usage=this.usage),t}}class Es extends ws{constructor(t,e,i){super(new Uint16Array(t),e,i)}}class Cs extends ws{constructor(t,e,i){super(new Uint32Array(t),e,i)}}class Ss extends ws{constructor(t,e,i){super(new Float32Array(t),e,i)}}let Is=0;const Ms=new vn,Ts=new Hn,Bs=new di,Rs=new Gi,Ps=new Gi,Ls=new di;class Ds extends Je{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Is++}),this.uuid=ni(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Ai(t)?Cs:Es)(t,1):this.index=t,this}setIndirect(t){return this.indirect=t,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,i=0){this.groups.push({start:t,count:e,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const e=(new gi).getNormalMatrix(t);i.applyNormalMatrix(e),i.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Ms.makeRotationFromQuaternion(t),this.applyMatrix4(Ms),this}rotateX(t){return Ms.makeRotationX(t),this.applyMatrix4(Ms),this}rotateY(t){return Ms.makeRotationY(t),this.applyMatrix4(Ms),this}rotateZ(t){return Ms.makeRotationZ(t),this.applyMatrix4(Ms),this}translate(t,e,i){return Ms.makeTranslation(t,e,i),this.applyMatrix4(Ms),this}scale(t,e,i){return Ms.makeScale(t,e,i),this.applyMatrix4(Ms),this}lookAt(t){return Ts.lookAt(t),Ts.updateMatrix(),this.applyMatrix4(Ts.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Bs).negate(),this.translate(Bs.x,Bs.y,Bs.z),this}setFromPoints(t){const e=this.getAttribute("position");if(void 0===e){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];e.push(n.x,n.y,n.z||0)}this.setAttribute("position",new Ss(e,3))}else{const i=Math.min(t.length,e.count);for(let n=0;n<i;n++){const i=t[n];e.setXYZ(n,i.x,i.y,i.z||0)}t.length>e.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),e.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Gi);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new di(-1/0,-1/0,-1/0),new di(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const i=e[t];Rs.setFromBufferAttribute(i),this.morphTargetsRelative?(Ls.addVectors(this.boundingBox.min,Rs.min),this.boundingBox.expandByPoint(Ls),Ls.addVectors(this.boundingBox.max,Rs.max),this.boundingBox.expandByPoint(Ls)):(this.boundingBox.expandByPoint(Rs.min),this.boundingBox.expandByPoint(Rs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new cn);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new di,1/0);if(t){const i=this.boundingSphere.center;if(Rs.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const i=e[t];Ps.setFromBufferAttribute(i),this.morphTargetsRelative?(Ls.addVectors(Rs.min,Ps.min),Rs.expandByPoint(Ls),Ls.addVectors(Rs.max,Ps.max),Rs.expandByPoint(Ls)):(Rs.expandByPoint(Ps.min),Rs.expandByPoint(Ps.max))}Rs.getCenter(i);let n=0;for(let e=0,s=t.count;e<s;e++)Ls.fromBufferAttribute(t,e),n=Math.max(n,i.distanceToSquared(Ls));if(e)for(let s=0,r=e.length;s<r;s++){const r=e[s],o=this.morphTargetsRelative;for(let e=0,s=r.count;e<s;e++)Ls.fromBufferAttribute(r,e),o&&(Bs.fromBufferAttribute(t,e),Ls.add(Bs)),n=Math.max(n,i.distanceToSquared(Ls))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.position,n=e.normal,s=e.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ws(new Float32Array(4*i.count),4));const r=this.getAttribute("tangent"),o=[],a=[];for(let t=0;t<i.count;t++)o[t]=new di,a[t]=new di;const l=new di,c=new di,h=new di,u=new hi,d=new hi,p=new hi,f=new di,g=new di;function m(t,e,n){l.fromBufferAttribute(i,t),c.fromBufferAttribute(i,e),h.fromBufferAttribute(i,n),u.fromBufferAttribute(s,t),d.fromBufferAttribute(s,e),p.fromBufferAttribute(s,n),c.sub(l),h.sub(l),d.sub(u),p.sub(u);const r=1/(d.x*p.y-p.x*d.y);isFinite(r)&&(f.copy(c).multiplyScalar(p.y).addScaledVector(h,-d.y).multiplyScalar(r),g.copy(h).multiplyScalar(d.x).addScaledVector(c,-p.x).multiplyScalar(r),o[t].add(f),o[e].add(f),o[n].add(f),a[t].add(g),a[e].add(g),a[n].add(g))}let A=this.groups;0===A.length&&(A=[{start:0,count:t.count}]);for(let e=0,i=A.length;e<i;++e){const i=A[e],n=i.start;for(let e=n,s=n+i.count;e<s;e+=3)m(t.getX(e+0),t.getX(e+1),t.getX(e+2))}const v=new di,y=new di,b=new di,_=new di;function x(t){b.fromBufferAttribute(n,t),_.copy(b);const e=o[t];v.copy(e),v.sub(b.multiplyScalar(b.dot(e))).normalize(),y.crossVectors(_,e);const i=y.dot(a[t])<0?-1:1;r.setXYZW(t,v.x,v.y,v.z,i)}for(let e=0,i=A.length;e<i;++e){const i=A[e],n=i.start;for(let e=n,s=n+i.count;e<s;e+=3)x(t.getX(e+0)),x(t.getX(e+1)),x(t.getX(e+2))}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let i=this.getAttribute("normal");if(void 0===i)i=new ws(new Float32Array(3*e.count),3),this.setAttribute("normal",i);else for(let t=0,e=i.count;t<e;t++)i.setXYZ(t,0,0,0);const n=new di,s=new di,r=new di,o=new di,a=new di,l=new di,c=new di,h=new di;if(t)for(let u=0,d=t.count;u<d;u+=3){const d=t.getX(u+0),p=t.getX(u+1),f=t.getX(u+2);n.fromBufferAttribute(e,d),s.fromBufferAttribute(e,p),r.fromBufferAttribute(e,f),c.subVectors(r,s),h.subVectors(n,s),c.cross(h),o.fromBufferAttribute(i,d),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,f),o.add(c),a.add(c),l.add(c),i.setXYZ(d,o.x,o.y,o.z),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(f,l.x,l.y,l.z)}else for(let t=0,o=e.count;t<o;t+=3)n.fromBufferAttribute(e,t+0),s.fromBufferAttribute(e,t+1),r.fromBufferAttribute(e,t+2),c.subVectors(r,s),h.subVectors(n,s),c.cross(h),i.setXYZ(t+0,c.x,c.y,c.z),i.setXYZ(t+1,c.x,c.y,c.z),i.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,i=t.count;e<i;e++)Ls.fromBufferAttribute(t,e),Ls.normalize(),t.setXYZ(e,Ls.x,Ls.y,Ls.z)}toNonIndexed(){function t(t,e){const i=t.array,n=t.itemSize,s=t.normalized,r=new i.constructor(e.length*n);let o=0,a=0;for(let s=0,l=e.length;s<l;s++){o=t.isInterleavedBufferAttribute?e[s]*t.data.stride+t.offset:e[s]*n;for(let t=0;t<n;t++)r[a++]=i[o++]}return new ws(r,n,s)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Ds,i=this.index.array,n=this.attributes;for(const s in n){const r=t(n[s],i);e.setAttribute(s,r)}const s=this.morphAttributes;for(const n in s){const r=[],o=s[n];for(let e=0,n=o.length;e<n;e++){const n=t(o[e],i);r.push(n)}e.morphAttributes[n]=r}e.morphTargetsRelative=this.morphTargetsRelative;const r=this.groups;for(let t=0,i=r.length;t<i;t++){const i=r[t];e.addGroup(i.start,i.count,i.materialIndex)}return e}toJSON(){const t={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const i=this.attributes;for(const e in i){const n=i[e];t.data.attributes[e]=n.toJSON(t.data)}const n={};let s=!1;for(const e in this.morphAttributes){const i=this.morphAttributes[e],r=[];for(let e=0,n=i.length;e<n;e++){const n=i[e];r.push(n.toJSON(t.data))}r.length>0&&(n[e]=r,s=!0)}s&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);const r=this.groups;r.length>0&&(t.data.groups=JSON.parse(JSON.stringify(r)));const o=this.boundingSphere;return null!==o&&(t.data.boundingSphere=o.toJSON()),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const i=t.index;null!==i&&this.setIndex(i.clone());const n=t.attributes;for(const t in n){const i=n[t];this.setAttribute(t,i.clone(e))}const s=t.morphAttributes;for(const t in s){const i=[],n=s[t];for(let t=0,s=n.length;t<s;t++)i.push(n[t].clone(e));this.morphAttributes[t]=i}this.morphTargetsRelative=t.morphTargetsRelative;const r=t.groups;for(let t=0,e=r.length;t<e;t++){const e=r[t];this.addGroup(e.start,e.count,e.materialIndex)}const o=t.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=t.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Ns=new vn,Os=new An,ks=new cn,Us=new di,Fs=new di,zs=new di,Vs=new di,Qs=new di,js=new di,Gs=new di,Hs=new di;class qs extends Hn{constructor(t=new Ds,e=new fs){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const i=t[e[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=i.length;t<e;t++){const e=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const i=this.geometry,n=i.attributes.position,s=i.morphAttributes.position,r=i.morphTargetsRelative;e.fromBufferAttribute(n,t);const o=this.morphTargetInfluences;if(s&&o){js.set(0,0,0);for(let i=0,n=s.length;i<n;i++){const n=o[i],a=s[i];0!==n&&(Qs.fromBufferAttribute(a,t),r?js.addScaledVector(Qs,n):js.addScaledVector(Qs.sub(e),n))}e.add(js)}return e}raycast(t,e){const i=this.geometry,n=this.material,s=this.matrixWorld;if(void 0!==n){if(null===i.boundingSphere&&i.computeBoundingSphere(),ks.copy(i.boundingSphere),ks.applyMatrix4(s),Os.copy(t.ray).recast(t.near),!1===ks.containsPoint(Os.origin)){if(null===Os.intersectSphere(ks,Us))return;if(Os.origin.distanceToSquared(Us)>(t.far-t.near)**2)return}Ns.copy(s).invert(),Os.copy(t.ray).applyMatrix4(Ns),null!==i.boundingBox&&!1===Os.intersectsBox(i.boundingBox)||this._computeIntersections(t,e,Os)}}_computeIntersections(t,e,i){let n;const s=this.geometry,r=this.material,o=s.index,a=s.attributes.position,l=s.attributes.uv,c=s.attributes.uv1,h=s.attributes.normal,u=s.groups,d=s.drawRange;if(null!==o)if(Array.isArray(r))for(let s=0,a=u.length;s<a;s++){const a=u[s],p=r[a.materialIndex];for(let s=Math.max(a.start,d.start),r=Math.min(o.count,Math.min(a.start+a.count,d.start+d.count));s<r;s+=3){n=$s(this,p,t,i,l,c,h,o.getX(s),o.getX(s+1),o.getX(s+2)),n&&(n.faceIndex=Math.floor(s/3),n.face.materialIndex=a.materialIndex,e.push(n))}}else{for(let s=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);s<a;s+=3){n=$s(this,r,t,i,l,c,h,o.getX(s),o.getX(s+1),o.getX(s+2)),n&&(n.faceIndex=Math.floor(s/3),e.push(n))}}else if(void 0!==a)if(Array.isArray(r))for(let s=0,o=u.length;s<o;s++){const o=u[s],p=r[o.materialIndex];for(let s=Math.max(o.start,d.start),r=Math.min(a.count,Math.min(o.start+o.count,d.start+d.count));s<r;s+=3){n=$s(this,p,t,i,l,c,h,s,s+1,s+2),n&&(n.faceIndex=Math.floor(s/3),n.face.materialIndex=o.materialIndex,e.push(n))}}else{for(let s=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);s<o;s+=3){n=$s(this,r,t,i,l,c,h,s,s+1,s+2),n&&(n.faceIndex=Math.floor(s/3),e.push(n))}}}}function $s(t,e,i,n,s,r,o,a,l,c){t.getVertexPosition(a,Fs),t.getVertexPosition(l,zs),t.getVertexPosition(c,Vs);const d=function(t,e,i,n,s,r,o,a){let l;if(l=e.side===u?n.intersectTriangle(o,r,s,!0,a):n.intersectTriangle(s,r,o,e.side===h,a),null===l)return null;Hs.copy(a),Hs.applyMatrix4(t.matrixWorld);const c=i.ray.origin.distanceTo(Hs);return c<i.near||c>i.far?null:{distance:c,point:Hs.clone(),object:t}}(t,e,i,n,Fs,zs,Vs,Gs);if(d){const t=new di;rs.getBarycoord(Gs,Fs,zs,Vs,t),s&&(d.uv=rs.getInterpolatedAttribute(s,a,l,c,t,new hi)),r&&(d.uv1=rs.getInterpolatedAttribute(r,a,l,c,t,new hi)),o&&(d.normal=rs.getInterpolatedAttribute(o,a,l,c,t,new di),d.normal.dot(n.direction)>0&&d.normal.multiplyScalar(-1));const e={a,b:l,c,normal:new di,materialIndex:0};rs.getNormal(Fs,zs,Vs,e.normal),d.face=e,d.barycoord=t}return d}class Ws extends Ds{constructor(t=1,e=1,i=1,n=1,s=1,r=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:s,depthSegments:r};const o=this;n=Math.floor(n),s=Math.floor(s),r=Math.floor(r);const a=[],l=[],c=[],h=[];let u=0,d=0;function p(t,e,i,n,s,r,p,f,g,m,A){const v=r/g,y=p/m,b=r/2,_=p/2,x=f/2,w=g+1,E=m+1;let C=0,S=0;const I=new di;for(let r=0;r<E;r++){const o=r*y-_;for(let a=0;a<w;a++){const u=a*v-b;I[t]=u*n,I[e]=o*s,I[i]=x,l.push(I.x,I.y,I.z),I[t]=0,I[e]=0,I[i]=f>0?1:-1,c.push(I.x,I.y,I.z),h.push(a/g),h.push(1-r/m),C+=1}}for(let t=0;t<m;t++)for(let e=0;e<g;e++){const i=u+e+w*t,n=u+e+w*(t+1),s=u+(e+1)+w*(t+1),r=u+(e+1)+w*t;a.push(i,n,r),a.push(n,s,r),S+=6}o.addGroup(d,S,A),d+=S,u+=C}p("z","y","x",-1,-1,i,e,t,r,s,0),p("z","y","x",1,-1,i,e,-t,r,s,1),p("x","z","y",1,1,t,i,e,n,r,2),p("x","z","y",1,-1,t,i,-e,n,r,3),p("x","y","z",1,-1,t,e,i,n,s,4),p("x","y","z",-1,-1,t,e,-i,n,s,5),this.setIndex(a),this.setAttribute("position",new Ss(l,3)),this.setAttribute("normal",new Ss(c,3)),this.setAttribute("uv",new Ss(h,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Ws(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Ks(t){const e={};for(const i in t){e[i]={};for(const n in t[i]){const s=t[i][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][n]=null):e[i][n]=s.clone():Array.isArray(s)?e[i][n]=s.slice():e[i][n]=s}}return e}function Xs(t){const e={};for(let i=0;i<t.length;i++){const n=Ks(t[i]);for(const t in n)e[t]=n[t]}return e}function Ys(t){const e=t.getRenderTarget();return null===e?t.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:Mi.workingColorSpace}const Js={clone:Ks,merge:Xs};class Zs extends ps{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ks(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?e.uniforms[i]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[i]={type:"m4",value:n.toArray()}:e.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const i={};for(const t in this.extensions)!0===this.extensions[t]&&(i[t]=!0);return Object.keys(i).length>0&&(e.extensions=i),e}}class tr extends Hn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new vn,this.projectionMatrix=new vn,this.projectionMatrixInverse=new vn,this.coordinateSystem=Xe}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const er=new di,ir=new hi,nr=new hi;class sr extends tr{constructor(t=50,e=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*ii*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*ei*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*ii*Math.atan(Math.tan(.5*ei*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,e,i){er.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),e.set(er.x,er.y).multiplyScalar(-t/er.z),er.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(er.x,er.y).multiplyScalar(-t/er.z)}getViewSize(t,e){return this.getViewBounds(t,ir,nr),e.subVectors(nr,ir)}setViewOffset(t,e,i,n,s,r){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=s,this.view.height=r,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*ei*this.fov)/this.zoom,i=2*e,n=this.aspect*i,s=-.5*n;const r=this.view;if(null!==this.view&&this.view.enabled){const t=r.fullWidth,o=r.fullHeight;s+=r.offsetX*n/t,e-=r.offsetY*i/o,n*=r.width/t,i*=r.height/o}const o=this.filmOffset;0!==o&&(s+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+n,e,e-i,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const rr=-90;class or extends Hn{constructor(t,e,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const n=new sr(rr,1,t,e);n.layers=this.layers,this.add(n);const s=new sr(rr,1,t,e);s.layers=this.layers,this.add(s);const r=new sr(rr,1,t,e);r.layers=this.layers,this.add(r);const o=new sr(rr,1,t,e);o.layers=this.layers,this.add(o);const a=new sr(rr,1,t,e);a.layers=this.layers,this.add(a);const l=new sr(rr,1,t,e);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const t=this.coordinateSystem,e=this.children.concat(),[i,n,s,r,o,a]=e;for(const t of e)this.remove(t);if(t===Xe)i.up.set(0,1,0),i.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),r.up.set(0,0,1),r.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else{if(t!==Ye)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);i.up.set(0,-1,0),i.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),r.up.set(0,0,-1),r.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1)}for(const t of e)this.add(t),t.updateMatrixWorld()}update(t,e){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:n}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[s,r,o,a,l,c]=this.children,h=t.getRenderTarget(),u=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),p=t.xr.enabled;t.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0,n),t.render(e,s),t.setRenderTarget(i,1,n),t.render(e,r),t.setRenderTarget(i,2,n),t.render(e,o),t.setRenderTarget(i,3,n),t.render(e,a),t.setRenderTarget(i,4,n),t.render(e,l),i.texture.generateMipmaps=f,t.setRenderTarget(i,5,n),t.render(e,c),t.setRenderTarget(h,u,d),t.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class ar extends Ui{constructor(t=[],e=rt,i,n,s,r,o,a,l,c){super(t,e,i,n,s,r,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class lr extends Vi{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const i={width:t,height:t,depth:1},n=[i,i,i,i,i,i];this.texture=new ar(n),this._setTextureOptions(e),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},n=new Ws(5,5,5),s=new Zs({name:"CubemapFromEquirect",uniforms:Ks(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:u,blending:p});s.uniforms.tEquirect.value=e;const r=new qs(n,s),o=e.minFilter;e.minFilter===vt&&(e.minFilter=mt);return new or(1,10,this).update(t,r),e.minFilter=o,r.geometry.dispose(),r.material.dispose(),this}clear(t,e=!0,i=!0,n=!0){const s=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,i,n);t.setRenderTarget(s)}}class cr extends Hn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const hr={type:"move"};class ur{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new cr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new cr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new di,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new di),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new cr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new di,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new di),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const i of t.hand.values())this._getHandJoint(e,i)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,i){let n=null,s=null,r=null;const o=this._targetRay,a=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(l&&t.hand){r=!0;for(const n of t.hand.values()){const t=e.getJointPose(n,i),s=this._getHandJoint(l,n);null!==t&&(s.matrix.fromArray(t.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,s.jointRadius=t.radius),s.visible=null!==t}const n=l.joints["index-finger-tip"],s=l.joints["thumb-tip"],o=n.position.distanceTo(s.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==a&&t.gripSpace&&(s=e.getPose(t.gripSpace,i),null!==s&&(a.matrix.fromArray(s.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,s.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(s.linearVelocity)):a.hasLinearVelocity=!1,s.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(s.angularVelocity)):a.hasAngularVelocity=!1));null!==o&&(n=e.getPose(t.targetRaySpace,i),null===n&&null!==s&&(n=s),null!==n&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(hr)))}return null!==o&&(o.visible=null!==n),null!==a&&(a.visible=null!==s),null!==l&&(l.visible=null!==r),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const i=new cr;i.matrixAutoUpdate=!1,i.visible=!1,t.joints[e.jointName]=i,t.add(i)}return t.joints[e.jointName]}}class dr extends Hn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Mn,this.environmentIntensity=1,this.environmentRotation=new Mn,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}}class pr{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=We,this.updateRanges=[],this.version=0,this.uuid=ni()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,i){t*=this.stride,i*=e.stride;for(let n=0,s=this.stride;n<s;n++)this.array[t+n]=e.array[i+n];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ni()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(e,this.stride);return i.setUsage(this.usage),i}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ni()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const fr=new di;class gr{constructor(t,e,i,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=i,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,i=this.data.count;e<i;e++)fr.fromBufferAttribute(this,e),fr.applyMatrix4(t),this.setXYZ(e,fr.x,fr.y,fr.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)fr.fromBufferAttribute(this,e),fr.applyNormalMatrix(t),this.setXYZ(e,fr.x,fr.y,fr.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)fr.fromBufferAttribute(this,e),fr.transformDirection(t),this.setXYZ(e,fr.x,fr.y,fr.z);return this}getComponent(t,e){let i=this.array[t*this.data.stride+this.offset+e];return this.normalized&&(i=ai(i,this.array)),i}setComponent(t,e,i){return this.normalized&&(i=li(i,this.array)),this.data.array[t*this.data.stride+this.offset+e]=i,this}setX(t,e){return this.normalized&&(e=li(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=li(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=li(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=li(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=ai(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=ai(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=ai(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=ai(e,this.array)),e}setXY(t,e,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=li(e,this.array),i=li(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this}setXYZ(t,e,i,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=li(e,this.array),i=li(i,this.array),n=li(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this}setXYZW(t,e,i,n,s){return t=t*this.data.stride+this.offset,this.normalized&&(e=li(e,this.array),i=li(i,this.array),n=li(n,this.array),s=li(s,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=s,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const i=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[i+e])}return new ws(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new gr(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const i=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[i+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const mr=new di,Ar=new Fi,vr=new Fi,yr=new di,br=new vn,_r=new di,xr=new cn,wr=new vn,Er=new An;class Cr extends qs{constructor(t,e){super(t,e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=st,this.bindMatrix=new vn,this.bindMatrixInverse=new vn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const t=this.geometry;null===this.boundingBox&&(this.boundingBox=new Gi),this.boundingBox.makeEmpty();const e=t.getAttribute("position");for(let t=0;t<e.count;t++)this.getVertexPosition(t,_r),this.boundingBox.expandByPoint(_r)}computeBoundingSphere(){const t=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new cn),this.boundingSphere.makeEmpty();const e=t.getAttribute("position");for(let t=0;t<e.count;t++)this.getVertexPosition(t,_r),this.boundingSphere.expandByPoint(_r)}copy(t,e){return super.copy(t,e),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this}raycast(t,e){const i=this.material,n=this.matrixWorld;void 0!==i&&(null===this.boundingSphere&&this.computeBoundingSphere(),xr.copy(this.boundingSphere),xr.applyMatrix4(n),!1!==t.ray.intersectsSphere(xr)&&(wr.copy(n).invert(),Er.copy(t.ray).applyMatrix4(wr),null!==this.boundingBox&&!1===Er.intersectsBox(this.boundingBox)||this._computeIntersections(t,e,Er)))}getVertexPosition(t,e){return super.getVertexPosition(t,e),this.applyBoneTransform(t,e),e}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Fi,e=this.geometry.attributes.skinWeight;for(let i=0,n=e.count;i<n;i++){t.fromBufferAttribute(e,i);const n=1/t.manhattanLength();n!==1/0?t.multiplyScalar(n):t.set(1,0,0,0),e.setXYZW(i,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode===st?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(t,e){const i=this.skeleton,n=this.geometry;Ar.fromBufferAttribute(n.attributes.skinIndex,t),vr.fromBufferAttribute(n.attributes.skinWeight,t),mr.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){const n=vr.getComponent(t);if(0!==n){const s=Ar.getComponent(t);br.multiplyMatrices(i.bones[s].matrixWorld,i.boneInverses[s]),e.addScaledVector(yr.copy(mr).applyMatrix4(br),n)}}return e.applyMatrix4(this.bindMatrixInverse)}}class Sr extends Hn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ir extends Ui{constructor(t=null,e=1,i=1,n,s,r,o,a,l=pt,c=pt,h,u){super(null,r,o,a,l,c,n,s,h,u),this.isDataTexture=!0,this.image={data:t,width:e,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Mr=new vn,Tr=new vn;class Br{constructor(t=[],e=[]){this.uuid=ni(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new vn)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new vn;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let n=0,s=t.length;n<s;n++){const s=t[n]?t[n].matrixWorld:Tr;Mr.multiplyMatrices(s,e[n]),Mr.toArray(i,16*n)}null!==n&&(n.needsUpdate=!0)}clone(){return new Br(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=4*Math.ceil(t/4),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const i=new Ir(e,t,t,Lt,Ct);return i.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=i,this}getBoneByName(t){for(let e=0,i=this.bones.length;e<i;e++){const i=this.bones[e];if(i.name===t)return i}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let i=0,n=t.bones.length;i<n;i++){const n=t.bones[i];let s=e[n];void 0===s&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),s=new Sr),this.bones.push(s),this.boneInverses.push((new vn).fromArray(t.boneInverses[i]))}return this.init(),this}toJSON(){const t={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,i=this.boneInverses;for(let n=0,s=e.length;n<s;n++){const s=e[n];t.bones.push(s.uuid);const r=i[n];t.boneInverses.push(r.toArray())}return t}}class Rr extends ws{constructor(t,e,i,n=1){super(t,e,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}const Pr=new vn,Lr=new vn,Dr=[],Nr=new Gi,Or=new vn,kr=new qs,Ur=new cn;class Fr extends qs{constructor(t,e,i){super(t,e),this.isInstancedMesh=!0,this.instanceMatrix=new Rr(new Float32Array(16*i),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let t=0;t<i;t++)this.setMatrixAt(t,Or)}computeBoundingBox(){const t=this.geometry,e=this.count;null===this.boundingBox&&(this.boundingBox=new Gi),null===t.boundingBox&&t.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<e;i++)this.getMatrixAt(i,Pr),Nr.copy(t.boundingBox).applyMatrix4(Pr),this.boundingBox.union(Nr)}computeBoundingSphere(){const t=this.geometry,e=this.count;null===this.boundingSphere&&(this.boundingSphere=new cn),null===t.boundingSphere&&t.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<e;i++)this.getMatrixAt(i,Pr),Ur.copy(t.boundingSphere).applyMatrix4(Pr),this.boundingSphere.union(Ur)}copy(t,e){return super.copy(t,e),this.instanceMatrix.copy(t.instanceMatrix),null!==t.morphTexture&&(this.morphTexture=t.morphTexture.clone()),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}getMorphAt(t,e){const i=e.morphTargetInfluences,n=this.morphTexture.source.data.data,s=t*(i.length+1)+1;for(let t=0;t<i.length;t++)i[t]=n[s+t]}raycast(t,e){const i=this.matrixWorld,n=this.count;if(kr.geometry=this.geometry,kr.material=this.material,void 0!==kr.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Ur.copy(this.boundingSphere),Ur.applyMatrix4(i),!1!==t.ray.intersectsSphere(Ur)))for(let s=0;s<n;s++){this.getMatrixAt(s,Pr),Lr.multiplyMatrices(i,Pr),kr.matrixWorld=Lr,kr.raycast(t,Dr);for(let t=0,i=Dr.length;t<i;t++){const i=Dr[t];i.instanceId=s,i.object=this,e.push(i)}Dr.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new Rr(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}setMorphAt(t,e){const i=e.morphTargetInfluences,n=i.length+1;null===this.morphTexture&&(this.morphTexture=new Ir(new Float32Array(n*this.count),n,this.count,Ot,Ct));const s=this.morphTexture.source.data.data;let r=0;for(let t=0;t<i.length;t++)r+=i[t];const o=this.geometry.morphTargetsRelative?1:1-r,a=n*t;s[a]=o,s.set(i,a+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const zr=new di,Vr=new di,Qr=new gi;class jr{constructor(t=new di(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,i){const n=zr.subVectors(i,e).cross(Vr.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const i=t.delta(zr),n=this.normal.dot(i);if(0===n)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const s=-(t.start.dot(this.normal)+this.constant)/n;return s<0||s>1?null:e.copy(t.start).addScaledVector(i,s)}intersectsLine(t){const e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const i=e||Qr.getNormalMatrix(t),n=this.coplanarPoint(zr).applyMatrix4(t),s=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(s),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Gr=new cn,Hr=new di;class qr{constructor(t=new jr,e=new jr,i=new jr,n=new jr,s=new jr,r=new jr){this.planes=[t,e,i,n,s,r]}set(t,e,i,n,s,r){const o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(s),o[5].copy(r),this}copy(t){const e=this.planes;for(let i=0;i<6;i++)e[i].copy(t.planes[i]);return this}setFromProjectionMatrix(t,e=Xe){const i=this.planes,n=t.elements,s=n[0],r=n[1],o=n[2],a=n[3],l=n[4],c=n[5],h=n[6],u=n[7],d=n[8],p=n[9],f=n[10],g=n[11],m=n[12],A=n[13],v=n[14],y=n[15];if(i[0].setComponents(a-s,u-l,g-d,y-m).normalize(),i[1].setComponents(a+s,u+l,g+d,y+m).normalize(),i[2].setComponents(a+r,u+c,g+p,y+A).normalize(),i[3].setComponents(a-r,u-c,g-p,y-A).normalize(),i[4].setComponents(a-o,u-h,g-f,y-v).normalize(),e===Xe)i[5].setComponents(a+o,u+h,g+f,y+v).normalize();else{if(e!==Ye)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);i[5].setComponents(o,h,f,v).normalize()}return this}intersectsObject(t){if(void 0!==t.boundingSphere)null===t.boundingSphere&&t.computeBoundingSphere(),Gr.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;null===e.boundingSphere&&e.computeBoundingSphere(),Gr.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(Gr)}intersectsSprite(t){return Gr.center.set(0,0,0),Gr.radius=.7071067811865476,Gr.applyMatrix4(t.matrixWorld),this.intersectsSphere(Gr)}intersectsSphere(t){const e=this.planes,i=t.center,n=-t.radius;for(let t=0;t<6;t++){if(e[t].distanceToPoint(i)<n)return!1}return!0}intersectsBox(t){const e=this.planes;for(let i=0;i<6;i++){const n=e[i];if(Hr.x=n.normal.x>0?t.max.x:t.min.x,Hr.y=n.normal.y>0?t.max.y:t.min.y,Hr.z=n.normal.z>0?t.max.z:t.min.z,n.distanceToPoint(Hr)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class $r extends ps{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new hs(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const Wr=new di,Kr=new di,Xr=new vn,Yr=new An,Jr=new cn,Zr=new di,to=new di;class eo extends Hn{constructor(t=new Ds,e=new $r){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,i=[0];for(let t=1,n=e.count;t<n;t++)Wr.fromBufferAttribute(e,t-1),Kr.fromBufferAttribute(e,t),i[t]=i[t-1],i[t]+=Wr.distanceTo(Kr);t.setAttribute("lineDistance",new Ss(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){const i=this.geometry,n=this.matrixWorld,s=t.params.Line.threshold,r=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Jr.copy(i.boundingSphere),Jr.applyMatrix4(n),Jr.radius+=s,!1===t.ray.intersectsSphere(Jr))return;Xr.copy(n).invert(),Yr.copy(t.ray).applyMatrix4(Xr);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=this.isLineSegments?2:1,c=i.index,h=i.attributes.position;if(null!==c){const i=Math.max(0,r.start),n=Math.min(c.count,r.start+r.count);for(let s=i,r=n-1;s<r;s+=l){const i=c.getX(s),n=c.getX(s+1),r=io(this,t,Yr,a,i,n,s);r&&e.push(r)}if(this.isLineLoop){const s=c.getX(n-1),r=c.getX(i),o=io(this,t,Yr,a,s,r,n-1);o&&e.push(o)}}else{const i=Math.max(0,r.start),n=Math.min(h.count,r.start+r.count);for(let s=i,r=n-1;s<r;s+=l){const i=io(this,t,Yr,a,s,s+1,s);i&&e.push(i)}if(this.isLineLoop){const s=io(this,t,Yr,a,n-1,i,n-1);s&&e.push(s)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const i=t[e[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=i.length;t<e;t++){const e=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}function io(t,e,i,n,s,r,o){const a=t.geometry.attributes.position;Wr.fromBufferAttribute(a,s),Kr.fromBufferAttribute(a,r);if(i.distanceSqToSegment(Wr,Kr,Zr,to)>n)return;Zr.applyMatrix4(t.matrixWorld);const l=e.ray.origin.distanceTo(Zr);return l<e.near||l>e.far?void 0:{distance:l,point:to.clone().applyMatrix4(t.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:t}}const no=new di,so=new di;class ro extends eo{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,i=[];for(let t=0,n=e.count;t<n;t+=2)no.fromBufferAttribute(e,t),so.fromBufferAttribute(e,t+1),i[t]=0===t?0:i[t-1],i[t+1]=i[t]+no.distanceTo(so);t.setAttribute("lineDistance",new Ss(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class oo extends eo{constructor(t,e){super(t,e),this.isLineLoop=!0,this.type="LineLoop"}}class ao extends ps{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new hs(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const lo=new vn,co=new An,ho=new cn,uo=new di;class po extends Hn{constructor(t=new Ds,e=new ao){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}raycast(t,e){const i=this.geometry,n=this.matrixWorld,s=t.params.Points.threshold,r=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),ho.copy(i.boundingSphere),ho.applyMatrix4(n),ho.radius+=s,!1===t.ray.intersectsSphere(ho))return;lo.copy(n).invert(),co.copy(t.ray).applyMatrix4(lo);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=i.index,c=i.attributes.position;if(null!==l){for(let i=Math.max(0,r.start),s=Math.min(l.count,r.start+r.count);i<s;i++){const s=l.getX(i);uo.fromBufferAttribute(c,s),fo(uo,s,a,n,t,e,this)}}else{for(let i=Math.max(0,r.start),s=Math.min(c.count,r.start+r.count);i<s;i++)uo.fromBufferAttribute(c,i),fo(uo,i,a,n,t,e,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const i=t[e[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=i.length;t<e;t++){const e=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}function fo(t,e,i,n,s,r,o){const a=co.distanceSqToPoint(t);if(a<i){const i=new di;co.closestPointToPoint(t,i),i.applyMatrix4(n);const l=s.ray.origin.distanceTo(i);if(l<s.near||l>s.far)return;r.push({distance:l,distanceToRay:Math.sqrt(a),point:i,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class go extends Ui{constructor(t,e,i,n,s,r,o,a,l,c,h,u){super(null,r,o,a,l,c,n,s,h,u),this.isCompressedTexture=!0,this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class mo extends go{constructor(t,e,i,n,s,r){super(t,e,i,s,r),this.isCompressedArrayTexture=!0,this.image.depth=n,this.wrapR=ut,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class Ao extends go{constructor(t,e,i){super(void 0,t[0].width,t[0].height,e,i,rt),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=t}}class vo extends Ui{constructor(t,e,i=Et,n,s,r,o=pt,a=pt,l,c=Dt,h=1){if(c!==Dt&&c!==Nt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:t,height:e,depth:h},n,s,r,o,a,c,i,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.source=new Di(Object.assign({},t.image)),this.compareFunction=t.compareFunction,this}toJSON(t){const e=super.toJSON(t);return null!==this.compareFunction&&(e.compareFunction=this.compareFunction),e}}class yo extends Ds{constructor(t=1,e=1,i=1,n=32,s=1,r=!1,o=0,a=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:s,openEnded:r,thetaStart:o,thetaLength:a};const l=this;n=Math.floor(n),s=Math.floor(s);const c=[],h=[],u=[],d=[];let p=0;const f=[],g=i/2;let m=0;function A(i){const s=p,r=new hi,f=new di;let A=0;const v=!0===i?t:e,y=!0===i?1:-1;for(let t=1;t<=n;t++)h.push(0,g*y,0),u.push(0,y,0),d.push(.5,.5),p++;const b=p;for(let t=0;t<=n;t++){const e=t/n*a+o,i=Math.cos(e),s=Math.sin(e);f.x=v*s,f.y=g*y,f.z=v*i,h.push(f.x,f.y,f.z),u.push(0,y,0),r.x=.5*i+.5,r.y=.5*s*y+.5,d.push(r.x,r.y),p++}for(let t=0;t<n;t++){const e=s+t,n=b+t;!0===i?c.push(n,n+1,e):c.push(n+1,n,e),A+=3}l.addGroup(m,A,!0===i?1:2),m+=A}!function(){const r=new di,A=new di;let v=0;const y=(e-t)/i;for(let l=0;l<=s;l++){const c=[],m=l/s,v=m*(e-t)+t;for(let t=0;t<=n;t++){const e=t/n,s=e*a+o,l=Math.sin(s),f=Math.cos(s);A.x=v*l,A.y=-m*i+g,A.z=v*f,h.push(A.x,A.y,A.z),r.set(l,y,f).normalize(),u.push(r.x,r.y,r.z),d.push(e,1-m),c.push(p++)}f.push(c)}for(let i=0;i<n;i++)for(let n=0;n<s;n++){const r=f[n][i],o=f[n+1][i],a=f[n+1][i+1],l=f[n][i+1];(t>0||0!==n)&&(c.push(r,o,l),v+=3),(e>0||n!==s-1)&&(c.push(o,a,l),v+=3)}l.addGroup(m,v,0),m+=v}(),!1===r&&(t>0&&A(!0),e>0&&A(!1)),this.setIndex(c),this.setAttribute("position",new Ss(h,3)),this.setAttribute("normal",new Ss(u,3)),this.setAttribute("uv",new Ss(d,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new yo(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class bo extends yo{constructor(t=1,e=1,i=32,n=1,s=!1,r=0,o=2*Math.PI){super(0,t,e,i,n,s,r,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:r,thetaLength:o}}static fromJSON(t){return new bo(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class _o{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(t,e){const i=this.getUtoTmapping(t);return this.getPoint(i,e)}getPoints(t=5){const e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return e}getSpacedPoints(t=5){const e=[];for(let i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let i,n=this.getPoint(0),s=0;e.push(0);for(let r=1;r<=t;r++)i=this.getPoint(r/t),s+=i.distanceTo(n),e.push(s),n=i;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e=null){const i=this.getLengths();let n=0;const s=i.length;let r;r=e||t*i[s-1];let o,a=0,l=s-1;for(;a<=l;)if(n=Math.floor(a+(l-a)/2),o=i[n]-r,o<0)a=n+1;else{if(!(o>0)){l=n;break}l=n-1}if(n=l,i[n]===r)return n/(s-1);const c=i[n];return(n+(r-c)/(i[n+1]-c))/(s-1)}getTangent(t,e){const i=1e-4;let n=t-i,s=t+i;n<0&&(n=0),s>1&&(s=1);const r=this.getPoint(n),o=this.getPoint(s),a=e||(r.isVector2?new hi:new di);return a.copy(o).sub(r).normalize(),a}getTangentAt(t,e){const i=this.getUtoTmapping(t);return this.getTangent(i,e)}computeFrenetFrames(t,e=!1){const i=new di,n=[],s=[],r=[],o=new di,a=new vn;for(let e=0;e<=t;e++){const i=e/t;n[e]=this.getTangentAt(i,new di)}s[0]=new di,r[0]=new di;let l=Number.MAX_VALUE;const c=Math.abs(n[0].x),h=Math.abs(n[0].y),u=Math.abs(n[0].z);c<=l&&(l=c,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),u<=l&&i.set(0,0,1),o.crossVectors(n[0],i).normalize(),s[0].crossVectors(n[0],o),r[0].crossVectors(n[0],s[0]);for(let e=1;e<=t;e++){if(s[e]=s[e-1].clone(),r[e]=r[e-1].clone(),o.crossVectors(n[e-1],n[e]),o.length()>Number.EPSILON){o.normalize();const t=Math.acos(si(n[e-1].dot(n[e]),-1,1));s[e].applyMatrix4(a.makeRotationAxis(o,t))}r[e].crossVectors(n[e],s[e])}if(!0===e){let e=Math.acos(si(s[0].dot(s[t]),-1,1));e/=t,n[0].dot(o.crossVectors(s[0],s[t]))>0&&(e=-e);for(let i=1;i<=t;i++)s[i].applyMatrix4(a.makeRotationAxis(n[i],e*i)),r[i].crossVectors(n[i],s[i])}return{tangents:n,normals:s,binormals:r}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class xo extends _o{constructor(t=0,e=0,i=1,n=1,s=0,r=2*Math.PI,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=s,this.aEndAngle=r,this.aClockwise=o,this.aRotation=a}getPoint(t,e=new hi){const i=e,n=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const r=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=n;for(;s>n;)s-=n;s<Number.EPSILON&&(s=r?0:n),!0!==this.aClockwise||r||(s===n?s=-n:s-=n);const o=this.aStartAngle+t*s;let a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),i=a-this.aX,n=l-this.aY;a=i*t-n*e+this.aX,l=i*e+n*t+this.aY}return i.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}function wo(){let t=0,e=0,i=0,n=0;function s(s,r,o,a){t=s,e=o,i=-3*s+3*r-2*o-a,n=2*s-2*r+o+a}return{initCatmullRom:function(t,e,i,n,r){s(e,i,r*(i-t),r*(n-e))},initNonuniformCatmullRom:function(t,e,i,n,r,o,a){let l=(e-t)/r-(i-t)/(r+o)+(i-e)/o,c=(i-e)/o-(n-e)/(o+a)+(n-i)/a;l*=o,c*=o,s(e,i,l,c)},calc:function(s){const r=s*s;return t+e*s+i*r+n*(r*s)}}}const Eo=new di,Co=new wo,So=new wo,Io=new wo;function Mo(t,e,i,n,s){const r=.5*(n-e),o=.5*(s-i),a=t*t;return(2*i-2*n+r+o)*(t*a)+(-3*i+3*n-2*r-o)*a+r*t+i}function To(t,e,i,n){return function(t,e){const i=1-t;return i*i*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,i)+function(t,e){return t*t*e}(t,n)}function Bo(t,e,i,n,s){return function(t,e){const i=1-t;return i*i*i*e}(t,e)+function(t,e){const i=1-t;return 3*i*i*t*e}(t,i)+function(t,e){return 3*(1-t)*t*t*e}(t,n)+function(t,e){return t*t*t*e}(t,s)}class Ro extends _o{constructor(t=new hi,e=new hi,i=new hi,n=new hi){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=i,this.v3=n}getPoint(t,e=new hi){const i=e,n=this.v0,s=this.v1,r=this.v2,o=this.v3;return i.set(Bo(t,n.x,s.x,r.x,o.x),Bo(t,n.y,s.y,r.y,o.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class Po extends _o{constructor(t=new hi,e=new hi){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new hi){const i=e;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new hi){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Lo extends _o{constructor(t=new hi,e=new hi,i=new hi){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new hi){const i=e,n=this.v0,s=this.v1,r=this.v2;return i.set(To(t,n.x,s.x,r.x),To(t,n.y,s.y,r.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Do extends _o{constructor(t=new di,e=new di,i=new di){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new di){const i=e,n=this.v0,s=this.v1,r=this.v2;return i.set(To(t,n.x,s.x,r.x),To(t,n.y,s.y,r.y),To(t,n.z,s.z,r.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class No extends _o{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new hi){const i=e,n=this.points,s=(n.length-1)*t,r=Math.floor(s),o=s-r,a=n[0===r?r:r-1],l=n[r],c=n[r>n.length-2?n.length-1:r+1],h=n[r>n.length-3?n.length-1:r+2];return i.set(Mo(o,a.x,l.x,c.x,h.x),Mo(o,a.y,l.y,c.y,h.y)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push(i.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){const i=this.points[e];t.points.push(i.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push((new hi).fromArray(i))}return this}}var Oo=Object.freeze({__proto__:null,ArcCurve:class extends xo{constructor(t,e,i,n,s,r){super(t,e,i,i,n,s,r),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class extends _o{constructor(t=[],e=!1,i="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=i,this.tension=n}getPoint(t,e=new di){const i=e,n=this.points,s=n.length,r=(s-(this.closed?0:1))*t;let o,a,l=Math.floor(r),c=r-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:0===c&&l===s-1&&(l=s-2,c=1),this.closed||l>0?o=n[(l-1)%s]:(Eo.subVectors(n[0],n[1]).add(n[0]),o=Eo);const h=n[l%s],u=n[(l+1)%s];if(this.closed||l+2<s?a=n[(l+2)%s]:(Eo.subVectors(n[s-1],n[s-2]).add(n[s-1]),a=Eo),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(o.distanceToSquared(h),t),i=Math.pow(h.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(a),t);i<1e-4&&(i=1),e<1e-4&&(e=i),n<1e-4&&(n=i),Co.initNonuniformCatmullRom(o.x,h.x,u.x,a.x,e,i,n),So.initNonuniformCatmullRom(o.y,h.y,u.y,a.y,e,i,n),Io.initNonuniformCatmullRom(o.z,h.z,u.z,a.z,e,i,n)}else"catmullrom"===this.curveType&&(Co.initCatmullRom(o.x,h.x,u.x,a.x,this.tension),So.initCatmullRom(o.y,h.y,u.y,a.y,this.tension),Io.initCatmullRom(o.z,h.z,u.z,a.z,this.tension));return i.set(Co.calc(c),So.calc(c),Io.calc(c)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){const i=this.points[e];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push((new di).fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}},CubicBezierCurve:Ro,CubicBezierCurve3:class extends _o{constructor(t=new di,e=new di,i=new di,n=new di){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=i,this.v3=n}getPoint(t,e=new di){const i=e,n=this.v0,s=this.v1,r=this.v2,o=this.v3;return i.set(Bo(t,n.x,s.x,r.x,o.x),Bo(t,n.y,s.y,r.y,o.y),Bo(t,n.z,s.z,r.z,o.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},EllipseCurve:xo,LineCurve:Po,LineCurve3:class extends _o{constructor(t=new di,e=new di){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new di){const i=e;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new di){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},QuadraticBezierCurve:Lo,QuadraticBezierCurve3:Do,SplineCurve:No});class ko extends _o{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);if(!t.equals(e)){const i=!0===t.isVector2?"LineCurve":"LineCurve3";this.curves.push(new Oo[i](e,t))}return this}getPoint(t,e){const i=t*this.getLength(),n=this.getCurveLengths();let s=0;for(;s<n.length;){if(n[s]>=i){const t=n[s]-i,r=this.curves[s],o=r.getLength(),a=0===o?0:1-t/o;return r.getPointAt(a,e)}s++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let i;for(let n=0,s=this.curves;n<s.length;n++){const r=s[n],o=r.isEllipseCurve?2*t:r.isLineCurve||r.isLineCurve3?1:r.isSplineCurve?t*r.points.length:t,a=r.getPoints(o);for(let t=0;t<a.length;t++){const n=a[t];i&&i.equals(n)||(e.push(n),i=n)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){const i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,i=this.curves.length;e<i;e++){const i=this.curves[e];t.curves.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){const i=t.curves[e];this.curves.push((new Oo[i.type]).fromJSON(i))}return this}}class Uo extends ko{constructor(t){super(),this.type="Path",this.currentPoint=new hi,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const i=new Po(this.currentPoint.clone(),new hi(t,e));return this.curves.push(i),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,i,n){const s=new Lo(this.currentPoint.clone(),new hi(t,e),new hi(i,n));return this.curves.push(s),this.currentPoint.set(i,n),this}bezierCurveTo(t,e,i,n,s,r){const o=new Ro(this.currentPoint.clone(),new hi(t,e),new hi(i,n),new hi(s,r));return this.curves.push(o),this.currentPoint.set(s,r),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),i=new No(e);return this.curves.push(i),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,i,n,s,r){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+o,e+a,i,n,s,r),this}absarc(t,e,i,n,s,r){return this.absellipse(t,e,i,i,n,s,r),this}ellipse(t,e,i,n,s,r,o,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,i,n,s,r,o,a),this}absellipse(t,e,i,n,s,r,o,a){const l=new xo(t,e,i,n,s,r,o,a);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Fo extends Uo{constructor(t){super(t),this.uuid=ni(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){const i=t.holes[e];this.holes.push(i.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,i=this.holes.length;e<i;e++){const i=this.holes[e];t.holes.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){const i=t.holes[e];this.holes.push((new Uo).fromJSON(i))}return this}}function zo(t,e,i=2){const n=e&&e.length,s=n?e[0]*i:t.length;let r=Vo(t,0,s,i,!0);const o=[];if(!r||r.next===r.prev)return o;let a,l,c;if(n&&(r=function(t,e,i,n){const s=[];for(let i=0,r=e.length;i<r;i++){const o=Vo(t,e[i]*n,i<r-1?e[i+1]*n:t.length,n,!1);o===o.next&&(o.steiner=!0),s.push(Jo(o))}s.sort(Wo);for(let t=0;t<s.length;t++)i=Ko(s[t],i);return i}(t,e,r,i)),t.length>80*i){a=1/0,l=1/0;let e=-1/0,n=-1/0;for(let r=i;r<s;r+=i){const i=t[r],s=t[r+1];i<a&&(a=i),s<l&&(l=s),i>e&&(e=i),s>n&&(n=s)}c=Math.max(e-a,n-l),c=0!==c?32767/c:0}return jo(r,o,i,a,l,c,0),o}function Vo(t,e,i,n,s){let r;if(s===function(t,e,i,n){let s=0;for(let r=e,o=i-n;r<i;r+=n)s+=(t[o]-t[r])*(t[r+1]+t[o+1]),o=r;return s}(t,e,i,n)>0)for(let s=e;s<i;s+=n)r=ca(s/n|0,t[s],t[s+1],r);else for(let s=i-n;s>=e;s-=n)r=ca(s/n|0,t[s],t[s+1],r);return r&&na(r,r.next)&&(ha(r),r=r.next),r}function Qo(t,e){if(!t)return t;e||(e=t);let i,n=t;do{if(i=!1,n.steiner||!na(n,n.next)&&0!==ia(n.prev,n,n.next))n=n.next;else{if(ha(n),n=e=n.prev,n===n.next)break;i=!0}}while(i||n!==e);return e}function jo(t,e,i,n,s,r,o){if(!t)return;!o&&r&&function(t,e,i,n){let s=t;do{0===s.z&&(s.z=Yo(s.x,s.y,e,i,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==t);s.prevZ.nextZ=null,s.prevZ=null,function(t){let e,i=1;do{let n,s=t;t=null;let r=null;for(e=0;s;){e++;let o=s,a=0;for(let t=0;t<i&&(a++,o=o.nextZ,o);t++);let l=i;for(;a>0||l>0&&o;)0!==a&&(0===l||!o||s.z<=o.z)?(n=s,s=s.nextZ,a--):(n=o,o=o.nextZ,l--),r?r.nextZ=n:t=n,n.prevZ=r,r=n;s=o}r.nextZ=null,i*=2}while(e>1)}(s)}(t,n,s,r);let a=t;for(;t.prev!==t.next;){const l=t.prev,c=t.next;if(r?Ho(t,n,s,r):Go(t))e.push(l.i,t.i,c.i),ha(t),t=c.next,a=c.next;else if((t=c)===a){o?1===o?jo(t=qo(Qo(t),e),e,i,n,s,r,2):2===o&&$o(t,e,i,n,s,r):jo(Qo(t),e,i,n,s,r,1);break}}}function Go(t){const e=t.prev,i=t,n=t.next;if(ia(e,i,n)>=0)return!1;const s=e.x,r=i.x,o=n.x,a=e.y,l=i.y,c=n.y,h=Math.min(s,r,o),u=Math.min(a,l,c),d=Math.max(s,r,o),p=Math.max(a,l,c);let f=n.next;for(;f!==e;){if(f.x>=h&&f.x<=d&&f.y>=u&&f.y<=p&&ta(s,a,r,l,o,c,f.x,f.y)&&ia(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Ho(t,e,i,n){const s=t.prev,r=t,o=t.next;if(ia(s,r,o)>=0)return!1;const a=s.x,l=r.x,c=o.x,h=s.y,u=r.y,d=o.y,p=Math.min(a,l,c),f=Math.min(h,u,d),g=Math.max(a,l,c),m=Math.max(h,u,d),A=Yo(p,f,e,i,n),v=Yo(g,m,e,i,n);let y=t.prevZ,b=t.nextZ;for(;y&&y.z>=A&&b&&b.z<=v;){if(y.x>=p&&y.x<=g&&y.y>=f&&y.y<=m&&y!==s&&y!==o&&ta(a,h,l,u,c,d,y.x,y.y)&&ia(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,b.x>=p&&b.x<=g&&b.y>=f&&b.y<=m&&b!==s&&b!==o&&ta(a,h,l,u,c,d,b.x,b.y)&&ia(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;y&&y.z>=A;){if(y.x>=p&&y.x<=g&&y.y>=f&&y.y<=m&&y!==s&&y!==o&&ta(a,h,l,u,c,d,y.x,y.y)&&ia(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;b&&b.z<=v;){if(b.x>=p&&b.x<=g&&b.y>=f&&b.y<=m&&b!==s&&b!==o&&ta(a,h,l,u,c,d,b.x,b.y)&&ia(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function qo(t,e){let i=t;do{const n=i.prev,s=i.next.next;!na(n,s)&&sa(n,i,i.next,s)&&aa(n,s)&&aa(s,n)&&(e.push(n.i,i.i,s.i),ha(i),ha(i.next),i=t=s),i=i.next}while(i!==t);return Qo(i)}function $o(t,e,i,n,s,r){let o=t;do{let t=o.next.next;for(;t!==o.prev;){if(o.i!==t.i&&ea(o,t)){let a=la(o,t);return o=Qo(o,o.next),a=Qo(a,a.next),jo(o,e,i,n,s,r,0),void jo(a,e,i,n,s,r,0)}t=t.next}o=o.next}while(o!==t)}function Wo(t,e){let i=t.x-e.x;if(0===i&&(i=t.y-e.y,0===i)){i=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return i}function Ko(t,e){const i=function(t,e){let i=e;const n=t.x,s=t.y;let r,o=-1/0;if(na(t,i))return i;do{if(na(t,i.next))return i.next;if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){const t=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=n&&t>o&&(o=t,r=i.x<i.next.x?i:i.next,t===n))return r}i=i.next}while(i!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let h=1/0;i=r;do{if(n>=i.x&&i.x>=l&&n!==i.x&&Zo(s<c?n:o,s,l,c,s<c?o:n,s,i.x,i.y)){const e=Math.abs(s-i.y)/(n-i.x);aa(i,t)&&(e<h||e===h&&(i.x>r.x||i.x===r.x&&Xo(r,i)))&&(r=i,h=e)}i=i.next}while(i!==a);return r}(t,e);if(!i)return e;const n=la(i,t);return Qo(n,n.next),Qo(i,i.next)}function Xo(t,e){return ia(t.prev,t,e.prev)<0&&ia(e.next,t,t.next)<0}function Yo(t,e,i,n,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*s|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*s|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Jo(t){let e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Zo(t,e,i,n,s,r,o,a){return(s-o)*(e-a)>=(t-o)*(r-a)&&(t-o)*(n-a)>=(i-o)*(e-a)&&(i-o)*(r-a)>=(s-o)*(n-a)}function ta(t,e,i,n,s,r,o,a){return!(t===o&&e===a)&&Zo(t,e,i,n,s,r,o,a)}function ea(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&sa(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(aa(t,e)&&aa(e,t)&&function(t,e){let i=t,n=!1;const s=(t.x+e.x)/2,r=(t.y+e.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&s<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(ia(t.prev,t,e.prev)||ia(t,e.prev,e))||na(t,e)&&ia(t.prev,t,t.next)>0&&ia(e.prev,e,e.next)>0)}function ia(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function na(t,e){return t.x===e.x&&t.y===e.y}function sa(t,e,i,n){const s=oa(ia(t,e,i)),r=oa(ia(t,e,n)),o=oa(ia(i,n,t)),a=oa(ia(i,n,e));return s!==r&&o!==a||(!(0!==s||!ra(t,i,e))||(!(0!==r||!ra(t,n,e))||(!(0!==o||!ra(i,t,n))||!(0!==a||!ra(i,e,n)))))}function ra(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function oa(t){return t>0?1:t<0?-1:0}function aa(t,e){return ia(t.prev,t,t.next)<0?ia(t,e,t.next)>=0&&ia(t,t.prev,e)>=0:ia(t,e,t.prev)<0||ia(t,t.next,e)<0}function la(t,e){const i=ua(t.i,t.x,t.y),n=ua(e.i,e.x,e.y),s=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}function ca(t,e,i,n){const s=ua(t,e,i);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function ha(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ua(t,e,i){return{i:t,x:e,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class da{static triangulate(t,e,i=2){return zo(t,e,i)}}class pa{static area(t){const e=t.length;let i=0;for(let n=e-1,s=0;s<e;n=s++)i+=t[n].x*t[s].y-t[s].x*t[n].y;return.5*i}static isClockWise(t){return pa.area(t)<0}static triangulateShape(t,e){const i=[],n=[],s=[];fa(t),ga(i,t);let r=t.length;e.forEach(fa);for(let t=0;t<e.length;t++)n.push(r),r+=e[t].length,ga(i,e[t]);const o=da.triangulate(i,n);for(let t=0;t<o.length;t+=3)s.push(o.slice(t,t+3));return s}}function fa(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function ga(t,e){for(let i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}class ma extends Ds{constructor(t=[new hi(0,-.5),new hi(.5,0),new hi(0,.5)],e=12,i=0,n=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},e=Math.floor(e),n=si(n,0,2*Math.PI);const s=[],r=[],o=[],a=[],l=[],c=1/e,h=new di,u=new hi,d=new di,p=new di,f=new di;let g=0,m=0;for(let e=0;e<=t.length-1;e++)switch(e){case 0:g=t[e+1].x-t[e].x,m=t[e+1].y-t[e].y,d.x=1*m,d.y=-g,d.z=0*m,f.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case t.length-1:a.push(f.x,f.y,f.z);break;default:g=t[e+1].x-t[e].x,m=t[e+1].y-t[e].y,d.x=1*m,d.y=-g,d.z=0*m,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),a.push(d.x,d.y,d.z),f.copy(p)}for(let s=0;s<=e;s++){const d=i+s*c*n,p=Math.sin(d),f=Math.cos(d);for(let i=0;i<=t.length-1;i++){h.x=t[i].x*p,h.y=t[i].y,h.z=t[i].x*f,r.push(h.x,h.y,h.z),u.x=s/e,u.y=i/(t.length-1),o.push(u.x,u.y);const n=a[3*i+0]*p,c=a[3*i+1],d=a[3*i+0]*f;l.push(n,c,d)}}for(let i=0;i<e;i++)for(let e=0;e<t.length-1;e++){const n=e+i*t.length,r=n,o=n+t.length,a=n+t.length+1,l=n+1;s.push(r,o,l),s.push(a,l,o)}this.setIndex(s),this.setAttribute("position",new Ss(r,3)),this.setAttribute("uv",new Ss(o,2)),this.setAttribute("normal",new Ss(l,3))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new ma(t.points,t.segments,t.phiStart,t.phiLength)}}class Aa extends Ds{constructor(t=1,e=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};const s=t/2,r=e/2,o=Math.floor(i),a=Math.floor(n),l=o+1,c=a+1,h=t/o,u=e/a,d=[],p=[],f=[],g=[];for(let t=0;t<c;t++){const e=t*u-r;for(let i=0;i<l;i++){const n=i*h-s;p.push(n,-e,0),f.push(0,0,1),g.push(i/o),g.push(1-t/a)}}for(let t=0;t<a;t++)for(let e=0;e<o;e++){const i=e+l*t,n=e+l*(t+1),s=e+1+l*(t+1),r=e+1+l*t;d.push(i,n,r),d.push(n,s,r)}this.setIndex(d),this.setAttribute("position",new Ss(p,3)),this.setAttribute("normal",new Ss(f,3)),this.setAttribute("uv",new Ss(g,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Aa(t.width,t.height,t.widthSegments,t.heightSegments)}}class va extends Ds{constructor(t=new Fo([new hi(0,.5),new hi(-.5,-.5),new hi(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const i=[],n=[],s=[],r=[];let o=0,a=0;if(!1===Array.isArray(t))l(t);else for(let e=0;e<t.length;e++)l(t[e]),this.addGroup(o,a,e),o+=a,a=0;function l(t){const o=n.length/3,l=t.extractPoints(e);let c=l.shape;const h=l.holes;!1===pa.isClockWise(c)&&(c=c.reverse());for(let t=0,e=h.length;t<e;t++){const e=h[t];!0===pa.isClockWise(e)&&(h[t]=e.reverse())}const u=pa.triangulateShape(c,h);for(let t=0,e=h.length;t<e;t++){const e=h[t];c=c.concat(e)}for(let t=0,e=c.length;t<e;t++){const e=c[t];n.push(e.x,e.y,0),s.push(0,0,1),r.push(e.x,e.y)}for(let t=0,e=u.length;t<e;t++){const e=u[t],n=e[0]+o,s=e[1]+o,r=e[2]+o;i.push(n,s,r),a+=3}}this.setIndex(i),this.setAttribute("position",new Ss(n,3)),this.setAttribute("normal",new Ss(s,3)),this.setAttribute("uv",new Ss(r,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let i=0,n=t.length;i<n;i++){const n=t[i];e.shapes.push(n.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){const i=[];for(let n=0,s=t.shapes.length;n<s;n++){const s=e[t.shapes[n]];i.push(s)}return new va(i,t.curveSegments)}}class ya extends Ds{constructor(t=1,e=32,i=16,n=0,s=2*Math.PI,r=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:s,thetaStart:r,thetaLength:o},e=Math.max(3,Math.floor(e)),i=Math.max(2,Math.floor(i));const a=Math.min(r+o,Math.PI);let l=0;const c=[],h=new di,u=new di,d=[],p=[],f=[],g=[];for(let d=0;d<=i;d++){const m=[],A=d/i;let v=0;0===d&&0===r?v=.5/e:d===i&&a===Math.PI&&(v=-.5/e);for(let i=0;i<=e;i++){const a=i/e;h.x=-t*Math.cos(n+a*s)*Math.sin(r+A*o),h.y=t*Math.cos(r+A*o),h.z=t*Math.sin(n+a*s)*Math.sin(r+A*o),p.push(h.x,h.y,h.z),u.copy(h).normalize(),f.push(u.x,u.y,u.z),g.push(a+v,1-A),m.push(l++)}c.push(m)}for(let t=0;t<i;t++)for(let n=0;n<e;n++){const e=c[t][n+1],s=c[t][n],o=c[t+1][n],l=c[t+1][n+1];(0!==t||r>0)&&d.push(e,s,l),(t!==i-1||a<Math.PI)&&d.push(s,o,l)}this.setIndex(d),this.setAttribute("position",new Ss(p,3)),this.setAttribute("normal",new Ss(f,3)),this.setAttribute("uv",new Ss(g,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new ya(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class ba extends Ds{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},null!==t){const e=[],i=new Set,n=new di,s=new di;if(null!==t.index){const r=t.attributes.position,o=t.index;let a=t.groups;0===a.length&&(a=[{start:0,count:o.count,materialIndex:0}]);for(let t=0,l=a.length;t<l;++t){const l=a[t],c=l.start;for(let t=c,a=c+l.count;t<a;t+=3)for(let a=0;a<3;a++){const l=o.getX(t+a),c=o.getX(t+(a+1)%3);n.fromBufferAttribute(r,l),s.fromBufferAttribute(r,c),!0===_a(n,s,i)&&(e.push(n.x,n.y,n.z),e.push(s.x,s.y,s.z))}}}else{const r=t.attributes.position;for(let t=0,o=r.count/3;t<o;t++)for(let o=0;o<3;o++){const a=3*t+o,l=3*t+(o+1)%3;n.fromBufferAttribute(r,a),s.fromBufferAttribute(r,l),!0===_a(n,s,i)&&(e.push(n.x,n.y,n.z),e.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ss(e,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}function _a(t,e,i){const n=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return!0!==i.has(n)&&!0!==i.has(s)&&(i.add(n),i.add(s),!0)}class xa extends ps{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new hs(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}class wa extends Zs{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Ea extends ps{constructor(t){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new hs(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new hs(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Pe,this.normalScale=new hi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Mn,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class Ca extends Ea{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new hi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return si(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new hs(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new hs(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new hs(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(t)}get anisotropy(){return this._anisotropy}set anisotropy(t){this._anisotropy>0!=t>0&&this.version++,this._anisotropy=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!=t>0&&this.version++,this._iridescence=t}get dispersion(){return this._dispersion}set dispersion(t){this._dispersion>0!=t>0&&this.version++,this._dispersion=t}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=t.anisotropy,this.anisotropyRotation=t.anisotropyRotation,this.anisotropyMap=t.anisotropyMap,this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.dispersion=t.dispersion,this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}class Sa extends ps{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new hs(16777215),this.specular=new hs(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new hs(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Pe,this.normalScale=new hi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Mn,this.combine=$,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class Ia extends ps{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class Ma extends ps{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function Ta(t,e){return t&&t.constructor!==e?"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t):t}function Ba(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Ra(t){const e=t.length,i=new Array(e);for(let t=0;t!==e;++t)i[t]=t;return i.sort(function(e,i){return t[e]-t[i]}),i}function Pa(t,e,i){const n=t.length,s=new t.constructor(n);for(let r=0,o=0;o!==n;++r){const n=i[r]*e;for(let i=0;i!==e;++i)s[o++]=t[n+i]}return s}function La(t,e,i,n){let s=1,r=t[0];for(;void 0!==r&&void 0===r[n];)r=t[s++];if(void 0===r)return;let o=r[n];if(void 0!==o)if(Array.isArray(o))do{o=r[n],void 0!==o&&(e.push(r.time),i.push(...o)),r=t[s++]}while(void 0!==r);else if(void 0!==o.toArray)do{o=r[n],void 0!==o&&(e.push(r.time),o.toArray(i,i.length)),r=t[s++]}while(void 0!==r);else do{o=r[n],void 0!==o&&(e.push(r.time),i.push(o)),r=t[s++]}while(void 0!==r)}class Da{constructor(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let i=this._cachedIndex,n=e[i],s=e[i-1];t:{e:{let r;i:{n:if(!(t<n)){for(let r=i+2;;){if(void 0===n){if(t<s)break n;return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===r)break;if(s=n,n=e[++i],t<n)break e}r=e.length;break i}if(!(t>=s)){const o=e[1];t<o&&(i=2,s=o);for(let r=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===r)break;if(n=s,s=e[--i-1],t>=s)break e}r=i,i=0;break i}break t}for(;i<r;){const n=i+r>>>1;t<e[n]?r=n:i=n+1}if(n=e[i],s=e[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,n)}return this.interpolate_(i,s,t,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,s=t*n;for(let t=0;t!==n;++t)e[t]=i[s+t];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Na extends Da{constructor(t,e,i,n){super(t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ee,endingEnd:Ee}}intervalChanged_(t,e,i){const n=this.parameterPositions;let s=t-2,r=t+1,o=n[s],a=n[r];if(void 0===o)switch(this.getSettings_().endingStart){case Ce:s=t,o=2*e-i;break;case Se:s=n.length-2,o=e+n[s]-n[s+1];break;default:s=t,o=i}if(void 0===a)switch(this.getSettings_().endingEnd){case Ce:r=t,a=2*i-e;break;case Se:r=1,a=i+n[1]-n[0];break;default:r=t-1,a=e}const l=.5*(i-e),c=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(a-i),this._offsetPrev=s*c,this._offsetNext=r*c}interpolate_(t,e,i,n){const s=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-e)/(n-e),f=p*p,g=f*p,m=-u*g+2*u*f-u*p,A=(1+u)*g+(-1.5-2*u)*f+(-.5+u)*p+1,v=(-1-d)*g+(1.5+d)*f+.5*p,y=d*g-d*f;for(let t=0;t!==o;++t)s[t]=m*r[c+t]+A*r[l+t]+v*r[a+t]+y*r[h+t];return s}}class Oa extends Da{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t,e,i,n){const s=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=(i-e)/(n-e),h=1-c;for(let t=0;t!==o;++t)s[t]=r[l+t]*h+r[a+t]*c;return s}}class ka extends Da{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t){return this.copySampleValue_(t-1)}}class Ua{constructor(t,e,i,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Ta(e,this.TimeBufferType),this.values=Ta(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let i;if(e.toJSON!==this.toJSON)i=e.toJSON(t);else{i={name:t.name,times:Ta(t.times,Array),values:Ta(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(i.interpolation=e)}return i.type=t.ValueTypeName,i}InterpolantFactoryMethodDiscrete(t){return new ka(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Oa(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Na(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case _e:e=this.InterpolantFactoryMethodDiscrete;break;case xe:e=this.InterpolantFactoryMethodLinear;break;case we:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return _e;case this.InterpolantFactoryMethodLinear:return xe;case this.InterpolantFactoryMethodSmooth:return we}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]*=t}return this}trim(t,e){const i=this.times,n=i.length;let s=0,r=n-1;for(;s!==n&&i[s]<t;)++s;for(;-1!==r&&i[r]>e;)--r;if(++r,0!==s||r!==n){s>=r&&(r=Math.max(r,1),s=r-1);const t=this.getValueSize();this.times=i.slice(s,r),this.values=this.values.slice(s*t,r*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const i=this.times,n=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let r=null;for(let e=0;e!==s;e++){const n=i[e];if("number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,n),t=!1;break}if(null!==r&&r>n){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,n,r),t=!1;break}r=n}if(void 0!==n&&Ba(n))for(let e=0,i=n.length;e!==i;++e){const i=n[e];if(isNaN(i)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,i),t=!1;break}}return t}optimize(){const t=this.times.slice(),e=this.values.slice(),i=this.getValueSize(),n=this.getInterpolation()===we,s=t.length-1;let r=1;for(let o=1;o<s;++o){let s=!1;const a=t[o];if(a!==t[o+1]&&(1!==o||a!==t[0]))if(n)s=!0;else{const t=o*i,n=t-i,r=t+i;for(let o=0;o!==i;++o){const i=e[t+o];if(i!==e[n+o]||i!==e[r+o]){s=!0;break}}}if(s){if(o!==r){t[r]=t[o];const n=o*i,s=r*i;for(let t=0;t!==i;++t)e[s+t]=e[n+t]}++r}}if(s>0){t[r]=t[s];for(let t=s*i,n=r*i,o=0;o!==i;++o)e[n+o]=e[t+o];++r}return r!==t.length?(this.times=t.slice(0,r),this.values=e.slice(0,r*i)):(this.times=t,this.values=e),this}clone(){const t=this.times.slice(),e=this.values.slice(),i=new(0,this.constructor)(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}}Ua.prototype.ValueTypeName="",Ua.prototype.TimeBufferType=Float32Array,Ua.prototype.ValueBufferType=Float32Array,Ua.prototype.DefaultInterpolation=xe;class Fa extends Ua{constructor(t,e,i){super(t,e,i)}}Fa.prototype.ValueTypeName="bool",Fa.prototype.ValueBufferType=Array,Fa.prototype.DefaultInterpolation=_e,Fa.prototype.InterpolantFactoryMethodLinear=void 0,Fa.prototype.InterpolantFactoryMethodSmooth=void 0;class za extends Ua{constructor(t,e,i,n){super(t,e,i,n)}}za.prototype.ValueTypeName="color";class Va extends Ua{constructor(t,e,i,n){super(t,e,i,n)}}Va.prototype.ValueTypeName="number";class Qa extends Da{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t,e,i,n){const s=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=(i-e)/(n-e);let l=t*o;for(let t=l+o;l!==t;l+=4)ui.slerpFlat(s,0,r,l-o,r,l,a);return s}}class ja extends Ua{constructor(t,e,i,n){super(t,e,i,n)}InterpolantFactoryMethodLinear(t){return new Qa(this.times,this.values,this.getValueSize(),t)}}ja.prototype.ValueTypeName="quaternion",ja.prototype.InterpolantFactoryMethodSmooth=void 0;class Ga extends Ua{constructor(t,e,i){super(t,e,i)}}Ga.prototype.ValueTypeName="string",Ga.prototype.ValueBufferType=Array,Ga.prototype.DefaultInterpolation=_e,Ga.prototype.InterpolantFactoryMethodLinear=void 0,Ga.prototype.InterpolantFactoryMethodSmooth=void 0;class Ha extends Ua{constructor(t,e,i,n){super(t,e,i,n)}}Ha.prototype.ValueTypeName="vector";class qa{constructor(t="",e=-1,i=[],n=2500){this.name=t,this.tracks=i,this.duration=e,this.blendMode=n,this.uuid=ni(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],i=t.tracks,n=1/(t.fps||1);for(let t=0,s=i.length;t!==s;++t)e.push($a(i[t]).scale(n));const s=new this(t.name,t.duration,e,t.blendMode);return s.uuid=t.uuid,s}static toJSON(t){const e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,n=i.length;t!==n;++t)e.push(Ua.toJSON(i[t]));return n}static CreateFromMorphTargetSequence(t,e,i,n){const s=e.length,r=[];for(let t=0;t<s;t++){let o=[],a=[];o.push((t+s-1)%s,t,(t+1)%s),a.push(0,1,0);const l=Ra(o);o=Pa(o,1,l),a=Pa(a,1,l),n||0!==o[0]||(o.push(s),a.push(a[0])),r.push(new Va(".morphTargetInfluences["+e[t].name+"]",o,a).scale(1/i))}return new this(t,-1,r)}static findByName(t,e){let i=t;if(!Array.isArray(t)){const e=t;i=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<i.length;t++)if(i[t].name===e)return i[t];return null}static CreateClipsFromMorphTargetSequences(t,e,i){const n={},s=/^([\w-]*?)([\d]+)$/;for(let e=0,i=t.length;e<i;e++){const i=t[e],r=i.name.match(s);if(r&&r.length>1){const t=r[1];let e=n[t];e||(n[t]=e=[]),e.push(i)}}const r=[];for(const t in n)r.push(this.CreateFromMorphTargetSequence(t,n[t],e,i));return r}static parseAnimation(t,e){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(t,e,i,n,s){if(0!==i.length){const r=[],o=[];La(i,r,o,n),0!==r.length&&s.push(new t(e,r,o))}},n=[],s=t.name||"default",r=t.fps||30,o=t.blendMode;let a=t.length||-1;const l=t.hierarchy||[];for(let t=0;t<l.length;t++){const s=l[t].keys;if(s&&0!==s.length)if(s[0].morphTargets){const t={};let e;for(e=0;e<s.length;e++)if(s[e].morphTargets)for(let i=0;i<s[e].morphTargets.length;i++)t[s[e].morphTargets[i]]=-1;for(const i in t){const t=[],r=[];for(let n=0;n!==s[e].morphTargets.length;++n){const n=s[e];t.push(n.time),r.push(n.morphTarget===i?1:0)}n.push(new Va(".morphTargetInfluence["+i+"]",t,r))}a=t.length*r}else{const r=".bones["+e[t].name+"]";i(Ha,r+".position",s,"pos",n),i(ja,r+".quaternion",s,"rot",n),i(Ha,r+".scale",s,"scl",n)}}if(0===n.length)return null;return new this(s,a,n,o)}resetDuration(){let t=0;for(let e=0,i=this.tracks.length;e!==i;++e){const i=this.tracks[e];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function $a(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Va;case"vector":case"vector2":case"vector3":case"vector4":return Ha;case"color":return za;case"quaternion":return ja;case"bool":case"boolean":return Fa;case"string":return Ga}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],i=[];La(t.keys,e,i,"value"),t.times=e,t.values=i}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Wa={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class Ka{constructor(t,e,i){const n=this;let s,r=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){a++,!1===r&&void 0!==n.onStart&&n.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==n.onProgress&&n.onProgress(t,o,a),o===a&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,i=l.length;e<i;e+=2){const i=l[e],n=l[e+1];if(i.global&&(i.lastIndex=0),i.test(t))return n}return null}}}const Xa=new Ka;class Ya{constructor(t){this.manager=void 0!==t?t:Xa,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const i=this;return new Promise(function(n,s){i.load(t,n,e,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}Ya.DEFAULT_MATERIAL_NAME="__DEFAULT";const Ja={};class Za extends Error{constructor(t,e){super(t),this.response=e}}class tl extends Ya{constructor(t){super(t),this.mimeType="",this.responseType=""}load(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const s=Wa.get(t);if(void 0!==s)return this.manager.itemStart(t),setTimeout(()=>{e&&e(s),this.manager.itemEnd(t)},0),s;if(void 0!==Ja[t])return void Ja[t].push({onLoad:e,onProgress:i,onError:n});Ja[t]=[],Ja[t].push({onLoad:e,onProgress:i,onError:n});const r=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(r).then(e=>{if(200===e.status||0===e.status){if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const i=Ja[t],n=e.body.getReader(),s=e.headers.get("X-File-Size")||e.headers.get("Content-Length"),r=s?parseInt(s):0,o=0!==r;let a=0;const l=new ReadableStream({start(t){!function e(){n.read().then(({done:n,value:s})=>{if(n)t.close();else{a+=s.byteLength;const n=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:r});for(let t=0,e=i.length;t<e;t++){const e=i[t];e.onProgress&&e.onProgress(n)}t.enqueue(s),e()}},e=>{t.error(e)})}()}});return new Response(l)}throw new Za(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`,e)}).then(t=>{switch(a){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then(t=>(new DOMParser).parseFromString(t,o));case"json":return t.json();default:if(""===o)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(o),i=e&&e[1]?e[1].toLowerCase():void 0,n=new TextDecoder(i);return t.arrayBuffer().then(t=>n.decode(t))}}}).then(e=>{Wa.add(t,e);const i=Ja[t];delete Ja[t];for(let t=0,n=i.length;t<n;t++){const n=i[t];n.onLoad&&n.onLoad(e)}}).catch(e=>{const i=Ja[t];if(void 0===i)throw this.manager.itemError(t),e;delete Ja[t];for(let t=0,n=i.length;t<n;t++){const n=i[t];n.onError&&n.onError(e)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class el extends Ya{constructor(t){super(t)}load(t,e,i,n){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,r=Wa.get(t);if(void 0!==r)return s.manager.itemStart(t),setTimeout(function(){e&&e(r),s.manager.itemEnd(t)},0),r;const o=vi("img");function a(){c(),Wa.add(t,this),e&&e(this),s.manager.itemEnd(t)}function l(e){c(),n&&n(e),s.manager.itemError(t),s.manager.itemEnd(t)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(t),o.src=t,o}}class il extends Ya{constructor(t){super(t)}load(t,e,i,n){const s=this,r=new Ir,o=new tl(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(t,function(t){let i;try{i=s.parse(t)}catch(t){if(void 0===n)return void console.error(t);n(t)}void 0!==i.image?r.image=i.image:void 0!==i.data&&(r.image.width=i.width,r.image.height=i.height,r.image.data=i.data),r.wrapS=void 0!==i.wrapS?i.wrapS:ut,r.wrapT=void 0!==i.wrapT?i.wrapT:ut,r.magFilter=void 0!==i.magFilter?i.magFilter:mt,r.minFilter=void 0!==i.minFilter?i.minFilter:mt,r.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.colorSpace&&(r.colorSpace=i.colorSpace),void 0!==i.flipY&&(r.flipY=i.flipY),void 0!==i.format&&(r.format=i.format),void 0!==i.type&&(r.type=i.type),void 0!==i.mipmaps&&(r.mipmaps=i.mipmaps,r.minFilter=vt),1===i.mipmapCount&&(r.minFilter=mt),void 0!==i.generateMipmaps&&(r.generateMipmaps=i.generateMipmaps),r.needsUpdate=!0,e&&e(r,i)},i,n),r}}class nl extends Ya{constructor(t){super(t)}load(t,e,i,n){const s=new Ui,r=new el(this.manager);return r.setCrossOrigin(this.crossOrigin),r.setPath(this.path),r.load(t,function(t){s.image=t,s.needsUpdate=!0,void 0!==e&&e(s)},i,n),s}}class sl extends Hn{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new hs(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(e.object.target=this.target.uuid),e}}class rl extends sl{constructor(t,e,i){super(t,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Hn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new hs(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}}const ol=new vn,al=new di,ll=new di;class cl{constructor(t){this.camera=t,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new hi(512,512),this.mapType=yt,this.map=null,this.mapPass=null,this.matrix=new vn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new qr,this._frameExtents=new hi(1,1),this._viewportCount=1,this._viewports=[new Fi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,i=this.matrix;al.setFromMatrixPosition(t.matrixWorld),e.position.copy(al),ll.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(ll),e.updateMatrixWorld(),ol.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ol),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(ol)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.intensity=t.intensity,this.bias=t.bias,this.radius=t.radius,this.autoUpdate=t.autoUpdate,this.needsUpdate=t.needsUpdate,this.normalBias=t.normalBias,this.blurSamples=t.blurSamples,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 1!==this.intensity&&(t.intensity=this.intensity),0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class hl extends cl{constructor(){super(new sr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(t){const e=this.camera,i=2*ii*t.angle*this.focus,n=this.mapSize.width/this.mapSize.height*this.aspect,s=t.distance||e.far;i===e.fov&&n===e.aspect&&s===e.far||(e.fov=i,e.aspect=n,e.far=s,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class ul extends sl{constructor(t,e,i=0,n=Math.PI/3,s=0,r=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Hn.DEFAULT_UP),this.updateMatrix(),this.target=new Hn,this.distance=i,this.angle=n,this.penumbra=s,this.decay=r,this.map=null,this.shadow=new hl}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const dl=new vn,pl=new di,fl=new di;class gl extends cl{constructor(){super(new sr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new hi(4,2),this._viewportCount=6,this._viewports=[new Fi(2,1,1,1),new Fi(0,1,1,1),new Fi(3,1,1,1),new Fi(1,1,1,1),new Fi(3,0,1,1),new Fi(1,0,1,1)],this._cubeDirections=[new di(1,0,0),new di(-1,0,0),new di(0,0,1),new di(0,0,-1),new di(0,1,0),new di(0,-1,0)],this._cubeUps=[new di(0,1,0),new di(0,1,0),new di(0,1,0),new di(0,1,0),new di(0,0,1),new di(0,0,-1)]}updateMatrices(t,e=0){const i=this.camera,n=this.matrix,s=t.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),pl.setFromMatrixPosition(t.matrixWorld),i.position.copy(pl),fl.copy(i.position),fl.add(this._cubeDirections[e]),i.up.copy(this._cubeUps[e]),i.lookAt(fl),i.updateMatrixWorld(),n.makeTranslation(-pl.x,-pl.y,-pl.z),dl.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(dl)}}class ml extends sl{constructor(t,e,i=0,n=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new gl}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class Al extends tr{constructor(t=-1,e=1,i=1,n=-1,s=.1,r=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=s,this.far=r,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,i,n,s,r){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=s,this.view.height=r,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let s=i-t,r=i+t,o=n+e,a=n-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=t*this.view.offsetX,r=s+t*this.view.width,o-=e*this.view.offsetY,a=o-e*this.view.height}this.projectionMatrix.makeOrthographic(s,r,o,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}class vl extends cl{constructor(){super(new Al(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class yl extends sl{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Hn.DEFAULT_UP),this.updateMatrix(),this.target=new Hn,this.shadow=new vl}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class bl extends sl{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}}class _l extends sl{constructor(t,e,i=10,n=10){super(t,e),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=n}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}class xl{static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.slice(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class wl extends Ds{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){const t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}const El=new WeakMap;class Cl extends Ya{constructor(t){super(t),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,r=Wa.get(t);if(void 0!==r)return s.manager.itemStart(t),r.then?void r.then(i=>{if(!0!==El.has(r))return e&&e(i),s.manager.itemEnd(t),i;n&&n(El.get(r)),s.manager.itemError(t),s.manager.itemEnd(t)}):(setTimeout(function(){e&&e(r),s.manager.itemEnd(t)},0),r);const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader;const a=fetch(t,o).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(i){return Wa.add(t,i),e&&e(i),s.manager.itemEnd(t),i}).catch(function(e){n&&n(e),El.set(a,e),Wa.remove(t),s.manager.itemError(t),s.manager.itemEnd(t)});Wa.add(t,a),s.manager.itemStart(t)}}class Sl extends sr{constructor(t=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=t}}class Il{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Ml(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=Ml();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}function Ml(){return performance.now()}class Tl{constructor(t,e,i){let n,s,r;switch(this.binding=t,this.valueSize=i,e){case"quaternion":n=this._slerp,s=this._slerpAdditive,r=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":n=this._select,s=this._select,r=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:n=this._lerp,s=this._lerpAdditive,r=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=s,this._setIdentity=r,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const i=this.buffer,n=this.valueSize,s=t*n+n;let r=this.cumulativeWeight;if(0===r){for(let t=0;t!==n;++t)i[s+t]=i[t];r=e}else{r+=e;const t=e/r;this._mixBufferRegion(i,s,0,t,n)}this.cumulativeWeight=r}accumulateAdditive(t){const e=this.buffer,i=this.valueSize,n=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,n,0,t,i),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,i=this.buffer,n=t*e+e,s=this.cumulativeWeight,r=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const t=e*this._origIndex;this._mixBufferRegion(i,n,t,1-s,e)}r>0&&this._mixBufferRegionAdditive(i,n,this._addIndex*e,1,e);for(let t=e,s=e+e;t!==s;++t)if(i[t]!==i[t+e]){o.setValue(i,n);break}}saveOriginalState(){const t=this.binding,e=this.buffer,i=this.valueSize,n=i*this._origIndex;t.getValue(e,n);for(let t=i,s=n;t!==s;++t)e[t]=e[n+t%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let i=t;i<e;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[e+i]=this.buffer[t+i]}_select(t,e,i,n,s){if(n>=.5)for(let n=0;n!==s;++n)t[e+n]=t[i+n]}_slerp(t,e,i,n){ui.slerpFlat(t,e,t,e,t,i,n)}_slerpAdditive(t,e,i,n,s){const r=this._workIndex*s;ui.multiplyQuaternionsFlat(t,r,t,e,t,i),ui.slerpFlat(t,e,t,e,t,r,n)}_lerp(t,e,i,n,s){const r=1-n;for(let o=0;o!==s;++o){const s=e+o;t[s]=t[s]*r+t[i+o]*n}}_lerpAdditive(t,e,i,n,s){for(let r=0;r!==s;++r){const s=e+r;t[s]=t[s]+t[i+r]*n}}}const Bl="\\[\\]\\.:\\/",Rl=new RegExp("["+Bl+"]","g"),Pl="[^"+Bl+"]",Ll="[^"+Bl.replace("\\.","")+"]",Dl=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Pl)+/(WCOD+)?/.source.replace("WCOD",Ll)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Pl)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Pl)+"$"),Nl=["material","materials","bones","map"];class Ol{constructor(t,e,i){this.path=e,this.parsedPath=i||Ol.parseTrackName(e),this.node=Ol.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,i){return t&&t.isAnimationObjectGroup?new Ol.Composite(t,e,i):new Ol(t,e,i)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Rl,"")}static parseTrackName(t){const e=Dl.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const t=i.nodeName.substring(n+1);-1!==Nl.indexOf(t)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=t)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const i=t.skeleton.getBoneByName(e);if(void 0!==i)return i}if(t.children){const i=function(t){for(let n=0;n<t.length;n++){const s=t[n];if(s.name===e||s.uuid===e)return s;const r=i(s.children);if(r)return r}return null},n=i(t.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)t[e++]=i[n]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)i[n]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,i=e.objectName,n=e.propertyName;let s=e.propertyIndex;if(t||(t=Ol.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(i){let n=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===n){n=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==n){if(void 0===t[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[n]}}const r=t[n];if(void 0===r){const i=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i+"."+n+" but it wasn't found.",t)}let o=this.Versioning.None;this.targetObject=t,!0===t.isMaterial?o=this.Versioning.NeedsUpdate:!0===t.isObject3D&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==s){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[s]&&(s=t.morphTargetDictionary[s])}a=this.BindingType.ArrayElement,this.resolvedProperty=r,this.propertyIndex=s}else void 0!==r.fromArray&&void 0!==r.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=r):Array.isArray(r)?(a=this.BindingType.EntireArray,this.resolvedProperty=r):this.propertyName=n;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ol.Composite=class{constructor(t,e,i){const n=i||Ol.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}getValue(t,e){this.bind();const i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)}setValue(t,e){const i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,s=i.length;n!==s;++n)i[n].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},Ol.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ol.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ol.prototype.GetterByBindingType=[Ol.prototype._getValue_direct,Ol.prototype._getValue_array,Ol.prototype._getValue_arrayElement,Ol.prototype._getValue_toArray],Ol.prototype.SetterByBindingTypeAndVersioning=[[Ol.prototype._setValue_direct,Ol.prototype._setValue_direct_setNeedsUpdate,Ol.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ol.prototype._setValue_array,Ol.prototype._setValue_array_setNeedsUpdate,Ol.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ol.prototype._setValue_arrayElement,Ol.prototype._setValue_arrayElement_setNeedsUpdate,Ol.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ol.prototype._setValue_fromArray,Ol.prototype._setValue_fromArray_setNeedsUpdate,Ol.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class kl{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ni(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let e=0,i=arguments.length;e!==i;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,i=this._paths,n=this._parsedPaths,s=this._bindings,r=s.length;let o,a=t.length,l=this.nCachedObjects_;for(let c=0,h=arguments.length;c!==h;++c){const h=arguments[c],u=h.uuid;let d=e[u];if(void 0===d){d=a++,e[u]=d,t.push(h);for(let t=0,e=r;t!==e;++t)s[t].push(new Ol(h,i[t],n[t]))}else if(d<l){o=t[d];const a=--l,c=t[a];e[c.uuid]=d,t[d]=c,e[u]=a,t[a]=h;for(let t=0,e=r;t!==e;++t){const e=s[t],r=e[a];let o=e[d];e[d]=r,void 0===o&&(o=new Ol(h,i[t],n[t])),e[a]=o}}else t[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const t=this._objects,e=this._indicesByUUID,i=this._bindings,n=i.length;let s=this.nCachedObjects_;for(let r=0,o=arguments.length;r!==o;++r){const o=arguments[r],a=o.uuid,l=e[a];if(void 0!==l&&l>=s){const r=s++,c=t[r];e[c.uuid]=l,t[l]=c,e[a]=r,t[r]=o;for(let t=0,e=n;t!==e;++t){const e=i[t],n=e[r],s=e[l];e[l]=n,e[r]=s}}}this.nCachedObjects_=s}uncache(){const t=this._objects,e=this._indicesByUUID,i=this._bindings,n=i.length;let s=this.nCachedObjects_,r=t.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o].uuid,l=e[a];if(void 0!==l)if(delete e[a],l<s){const o=--s,a=t[o],c=--r,h=t[c];e[a.uuid]=l,t[l]=a,e[h.uuid]=o,t[o]=h,t.pop();for(let t=0,e=n;t!==e;++t){const e=i[t],n=e[o],s=e[c];e[l]=n,e[o]=s,e.pop()}}else{const s=--r,o=t[s];s>0&&(e[o.uuid]=l),t[l]=o,t.pop();for(let t=0,e=n;t!==e;++t){const e=i[t];e[l]=e[s],e.pop()}}}this.nCachedObjects_=s}subscribe_(t,e){const i=this._bindingsIndicesByPath;let n=i[t];const s=this._bindings;if(void 0!==n)return s[n];const r=this._paths,o=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,h=new Array(l);n=s.length,i[t]=n,r.push(t),o.push(e),s.push(h);for(let i=c,n=a.length;i!==n;++i){const n=a[i];h[i]=new Ol(n,t,e)}return h}unsubscribe_(t){const e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){const n=this._paths,s=this._parsedPaths,r=this._bindings,o=r.length-1,a=r[o];e[t[o]]=i,r[i]=a,r.pop(),s[i]=s[o],s.pop(),n[i]=n[o],n.pop()}}}class Ul{constructor(t,e,i=null,n=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=i,this.blendMode=n;const s=e.tracks,r=s.length,o=new Array(r),a={endingStart:Ee,endingEnd:Ee};for(let t=0;t!==r;++t){const e=s[t].createInterpolant(null);o[t]=e,e.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=be,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,i=!1){if(t.fadeOut(e),this.fadeIn(e),!0===i){const i=this._clip.duration,n=t._clip.duration,s=n/i,r=i/n;t.warp(1,s,e),this.warp(r,1,e)}return this}crossFadeTo(t,e,i=!1){return t.crossFadeFrom(this,e,i)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,i){const n=this._mixer,s=n.time,r=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,a[1]=s+i,l[0]=t/r,l[1]=e/r,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,i,n){if(!this.enabled)return void this._updateWeight(t);const s=this._startTime;if(null!==s){const n=(t-s)*i;n<0||0===i?e=0:(this._startTime=null,e=i*n)}e*=this._updateTimeScale(t);const r=this._updateTime(e),o=this._updateWeight(t);if(o>0){const t=this._interpolants,e=this._propertyBindings;if(2501===this.blendMode)for(let i=0,n=t.length;i!==n;++i)t[i].evaluate(r),e[i].accumulateAdditive(o);else for(let i=0,s=t.length;i!==s;++i)t[i].evaluate(r),e[i].accumulate(n,o)}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const i=this._weightInterpolant;if(null!==i){const n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const i=this._timeScaleInterpolant;if(null!==i){e*=i.evaluate(t)[0],t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,i=this.loop;let n=this.time+t,s=this._loopCount;const r=2202===i;if(0===t)return-1===s||!r||1&~s?n:e-n;if(i===ye){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(n>=e)n=e;else{if(!(n<0)){this.time=n;break t}n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===s&&(t>=0?(s=0,this._setEndings(!0,0===this.repetitions,r)):this._setEndings(0===this.repetitions,!0,r)),n>=e||n<0){const i=Math.floor(n/e);n-=e*i,s+=Math.abs(i);const o=this.repetitions-s;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=t>0?e:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===o){const e=t<0;this._setEndings(e,!e,r)}else this._setEndings(!1,!1,r);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i})}}else this.time=n;if(r&&!(1&~s))return e-n}return n}_setEndings(t,e,i){const n=this._interpolantSettings;i?(n.endingStart=Ce,n.endingEnd=Ce):(n.endingStart=t?this.zeroSlopeAtStart?Ce:Ee:Se,n.endingEnd=e?this.zeroSlopeAtEnd?Ce:Ee:Se)}_scheduleFading(t,e,i){const n=this._mixer,s=n.time;let r=this._weightInterpolant;null===r&&(r=n._lendControlInterpolant(),this._weightInterpolant=r);const o=r.parameterPositions,a=r.sampleValues;return o[0]=s,a[0]=e,o[1]=s+t,a[1]=i,this}}const Fl=new Float32Array(1);class zl extends Je{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const i=t._localRoot||this._root,n=t._clip.tracks,s=n.length,r=t._propertyBindings,o=t._interpolants,a=i.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let t=0;t!==s;++t){const s=n[t],l=s.name;let h=c[l];if(void 0!==h)++h.referenceCount,r[t]=h;else{if(h=r[t],void 0!==h){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,a,l));continue}const n=e&&e._propertyBindings[t].binding.parsedPath;h=new Tl(Ol.create(i,l,n),s.ValueTypeName,s.getValueSize()),++h.referenceCount,this._addInactiveBinding(h,a,l),r[t]=h}o[t].resultBuffer=h.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}const e=t._propertyBindings;for(let t=0,i=e.length;t!==i;++t){const i=e[t];0===i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,i=e.length;t!==i;++t){const i=e[t];0===--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,i){const n=this._actions,s=this._actionsByClip;let r=s[e];if(void 0===r)r={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,s[e]=r;else{const e=r.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=n.length,n.push(t),r.actionByRoot[i]=t}_removeInactiveAction(t){const e=this._actions,i=e[e.length-1],n=t._cacheIndex;i._cacheIndex=n,e[n]=i,e.pop(),t._cacheIndex=null;const s=t._clip.uuid,r=this._actionsByClip,o=r[s],a=o.knownActions,l=a[a.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),t._byClipCacheIndex=null;delete o.actionByRoot[(t._localRoot||this._root).uuid],0===a.length&&delete r[s],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let t=0,i=e.length;t!==i;++t){const i=e[t];0===--i.referenceCount&&this._removeInactiveBinding(i)}}_lendAction(t){const e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,s=e[n];t._cacheIndex=n,e[n]=t,s._cacheIndex=i,e[i]=s}_takeBackAction(t){const e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,s=e[n];t._cacheIndex=n,e[n]=t,s._cacheIndex=i,e[i]=s}_addInactiveBinding(t,e,i){const n=this._bindingsByRootAndName,s=this._bindings;let r=n[e];void 0===r&&(r={},n[e]=r),r[i]=t,t._cacheIndex=s.length,s.push(t)}_removeInactiveBinding(t){const e=this._bindings,i=t.binding,n=i.rootNode.uuid,s=i.path,r=this._bindingsByRootAndName,o=r[n],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete o[s],0===Object.keys(o).length&&delete r[n]}_lendBinding(t){const e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,s=e[n];t._cacheIndex=n,e[n]=t,s._cacheIndex=i,e[i]=s}_takeBackBinding(t){const e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,s=e[n];t._cacheIndex=n,e[n]=t,s._cacheIndex=i,e[i]=s}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let i=t[e];return void 0===i&&(i=new Oa(new Float32Array(2),new Float32Array(2),1,Fl),i.__cacheIndex=e,t[e]=i),i}_takeBackControlInterpolant(t){const e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,s=e[n];t.__cacheIndex=n,e[n]=t,s.__cacheIndex=i,e[i]=s}clipAction(t,e,i){const n=e||this._root,s=n.uuid;let r="string"==typeof t?qa.findByName(n,t):t;const o=null!==r?r.uuid:t,a=this._actionsByClip[o];let l=null;if(void 0===i&&(i=null!==r?r.blendMode:Ie),void 0!==a){const t=a.actionByRoot[s];if(void 0!==t&&t.blendMode===i)return t;l=a.knownActions[0],null===r&&(r=l._clip)}if(null===r)return null;const c=new Ul(this,r,e,i);return this._bindAction(c,l),this._addInactiveAction(c,o,s),c}existingAction(t,e){const i=e||this._root,n=i.uuid,s="string"==typeof t?qa.findByName(i,t):t,r=s?s.uuid:t,o=this._actionsByClip[r];return void 0!==o&&o.actionByRoot[n]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){t*=this.timeScale;const e=this._actions,i=this._nActiveActions,n=this.time+=t,s=Math.sign(t),r=this._accuIndex^=1;for(let o=0;o!==i;++o){e[o]._update(n,t,s,r)}const o=this._bindings,a=this._nActiveBindings;for(let t=0;t!==a;++t)o[t].apply(r);return this}setTime(t){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,i=t.uuid,n=this._actionsByClip,s=n[i];if(void 0!==s){const t=s.knownActions;for(let i=0,n=t.length;i!==n;++i){const n=t[i];this._deactivateAction(n);const s=n._cacheIndex,r=e[e.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,r._cacheIndex=s,e[s]=r,e.pop(),this._removeInactiveBindingsForAction(n)}delete n[i]}}uncacheRoot(t){const e=t.uuid,i=this._actionsByClip;for(const t in i){const n=i[t].actionByRoot[e];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}const n=this._bindingsByRootAndName[e];if(void 0!==n)for(const t in n){const e=n[t];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(t,e){const i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class Vl extends pr{constructor(t,e,i=1){super(t,e),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}const Ql=new vn;class jl{constructor(t,e,i=0,n=1/0){this.ray=new An(t,e),this.near=i,this.far=n,this.camera=null,this.layers=new Tn,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}setFromXRController(t){return Ql.identity().extractRotation(t.matrixWorld),this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Ql),this}intersectObject(t,e=!0,i=[]){return Hl(t,this,i,e),i.sort(Gl),i}intersectObjects(t,e=!0,i=[]){for(let n=0,s=t.length;n<s;n++)Hl(t[n],this,i,e);return i.sort(Gl),i}}function Gl(t,e){return t.distance-e.distance}function Hl(t,e,i,n){let s=!0;if(t.layers.test(e.layers)){!1===t.raycast(e,i)&&(s=!1)}if(!0===s&&!0===n){const n=t.children;for(let t=0,s=n.length;t<s;t++)Hl(n[t],e,i,!0)}}class ql{constructor(t=1,e=0,i=0){this.radius=t,this.phi=e,this.theta=i}set(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=si(this.phi,t,Math.PI-t),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(si(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const $l=new di,Wl=new di;class Kl{constructor(t=new di,e=new di){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){$l.subVectors(t,this.start),Wl.subVectors(this.end,this.start);const i=Wl.dot(Wl);let n=Wl.dot($l)/i;return e&&(n=si(n,0,1)),n}closestPointToPoint(t,e,i){const n=this.closestPointToPointParameter(t,e);return this.delta(i).multiplyScalar(n).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}class Xl extends ro{constructor(t,e=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Ds;n.setIndex(new ws(i,1)),n.setAttribute("position",new Ss([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(n,new $r({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}}function Yl(t,e,i,n){const s=function(t){switch(t){case yt:case bt:return{byteLength:1,components:1};case xt:case _t:case St:return{byteLength:2,components:1};case It:case Mt:return{byteLength:2,components:4};case Et:case wt:case Ct:return{byteLength:4,components:1};case Bt:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}(n);switch(i){case Rt:return t*e;case Ot:case kt:return t*e/s.components*s.byteLength;case Ut:case Ft:return t*e*2/s.components*s.byteLength;case Pt:return t*e*3/s.components*s.byteLength;case Lt:case zt:return t*e*4/s.components*s.byteLength;case Vt:case Qt:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case jt:case Gt:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case qt:case Wt:return Math.max(t,16)*Math.max(e,8)/4;case Ht:case $t:return Math.max(t,8)*Math.max(e,8)/2;case Kt:case Xt:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case Yt:case Jt:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case Zt:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case te:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case ee:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case ie:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case ne:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case se:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case re:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case oe:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case ae:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case le:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case ce:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case he:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case ue:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case de:case pe:case fe:return Math.ceil(t/4)*Math.ceil(e/4)*16;case ge:case me:return Math.ceil(t/4)*Math.ceil(e/4)*8;case Ae:case ve:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${i} format.`)}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=n)},4709:(t,e,i)=>{"use strict";i.d(e,{Bj:()=>a,XY:()=>s,c1:()=>o,h5:()=>h,s9:()=>c,xL:()=>n,zY:()=>u});const n=`{{lit-${String(Math.random()).slice(2)}}}`,s=`\x3c!--${n}--\x3e`,r=new RegExp(`${n}|${s}`),o="$lit$";class a{constructor(t,e){this.parts=[],this.element=e;const i=[],s=[],a=document.createTreeWalker(e.content,133,null,!1);let c=0,d=-1,p=0;const{strings:f,values:{length:g}}=t;for(;p<g;){const t=a.nextNode();if(null!==t){if(d++,1===t.nodeType){if(t.hasAttributes()){const e=t.attributes,{length:i}=e;let n=0;for(let t=0;t<i;t++)l(e[t].name,o)&&n++;for(;n-- >0;){const e=f[p],i=u.exec(e)[2],n=i.toLowerCase()+o,s=t.getAttribute(n);t.removeAttribute(n);const a=s.split(r);this.parts.push({type:"attribute",index:d,name:i,strings:a}),p+=a.length-1}}"TEMPLATE"===t.tagName&&(s.push(t),a.currentNode=t.content)}else if(3===t.nodeType){const e=t.data;if(e.indexOf(n)>=0){const n=t.parentNode,s=e.split(r),a=s.length-1;for(let e=0;e<a;e++){let i,r=s[e];if(""===r)i=h();else{const t=u.exec(r);null!==t&&l(t[2],o)&&(r=r.slice(0,t.index)+t[1]+t[2].slice(0,-o.length)+t[3]),i=document.createTextNode(r)}n.insertBefore(i,t),this.parts.push({type:"node",index:++d})}""===s[a]?(n.insertBefore(h(),t),i.push(t)):t.data=s[a],p+=a}}else if(8===t.nodeType)if(t.data===n){const e=t.parentNode;null!==t.previousSibling&&d!==c||(d++,e.insertBefore(h(),t)),c=d,this.parts.push({type:"node",index:d}),null===t.nextSibling?t.data="":(i.push(t),d--),p++}else{let e=-1;for(;-1!==(e=t.data.indexOf(n,e+1));)this.parts.push({type:"node",index:-1}),p++}}else a.currentNode=s.pop()}for(const t of i)t.parentNode.removeChild(t)}}const l=(t,e)=>{const i=t.length-e.length;return i>=0&&t.slice(i)===e},c=t=>-1!==t.index,h=()=>document.createComment(""),u=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/},4743:(t,e,i)=>{"use strict";i.d(e,{ab:()=>n.ab,Yp:()=>n.Yp,GP:()=>n.GP,Qh:()=>n.Qh,Vm:()=>n.Vm,h5:()=>c.h5,u$:()=>o.u,qy:()=>h,if:()=>a.if,XX:()=>l.X,Pf:()=>a.Pf});var n=i(3869);const s=new class{handleAttributeExpressions(t,e,i,s){const r=e[0];if("."===r){return new n.g$(t,e.slice(1),i).parts}if("@"===r)return[new n.GP(t,e.slice(1),s.eventContext)];if("?"===r)return[new n.Yp(t,e.slice(1),i)];return new n.pU(t,e,i).parts}handleTextExpression(t){return new n.Qh(t)}};var r=i(2387),o=i(6342),a=i(6187),l=(i(1142),i(8135)),c=(i(1046),i(1757),i(4709));"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const h=(t,...e)=>new r.Q(t,e,"html",s)},4757:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var n=i(4640),s=i(9979),r=i(3331),o=i(2799),a=i(4270),l=i(3275),c=i(7795),h=i(3889),u=i(5676);class d extends r.A{constructor(t,e,i){super(),this.viewports=[],this.rendererComponent=null,this.targetViewport=null,this.targetObject3D=null,this.targetComponent=null,this.targetScene=null,this.targetCamera=null,this.defaultScene=new n.Z58,this.defaultCamera=new u.Ay,this.system=t,this.canvas=e,this.overlay=i,this.renderer=new s.JeP({canvas:e,antialias:!0}),this.renderer.autoClear=!1,this.renderer.outputColorSpace=n.er$,this.picker=new c.A(this.renderer)}dispose(){this.renderer.dispose(),this.viewports.forEach(t=>t.dispose())}get canvasWidth(){return this.canvas.width}get canvasHeight(){return this.canvas.height}attach(){const t=this.canvasWidth,e=this.canvasHeight;this.viewports.forEach(i=>i.setCanvasSize(t,e)),this.renderer.setSize(t,e,!1),this.rendererComponent=this.system.getComponent(h.A,!0),this.rendererComponent.attachView(this)}detach(){this.rendererComponent=this.system.getComponent(h.A,!0),this.rendererComponent.detachView(this),this.rendererComponent=null}renderImage(t,e,i,n){const s=this.canvas.width,r=this.canvas.height;this.setRenderSize(t,e),this.render();const o=this.canvas.toDataURL(i,n);return this.setRenderSize(s,r),o}render(){const t=this.rendererComponent.activeSceneComponent;if(!t)return;let e=t.scene,i=t.activeCamera;e&&i||(e=this.defaultScene,i=this.defaultCamera);const n=this.renderer;n.clear(),n.__view=this;const s=this.viewports;for(let t=0,r=s.length;t<r;++t){const r=s[t];let o=n.getContext();o.clear(o.DEPTH_BUFFER_BIT),o.finish(),n.__viewport=r;const a=r.updateCamera(i);r.applyViewport(this.renderer),n.render(e,a)}}setRenderSize(t,e){this.canvas.width=t,this.canvas.height=e,this.viewports.forEach(i=>i.setCanvasSize(t,e)),this.renderer.xr.isPresenting||this.renderer.setSize(t,e,!1)}resize(){this.setRenderSize(this.canvas.clientWidth,this.canvas.clientHeight),this.renderer.xr.isPresenting||this.render()}setViewportCount(t){const e=this.viewports;for(let i=t;i<e.length;++i)e[i].dispose();for(let i=e.length;i<t;++i){const t=(new l.A).appendTo(this.overlay);e[i]=new a.A,e[i].setCanvasSize(this.canvasWidth,this.canvasHeight),e[i].overlay=t}e.length=t}getViewportCount(){return this.viewports.length}onPointer(t){if(!this.system)return!1;let e=!1,i=!1;"pointer-hover"===t.type?i=!0:t.isPrimary&&"pointer-down"===t.type&&(i=!0,e=!0);const n=this.routeEvent(t,i,e);if(n){const t=n.component;if(t){t.emit(n);const e=t.getComponent(o.A);!n.stopPropagation&&e&&e.propagateUp(!1,!0,n)}if(n.stopPropagation||this.system.emit(n),!n.stopPropagation){n.viewport.onPointer(n)&&this.system.getMainComponent(h.A).forceRender()}return!0}return!1}onTrigger(t){if(!this.system)return!1;const e=this.routeEvent(t,!0,!0);if(e){const t=e.component;if(t){t.emit(e);const i=t.getComponent(o.A);!e.stopPropagation&&i&&i.propagateUp(!1,!0,e)}if(e.stopPropagation||this.system.emit(e),!e.stopPropagation){e.viewport.onTrigger(e)&&this.system.getMainComponent(h.A).forceRender()}return!0}return!1}onKeypress(t){if(!this.system)return!1;const e=this.routeEvent(t,!1,!1);if(e){const t=e.component;if(t){t.emit(e);const i=t.getComponent(o.A);!e.stopPropagation&&i&&i.propagateUp(!1,!0,e)}if(e.stopPropagation||this.system.emit(e),!e.stopPropagation){e.viewport.onKeyboard(e)&&this.system.getMainComponent(h.A).forceRender()}return!0}return!1}pickPosition(t,e,i){return this.picker.pickPosition(this.targetScene,this.targetCamera,t,e,i)}pickNormal(t,e){return this.picker.pickNormal(this.targetScene,this.targetCamera,t,e)}routeEvent(t,e,i){let n=this.targetViewport,s=this.targetComponent&&this.targetComponent.node?this.targetComponent:null,r=s?this.targetObject3D:null;if(e){n=null;const e=this.viewports;for(let i=0,s=e.length;i<s;++i){const s=e[i];if(s.isInside(t)){n=s;break}}}if(!n)return null;const o=t;if(o.view=this,o.viewport=n,o.deviceX=n.getDeviceX(t.localX),o.deviceY=n.getDeviceY(t.localY),o.stopPropagation=!1,i){const e=this.rendererComponent.activeSceneComponent,i=this.targetScene=e&&e.scene,n=this.targetCamera=e&&e.activeCamera;if(r=null,s=null,i&&n)if(r=this.picker.pickObject(i,n,t),void 0===r)0;else{let t=r;for(;t&&!s;)s=t.userData.component,s||(t=t.parent);0}}return o.object3D=r,o.component=s,this.targetViewport=n,this.targetObject3D=r,this.targetComponent=s,o}}},4949:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var n=i(4640);i(8948);class s extends n.B69{constructor(){super(...arguments),this.isHTMLSpriteGroup=!0,this._visible=!0}getVisible(){return this._visible}setVisible(t){if(t!==this._visible){this._visible=t;const e=this.children;for(let i=0,n=e.length;i<n;++i)e[i].setVisible(t)}}dispose(){const t=this.children;for(let e=0,i=t.length;e<i;++e)t[e].dispose()}disposeHTMLElements(t){const e=this.children;for(let i=0,n=e.length;i<n;++i)e[i].disposeHTMLElement(t)}render(t,e){if(!this.visible)return;const i=t.getBoundingClientRect();t.scrollTop=0,t.scrollLeft=0;const n=this.children;for(let s=0,r=n.length;s<r;++s){const r=n[s],o=r.getHTMLElement(t);o&&r.renderHTMLElement(o,i,e)}}update(){const t=this.children;for(let e=0,i=t.length;e<i;++e)t[e].update()}}},4955:(t,e,i)=>{"use strict";i.d(e,{A:()=>a,k:()=>n});var n,s=i(3423),r=i(1860),o=i(5240);!function(t){t[t.Graph=0]="Graph",t[t.Main=1]="Main",t[t.System=2]="System"}(n||(n={}));class a extends s.Ay{constructor(){super(...arguments),this._scope=n.Graph,this._scopedGraph=null,this._activeNode=null}get nodeType(){return this.constructor.nodeType}get followNodeSelection(){return this.constructor.followNodeSelection}get followComponentSelection(){return this.constructor.followComponentSelection}get retainSelection(){return this.constructor.retainSelection}get scope(){return this._scope}set scope(t){this._scope=t,this._activeNode&&!this.isNodeInScope(this._activeNode)&&(this.activeNode=null)}get scopedGraph(){return this._scopedGraph}set scopedGraph(t){t!==this._scopedGraph&&(this._scopedGraph=t,this._activeNode&&!this.isNodeInScope(this._activeNode)&&(this.activeNode=null),this.onScopedNodes(),this.emit({type:"scoped-nodes"}))}get scopedNodes(){switch(this._scope){case n.Graph:return(this._scopedGraph?this._scopedGraph.innerGraph:this.graph).getNodes(this.nodeType);case n.Main:return this.getMainNodes(this.nodeType);case n.System:return this.getSystemNodes(this.nodeType)}}get activeNode(){return this._activeNode}set activeNode(t){const e=this.activeNode;if(t!==e){if(e&&this.deactivateNode(e),t){if(!this.isNodeInScope(t))throw new Error("can't activate, node out of scope");this.activateNode(t)}this._activeNode=t,this.onActiveNode(e,t),this.emit({type:"active-node",previous:e,next:t})}}get selection(){return this.getSystemComponent(o.A)}create(){super.create(),this.system.nodes.on(r.A,this.onNode,this),this.followNodeSelection&&this.selection.selectedNodes.on(this.nodeType,this.onSelectNode,this),this.followComponentSelection&&this.selection.selectedComponents.on(s.Ay,this.onSelectComponent,this)}dispose(){this.activeNode&&(this.activeNode=null),this.system.nodes.off(r.A,this.onNode,this),this.followNodeSelection&&this.selection.selectedNodes.off(this.nodeType,this.onSelectNode,this),this.followComponentSelection&&this.selection.selectedComponents.off(s.Ay,this.onSelectComponent,this),super.dispose()}activateNode(t){}deactivateNode(t){}onActiveNode(t,e){}onScopedNodes(){}onNode(t){t.remove&&t.object===this.activeNode&&(this.activeNode=null),this.isNodeInScope(t.object)&&(this.onScopedNodes(),this.emit({type:"scoped-nodes"}))}onSelectNode(t){const e=t.object;this.isNodeInScope(e)&&(t.add?this.activeNode=e:t.remove&&!this.retainSelection&&e===this.activeNode&&(this.activeNode=null))}onSelectComponent(t){const e=t.object.node;e.is(this.nodeType)&&this.onSelectNode({type:e.typeName,object:e,add:t.add,remove:t.remove})}isNodeInScope(t){if(!t.is(this.nodeType))return!1;switch(this._scope){case n.Graph:const e=this._scopedGraph?this._scopedGraph.innerGraph:this.graph;return t.graph===e;case n.Main:return t.graph===this.system.graph;case n.System:return!0}return!1}}a.typeName="CNodeProvider",a.nodeType=r.A,a.followNodeSelection=!0,a.followComponentSelection=!1,a.retainSelection=!0},4965:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n=i(4640),s=i(3423),r=i(2464);class o extends r.A{constructor(t,e){super(t,e),this.ins=this.addInputs(o.spotLightIns),this.object3D=new n.nCl,this.light.target.matrixAutoUpdate=!1}get light(){return this.object3D}update(t){super.update(t);const e=this.light,i=this.ins;return(i.position.changed||i.target.changed)&&(e.position.fromArray(i.position.value),e.target.position.fromArray(i.target.value),e.updateMatrix(),e.target.updateMatrix()),(i.distance.changed||i.decay.changed||i.angle.changed||i.penumbra.changed)&&(e.distance=i.distance.value,e.decay=i.decay.value,e.angle=i.angle.value*n.cj9.DEG2RAD,e.penumbra=i.penumbra.value,e.shadow.camera.near=e.distance?e.distance/800:.5),!0}onAddToParent(t){super.onAddToParent(t),t.add(this.light.target)}onRemoveFromParent(t){super.onRemoveFromParent(t),t.remove(this.light.target)}}o.typeName="CSpotLight",o.spotLightIns={position:s.gK.Vector3("Light.Position"),target:s.gK.Vector3("Light.Target",[0,-1,0]),distance:s.gK.Number("Light.Distance",{preset:0,min:0}),decay:s.gK.Number("Light.Decay",{preset:1,min:0}),angle:s.gK.Number("Light.Angle",{preset:45,min:0,max:89}),penumbra:s.gK.Percent("Light.Penumbra",{preset:.5,min:0})};class a extends o{get settingProperties(){return[this.ins.name,this.ins.enabled,this.ins.color,this.ins.intensity,this.ins.distance,this.ins.decay,this.ins.angle,this.ins.penumbra,this.ins.shadowEnabled,this.ins.shadowResolution,this.ins.shadowBlur,this.ins.shadowIntensity]}get snapshotProperties(){return[this.ins.color,this.ins.intensity]}dispose(){this.ins.shadowEnabled.value&&this.light.shadow.map&&this.light.shadow.map.dispose(),super.dispose()}fromDocument(t,e){if(!isFinite(e.light))throw new Error("light property missing in node");const i=t.lights[e.light],n=this.ins;if(i.type!==a.type)throw new Error("light type mismatch: not a spot light");return n.name.setValue(e.name),i.spot=i.spot||{},n.copyValues({enabled:void 0!==i.enabled?i.enabled:n.enabled.schema.preset,color:void 0!==i.color?i.color:n.color.schema.preset,intensity:void 0!==i.intensity?i.intensity:n.intensity.schema.preset,position:n.position.schema.preset,target:n.target.schema.preset,distance:i.spot.distance||n.distance.schema.preset,decay:void 0!==i.spot.decay?i.spot.decay:n.decay.schema.preset,angle:void 0!==i.spot.angle?i.spot.angle:n.angle.schema.preset,penumbra:i.spot.penumbra||n.penumbra.schema.preset,shadowEnabled:i.shadowEnabled||!1,shadowResolution:void 0!==i.shadowResolution&&r.Y[i.shadowResolution]||1,shadowBlur:void 0!==i.shadowBlur?i.shadowBlur:n.shadowBlur.schema.preset,shadowIntensity:void 0!==i.shadowIntensity?i.shadowIntensity:n.shadowIntensity.schema.preset}),e.light}toDocument(t,e){const i=this.ins,n={enabled:i.enabled.value,color:i.color.cloneValue(),intensity:i.intensity.value,spot:{distance:i.distance.value,decay:i.decay.value,angle:i.angle.value,penumbra:i.penumbra.value}};n.type=a.type,i.shadowEnabled.value&&(n.shadowEnabled=!0,i.shadowBlur.isDefault()||(n.shadowBlur=i.shadowBlur.value),i.shadowResolution.isDefault()||(n.shadowResolution=r.Y[i.shadowResolution.value]),i.shadowIntensity.isDefault()||(n.shadowIntensity=i.shadowIntensity.value)),t.lights=t.lights||[];const s=t.lights.length;return t.lights.push(n),s}}a.typeName="CVSpotLight",a.type="spot",a.text="Spot Light",a.icon="spot"},5007:(t,e,i)=>{"use strict";i.d(e,{A:()=>r,T:()=>n});var n,s=i(3423);!function(t){t[t.none=0]="none",t[t.menu=1]="menu",t[t.title=2]="title",t[t.logo=4]="logo",t[t.language=8]="language",t[t.tour_exit=16]="tour_exit",t[t.help=32]="help"}(n||(n={}));class r extends s.Ay{constructor(){super(...arguments),this.ins=this.addInputs(r.ins),this.outs=this.addOutputs(r.outs)}update(t){return!0}fromData(t){t=t||{},this.ins.setValues({visible:void 0===t.visible||t.visible,logo:void 0===t.logo||t.logo,menu:void 0===t.menu||t.menu,tools:void 0===t.tools||t.tools})}toData(){const t=this.ins;return{visible:t.visible.value,logo:t.logo.value,menu:t.menu.value,tools:t.tools.value}}isShowing(t){return(t&this.ins.visibleElements.value)===t}}r.typeName="CVInterface",r.ins={visible:s.gK.Boolean("Interface.Visible",!0),logo:s.gK.Boolean("Interface.Logo",!0),menu:s.gK.Boolean("Interface.Menu",!0),tools:s.gK.Boolean("Interface.Tools",!0),visibleElements:s.gK.Number("Interface.VisibleElements",63)},r.outs={documentTitle:s.gK.String("Document.Title")}},5068:t=>{"use strict";var e=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===i}(t)}(t)};var i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(t,e){return!1!==e.clone&&e.isMergeableObject(t)?l((i=t,Array.isArray(i)?[]:{}),t,e):t;var i}function s(t,e,i){return t.concat(e).map(function(t){return n(t,i)})}function r(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return t.propertyIsEnumerable(e)}):[]}(t))}function o(t,e){try{return e in t}catch(t){return!1}}function a(t,e,i){var s={};return i.isMergeableObject(t)&&r(t).forEach(function(e){s[e]=n(t[e],i)}),r(e).forEach(function(r){(function(t,e){return o(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,r)||(o(t,r)&&i.isMergeableObject(e[r])?s[r]=function(t,e){if(!e.customMerge)return l;var i=e.customMerge(t);return"function"==typeof i?i:l}(r,i)(t[r],e[r],i):s[r]=n(e[r],i))}),s}function l(t,i,r){(r=r||{}).arrayMerge=r.arrayMerge||s,r.isMergeableObject=r.isMergeableObject||e,r.cloneUnlessOtherwiseSpecified=n;var o=Array.isArray(i);return o===Array.isArray(t)?o?r.arrayMerge(t,i,r):a(t,i,r):n(i,r)}l.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,i){return l(t,i,e)},{})};var c=l;t.exports=c},5092:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(2420),s=i(6552),r=i(6262),o=i(7776),a=i(1469),l=[n.default,s.default,(0,r.default)(),o.default,a.metadataVocabulary,a.contentVocabulary];e.default=l},5240:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var n=i(3627),s=i(0),r=i(3423),o=i(1860),a=i(4424),l=i(3331);class c{constructor(t,e){this._args=t,this._props=e,this._args=t,this._state=null}get name(){return this._props.name||this._props.do.name.replace(/([A-Z])/g," $1").replace(/^./,t=>t.toUpperCase())}do(){if(this._state)throw new Error("undo should be called before execute can be applied again");this._state=this._props.do.apply(this._props.target,this._args)}undo(){if(!this._props.undo)throw new Error("can't undo this command");if(!this._state)throw new Error("execute should be called before undo can be applied");this._props.undo.call(this._props.target,this._state),this._state=null}canDo(){return!this._props.canDo||this._props.canDo()}canUndo(){return!!this._props.undo}}class h extends l.A{constructor(t){super(),this.addEvent("update"),this.stack=[],this.pointer=-1,this.capacity=void 0!==t?t:h.defaultCapacity}register(t){let e;e="function"==typeof t?t:e=>new c(e,t);return(...t)=>{const i=e(t);this.do(i)}}setCapacity(t){for(this.capacity=t;this.stack.length>t;)this.stack.shift(),this.pointer--;this.pointer<0&&(this.stack=[],this.pointer=-1)}do(t){console.log(`Commander.do - '${t.name}'`),t.do(),t.canUndo()&&(this.stack.splice(this.pointer+1),this.stack.push(t),this.stack.length>this.capacity&&this.stack.shift(),this.pointer=this.stack.length-1,this.emit("update"))}undo(){if(this.pointer>=0){this.stack[this.pointer].undo(),this.pointer--,this.emit("update")}}redo(){if(this.pointer<this.stack.length-1){this.pointer++;this.stack[this.pointer].do(),this.emit("update")}}clear(){this.stack.length>0&&(this.stack=[],this.pointer=-1,this.emit("update"))}canUndo(){return this.pointer>=0}canRedo(){return this.pointer<this.stack.length-1}getUndoText(){return this.pointer>=0?"Undo "+this.stack[this.pointer].name:"Can't Undo"}getRedoText(){return this.pointer<this.stack.length-1?"Redo "+this.stack[this.pointer+1].name:"Can't Redo"}}h.defaultCapacity=30;class u extends r.Ay{createActions(t){return{}}}u.typeName="CController",u.isSystemSingleton=!0;class d extends u{getSelectedNode(t){return this.selectedNodes.get(t,!0)}getSelectedNodes(t){return this.selectedNodes.getArray(t)}getSelectedComponent(t){return this.selectedComponents.get(t,!0)}getSelectedComponents(t){return this.selectedComponents.getArray(t)}constructor(t,e){super(t,e),this.outs=this.addOutputs(d.selOuts),this.multiSelect=!1,this.exclusiveSelect=!0,this.selectedNodes=new n.A(o.A),this.selectedComponents=new n.A(r.Ay),this._activeGraph=null,this.addEvents("select-node","select-component","active-graph","update"),this.selectedNodes.on(o.A,t=>this.onSelectNode(t.object,t.add)),this.selectedComponents.on(r.Ay,t=>this.onSelectComponent(t.object,t.add)),this._activeGraph=this.system.graph}get activeGraph(){return this._activeGraph}set activeGraph(t){if(t!==this.activeGraph){this.clearSelection();const e=this._activeGraph;this._activeGraph=t,this.onActiveGraph(t),this.emit({type:"active-graph",previous:e,next:t})}}hasParentGraph(){return this._activeGraph&&this._activeGraph.parent}activateParentGraph(){this._activeGraph&&this._activeGraph.parent.graph&&(this.activeGraph=this._activeGraph.parent.graph)}hasChildGraph(){return this.selectedComponents.has(a.Ay)}activateChildGraph(){const t=this.selectedComponents.get(a.Ay,!0);t&&(this.activeGraph=t.innerGraph)}create(){super.create(),this.system.nodes.on(o.A,this.onSystemNode,this),this.system.components.on(r.Ay,this.onSystemComponent,this)}dispose(){this.system.nodes.off(o.A,this.onSystemNode,this),this.system.components.off(r.Ay,this.onSystemComponent,this),super.dispose()}createActions(t){return{selectNode:t.register({name:"Select Node",do:this.selectNode,target:this}),selectComponent:t.register({name:"Select Component",do:this.selectComponent,target:this}),clearSelection:t.register({name:"Clear Selection",do:this.clearSelection,target:this})}}nodeContainsSelectedComponent(t){const e=t.components.getArray();for(let t=0,i=e.length;t<i;++t)if(this.selectedComponents.contains(e[t]))return!0;return!1}selectNode(t,e=!1){this.activeGraph=t.graph;const i=this.selectedNodes,n=this.multiSelect&&e;t&&i.contains(t)?n&&i.remove(t):(this.exclusiveSelect&&this.selectedComponents.clear(),n||i.clear(),t&&i.add(t)),this.updateStats()}selectComponent(t,e=!1){this.activeGraph=t.graph;const i=this.selectedComponents,n=this.multiSelect&&e;t&&i.contains(t)?n&&i.remove(t):(this.exclusiveSelect&&this.selectedNodes.clear(),n||i.clear(),t&&i.add(t)),this.updateStats()}clearSelection(){this.selectedNodes.clear(),this.selectedComponents.clear(),this.updateStats()}onSelectNode(t,e){}onSelectComponent(t,e){}onActiveGraph(t){}onSystemNode(t){t.remove&&this.selectedNodes.contains(t.object)&&(this.selectedNodes.remove(t.object),this.updateStats())}onSystemComponent(t){t.remove&&this.selectedComponents.contains(t.object)&&(this.selectedComponents.remove(t.object),this.updateStats())}updateStats(){const t=this.outs;t.selNodeCount.setValue(this.selectedNodes.length),t.selComponentCount.setValue(this.selectedComponents.length)}}d.typeName="CSelection",d.selOuts={selNodeCount:s.gK.Integer("Selection.Nodes"),selComponentCount:s.gK.Integer("Selection.Components")}},5253:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:t})=>n.str`must match format "${t}"`,params:({schemaCode:t})=>n._`{format: ${t}}`},code(t,e){const{gen:i,data:s,$data:r,schema:o,schemaCode:a,it:l}=t,{opts:c,errSchemaPath:h,schemaEnv:u,self:d}=l;c.validateFormats&&(r?function(){const r=i.scopeValue("formats",{ref:d.formats,code:c.code.formats}),o=i.const("fDef",n._`${r}[${a}]`),l=i.let("fType"),h=i.let("format");i.if(n._`typeof ${o} == "object" && !(${o} instanceof RegExp)`,()=>i.assign(l,n._`${o}.type || "string"`).assign(h,n._`${o}.validate`),()=>i.assign(l,n._`"string"`).assign(h,o)),t.fail$data((0,n.or)(!1===c.strictSchema?n.nil:n._`${a} && !${h}`,function(){const t=u.$async?n._`(${o}.async ? await ${h}(${s}) : ${h}(${s}))`:n._`${h}(${s})`,i=n._`(typeof ${h} == "function" ? ${t} : ${h}.test(${s}))`;return n._`${h} && ${h} !== true && ${l} === ${e} && !${i}`}()))}():function(){const r=d.formats[o];if(!r)return void function(){if(!1===c.strictSchema)return void d.logger.warn(t());throw new Error(t());function t(){return`unknown format "${o}" ignored in schema at path "${h}"`}}();if(!0===r)return;const[a,l,p]=function(t){const e=t instanceof RegExp?(0,n.regexpCode)(t):c.code.formats?n._`${c.code.formats}${(0,n.getProperty)(o)}`:void 0,s=i.scopeValue("formats",{key:o,ref:t,code:e});if("object"==typeof t&&!(t instanceof RegExp))return[t.type||"string",t.validate,n._`${s}.validate`];return["string",t,s]}(r);a===e&&t.pass(function(){if("object"==typeof r&&!(r instanceof RegExp)&&r.async){if(!u.$async)throw new Error("async format in sync schema");return n._`await ${p}(${s})`}return"function"==typeof l?n._`${p}(${s})`:n._`${p}.test(${s})`}())}())}};e.default=s},5265:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const n=i(7988),s=i(8089);var r=i(7988);Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}});var o=i(8089);Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return o.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return o.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return o.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return o.varKinds}}),e.operators={GT:new n._Code(">"),GTE:new n._Code(">="),LT:new n._Code("<"),LTE:new n._Code("<="),EQ:new n._Code("==="),NEQ:new n._Code("!=="),NOT:new n._Code("!"),OR:new n._Code("||"),AND:new n._Code("&&"),ADD:new n._Code("+")};class a{optimizeNodes(){return this}optimizeNames(t,e){return this}}class l extends a{constructor(t,e,i){super(),this.varKind=t,this.name=e,this.rhs=i}render({es5:t,_n:e}){const i=t?s.varKinds.var:this.varKind,n=void 0===this.rhs?"":` = ${this.rhs}`;return`${i} ${this.name}${n};`+e}optimizeNames(t,e){if(t[this.name.str])return this.rhs&&(this.rhs=R(this.rhs,t,e)),this}get names(){return this.rhs instanceof n._CodeOrName?this.rhs.names:{}}}class c extends a{constructor(t,e,i){super(),this.lhs=t,this.rhs=e,this.sideEffects=i}render({_n:t}){return`${this.lhs} = ${this.rhs};`+t}optimizeNames(t,e){if(!(this.lhs instanceof n.Name)||t[this.lhs.str]||this.sideEffects)return this.rhs=R(this.rhs,t,e),this}get names(){return B(this.lhs instanceof n.Name?{}:{...this.lhs.names},this.rhs)}}class h extends c{constructor(t,e,i,n){super(t,i,n),this.op=e}render({_n:t}){return`${this.lhs} ${this.op}= ${this.rhs};`+t}}class u extends a{constructor(t){super(),this.label=t,this.names={}}render({_n:t}){return`${this.label}:`+t}}class d extends a{constructor(t){super(),this.label=t,this.names={}}render({_n:t}){return`break${this.label?` ${this.label}`:""};`+t}}class p extends a{constructor(t){super(),this.error=t}render({_n:t}){return`throw ${this.error};`+t}get names(){return this.error.names}}class f extends a{constructor(t){super(),this.code=t}render({_n:t}){return`${this.code};`+t}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(t,e){return this.code=R(this.code,t,e),this}get names(){return this.code instanceof n._CodeOrName?this.code.names:{}}}class g extends a{constructor(t=[]){super(),this.nodes=t}render(t){return this.nodes.reduce((e,i)=>e+i.render(t),"")}optimizeNodes(){const{nodes:t}=this;let e=t.length;for(;e--;){const i=t[e].optimizeNodes();Array.isArray(i)?t.splice(e,1,...i):i?t[e]=i:t.splice(e,1)}return t.length>0?this:void 0}optimizeNames(t,e){const{nodes:i}=this;let n=i.length;for(;n--;){const s=i[n];s.optimizeNames(t,e)||(P(t,s.names),i.splice(n,1))}return i.length>0?this:void 0}get names(){return this.nodes.reduce((t,e)=>T(t,e.names),{})}}class m extends g{render(t){return"{"+t._n+super.render(t)+"}"+t._n}}class A extends g{}class v extends m{}v.kind="else";class y extends m{constructor(t,e){super(e),this.condition=t}render(t){let e=`if(${this.condition})`+super.render(t);return this.else&&(e+="else "+this.else.render(t)),e}optimizeNodes(){super.optimizeNodes();const t=this.condition;if(!0===t)return this.nodes;let e=this.else;if(e){const t=e.optimizeNodes();e=this.else=Array.isArray(t)?new v(t):t}return e?!1===t?e instanceof y?e:e.nodes:this.nodes.length?this:new y(L(t),e instanceof y?[e]:e.nodes):!1!==t&&this.nodes.length?this:void 0}optimizeNames(t,e){var i;if(this.else=null===(i=this.else)||void 0===i?void 0:i.optimizeNames(t,e),super.optimizeNames(t,e)||this.else)return this.condition=R(this.condition,t,e),this}get names(){const t=super.names;return B(t,this.condition),this.else&&T(t,this.else.names),t}}y.kind="if";class b extends m{}b.kind="for";class _ extends b{constructor(t){super(),this.iteration=t}render(t){return`for(${this.iteration})`+super.render(t)}optimizeNames(t,e){if(super.optimizeNames(t,e))return this.iteration=R(this.iteration,t,e),this}get names(){return T(super.names,this.iteration.names)}}class x extends b{constructor(t,e,i,n){super(),this.varKind=t,this.name=e,this.from=i,this.to=n}render(t){const e=t.es5?s.varKinds.var:this.varKind,{name:i,from:n,to:r}=this;return`for(${e} ${i}=${n}; ${i}<${r}; ${i}++)`+super.render(t)}get names(){const t=B(super.names,this.from);return B(t,this.to)}}class w extends b{constructor(t,e,i,n){super(),this.loop=t,this.varKind=e,this.name=i,this.iterable=n}render(t){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(t)}optimizeNames(t,e){if(super.optimizeNames(t,e))return this.iterable=R(this.iterable,t,e),this}get names(){return T(super.names,this.iterable.names)}}class E extends m{constructor(t,e,i){super(),this.name=t,this.args=e,this.async=i}render(t){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(t)}}E.kind="func";class C extends g{render(t){return"return "+super.render(t)}}C.kind="return";class S extends m{render(t){let e="try"+super.render(t);return this.catch&&(e+=this.catch.render(t)),this.finally&&(e+=this.finally.render(t)),e}optimizeNodes(){var t,e;return super.optimizeNodes(),null===(t=this.catch)||void 0===t||t.optimizeNodes(),null===(e=this.finally)||void 0===e||e.optimizeNodes(),this}optimizeNames(t,e){var i,n;return super.optimizeNames(t,e),null===(i=this.catch)||void 0===i||i.optimizeNames(t,e),null===(n=this.finally)||void 0===n||n.optimizeNames(t,e),this}get names(){const t=super.names;return this.catch&&T(t,this.catch.names),this.finally&&T(t,this.finally.names),t}}class I extends m{constructor(t){super(),this.error=t}render(t){return`catch(${this.error})`+super.render(t)}}I.kind="catch";class M extends m{render(t){return"finally"+super.render(t)}}M.kind="finally";function T(t,e){for(const i in e)t[i]=(t[i]||0)+(e[i]||0);return t}function B(t,e){return e instanceof n._CodeOrName?T(t,e.names):t}function R(t,e,i){return t instanceof n.Name?r(t):(s=t)instanceof n._Code&&s._items.some(t=>t instanceof n.Name&&1===e[t.str]&&void 0!==i[t.str])?new n._Code(t._items.reduce((t,e)=>(e instanceof n.Name&&(e=r(e)),e instanceof n._Code?t.push(...e._items):t.push(e),t),[])):t;var s;function r(t){const n=i[t.str];return void 0===n||1!==e[t.str]?t:(delete e[t.str],n)}}function P(t,e){for(const i in e)t[i]=(t[i]||0)-(e[i]||0)}function L(t){return"boolean"==typeof t||"number"==typeof t||null===t?!t:n._`!${k(t)}`}e.CodeGen=class{constructor(t,e={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...e,_n:e.lines?"\n":""},this._extScope=t,this._scope=new s.Scope({parent:t}),this._nodes=[new A]}toString(){return this._root.render(this.opts)}name(t){return this._scope.name(t)}scopeName(t){return this._extScope.name(t)}scopeValue(t,e){const i=this._extScope.value(t,e);return(this._values[i.prefix]||(this._values[i.prefix]=new Set)).add(i),i}getScopeValue(t,e){return this._extScope.getValue(t,e)}scopeRefs(t){return this._extScope.scopeRefs(t,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(t,e,i,n){const s=this._scope.toName(e);return void 0!==i&&n&&(this._constants[s.str]=i),this._leafNode(new l(t,s,i)),s}const(t,e,i){return this._def(s.varKinds.const,t,e,i)}let(t,e,i){return this._def(s.varKinds.let,t,e,i)}var(t,e,i){return this._def(s.varKinds.var,t,e,i)}assign(t,e,i){return this._leafNode(new c(t,e,i))}add(t,i){return this._leafNode(new h(t,e.operators.ADD,i))}code(t){return"function"==typeof t?t():t!==n.nil&&this._leafNode(new f(t)),this}object(...t){const e=["{"];for(const[i,s]of t)e.length>1&&e.push(","),e.push(i),(i!==s||this.opts.es5)&&(e.push(":"),(0,n.addCodeArg)(e,s));return e.push("}"),new n._Code(e)}if(t,e,i){if(this._blockNode(new y(t)),e&&i)this.code(e).else().code(i).endIf();else if(e)this.code(e).endIf();else if(i)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(t){return this._elseNode(new y(t))}else(){return this._elseNode(new v)}endIf(){return this._endBlockNode(y,v)}_for(t,e){return this._blockNode(t),e&&this.code(e).endFor(),this}for(t,e){return this._for(new _(t),e)}forRange(t,e,i,n,r=(this.opts.es5?s.varKinds.var:s.varKinds.let)){const o=this._scope.toName(t);return this._for(new x(r,o,e,i),()=>n(o))}forOf(t,e,i,r=s.varKinds.const){const o=this._scope.toName(t);if(this.opts.es5){const t=e instanceof n.Name?e:this.var("_arr",e);return this.forRange("_i",0,n._`${t}.length`,e=>{this.var(o,n._`${t}[${e}]`),i(o)})}return this._for(new w("of",r,o,e),()=>i(o))}forIn(t,e,i,r=(this.opts.es5?s.varKinds.var:s.varKinds.const)){if(this.opts.ownProperties)return this.forOf(t,n._`Object.keys(${e})`,i);const o=this._scope.toName(t);return this._for(new w("in",r,o,e),()=>i(o))}endFor(){return this._endBlockNode(b)}label(t){return this._leafNode(new u(t))}break(t){return this._leafNode(new d(t))}return(t){const e=new C;if(this._blockNode(e),this.code(t),1!==e.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(C)}try(t,e,i){if(!e&&!i)throw new Error('CodeGen: "try" without "catch" and "finally"');const n=new S;if(this._blockNode(n),this.code(t),e){const t=this.name("e");this._currNode=n.catch=new I(t),e(t)}return i&&(this._currNode=n.finally=new M,this.code(i)),this._endBlockNode(I,M)}throw(t){return this._leafNode(new p(t))}block(t,e){return this._blockStarts.push(this._nodes.length),t&&this.code(t).endBlock(e),this}endBlock(t){const e=this._blockStarts.pop();if(void 0===e)throw new Error("CodeGen: not in self-balancing block");const i=this._nodes.length-e;if(i<0||void 0!==t&&i!==t)throw new Error(`CodeGen: wrong number of nodes: ${i} vs ${t} expected`);return this._nodes.length=e,this}func(t,e=n.nil,i,s){return this._blockNode(new E(t,e,i)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(E)}optimize(t=1){for(;t-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(t){return this._currNode.nodes.push(t),this}_blockNode(t){this._currNode.nodes.push(t),this._nodes.push(t)}_endBlockNode(t,e){const i=this._currNode;if(i instanceof t||e&&i instanceof e)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${e?`${t.kind}/${e.kind}`:t.kind}"`)}_elseNode(t){const e=this._currNode;if(!(e instanceof y))throw new Error('CodeGen: "else" without "if"');return this._currNode=e.else=t,this}get _root(){return this._nodes[0]}get _currNode(){const t=this._nodes;return t[t.length-1]}set _currNode(t){const e=this._nodes;e[e.length-1]=t}},e.not=L;const D=O(e.operators.AND);e.and=function(...t){return t.reduce(D)};const N=O(e.operators.OR);function O(t){return(e,i)=>e===n.nil?i:i===n.nil?e:n._`${k(e)} ${t} ${k(i)}`}function k(t){return t instanceof n.Name?t:n._`(${t})`}e.or=function(...t){return t.reduce(N)}},5277:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateKeywordUsage=e.validSchemaType=e.funcKeywordCode=e.macroKeywordCode=void 0;const n=i(5265),s=i(2363),r=i(6241),o=i(6280);function a(t){const{gen:e,data:i,it:s}=t;e.if(s.parentData,()=>e.assign(i,n._`${s.parentData}[${s.parentDataProperty}]`))}function l(t,e,i){if(void 0===i)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword","function"==typeof i?{ref:i}:{ref:i,code:(0,n.stringify)(i)})}e.macroKeywordCode=function(t,e){const{gen:i,keyword:s,schema:r,parentSchema:o,it:a}=t,c=e.macro.call(a.self,r,o,a),h=l(i,s,c);!1!==a.opts.validateSchema&&a.self.validateSchema(c,!0);const u=i.name("valid");t.subschema({schema:c,schemaPath:n.nil,errSchemaPath:`${a.errSchemaPath}/${s}`,topSchemaRef:h,compositeRule:!0},u),t.pass(u,()=>t.error(!0))},e.funcKeywordCode=function(t,e){var i;const{gen:c,keyword:h,schema:u,parentSchema:d,$data:p,it:f}=t;!function({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}(f,e);const g=!p&&e.compile?e.compile.call(f.self,u,d,f):e.validate,m=l(c,h,g),A=c.let("valid");function v(i=(e.async?n._`await `:n.nil)){const o=f.opts.passContext?s.default.this:s.default.self,a=!("compile"in e&&!p||!1===e.schema);c.assign(A,n._`${i}${(0,r.callValidateCode)(t,m,o,a)}`,e.modifying)}function y(t){var i;c.if((0,n.not)(null!==(i=e.valid)&&void 0!==i?i:A),t)}t.block$data(A,function(){if(!1===e.errors)v(),e.modifying&&a(t),y(()=>t.error());else{const i=e.async?function(){const t=c.let("ruleErrs",null);return c.try(()=>v(n._`await `),e=>c.assign(A,!1).if(n._`${e} instanceof ${f.ValidationError}`,()=>c.assign(t,n._`${e}.errors`),()=>c.throw(e))),t}():function(){const t=n._`${m}.errors`;return c.assign(t,null),v(n.nil),t}();e.modifying&&a(t),y(()=>function(t,e){const{gen:i}=t;i.if(n._`Array.isArray(${e})`,()=>{i.assign(s.default.vErrors,n._`${s.default.vErrors} === null ? ${e} : ${s.default.vErrors}.concat(${e})`).assign(s.default.errors,n._`${s.default.vErrors}.length`),(0,o.extendErrors)(t)},()=>t.error())}(t,i))}}),t.ok(null!==(i=e.valid)&&void 0!==i?i:A)},e.validSchemaType=function(t,e,i=!1){return!e.length||e.some(e=>"array"===e?Array.isArray(t):"object"===e?t&&"object"==typeof t&&!Array.isArray(t):typeof t==e||i&&void 0===t)},e.validateKeywordUsage=function({schema:t,opts:e,self:i,errSchemaPath:n},s,r){if(Array.isArray(s.keyword)?!s.keyword.includes(r):s.keyword!==r)throw new Error("ajv implementation error");const o=s.dependencies;if(null==o?void 0:o.some(e=>!Object.prototype.hasOwnProperty.call(t,e)))throw new Error(`parent schema must have dependencies of ${r}: ${o.join(",")}`);if(s.validateSchema){if(!s.validateSchema(t[r])){const t=`keyword "${r}" value is invalid at path "${n}": `+i.errorsText(s.validateSchema.errors);if("log"!==e.validateSchema)throw new Error(t);i.logger.error(t)}}}},5289:(t,e,i)=>{var n=i(9348),s="object"==typeof self&&self&&self.Object===Object&&self,r=n||s||Function("return this")();t.exports=r},5295:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.prevElementSibling=e.nextElementSibling=e.getName=e.hasAttrib=e.getAttributeValue=e.getSiblings=e.getParent=e.getChildren=void 0;var n=i(5724);function s(t){return(0,n.hasChildren)(t)?t.children:[]}function r(t){return t.parent||null}e.getChildren=s,e.getParent=r,e.getSiblings=function(t){var e=r(t);if(null!=e)return s(e);for(var i=[t],n=t.prev,o=t.next;null!=n;)i.unshift(n),n=n.prev;for(;null!=o;)i.push(o),o=o.next;return i},e.getAttributeValue=function(t,e){var i;return null===(i=t.attribs)||void 0===i?void 0:i[e]},e.hasAttrib=function(t,e){return null!=t.attribs&&Object.prototype.hasOwnProperty.call(t.attribs,e)&&null!=t.attribs[e]},e.getName=function(t){return t.name},e.nextElementSibling=function(t){for(var e=t.next;null!==e&&!(0,n.isTag)(e);)e=e.next;return e},e.prevElementSibling=function(t){for(var e=t.prev;null!==e&&!(0,n.isTag)(e);)e=e.prev;return e}},5324:()=>{},5362:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getElementsByTagType=e.getElementsByTagName=e.getElementById=e.getElements=e.testElement=void 0;var n=i(5724),s=i(1991),r={tag_name:function(t){return"function"==typeof t?function(e){return(0,n.isTag)(e)&&t(e.name)}:"*"===t?n.isTag:function(e){return(0,n.isTag)(e)&&e.name===t}},tag_type:function(t){return"function"==typeof t?function(e){return t(e.type)}:function(e){return e.type===t}},tag_contains:function(t){return"function"==typeof t?function(e){return(0,n.isText)(e)&&t(e.data)}:function(e){return(0,n.isText)(e)&&e.data===t}}};function o(t,e){return"function"==typeof e?function(i){return(0,n.isTag)(i)&&e(i.attribs[t])}:function(i){return(0,n.isTag)(i)&&i.attribs[t]===e}}function a(t,e){return function(i){return t(i)||e(i)}}function l(t){var e=Object.keys(t).map(function(e){var i=t[e];return Object.prototype.hasOwnProperty.call(r,e)?r[e](i):o(e,i)});return 0===e.length?null:e.reduce(a)}e.testElement=function(t,e){var i=l(t);return!i||i(e)},e.getElements=function(t,e,i,n){void 0===n&&(n=1/0);var r=l(t);return r?(0,s.filter)(r,e,i,n):[]},e.getElementById=function(t,e,i){return void 0===i&&(i=!0),Array.isArray(e)||(e=[e]),(0,s.findOne)(o("id",t),e,i)},e.getElementsByTagName=function(t,e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=1/0),(0,s.filter)(r.tag_name(t),e,i,n)},e.getElementsByTagType=function(t,e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=1/0),(0,s.filter)(r.tag_type(t),e,i,n)}},5370:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:t,schemaCode:e}){const i="maxProperties"===t?"more":"fewer";return n.str`must NOT have ${i} than ${e} items`},params:({schemaCode:t})=>n._`{limit: ${t}}`},code(t){const{keyword:e,data:i,schemaCode:s}=t,r="maxProperties"===e?n.operators.GT:n.operators.LT;t.fail$data(n._`Object.keys(${i}).length ${r} ${s}`)}};e.default=s},5391:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getSchemaRefs=e.resolveUrl=e.normalizeId=e._getFullPath=e.getFullPath=e.inlineRef=void 0;const n=i(3151),s=i(1365),r=i(7022),o=i(6335),a=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);e.inlineRef=function(t,e=!0){return"boolean"==typeof t||(!0===e?!c(t):!!e&&h(t)<=e)};const l=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function c(t){for(const e in t){if(l.has(e))return!0;const i=t[e];if(Array.isArray(i)&&i.some(c))return!0;if("object"==typeof i&&c(i))return!0}return!1}function h(t){let e=0;for(const i in t){if("$ref"===i)return 1/0;if(e++,!a.has(i)&&("object"==typeof t[i]&&(0,n.eachItem)(t[i],t=>e+=h(t)),e===1/0))return 1/0}return e}function u(t="",e){!1!==e&&(t=f(t));return d(o.parse(t))}function d(t){return o.serialize(t).split("#")[0]+"#"}e.getFullPath=u,e._getFullPath=d;const p=/#\/?$/;function f(t){return t?t.replace(p,""):""}e.normalizeId=f,e.resolveUrl=function(t,e){return e=f(e),o.resolve(t,e)};const g=/^[a-z_][-a-z0-9._]*$/i;e.getSchemaRefs=function(t,e){if("boolean"==typeof t)return{};const{schemaId:i}=this.opts,n=f(t[i]||e),a={"":n},l=u(n,!1),c={},h=new Set;return r(t,{allKeys:!0},(t,e,n,s)=>{if(void 0===s)return;const r=l+e;let u=a[s];function m(e){if(e=f(u?o.resolve(u,e):e),h.has(e))throw p(e);h.add(e);let i=this.refs[e];return"string"==typeof i&&(i=this.refs[i]),"object"==typeof i?d(t,i.schema,e):e!==f(r)&&("#"===e[0]?(d(t,c[e],e),c[e]=t):this.refs[e]=r),e}function A(t){if("string"==typeof t){if(!g.test(t))throw new Error(`invalid anchor "${t}"`);m.call(this,`#${t}`)}}"string"==typeof t[i]&&(u=m.call(this,t[i])),A.call(this,t.$anchor),A.call(this,t.$dynamicAnchor),a[e]=u}),c;function d(t,e,i){if(void 0!==e&&!s(t,e))throw p(i)}function p(t){return new Error(`reference "${t}" resolves to more than one schema`)}}},5532:(t,e,i)=>{"use strict";i.d(e,{Pq:()=>s,Ay:()=>o});var n=i(2704);class s{static makeZeros(){return new s(0,0,0)}static makeOnes(){return new s(1,1,1)}static makeUnitX(){return new s(1,0,0)}static makeUnitY(){return new s(0,1,0)}static makeUnitZ(){return new s(0,0,1)}static makeCopy(t){return new s(t.x,t.y,t.z)}static makeFromScalar(t){return new s(t,t,t)}static makeFromArray(t){return new s(t[0],t[1],t[2])}static toString(t){return`[${t.x}, ${t.y}, ${t.z}]`}constructor(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,e,i){return this.x=t,this.y=e,this.z=i,this}setFromScalar(t){return this.x=t,this.y=t,this.z=t,this}setFromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}setZeros(){return this.x=0,this.y=0,this.z=0,this}setOnes(){return this.x=1,this.y=1,this.z=1,this}setUnitX(){return this.x=1,this.y=0,this.z=0,this}setUnitY(){return this.x=0,this.y=1,this.z=0,this}setUnitZ(){return this.x=0,this.y=0,this.z=1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}mul(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}div(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}mulScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}divScalar(t){return this.x/=t,this.y/=t,this.z/=t,this}translate(t,e,i){return this.x+=t,this.y+=e,this.z+=i,this}rotateX(t){const e=Math.cos(t),i=Math.sin(t),n=this.y,s=this.z;return this.y=e*n-i*s,this.z=i*n+e*s,this}rotateY(t){const e=Math.cos(t),i=Math.sin(t),n=this.x,s=this.z;return this.x=e*n+i*s,this.z=-i*n+e*s,this}rotateZ(t){const e=Math.cos(t),i=Math.sin(t),n=this.x,s=this.y;return this.x=e*n-i*s,this.y=i*n+e*s,this}scale(t,e,i){return this.x*=t,this.y*=e,this.z*=i,this}invert(){return this.x=1/this.x,this.y=1/this.y,this.z=1/this.z,this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}normalize(){const t=1/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.x*=t,this.y*=t,this.z*=t,this}homogenize(){return this.x/=this.z,this.y/=this.z,this.z=1,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){const e=this.y*t.z-this.z*t.y,i=this.z*t.x-this.x*t.z,n=this.x*t.y-this.y*t.x;return this.x=e,this.y=i,this.z=n,this}length(){const t=this.x,e=this.y,i=this.z;return Math.sqrt(t*t+e*e+i*i)}lengthSquared(){const t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i}distanceTo(t){const e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return Math.sqrt(e*e+i*i+n*n)}min(){return this.x<this.y?this.x<this.z?this.x:this.z:this.y<this.z?this.y:this.z}max(){return this.x>this.y?this.x>this.z?this.x:this.z:this.y>this.z?this.y:this.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}clone(){return new s(this.x,this.y,this.z)}toArray(t,e){return t?(void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t):[this.x,this.y,this.z]}toVector2(t){return t?(t.x=this.x,t.y=this.y,t):new n.A(this.x,this.y)}toString(){return s.toString(this)}}s.zeros=new s(0,0,0),s.ones=new s(1,1,1),s.unitX=new s(1,0,0),s.unitY=new s(0,1,0),s.unitZ=new s(0,0,1);class r{static makeZeros(){return new r(0,0,0,0)}static makeOnes(){return new r(1,1,1,1)}static makeUnitX(){return new r(1,0,0,0)}static makeUnitY(){return new r(0,1,0,0)}static makeUnitZ(){return new r(0,0,1,0)}static makeUnitW(){return new r(0,0,0,1)}static makeCopy(t){return new r(t.x,t.y,t.z,t.w)}static makeFromScalar(t){return new r(t,t,t,t)}static makeFromArray(t){return new r(t[0],t[1],t[2],t[3])}static makeFromPosition(t){return new r(t.x,t.y,t.z,1)}static makeFromDirection(t){return new r(t.x,t.y,t.z,0)}static toString(t){return`[${t.x}, ${t.y}, ${t.z}, ${t.w}]`}constructor(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=void 0===n?1:n,this}setFromScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setFromArray(t,e=1){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}setPosition(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=1,this}setDirection(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=0,this}setZeros(){return this.x=0,this.y=0,this.z=0,this.w=0,this}setOnes(){return this.x=1,this.y=1,this.z=1,this.w=1,this}setUnitX(){return this.x=1,this.y=0,this.z=0,this.w=0,this}setUnitY(){return this.x=0,this.y=1,this.z=0,this.w=0,this}setUnitZ(){return this.x=0,this.y=0,this.z=1,this.w=0,this}setUnitW(){return this.x=0,this.y=0,this.z=0,this.w=1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}mul(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}div(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}normalize(){const t=1/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}homogenize(){return this.x/=this.w,this.y/=this.w,this.z/=this.w,this.w=1,this}project(t){const e=this.dot(t)/this.lengthSquared();return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}length(){const t=this.x,e=this.y,i=this.z,n=this.w;return Math.sqrt(t*t+e*e+i*i+n*n)}lengthSquared(){const t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n}isZero(){return 0===this.x&&0===this.y&&0===this.z&&0===this.w}clone(){return new r(this.x,this.y,this.z,this.w)}toArray(t,e){return t?(void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t):[this.x,this.y,this.z,this.w]}toVector3(t){return t?(t.x=this.x,t.y=this.y,t.z=this.z,t):new s(this.x,this.y,this.z)}toString(){return r.toString(this)}}r.zeros=new r(0,0,0,0),r.ones=new r(1,1,1,1),r.unitX=new r(1,0,0,0),r.unitY=new r(0,1,0,0),r.unitZ=new r(0,0,1,0),r.unitW=new r(0,0,0,1);class o{static fromString(t){return(new o).setString(t)}static fromArray(t){return new o(t)}constructor(t=0,e=0,i=0,n=1){t instanceof o?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):Array.isArray(t)?(this.x=t[0]||0,this.y=t[1]||0,this.z=t[2]||0,this.w=void 0!==t[3]?t[3]:1):"string"==typeof t?this.setString(t):(this.x=t,this.y=e,this.z=i,this.w=n)}get r(){return this.x}get g(){return this.y}get b(){return this.z}get a(){return this.w}set r(t){this.x=t}set g(t){this.y=t}set b(t){this.z=t}set a(t){this.w=t}get red(){return this.x}get green(){return this.y}get blue(){return this.z}get alpha(){return this.w}set red(t){this.x=t}set green(t){this.y=t}set blue(t){this.z=t}set alpha(t){this.w=t}get redByte(){return Math.floor(255*this.x)}get greenByte(){return Math.floor(255*this.y)}get blueByte(){return Math.floor(255*this.z)}get alphaByte(){return Math.floor(255*this.w)}set redByte(t){this.x=t/255}set greenByte(t){this.y=t/255}set blueByte(t){this.z=t/255}set alphaByte(t){this.w=t/255}inverseMultiply(t){return this.x=this.x*(1-t)+t,this.y=this.y*(1-t)+t,this.z=this.z*(1-t)+t,this}multiply(t){return this.x*=t,this.y*=t,this.z*=t,this}copy(t){this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w}clone(){return new o(this.x,this.y,this.z,this.w)}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=void 0===n?1:n,this}setBytes(t,e,i,n){return this.x=t/255,this.y=e/255,this.z=i/255,this.w=void 0===n?1:n/255,this}setUInt24RGB(t){return this.x=t>>16&255,this.y=t>>8&255,this.z=255&t,this.w=1,this}setUInt32RGBA(t){return this.x=t>>24&255,this.y=t>>16&255,this.z=t>>8&255,this.w=255&t,this.w=1,this}setRed(t){return this.x=t,this}setGreen(t){return this.y=t,this}setBlue(t){return this.z=t,this}setAlpha(t){return this.w=t,this}setRedByte(t){return this.x=t/255,this}setGreenByte(t){return this.y=t/255,this}setBlueByte(t){return this.z=t/255,this}setAlphaByte(t){return this.w=t/255,this}setHSV(t,e=1,i=1,n){"object"==typeof t&&(e=t.y,i=t.z,n=void 0!==t.w?t.w:n,t=t.x);const s=Math.floor(t/60),r=t/60-s,o=i*(1-e),a=i*(1-r*e),l=i*(1-(1-r)*e);let c,h,u;switch(s%6){case 0:c=i,h=l,u=o;break;case 1:c=a,h=i,u=o;break;case 2:c=o,h=i,u=l;break;case 3:c=o,h=a,u=i;break;case 4:c=l,h=o,u=i;break;case 5:c=i,h=o,u=a}return this.x=c,this.y=h,this.z=u,void 0!==n&&(this.w=n),this}setHSL(t,e=1,i=1,n){if("object"==typeof t&&(e=t.y,i=t.z,n=void 0!==t.w?t.w:n,t=t.x),0===e)this.x=this.y=this.z=i;else{function o(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}t/=360;var s=i<.5?i*(1+e):i+e-i*e,r=2*i-s;this.x=o(r,s,t+1/3),this.y=o(r,s,t),this.z=o(r,s,t-1/3)}return void 0!==n&&(this.w=n),this}fromArray(t){this.x=t[0]||0,this.y=t[1]||0,this.z=t[2]||0,this.w=void 0!==t[3]?t[3]:1}setString(t,e=1,i=!0){var n;t=t.trim().toLowerCase(),t=o.presets[t]||t;let s=null===(n=/^#?([0-9a-f]{3,8})$/i.exec(t))||void 0===n?void 0:n[1];if(s&&(3===s.length||4==s.length)){const t=1/15;return this.x=Number.parseInt(s.charAt(0),16)*t,this.y=Number.parseInt(s.charAt(1),16)*t,this.z=Number.parseInt(s.charAt(2),16)*t,this.w=4==s.length?Number.parseInt(s.charAt(3),16)*t:e,this}if(s&&(6===s.length||8==s.length)){const t=1/255;return this.x=Number.parseInt(s.substr(0,2),16)*t,this.y=Number.parseInt(s.substr(2,2),16)*t,this.z=Number.parseInt(s.substr(4,2),16)*t,this.w=8==s.length?Number.parseInt(s.substr(6,2),16)*t:e,this}if(0===t.indexOf("rgb")){let i=t.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);if(i){const t=1/255;return this.x=Number.parseInt(i[1])*t,this.y=Number.parseInt(i[2])*t,this.z=Number.parseInt(i[3])*t,this.w=e,this}if(i=t.match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+.*\d*)\s*\)$/i),i){const t=1/255;return this.x=Number.parseInt(i[1])*t,this.y=Number.parseInt(i[2])*t,this.z=Number.parseInt(i[3])*t,this.w=Number.parseFloat(i[4]),this}}if(0===t.indexOf("hsl")){let i=t.match(/(\d+(\.\d+)?)/g);return i&&this.setHSL(Number.parseFloat(i[0]),.01*Number.parseFloat(i[1]),.01*Number.parseFloat(i[2]),void 0!==i[3]?Number.parseFloat(i[3]):e),this}if(i)throw new RangeError("failed to parse color from string: "+t);return this}toUInt24RGB(){return Math.floor(255*this.x)<<16+Math.floor(255*this.y)<<8+Math.floor(255*this.z)}toUInt32RGBA(){return Math.floor(255*this.x)<<24+Math.floor(255*this.y)<<16+Math.floor(255*this.z)<<8+Math.floor(255*this.w)}toVector3(t){return t?(t.x=this.r,t.y=this.g,t.z=this.b,t):new s(this.r,this.g,this.b)}toVector4(t){return t?(t.x=this.r,t.y=this.g,t.z=this.b,t.w=this.a,t):new r(this.r,this.g,this.b,this.a)}toHSV(t){let e=this.x,i=this.y,n=this.z,r=Math.min(e,i,n),o=Math.max(e,i,n),a=o-r,l=0,c=0===o?0:a/o,h=o;return 0!==a&&(l=60*(e===o?(i-n)/a+(i<n?6:0):i===o?(n-e)/a+2:(e-i)/a+4)),t?(t.x=l,t.y=c,t.z=h,t):new s(l,c,h)}toHSL(t){let e=this.x,i=this.y,n=this.z,r=Math.min(e,i,n),o=Math.max(e,i,n),a=o-r,l=0,c=0,h=.5*(o+r);return 0!==a&&(c=h>.5?a/(2-o-r):a/(o+r),l=60*(e===o?(i-n)/a+(i<n?6:0):i===o?2+(n-e)/a:4+(e-i)/a)),t?(t.x=l,t.y=c,t.z=h,t):new s(l,c,h)}toRGBArray(t){return t?(t[0]=this.r,t[1]=this.g,t[2]=this.b,t):[this.r,this.g,this.b]}toRGBAArray(t){return t?(t[0]=this.r,t[1]=this.g,t[2]=this.b,t[3]=this.a,t):[this.r,this.g,this.b,this.a]}toString(t){let e=[this.redByte,this.greenByte,this.blueByte];return(t||void 0===t&&this.w<1)&&e.push(this.alphaByte),"#"+e.map(t=>t.toString(16).padStart(2,"0")).join("")}}o.presets={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},5590:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var n=i(4640),s=i(3423),r=i(2464);class o extends r.A{constructor(t,e){super(t,e),this.ins=this.addInputs(o.dirLightIns),this.object3D=new n.ZyN,this.light.target.matrixAutoUpdate=!1}get light(){return this.object3D}update(t){super.update(t);const e=this.light,i=this.ins;if((i.color.changed||i.intensity.changed)&&(e.intensity=i.intensity.value*Math.PI),(i.position.changed||i.target.changed)&&(e.position.fromArray(i.position.value),e.target.position.fromArray(i.target.value),e.updateMatrix(),e.target.updateMatrix()),i.shadowSize.changed){const t=e.shadow.camera,n=.5*i.shadowSize.value;t.left=t.bottom=-n,t.right=t.top=n,t.near=.05*i.shadowSize.value,t.far=50*i.shadowSize.value,t.updateProjectionMatrix()}return!0}onAddToParent(t){super.onAddToParent(t),t.add(this.light.target)}onRemoveFromParent(t){super.onRemoveFromParent(t),t.remove(this.light.target)}}o.typeName="CDirectionalLight",o.dirLightIns={position:s.gK.Vector3("Light.Position"),target:s.gK.Vector3("Light.Target",[0,-1,0]),shadowSize:s.gK.Number("Shadow.Size",{preset:100,min:0})}},5623:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var n=i(2464),s=i(6389);class r extends n.A{constructor(){super(...arguments),this.canDelete=!1,this.environment=null}get settingProperties(){return[this.ins.enabled,this.ins.intensity]}create(){super.create(),this.environment=this.getGraphComponent(s.A);const t=this.environment.ins;t.intensity.linkFrom(this.ins.intensity),t.enabled.linkFrom(this.ins.enabled),this.node.name="Environment",this.ins.name.setValue("Environment"),this.node.transform.addTag("no_settings")}update(){return this.ins.enabled.changed&&this.node.emit({type:"change",what:"enabled",node:this.node}),!0}dispose(){super.dispose()}fromDocument(t,e){if(!isFinite(e.light))throw new Error("light property missing in node");const i=t.lights[e.light],n=this.ins;if(i.type!==r.type)throw new Error("light type mismatch: not an environment light");return i.point=i.point||{},n.copyValues({enabled:void 0!==i.enabled?i.enabled:n.enabled.schema.preset,intensity:void 0!==i.intensity?i.intensity:n.intensity.schema.preset}),e.light}toDocument(t,e){const i=this.ins,n={enabled:i.enabled.value,intensity:i.intensity.value};n.type=r.type,t.lights=t.lights||[];const s=t.lights.length;return t.lights.push(n),s}}r.typeName="CVEnvironmentLight",r.type="environment",r.text="Environment Light",r.icon="globe"},5624:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var n=i(3331);class s extends n.A{constructor(){super(),this._dict={},this.addEvent("type")}add(t){if(Array.isArray(t))return void t.forEach(t=>this.add(t));const e=t.typeName;if(!e)throw new Error("type must have a 'typeName' member");if(this._dict[e])throw new Error(`type '${e}' already registered`);this._dict[e]=t,this.emit({type:"type",add:!0,remove:!1,classType:t})}remove(t){if(Array.isArray(t))return void t.forEach(t=>this.remove(t));const e=t.typeName;if(!e)throw new Error("type must have a 'typeName' member");if(!this._dict[e])throw new Error(`type '${e}' not registered`);delete this._dict[e],this.emit({type:"type",add:!1,remove:!0,classType:t})}getType(t){let e=t;return"function"==typeof t?e=t.typeName:"object"==typeof t&&(e=t.constructor.typeName),this._dict[e]}createInstance(t,...e){const i=this.getType(t);if(!i)throw new Error(`type '${t}' not registered`);return new i(...e)}}},5626:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateTuple=void 0;const n=i(5265),s=i(3151),r=i(6241),o={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){const{schema:e,it:i}=t;if(Array.isArray(e))return a(t,"additionalItems",e);i.items=!0,(0,s.alwaysValidSchema)(i,e)||t.ok((0,r.validateArray)(t))}};function a(t,e,i=t.schema){const{gen:r,parentSchema:o,data:a,keyword:l,it:c}=t;!function(t){const{opts:n,errSchemaPath:r}=c,o=i.length,a=o===t.minItems&&(o===t.maxItems||!1===t[e]);if(n.strictTuples&&!a){const t=`"${l}" is ${o}-tuple, but minItems or maxItems/${e} are not specified or different at path "${r}"`;(0,s.checkStrictMode)(c,t,n.strictTuples)}}(o),c.opts.unevaluated&&i.length&&!0!==c.items&&(c.items=s.mergeEvaluated.items(r,i.length,c.items));const h=r.name("valid"),u=r.const("len",n._`${a}.length`);i.forEach((e,i)=>{(0,s.alwaysValidSchema)(c,e)||(r.if(n._`${u} > ${i}`,()=>t.subschema({keyword:l,schemaProp:i,dataProp:i},h)),t.ok(h))})}e.validateTuple=a,e.default=o},5632:(t,e,i)=>{"use strict";var n=i(8337),s=i(5532),r=(i(8428),i(8738)),o=i(2704),a=i(6763),l=i(7280),c=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let h=class extends a.Ay{constructor(){super(),this.value=new o.A,this._offsetX=0,this._offsetY=0,this._knob=(new a.Ay).addClass("ff-knob").setStyle({display:"block",position:"relative "}),new l.A(this)}setXY(t,e){this.value.set(t,e),this.requestUpdate()}dragStart(t){const e=this._knob,i=this.getBoundingClientRect();t.target===this._knob?(this._offsetX=t.clientX-e.offsetLeft+.5*(e.clientWidth-e.offsetWidth),this._offsetY=t.clientY-e.offsetTop+.5*(e.clientHeight-e.offsetHeight)):(this._offsetX=i.left+.8*e.clientWidth,this._offsetY=i.top+.8*e.clientHeight),this.dragMove(t)}dragMove(t){const e=this._knob,i=t.clientX-this._offsetX,s=t.clientY-this._offsetY;let r=i/(this.clientWidth-e.clientWidth);r=n.A.limit(r,0,1);let o=1-s/(this.clientHeight-e.clientHeight);o=n.A.limit(o,0,1),r===this.value.x&&o===this.value.y||(this.value=this.value.set(r,o),this.emitChangeEvent(!0))}dragEnd(){this.emitChangeEvent(!1)}firstConnected(){this.setStyle({position:"relative",touchAction:"none"}),this.setAttribute("touch-action","none"),this.setAttribute("tabindex","0"),this.classList.add("ff-control","ff-vector-slider"),this.appendChild(this._knob)}update(t){const e=100*this.value.x,i=100*(1-this.value.y);this._knob.style.left=`${e.toFixed(3)}%`,this._knob.style.top=`${i.toFixed(3)}%`,super.update(t)}emitChangeEvent(t){this.dispatchEvent(new CustomEvent("change",{detail:{value:this.value,isDragging:t},bubbles:!0}))}};c([(0,a.MZ)({attribute:!1})],h.prototype,"value",void 0),h=c([(0,a.EM)("ff-vector-slider")],h);const u=h;var d=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};const p=new s.Ay;let f=class extends a.Ay{constructor(){super(),this.color=new s.Ay,this.alpha=!1,this.numeric=!1,this.onLumSatChange=this.onLumSatChange.bind(this),this.onHueChange=this.onHueChange.bind(this),this.onAlphaChange=this.onAlphaChange.bind(this),this.addEventListener("click",t=>t.stopPropagation()),this._hsv=new s.Pq,this._lumSatSlider=(new u).on("change",this.onLumSatChange),this._hueSlider=(new r.A).addClass("ff-hue-slider").on("change",this.onHueChange),this._hueSlider.direction="vertical"}firstConnected(){this.classList.add("ff-flex-column","ff-control","ff-color-edit")}update(t){t.has("color")&&this.color.toHSV(this._hsv),t.has("alpha")&&(this.alpha&&!this._alphaSlider?(this._alphaSlider=(new r.A).addClass("ff-alpha-slider").on("change",this.onAlphaChange),this._alphaSlider.direction="vertical"):!this.alpha&&this._alphaSlider&&this._alphaSlider.remove()),super.update(t)}render(){let t=null;if(this.numeric){const e=this.color,i=e.toString(!1).substr(1),n=this.alpha?a.qy`
                <div class="ff-text">A</div><ff-line-edit name="alphaByte" text=${e.alphaByte} align="center" @change=${this.onNumericEdit}></ff-line-edit>
            `:null;t=a.qy`<div class="ff-flex-row ff-numeric-controls">
                <div class="ff-text">R</div><ff-line-edit name="redByte" text=${e.redByte} align="center" @change=${this.onNumericEdit}></ff-line-edit>
                <div class="ff-text">G</div><ff-line-edit name="greenByte" text=${e.greenByte} align="center" @change=${this.onNumericEdit}></ff-line-edit>
                <div class="ff-text">B</div><ff-line-edit name="blueByte" text=${e.blueByte} align="center" @change=${this.onNumericEdit}></ff-line-edit>
                ${n}
                <div class="ff-text">#</div><ff-line-edit name="string" text=${i} class="ff-wide" align="center" @change=${this.onNumericEdit}></ff-line-edit>
            </div>`}return a.qy`<div class="ff-flex-row ff-slider-controls" role="application" @keydown=${this.onKeyDown}>
                ${this._lumSatSlider}${this._hueSlider}${this._alphaSlider}
            </div>${t}`}updated(){this._hueSlider.value=1-this._hsv.x/360;const t=`linear-gradient(to bottom, transparent, black), linear-gradient(to right, white, ${p.setHSV(this._hsv.x).toString(!1)})`;if(this._lumSatSlider.style.backgroundImage=t,this._lumSatSlider.setXY(this._hsv.y,this._hsv.z),this.alpha){const t=this.color.toString(!1),e=getComputedStyle(this._alphaSlider).color,i=`linear-gradient(to top, transparent, ${t}), repeating-linear-gradient(-45deg, transparent, transparent 8px, ${e} 8px, ${e} 16px)`;this._alphaSlider.style.backgroundImage=i,this._alphaSlider.value=this.color.alpha}}onLumSatChange(t){t.stopPropagation();const e=t.detail.value;this._hsv.y=e.x,this._hsv.z=e.y,this.color.setHSV(this._hsv),this.requestUpdate(),this.emitChangeEvent(t.detail.isDragging)}onHueChange(t){t.stopPropagation(),this._hsv.x=360*(1-t.target.value),this.color.setHSV(this._hsv),this.requestUpdate(),this.emitChangeEvent(t.detail.isDragging)}onAlphaChange(t){t.stopPropagation(),this.color.alpha=t.target.value,this.requestUpdate(),this.emitChangeEvent(t.detail.isDragging)}onNumericEdit(t){t.stopPropagation();const e=t.target.name;if("string"===e)this.color.setString(t.detail.text,1,!1);else{let i=parseInt(t.detail.text);if(!isFinite(i))return;this.color[e]=n.A.limit(i,0,255)}this.color.toHSV(this._hsv),this.requestUpdate(),this.emitChangeEvent(t.detail.isEditing)}onKeyDown(t){const e="ArrowRight"===t.code||"ArrowUp"===t.code,i="PageUp"===t.code,s="ArrowLeft"===t.code||"ArrowDown"===t.code,r="PageDown"===t.code;if(e||i||s||r)if(t.target===this._hueSlider||t.target===this._alphaSlider){const r=e||i?-1:1,o=e||s?.01:.1;t.target===this._hueSlider?(this._hsv.x=n.A.limit(this._hsv.x+360*o*r,0,360),this.color.setHSV(this._hsv)):this.color.alpha=n.A.limit(this.color.alpha+o*r,0,1),this.requestUpdate(),this.emitChangeEvent(!1)}else if(t.target===this._lumSatSlider&&(e||s)){const i=e?1:-1,s=t.shiftKey?.1:.01;"ArrowRight"===t.code||"ArrowLeft"===t.code?this._hsv.y=n.A.limit(this._hsv.y+s*i,0,1):this._hsv.z=n.A.limit(this._hsv.z+s*i,0,1),this.color.setHSV(this._hsv),this.requestUpdate(),this.emitChangeEvent(!1)}}emitChangeEvent(t){this.dispatchEvent(new CustomEvent("change",{detail:{color:this.color,isDragging:t},bubbles:!0}))}};d([(0,a.MZ)({attribute:!1})],f.prototype,"color",void 0),d([(0,a.MZ)({type:Boolean})],f.prototype,"alpha",void 0),d([(0,a.MZ)({type:Boolean})],f.prototype,"numeric",void 0),f=d([(0,a.EM)("ff-color-edit")],f)},5659:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var n=i(3423),s=i(3675),r=i(4085),o=i(8604),a=i(9337),l=i(1721);class c extends n.Ay{constructor(){super(...arguments),this.ins=this.addInputs(c.ins),this.outs=this.addOutputs(c.outs),this._tours=[]}get analytics(){return this.getMainComponent(o.A)}get language(){return this.getGraphComponent(a.A)}get setup(){return this.getGraphComponent(l.A)}get snapshots(){return this.getComponent(r.A)}get tours(){return this._tours}get activeSteps(){const t=this.activeTour;return t?t.steps:null}get activeTour(){return this._tours[this.outs.tourIndex.value]}get activeStep(){const t=this.activeTour;return t?t.steps[this.outs.stepIndex.value]:null}get title(){const t=this.activeTour;return 0===Object.keys(t.titles).length&&(t.titles[s.Nm]=t.title),t.titles[s.aL[this.language.outs.activeLanguage.value]]||"Missing content"}set title(t){this.activeTour.titles[s.aL[this.language.outs.activeLanguage.value]]=t}get lead(){const t=this.activeTour;return 0===Object.keys(t.leads).length&&(t.leads[s.Nm]=t.lead),t.leads[s.aL[this.language.outs.activeLanguage.value]]||""}set lead(t){this.activeTour.leads[s.aL[this.language.outs.activeLanguage.value]]=t}get taglist(){const t=this.activeTour;return 0===Object.keys(t.taglist).length&&t.tags.length>0&&(t.taglist[s.Nm]=t.tags),t.taglist[s.aL[this.language.outs.activeLanguage.value]]||[]}set taglist(t){this.activeTour.taglist[s.aL[this.language.outs.activeLanguage.value]]=t}get stepTitle(){const t=this.activeStep;return t?(0===Object.keys(t.titles).length&&(t.titles[s.Nm]=t.title),t.titles[s.aL[this.language.outs.activeLanguage.value]]||"Missing content"):null}set stepTitle(t){const e=this.activeStep;e&&(e.titles[s.aL[this.language.outs.activeLanguage.value]]=t)}get stepAltText(){const t=this.activeStep;return t?t.altTexts[s.aL[this.language.outs.activeLanguage.value]]||"Missing content":null}set stepAltText(t){const e=this.activeStep;e&&(e.altTexts[s.aL[this.language.outs.activeLanguage.value]]=t)}create(){super.create(),this.language.outs.activeLanguage.on("value",this.update,this)}dispose(){this.language.outs.activeLanguage.off("value",this.update,this),super.dispose()}update(t){const{ins:e,outs:i}=this,n=this._tours,s=this.snapshots,o=this.setup.navigation,a=this.setup.viewer.rootElement.shadowRoot.querySelector("#sceneview-sr");if(e.enabled.changed){if(!e.enabled.value)return i.tourIndex.set(),this.normalizeViewOrbit(c.sceneSnapshotId),s.tweenTo(c.sceneSnapshotId,t.secondsElapsed),s.deleteState(c.sceneSnapshotId),a.textContent="",!0;{const t={id:c.sceneSnapshotId,curve:r.k.EaseOutQuad,duration:1,threshold:0,values:s.getCurrentValues()};s.setState(t)}}const l=Math.min(n.length-1,Math.max(-1,e.tourIndex.value)),h=n[l],u=h?h.steps.length:0;i.stepCount.setValue(u);let d=-1;if((e.tourIndex.changed||e.enabled.changed)&&(l!==i.tourIndex.value&&(d=0),i.tourIndex.setValue(l),i.tourTitle.setValue(h?this.title:""),i.tourLead.setValue(h?this.lead:"")),0===u)return i.stepIndex.setValue(-1),i.stepTitle.setValue(""),!0;let p=!0;if(e.enabled.changed&&(d=i.stepIndex.value),e.stepIndex.changed&&(d=Math.min(h.steps.length-1,Math.max(0,e.stepIndex.value)),p=!1),e.first.changed&&(d=0),e.next.changed&&(d=i.stepIndex.value+1,d>=u&&(i.ending.setValue(!0),i.tourIndex.setValue(-1),i.tourTitle.setValue(""),i.tourLead.setValue(""),i.stepIndex.set(),d=-1,a.textContent="")),e.previous.changed&&(d=(i.stepIndex.value+u-1)%u),0===d&&this.normalizeViewOrbit(h.steps[0].id),d>=0){o.setChanged(!0);const t=h.steps[d];i.stepIndex.setValue(d),i.stepTitle.setValue(this.stepTitle||"Missing content"),s.ins.id.setValue(t.id),p?s.ins.tween.set():s.ins.recall.set(),a.textContent="Missing content"!=this.stepAltText?"Alt text: "+this.stepAltText:""}return!0}fromData(t){this._tours=t.map(t=>({title:t.title,titles:t.titles||{},steps:t.steps.map(t=>({title:t.title,titles:t.titles||{},altTexts:t.altTexts||{},id:t.id})),lead:t.lead||"",leads:t.leads||{},tags:t.tags||[],taglist:t.taglist||{}})),this._tours.forEach(t=>{Object.keys(t.titles).forEach(t=>{this.language.addLanguage(s.aL[t])}),t.steps.forEach(t=>{0==Object.keys(t.titles).length&&(t.titles[s.Nm]=t.title||null)})}),this.ins.tourIndex.setValue(-1),this.outs.count.setValue(this._tours.length)}toData(){return 0===this._tours.length?null:this._tours.map(t=>{const e={steps:t.steps.map(t=>{const e={};return e.id=t.id,Object.keys(t.titles).length>0?e.titles=t.titles:t.title&&(e.title=t.title),Object.keys(t.altTexts).length>0&&(e.altTexts=t.altTexts),e})};return Object.keys(t.titles).length>0?e.titles=t.titles:t.title&&(e.title=t.title),Object.keys(t.leads).length>0?e.leads=t.leads:t.lead&&(e.lead=t.lead),Object.keys(t.taglist).length>0?e.taglist=t.taglist:t.tags.length>0&&(e.tags=t.tags),e})}normalizeViewOrbit(t){const e=this.snapshots.getTargetProperties().findIndex(t=>"Orbit"==t.name),i=this.snapshots.getState(t),n=this.snapshots.getCurrentValues()[e];i&&n.forEach((t,n)=>{const s=Math.round((i.values[e][n]-t)/360);this.snapshots.getTargetProperties()[e].value[n]+=360*s})}}c.typeName="CVTours",c.sceneSnapshotId="scene-default",c.ins={enabled:n.gK.Boolean("Tours.Enabled"),tourIndex:n.gK.Integer("Tours.Index",-1),closed:n.gK.Event("Tours.Closed"),stepIndex:n.gK.Integer("Step.Index"),next:n.gK.Event("Step.Next"),previous:n.gK.Event("Step.Previous"),first:n.gK.Event("Step.First")},c.outs={count:n.gK.Integer("Tours.Count"),tourIndex:n.gK.Integer("Tour.Index",-1),tourTitle:n.gK.String("Tour.Title"),tourLead:n.gK.String("Tour.Lead"),stepCount:n.gK.Integer("Tour.Steps"),ending:n.gK.Boolean("Tour.Ending"),stepIndex:n.gK.Integer("Step.Index"),stepTitle:n.gK.String("Step.Title")}},5676:(t,e,i)=>{"use strict";i.d(e,{$R:()=>d,Ay:()=>f,Gz:()=>p});var n=i(4640),s=i(8337);const r=.5*Math.PI,o=new n.NRn,a=new n.Pq0,l=new n.Pq0,c=new n.Pq0,h=new n.kn4,u=(new n.kn4,[new n.Pq0(0,-r,0),new n.Pq0(0,r,0),new n.Pq0(-r,0,0),new n.Pq0(r,0,0),new n.Pq0(0,0,0),new n.Pq0(0,Math.PI,0)]);var d,p;!function(t){t[t.Perspective=0]="Perspective",t[t.Orthographic=1]="Orthographic"}(d||(d={})),function(t){t[t.None=-1]="None",t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Top=2]="Top",t[t.Bottom=3]="Bottom",t[t.Front=4]="Front",t[t.Back=5]="Back"}(p||(p={}));class f extends n.i7d{constructor(t){super(),this.isUniversalCamera=!0,this.fov=50,this.size=20,this.aspect=1,this.distance=20,this.zoom=1,this.near=.1,this.far=2e3,this.focus=10,this.filmGauge=35,this.filmOffset=0,this.view=null,this.setProjection(t)}setProjection(t){t===d.Orthographic?(this.type="OrthographicCamera",this.isPerspectiveCamera=!1,this.isOrthographicCamera=!0):(this.type="PerspectiveCamera",this.isPerspectiveCamera=!0,this.isOrthographicCamera=!1),this.updateProjectionMatrix()}getProjection(){return this.isOrthographicCamera?d.Orthographic:d.Perspective}setPreset(t){t!==p.None?(this.rotation.setFromVector3(u[t],"XYZ"),this.position.set(0,0,this.distance).applyQuaternion(this.quaternion)):(this.rotation.set(0,0,0),this.position.set(0,0,0)),this.updateMatrix()}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*n.cj9.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*n.cj9.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*n.cj9.RAD2DEG*Math.atan(Math.tan(.5*n.cj9.DEG2RAD*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,i,s,r,o){this.isPerspectiveCamera?n.ubm.prototype.setViewOffset.call(this,t,e,i,s,r,o):n.qUd.prototype.setViewOffset.call(this,t,e,i,s,r,o)}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}zoomToView(){}moveToView(t){this.updateMatrixWorld(!1),o.copy(t),h.extractRotation(this.matrixWorldInverse),o.applyMatrix4(h),o.getSize(a),o.getCenter(l);const e=Math.max(a.x/this.aspect,a.y);c.set(-l.x,-l.y,0),this.isPerspectiveCamera?c.z=a.z/(2*Math.tan(this.fov*s.A.DEG2RAD*.5)):(this.size=.5*e,c.z=2*a.z,this.far=Math.max(this.far,2*c.z)),h.extractRotation(this.matrixWorld),c.applyMatrix4(h),this.matrix.decompose(this.position,this.quaternion,this.scale),this.position.copy(c),this.updateMatrix()}updateProjectionMatrix(){const t=this.near,e=this.far,i=this.aspect,s=this.zoom,r=this.view;if(this.isOrthographicCamera){const n=this.size,o=n/(2*s),a=o*i;let l=-a,c=a,h=o,u=-o;if(r&&r.enabled){const t=s/(r.width/r.fullWidth),e=s/(r.height/r.fullHeight),o=n*i/r.width,a=n/r.height;l+=o*(r.offsetX/t),c=l+o*(r.width/t),h-=a*(r.offsetY/e),u=h-a*(r.height/e)}this.projectionMatrix.makeOrthographic(l,c,h,u,t,e)}else{let a=t*Math.tan(.5*n.cj9.DEG2RAD*this.fov)/s,l=2*a,c=i*l,h=-.5*c;r&&r.enabled&&(h+=r.offsetX*c/r.fullWidth,a-=r.offsetY*l/r.fullHeight,c*=r.width/r.fullWidth,l*=r.height/r.fullHeight);var o=this.filmOffset;0!==o&&(h+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(h,h+c,a,a-l,t,e)}this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}copy(t,e){return super.copy(t,e),this.type=t.type,this.isOrthographicCamera=t.isOrthographicCamera,this.isPerspectiveCamera=t.isPerspectiveCamera,this.fov=t.fov,this.size=t.size,this.aspect=t.aspect,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this.view=t.view?Object.assign({},t.view):null,this}clone(){return(new this.constructor).copy(this)}toJSON(t){const e=super.toJSON(t);return Object.assign(e.object,{fov:this.fov,size:this.size,aspect:this.aspect,zoom:this.zoom,near:this.near,far:this.far,focus:this.focus,filmGauge:this.filmGauge,filmOffset:this.filmOffset}),null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}},5713:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(2310),s=i(6241),r=i(3151),o=i(624),a={keyword:"properties",type:"object",schemaType:"object",code(t){const{gen:e,schema:i,parentSchema:a,data:l,it:c}=t;"all"===c.opts.removeAdditional&&void 0===a.additionalProperties&&o.default.code(new n.KeywordCxt(c,o.default,"additionalProperties"));const h=(0,s.allSchemaProperties)(i);for(const t of h)c.definedProperties.add(t);c.opts.unevaluated&&h.length&&!0!==c.props&&(c.props=r.mergeEvaluated.props(e,(0,r.toHash)(h),c.props));const u=h.filter(t=>!(0,r.alwaysValidSchema)(c,i[t]));if(0===u.length)return;const d=e.name("valid");for(const i of u)p(i)?f(i):(e.if((0,s.propertyInData)(e,l,i,c.opts.ownProperties)),f(i),c.allErrors||e.else().var(d,!0),e.endIf()),t.it.definedProperties.add(i),t.ok(d);function p(t){return c.opts.useDefaults&&!c.compositeRule&&void 0!==i[t].default}function f(e){t.subschema({keyword:"properties",schemaProp:e,dataProp:e},d)}}};e.default=a},5717:(t,e,i)=>{"use strict";i.d(e,{I:()=>r,q:()=>s});var n=i(4640);new n.Pq0(1,0,0);function s(t,e,i){return Math.min(Math.max(t,e),i)}function r(t,e){var i=new n.kn4,s=new n.kn4;i.identity();do{s.compose(e.position,e.quaternion,e.scale),i.multiply(s.invert()),e=e.parent}while(t!==e);return i}},5724:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.DomHandler=void 0;var r=i(2177),o=i(2426);s(i(2426),e);var a={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},l=function(){function t(t,e,i){this.dom=[],this.root=new o.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,"function"==typeof e&&(i=e,e=a),"object"==typeof t&&(e=t,t=void 0),this.callback=null!=t?t:null,this.options=null!=e?e:a,this.elementCB=null!=i?i:null}return t.prototype.onparserinit=function(t){this.parser=t},t.prototype.onreset=function(){this.dom=[],this.root=new o.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},t.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},t.prototype.onerror=function(t){this.handleCallback(t)},t.prototype.onclosetag=function(){this.lastNode=null;var t=this.tagStack.pop();this.options.withEndIndices&&(t.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(t)},t.prototype.onopentag=function(t,e){var i=this.options.xmlMode?r.ElementType.Tag:void 0,n=new o.Element(t,e,void 0,i);this.addNode(n),this.tagStack.push(n)},t.prototype.ontext=function(t){var e=this.lastNode;if(e&&e.type===r.ElementType.Text)e.data+=t,this.options.withEndIndices&&(e.endIndex=this.parser.endIndex);else{var i=new o.Text(t);this.addNode(i),this.lastNode=i}},t.prototype.oncomment=function(t){if(this.lastNode&&this.lastNode.type===r.ElementType.Comment)this.lastNode.data+=t;else{var e=new o.Comment(t);this.addNode(e),this.lastNode=e}},t.prototype.oncommentend=function(){this.lastNode=null},t.prototype.oncdatastart=function(){var t=new o.Text(""),e=new o.CDATA([t]);this.addNode(e),t.parent=e,this.lastNode=t},t.prototype.oncdataend=function(){this.lastNode=null},t.prototype.onprocessinginstruction=function(t,e){var i=new o.ProcessingInstruction(t,e);this.addNode(i)},t.prototype.handleCallback=function(t){if("function"==typeof this.callback)this.callback(t,this.dom);else if(t)throw t},t.prototype.addNode=function(t){var e=this.tagStack[this.tagStack.length-1],i=e.children[e.children.length-1];this.options.withStartIndices&&(t.startIndex=this.parser.startIndex),this.options.withEndIndices&&(t.endIndex=this.parser.endIndex),e.children.push(t),i&&(t.prev=i,i.next=t),t.parent=e,this.lastNode=null},t}();e.DomHandler=l,e.default=l},5852:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var n=i(7482);class s extends n.A{get settingProperties(){return[this.ins.name,this.ins.enabled,this.ins.color,this.ins.intensity]}get snapshotProperties(){return[this.ins.color,this.ins.intensity]}dispose(){super.dispose()}fromDocument(t,e){if(!isFinite(e.light))throw new Error("light property missing in node");const i=t.lights[e.light],n=this.ins;if(i.type!==s.type)throw new Error("light type mismatch: not an ambient light");return n.name.setValue(e.name),i.point=i.point||{},n.copyValues({enabled:void 0!==i.enabled?i.enabled:n.enabled.schema.preset,color:void 0!==i.color?i.color:n.color.schema.preset,intensity:void 0!==i.intensity?i.intensity:n.intensity.schema.preset}),e.light}toDocument(t,e){const i=this.ins,n={enabled:i.enabled.value,color:i.color.cloneValue(),intensity:i.intensity.value};n.type=s.type,t.lights=t.lights||[];const r=t.lights.length;return t.lights.push(n),r}}s.typeName="CVAmbientLight",s.type="ambient",s.text="Ambient Light",s.icon="globe"},5911:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.attributeNames=e.elementNames=void 0,e.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(function(t){return[t.toLowerCase(),t]})),e.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(function(t){return[t.toLowerCase(),t]}))},5933:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>r,EM:()=>n.EM,qy:()=>n.qy});i(9085);var n=i(6763),s=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};class r extends n.Ay{constructor(t){super(),this.system=t}}s([(0,n.MZ)({attribute:!1})],r.prototype,"system",void 0)},5940:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});const n=function(t,e){const i=document.createElement("a");i.download=e,i.href=t,document.body.appendChild(i),i.click(),document.body.removeChild(i)},s={text:function(t,e){const i=window.URL.createObjectURL(new Blob([t],{type:"text/plain"}));n(i,e)},json:function(t,e){"object"==typeof t&&(t=JSON.stringify(t));const i=window.URL.createObjectURL(new Blob([t],{type:"text/json"}));n(i,e)},url:function(t,e){n(t,e)}}},6187:(t,e,i)=>{"use strict";i.d(e,{Pf:()=>s,if:()=>r,o6:()=>n});const n="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,s=(t,e,i=null,n=null)=>{for(;e!==i;){const i=e.nextSibling;t.insertBefore(e,n),e=i}},r=(t,e,i=null)=>{for(;e!==i;){const i=e.nextSibling;t.removeChild(e),e=i}}},6216:(t,e,i)=>{"use strict";let n,s,r=i(6613);class o extends r{constructor(t){super(t),this.type="root",this.nodes||(this.nodes=[])}normalize(t,e,i){let n=super.normalize(t);if(e)if("prepend"===i)this.nodes.length>1?e.raws.before=this.nodes[1].raws.before:delete e.raws.before;else if(this.first!==e)for(let t of n)t.raws.before=e.raws.before;return n}removeChild(t,e){let i=this.index(t);return!e&&0===i&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[i].raws.before),super.removeChild(t)}toResult(t={}){return new n(new s,this,t).stringify()}}o.registerLazyResult=t=>{n=t},o.registerProcessor=t=>{s=t},t.exports=o,o.default=o,r.registerRoot(o)},6233:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n=i(3423),s=i(4146),r=i(1160),o=i(8604);class a extends s.A{get analytics(){return this.getMainComponent(o.A)}constructor(t,e){super(t,e),this.ins=this.addInputs(a.ins),this.scope=s.X.Node}update(t){return this.ins.visible.changed,!0}activateComponent(t){t.activateTool(),this.analytics.sendProperty("Tools_ActiveTool",t.text)}deactivateComponent(t){t.deactivateTool()}onActiveComponent(t,e){}}a.typeName="CVToolProvider",a.isSystemSingleton=!0,a.componentType=r.Ay,a.ins={visible:n.gK.Boolean("Tools.Visible"),closed:n.gK.Event("Tools.Closed")}},6241:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateUnion=e.validateArray=e.usePattern=e.callValidateCode=e.schemaProperties=e.allSchemaProperties=e.noPropertyInData=e.propertyInData=e.isOwnProperty=e.hasPropFunc=e.reportMissingProp=e.checkMissingProp=e.checkReportMissingProp=void 0;const n=i(5265),s=i(3151),r=i(2363);function o(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:n._`Object.prototype.hasOwnProperty`})}function a(t,e,i){return n._`${o(t)}.call(${e}, ${i})`}function l(t,e,i,s){const r=n._`${e}${(0,n.getProperty)(i)} === undefined`;return s?(0,n.or)(r,(0,n.not)(a(t,e,i))):r}function c(t){return t?Object.keys(t).filter(t=>"__proto__"!==t):[]}e.checkReportMissingProp=function(t,e){const{gen:i,data:s,it:r}=t;i.if(l(i,s,e,r.opts.ownProperties),()=>{t.setParams({missingProperty:n._`${e}`},!0),t.error()})},e.checkMissingProp=function({gen:t,data:e,it:{opts:i}},s,r){return(0,n.or)(...s.map(s=>(0,n.and)(l(t,e,s,i.ownProperties),n._`${r} = ${s}`)))},e.reportMissingProp=function(t,e){t.setParams({missingProperty:e},!0),t.error()},e.hasPropFunc=o,e.isOwnProperty=a,e.propertyInData=function(t,e,i,s){const r=n._`${e}${(0,n.getProperty)(i)} !== undefined`;return s?n._`${r} && ${a(t,e,i)}`:r},e.noPropertyInData=l,e.allSchemaProperties=c,e.schemaProperties=function(t,e){return c(e).filter(i=>!(0,s.alwaysValidSchema)(t,e[i]))},e.callValidateCode=function({schemaCode:t,data:e,it:{gen:i,topSchemaRef:s,schemaPath:o,errorPath:a},it:l},c,h,u){const d=u?n._`${t}, ${e}, ${s}${o}`:e,p=[[r.default.instancePath,(0,n.strConcat)(r.default.instancePath,a)],[r.default.parentData,l.parentData],[r.default.parentDataProperty,l.parentDataProperty],[r.default.rootData,r.default.rootData]];l.opts.dynamicRef&&p.push([r.default.dynamicAnchors,r.default.dynamicAnchors]);const f=n._`${d}, ${i.object(...p)}`;return h!==n.nil?n._`${c}.call(${h}, ${f})`:n._`${c}(${f})`},e.usePattern=function({gen:t,it:{opts:e}},i){const s=e.unicodeRegExp?"u":"";return t.scopeValue("pattern",{key:i,ref:new RegExp(i,s),code:n._`new RegExp(${i}, ${s})`})},e.validateArray=function(t){const{gen:e,data:i,keyword:r,it:o}=t,a=e.name("valid");if(o.allErrors){const t=e.let("valid",!0);return l(()=>e.assign(t,!1)),t}return e.var(a,!0),l(()=>e.break()),a;function l(o){const l=e.const("len",n._`${i}.length`);e.forRange("i",0,l,i=>{t.subschema({keyword:r,dataProp:i,dataPropType:s.Type.Num},a),e.if((0,n.not)(a),o)})}},e.validateUnion=function(t){const{gen:e,schema:i,keyword:r,it:o}=t;if(!Array.isArray(i))throw new Error("ajv implementation error");if(i.some(t=>(0,s.alwaysValidSchema)(o,t))&&!o.opts.unevaluated)return;const a=e.let("valid",!1),l=e.name("_valid");e.block(()=>i.forEach((i,s)=>{const o=t.subschema({keyword:r,schemaProp:s,compositeRule:!0},l);e.assign(a,n._`${a} || ${l}`);t.mergeValidEvaluated(o,l)||e.if((0,n.not)(a))})),t.result(a,()=>t.reset(),()=>t.error(!0))}},6257:t=>{"use strict";const e="'".charCodeAt(0),i='"'.charCodeAt(0),n="\\".charCodeAt(0),s="/".charCodeAt(0),r="\n".charCodeAt(0),o=" ".charCodeAt(0),a="\f".charCodeAt(0),l="\t".charCodeAt(0),c="\r".charCodeAt(0),h="[".charCodeAt(0),u="]".charCodeAt(0),d="(".charCodeAt(0),p=")".charCodeAt(0),f="{".charCodeAt(0),g="}".charCodeAt(0),m=";".charCodeAt(0),A="*".charCodeAt(0),v=":".charCodeAt(0),y="@".charCodeAt(0),b=/[\t\n\f\r "#'()/;[\\\]{}]/g,_=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,x=/.[\r\n"'(/\\]/,w=/[\da-f]/i;t.exports=function(t,E={}){let C,S,I,M,T,B,R,P,L,D,N=t.css.valueOf(),O=E.ignoreErrors,k=N.length,U=0,F=[],z=[];function V(e){throw t.error("Unclosed "+e,U)}return{back:function(t){z.push(t)},endOfFile:function(){return 0===z.length&&U>=k},nextToken:function(t){if(z.length)return z.pop();if(U>=k)return;let E=!!t&&t.ignoreUnclosed;switch(C=N.charCodeAt(U),C){case r:case o:case l:case c:case a:M=U;do{M+=1,C=N.charCodeAt(M)}while(C===o||C===r||C===l||C===c||C===a);B=["space",N.slice(U,M)],U=M-1;break;case h:case u:case f:case g:case v:case m:case p:{let t=String.fromCharCode(C);B=[t,t,U];break}case d:if(D=F.length?F.pop()[1]:"",L=N.charCodeAt(U+1),"url"===D&&L!==e&&L!==i&&L!==o&&L!==r&&L!==l&&L!==a&&L!==c){M=U;do{if(R=!1,M=N.indexOf(")",M+1),-1===M){if(O||E){M=U;break}V("bracket")}for(P=M;N.charCodeAt(P-1)===n;)P-=1,R=!R}while(R);B=["brackets",N.slice(U,M+1),U,M],U=M}else M=N.indexOf(")",U+1),S=N.slice(U,M+1),-1===M||x.test(S)?B=["(","(",U]:(B=["brackets",S,U,M],U=M);break;case e:case i:T=C===e?"'":'"',M=U;do{if(R=!1,M=N.indexOf(T,M+1),-1===M){if(O||E){M=U+1;break}V("string")}for(P=M;N.charCodeAt(P-1)===n;)P-=1,R=!R}while(R);B=["string",N.slice(U,M+1),U,M],U=M;break;case y:b.lastIndex=U+1,b.test(N),M=0===b.lastIndex?N.length-1:b.lastIndex-2,B=["at-word",N.slice(U,M+1),U,M],U=M;break;case n:for(M=U,I=!0;N.charCodeAt(M+1)===n;)M+=1,I=!I;if(C=N.charCodeAt(M+1),I&&C!==s&&C!==o&&C!==r&&C!==l&&C!==c&&C!==a&&(M+=1,w.test(N.charAt(M)))){for(;w.test(N.charAt(M+1));)M+=1;N.charCodeAt(M+1)===o&&(M+=1)}B=["word",N.slice(U,M+1),U,M],U=M;break;default:C===s&&N.charCodeAt(U+1)===A?(M=N.indexOf("*/",U+2)+1,0===M&&(O||E?M=N.length:V("comment")),B=["comment",N.slice(U,M+1),U,M],U=M):(_.lastIndex=U+1,_.test(N),M=0===_.lastIndex?N.length-1:_.lastIndex-2,B=["word",N.slice(U,M+1),U,M],F.push(B),U=M)}return U++,B},position:function(){return U}}}},6262:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(8541),s=i(8086),r=i(5626),o=i(6458),a=i(8385),l=i(7405),c=i(101),h=i(624),u=i(5713),d=i(8569),p=i(991),f=i(2645),g=i(8031),m=i(4200),A=i(4571),v=i(3270);e.default=function(t=!1){const e=[p.default,f.default,g.default,m.default,A.default,v.default,c.default,h.default,l.default,u.default,d.default];return t?e.push(s.default,o.default):e.push(n.default,r.default),e.push(a.default),e}},6280:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const n=i(5265),s=i(3151),r=i(2363);function o(t,e){const i=t.const("err",e);t.if(n._`${r.default.vErrors} === null`,()=>t.assign(r.default.vErrors,n._`[${i}]`),n._`${r.default.vErrors}.push(${i})`),t.code(n._`${r.default.errors}++`)}function a(t,e){const{gen:i,validateName:s,schemaEnv:r}=t;r.$async?i.throw(n._`new ${t.ValidationError}(${e})`):(i.assign(n._`${s}.errors`,e),i.return(!1))}e.keywordError={message:({keyword:t})=>n.str`must pass "${t}" keyword validation`},e.keyword$DataError={message:({keyword:t,schemaType:e})=>e?n.str`"${t}" keyword must be ${e} ($data)`:n.str`"${t}" keyword is invalid ($data)`},e.reportError=function(t,i=e.keywordError,s,r){const{it:l}=t,{gen:h,compositeRule:u,allErrors:d}=l,p=c(t,i,s);(null!=r?r:u||d)?o(h,p):a(l,n._`[${p}]`)},e.reportExtraError=function(t,i=e.keywordError,n){const{it:s}=t,{gen:l,compositeRule:h,allErrors:u}=s;o(l,c(t,i,n)),h||u||a(s,r.default.vErrors)},e.resetErrorsCount=function(t,e){t.assign(r.default.errors,e),t.if(n._`${r.default.vErrors} !== null`,()=>t.if(e,()=>t.assign(n._`${r.default.vErrors}.length`,e),()=>t.assign(r.default.vErrors,null)))},e.extendErrors=function({gen:t,keyword:e,schemaValue:i,data:s,errsCount:o,it:a}){if(void 0===o)throw new Error("ajv implementation error");const l=t.name("err");t.forRange("i",o,r.default.errors,o=>{t.const(l,n._`${r.default.vErrors}[${o}]`),t.if(n._`${l}.instancePath === undefined`,()=>t.assign(n._`${l}.instancePath`,(0,n.strConcat)(r.default.instancePath,a.errorPath))),t.assign(n._`${l}.schemaPath`,n.str`${a.errSchemaPath}/${e}`),a.opts.verbose&&(t.assign(n._`${l}.schema`,i),t.assign(n._`${l}.data`,s))})};const l={keyword:new n.Name("keyword"),schemaPath:new n.Name("schemaPath"),params:new n.Name("params"),propertyName:new n.Name("propertyName"),message:new n.Name("message"),schema:new n.Name("schema"),parentSchema:new n.Name("parentSchema")};function c(t,e,i){const{createErrors:s}=t.it;return!1===s?n._`{}`:function(t,e,i={}){const{gen:s,it:o}=t,a=[h(o,i),u(t,i)];return function(t,{params:e,message:i},s){const{keyword:o,data:a,schemaValue:c,it:h}=t,{opts:u,propertyName:d,topSchemaRef:p,schemaPath:f}=h;s.push([l.keyword,o],[l.params,"function"==typeof e?e(t):e||n._`{}`]),u.messages&&s.push([l.message,"function"==typeof i?i(t):i]);u.verbose&&s.push([l.schema,c],[l.parentSchema,n._`${p}${f}`],[r.default.data,a]);d&&s.push([l.propertyName,d])}(t,e,a),s.object(...a)}(t,e,i)}function h({errorPath:t},{instancePath:e}){const i=e?n.str`${t}${(0,s.getErrorPath)(e,s.Type.Str)}`:t;return[r.default.instancePath,(0,n.strConcat)(r.default.instancePath,i)]}function u({keyword:t,it:{errSchemaPath:e}},{schemaPath:i,parentSchema:r}){let o=r?e:n.str`${e}/${t}`;return i&&(o=n.str`${o}${(0,s.getErrorPath)(i,s.Type.Str)}`),[l.schemaPath,o]}},6335:function(t,e){!function(t){"use strict";function e(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];if(e.length>1){e[0]=e[0].slice(0,-1);for(var n=e.length-1,s=1;s<n;++s)e[s]=e[s].slice(1,-1);return e[n]=e[n].slice(1),e.join("")}return e[0]}function i(t){return"(?:"+t+")"}function n(t){return void 0===t?"undefined":null===t?"null":Object.prototype.toString.call(t).split(" ").pop().split("]").shift().toLowerCase()}function s(t){return t.toUpperCase()}function r(t){return null!=t?t instanceof Array?t:"number"!=typeof t.length||t.split||t.setInterval||t.call?[t]:Array.prototype.slice.call(t):[]}function o(t,e){var i=t;if(e)for(var n in e)i[n]=e[n];return i}function a(t){var n="[A-Za-z]",s="[0-9]",r=e(s,"[A-Fa-f]"),o=i(i("%[EFef]"+r+"%"+r+r+"%"+r+r)+"|"+i("%[89A-Fa-f]"+r+"%"+r+r)+"|"+i("%"+r+r)),a="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",l=e("[\\:\\/\\?\\#\\[\\]\\@]",a),c=t?"[\\uE000-\\uF8FF]":"[]",h=e(n,s,"[\\-\\.\\_\\~]",t?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),u=i(n+e(n,s,"[\\+\\-\\.]")+"*"),d=i(i(o+"|"+e(h,a,"[\\:]"))+"*"),p=(i(i("25[0-5]")+"|"+i("2[0-4]"+s)+"|"+i("1"+s+s)+"|"+i("[1-9]"+s)+"|"+s),i(i("25[0-5]")+"|"+i("2[0-4]"+s)+"|"+i("1"+s+s)+"|"+i("0?[1-9]"+s)+"|0?0?"+s)),f=i(p+"\\."+p+"\\."+p+"\\."+p),g=i(r+"{1,4}"),m=i(i(g+"\\:"+g)+"|"+f),A=i(i(g+"\\:")+"{6}"+m),v=i("\\:\\:"+i(g+"\\:")+"{5}"+m),y=i(i(g)+"?\\:\\:"+i(g+"\\:")+"{4}"+m),b=i(i(i(g+"\\:")+"{0,1}"+g)+"?\\:\\:"+i(g+"\\:")+"{3}"+m),_=i(i(i(g+"\\:")+"{0,2}"+g)+"?\\:\\:"+i(g+"\\:")+"{2}"+m),x=i(i(i(g+"\\:")+"{0,3}"+g)+"?\\:\\:"+g+"\\:"+m),w=i(i(i(g+"\\:")+"{0,4}"+g)+"?\\:\\:"+m),E=i(i(i(g+"\\:")+"{0,5}"+g)+"?\\:\\:"+g),C=i(i(i(g+"\\:")+"{0,6}"+g)+"?\\:\\:"),S=i([A,v,y,b,_,x,w,E,C].join("|")),I=i(i(h+"|"+o)+"+"),M=(i(S+"\\%25"+I),i(S+i("\\%25|\\%(?!"+r+"{2})")+I)),T=i("[vV]"+r+"+\\."+e(h,a,"[\\:]")+"+"),B=i("\\["+i(M+"|"+S+"|"+T)+"\\]"),R=i(i(o+"|"+e(h,a))+"*"),P=i(B+"|"+f+"(?!"+R+")|"+R),L=i(s+"*"),D=i(i(d+"@")+"?"+P+i("\\:"+L)+"?"),N=i(o+"|"+e(h,a,"[\\:\\@]")),O=i(N+"*"),k=i(N+"+"),U=i(i(o+"|"+e(h,a,"[\\@]"))+"+"),F=i(i("\\/"+O)+"*"),z=i("\\/"+i(k+F)+"?"),V=i(U+F),Q=i(k+F),j="(?!"+N+")",G=(i(F+"|"+z+"|"+V+"|"+Q+"|"+j),i(i(N+"|"+e("[\\/\\?]",c))+"*")),H=i(i(N+"|[\\/\\?]")+"*"),q=i(i("\\/\\/"+D+F)+"|"+z+"|"+Q+"|"+j),$=i(u+"\\:"+q+i("\\?"+G)+"?"+i("\\#"+H)+"?"),W=i(i("\\/\\/"+D+F)+"|"+z+"|"+V+"|"+j),K=i(W+i("\\?"+G)+"?"+i("\\#"+H)+"?");return i($+"|"+K),i(u+"\\:"+q+i("\\?"+G)+"?"),i(i("\\/\\/("+i("("+d+")@")+"?("+P+")"+i("\\:("+L+")")+"?)")+"?("+F+"|"+z+"|"+Q+"|"+j+")"),i("\\?("+G+")"),i("\\#("+H+")"),i(i("\\/\\/("+i("("+d+")@")+"?("+P+")"+i("\\:("+L+")")+"?)")+"?("+F+"|"+z+"|"+V+"|"+j+")"),i("\\?("+G+")"),i("\\#("+H+")"),i(i("\\/\\/("+i("("+d+")@")+"?("+P+")"+i("\\:("+L+")")+"?)")+"?("+F+"|"+z+"|"+Q+"|"+j+")"),i("\\?("+G+")"),i("\\#("+H+")"),i("("+d+")@"),i("\\:("+L+")"),{NOT_SCHEME:new RegExp(e("[^]",n,s,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",h,a),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",h,a),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",h,a),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",h,a),"g"),NOT_QUERY:new RegExp(e("[^\\%]",h,a,"[\\:\\@\\/\\?]",c),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",h,a,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",h,a),"g"),UNRESERVED:new RegExp(h,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",h,l),"g"),PCT_ENCODED:new RegExp(o,"g"),IPV4ADDRESS:new RegExp("^("+f+")$"),IPV6ADDRESS:new RegExp("^\\[?("+S+")"+i(i("\\%25|\\%(?!"+r+"{2})")+"("+I+")")+"?\\]?$")}}var l=a(!1),c=a(!0),h=function(){function t(t,e){var i=[],n=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){s=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(s)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)},d=2147483647,p=36,f=1,g=26,m=38,A=700,v=72,y=128,b="-",_=/^xn--/,x=/[^\0-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=p-f,S=Math.floor,I=String.fromCharCode;function M(t){throw new RangeError(E[t])}function T(t,e){for(var i=[],n=t.length;n--;)i[n]=e(t[n]);return i}function B(t,e){var i=t.split("@"),n="";return i.length>1&&(n=i[0]+"@",t=i[1]),n+T((t=t.replace(w,".")).split("."),e).join(".")}function R(t){for(var e=[],i=0,n=t.length;i<n;){var s=t.charCodeAt(i++);if(s>=55296&&s<=56319&&i<n){var r=t.charCodeAt(i++);56320==(64512&r)?e.push(((1023&s)<<10)+(1023&r)+65536):(e.push(s),i--)}else e.push(s)}return e}var P=function(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:p},L=function(t,e){return t+22+75*(t<26)-((0!=e)<<5)},D=function(t,e,i){var n=0;for(t=i?S(t/A):t>>1,t+=S(t/e);t>C*g>>1;n+=p)t=S(t/C);return S(n+(C+1)*t/(t+m))},N=function(t){var e=[],i=t.length,n=0,s=y,r=v,o=t.lastIndexOf(b);o<0&&(o=0);for(var a=0;a<o;++a)t.charCodeAt(a)>=128&&M("not-basic"),e.push(t.charCodeAt(a));for(var l=o>0?o+1:0;l<i;){for(var c=n,h=1,u=p;;u+=p){l>=i&&M("invalid-input");var m=P(t.charCodeAt(l++));(m>=p||m>S((d-n)/h))&&M("overflow"),n+=m*h;var A=u<=r?f:u>=r+g?g:u-r;if(m<A)break;var _=p-A;h>S(d/_)&&M("overflow"),h*=_}var x=e.length+1;r=D(n-c,x,0==c),S(n/x)>d-s&&M("overflow"),s+=S(n/x),n%=x,e.splice(n++,0,s)}return String.fromCodePoint.apply(String,e)},O=function(t){var e=[],i=(t=R(t)).length,n=y,s=0,r=v,o=!0,a=!1,l=void 0;try{for(var c,h=t[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){var u=c.value;u<128&&e.push(I(u))}}catch(t){a=!0,l=t}finally{try{!o&&h.return&&h.return()}finally{if(a)throw l}}var m=e.length,A=m;for(m&&e.push(b);A<i;){var _=d,x=!0,w=!1,E=void 0;try{for(var C,T=t[Symbol.iterator]();!(x=(C=T.next()).done);x=!0){var B=C.value;B>=n&&B<_&&(_=B)}}catch(t){w=!0,E=t}finally{try{!x&&T.return&&T.return()}finally{if(w)throw E}}var P=A+1;_-n>S((d-s)/P)&&M("overflow"),s+=(_-n)*P,n=_;var N=!0,O=!1,k=void 0;try{for(var U,F=t[Symbol.iterator]();!(N=(U=F.next()).done);N=!0){var z=U.value;if(z<n&&++s>d&&M("overflow"),z==n){for(var V=s,Q=p;;Q+=p){var j=Q<=r?f:Q>=r+g?g:Q-r;if(V<j)break;var G=V-j,H=p-j;e.push(I(L(j+G%H,0))),V=S(G/H)}e.push(I(L(V,0))),r=D(s,P,A==m),s=0,++A}}}catch(t){O=!0,k=t}finally{try{!N&&F.return&&F.return()}finally{if(O)throw k}}++s,++n}return e.join("")},k=function(t){return B(t,function(t){return _.test(t)?N(t.slice(4).toLowerCase()):t})},U=function(t){return B(t,function(t){return x.test(t)?"xn--"+O(t):t})},F={version:"2.1.0",ucs2:{decode:R,encode:function(t){return String.fromCodePoint.apply(String,u(t))}},decode:N,encode:O,toASCII:U,toUnicode:k},z={};function V(t){var e=t.charCodeAt(0);return e<16?"%0"+e.toString(16).toUpperCase():e<128?"%"+e.toString(16).toUpperCase():e<2048?"%"+(e>>6|192).toString(16).toUpperCase()+"%"+(63&e|128).toString(16).toUpperCase():"%"+(e>>12|224).toString(16).toUpperCase()+"%"+(e>>6&63|128).toString(16).toUpperCase()+"%"+(63&e|128).toString(16).toUpperCase()}function Q(t){for(var e="",i=0,n=t.length;i<n;){var s=parseInt(t.substr(i+1,2),16);if(s<128)e+=String.fromCharCode(s),i+=3;else if(s>=194&&s<224){if(n-i>=6){var r=parseInt(t.substr(i+4,2),16);e+=String.fromCharCode((31&s)<<6|63&r)}else e+=t.substr(i,6);i+=6}else if(s>=224){if(n-i>=9){var o=parseInt(t.substr(i+4,2),16),a=parseInt(t.substr(i+7,2),16);e+=String.fromCharCode((15&s)<<12|(63&o)<<6|63&a)}else e+=t.substr(i,9);i+=9}else e+=t.substr(i,3),i+=3}return e}function j(t,e){function i(t){var i=Q(t);return i.match(e.UNRESERVED)?i:t}return t.scheme&&(t.scheme=String(t.scheme).replace(e.PCT_ENCODED,i).toLowerCase().replace(e.NOT_SCHEME,"")),void 0!==t.userinfo&&(t.userinfo=String(t.userinfo).replace(e.PCT_ENCODED,i).replace(e.NOT_USERINFO,V).replace(e.PCT_ENCODED,s)),void 0!==t.host&&(t.host=String(t.host).replace(e.PCT_ENCODED,i).toLowerCase().replace(e.NOT_HOST,V).replace(e.PCT_ENCODED,s)),void 0!==t.path&&(t.path=String(t.path).replace(e.PCT_ENCODED,i).replace(t.scheme?e.NOT_PATH:e.NOT_PATH_NOSCHEME,V).replace(e.PCT_ENCODED,s)),void 0!==t.query&&(t.query=String(t.query).replace(e.PCT_ENCODED,i).replace(e.NOT_QUERY,V).replace(e.PCT_ENCODED,s)),void 0!==t.fragment&&(t.fragment=String(t.fragment).replace(e.PCT_ENCODED,i).replace(e.NOT_FRAGMENT,V).replace(e.PCT_ENCODED,s)),t}function G(t){return t.replace(/^0*(.*)/,"$1")||"0"}function H(t,e){var i=t.match(e.IPV4ADDRESS)||[],n=h(i,2)[1];return n?n.split(".").map(G).join("."):t}function q(t,e){var i=t.match(e.IPV6ADDRESS)||[],n=h(i,3),s=n[1],r=n[2];if(s){for(var o=s.toLowerCase().split("::").reverse(),a=h(o,2),l=a[0],c=a[1],u=c?c.split(":").map(G):[],d=l.split(":").map(G),p=e.IPV4ADDRESS.test(d[d.length-1]),f=p?7:8,g=d.length-f,m=Array(f),A=0;A<f;++A)m[A]=u[A]||d[g+A]||"";p&&(m[f-1]=H(m[f-1],e));var v=m.reduce(function(t,e,i){if(!e||"0"===e){var n=t[t.length-1];n&&n.index+n.length===i?n.length++:t.push({index:i,length:1})}return t},[]).sort(function(t,e){return e.length-t.length})[0],y=void 0;if(v&&v.length>1){var b=m.slice(0,v.index),_=m.slice(v.index+v.length);y=b.join(":")+"::"+_.join(":")}else y=m.join(":");return r&&(y+="%"+r),y}return t}var $=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,W=void 0==="".match(/(){0}/)[1];function K(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={},n=!1!==e.iri?c:l;"suffix"===e.reference&&(t=(e.scheme?e.scheme+":":"")+"//"+t);var s=t.match($);if(s){W?(i.scheme=s[1],i.userinfo=s[3],i.host=s[4],i.port=parseInt(s[5],10),i.path=s[6]||"",i.query=s[7],i.fragment=s[8],isNaN(i.port)&&(i.port=s[5])):(i.scheme=s[1]||void 0,i.userinfo=-1!==t.indexOf("@")?s[3]:void 0,i.host=-1!==t.indexOf("//")?s[4]:void 0,i.port=parseInt(s[5],10),i.path=s[6]||"",i.query=-1!==t.indexOf("?")?s[7]:void 0,i.fragment=-1!==t.indexOf("#")?s[8]:void 0,isNaN(i.port)&&(i.port=t.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?s[4]:void 0)),i.host&&(i.host=q(H(i.host,n),n)),void 0!==i.scheme||void 0!==i.userinfo||void 0!==i.host||void 0!==i.port||i.path||void 0!==i.query?void 0===i.scheme?i.reference="relative":void 0===i.fragment?i.reference="absolute":i.reference="uri":i.reference="same-document",e.reference&&"suffix"!==e.reference&&e.reference!==i.reference&&(i.error=i.error||"URI is not a "+e.reference+" reference.");var r=z[(e.scheme||i.scheme||"").toLowerCase()];if(e.unicodeSupport||r&&r.unicodeSupport)j(i,n);else{if(i.host&&(e.domainHost||r&&r.domainHost))try{i.host=F.toASCII(i.host.replace(n.PCT_ENCODED,Q).toLowerCase())}catch(t){i.error=i.error||"Host's domain name can not be converted to ASCII via punycode: "+t}j(i,l)}r&&r.parse&&r.parse(i,e)}else i.error=i.error||"URI can not be parsed.";return i}function X(t,e){var i=!1!==e.iri?c:l,n=[];return void 0!==t.userinfo&&(n.push(t.userinfo),n.push("@")),void 0!==t.host&&n.push(q(H(String(t.host),i),i).replace(i.IPV6ADDRESS,function(t,e,i){return"["+e+(i?"%25"+i:"")+"]"})),"number"!=typeof t.port&&"string"!=typeof t.port||(n.push(":"),n.push(String(t.port))),n.length?n.join(""):void 0}var Y=/^\.\.?\//,J=/^\/\.(\/|$)/,Z=/^\/\.\.(\/|$)/,tt=/^\/?(?:.|\n)*?(?=\/|$)/;function et(t){for(var e=[];t.length;)if(t.match(Y))t=t.replace(Y,"");else if(t.match(J))t=t.replace(J,"/");else if(t.match(Z))t=t.replace(Z,"/"),e.pop();else if("."===t||".."===t)t="";else{var i=t.match(tt);if(!i)throw new Error("Unexpected dot segment condition");var n=i[0];t=t.slice(n.length),e.push(n)}return e.join("")}function it(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.iri?c:l,n=[],s=z[(e.scheme||t.scheme||"").toLowerCase()];if(s&&s.serialize&&s.serialize(t,e),t.host)if(i.IPV6ADDRESS.test(t.host));else if(e.domainHost||s&&s.domainHost)try{t.host=e.iri?F.toUnicode(t.host):F.toASCII(t.host.replace(i.PCT_ENCODED,Q).toLowerCase())}catch(i){t.error=t.error||"Host's domain name can not be converted to "+(e.iri?"Unicode":"ASCII")+" via punycode: "+i}j(t,i),"suffix"!==e.reference&&t.scheme&&(n.push(t.scheme),n.push(":"));var r=X(t,e);if(void 0!==r&&("suffix"!==e.reference&&n.push("//"),n.push(r),t.path&&"/"!==t.path.charAt(0)&&n.push("/")),void 0!==t.path){var o=t.path;e.absolutePath||s&&s.absolutePath||(o=et(o)),void 0===r&&(o=o.replace(/^\/\//,"/%2F")),n.push(o)}return void 0!==t.query&&(n.push("?"),n.push(t.query)),void 0!==t.fragment&&(n.push("#"),n.push(t.fragment)),n.join("")}function nt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={};return arguments[3]||(t=K(it(t,i),i),e=K(it(e,i),i)),!(i=i||{}).tolerant&&e.scheme?(n.scheme=e.scheme,n.userinfo=e.userinfo,n.host=e.host,n.port=e.port,n.path=et(e.path||""),n.query=e.query):(void 0!==e.userinfo||void 0!==e.host||void 0!==e.port?(n.userinfo=e.userinfo,n.host=e.host,n.port=e.port,n.path=et(e.path||""),n.query=e.query):(e.path?("/"===e.path.charAt(0)?n.path=et(e.path):(void 0===t.userinfo&&void 0===t.host&&void 0===t.port||t.path?t.path?n.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:n.path=e.path:n.path="/"+e.path,n.path=et(n.path)),n.query=e.query):(n.path=t.path,void 0!==e.query?n.query=e.query:n.query=t.query),n.userinfo=t.userinfo,n.host=t.host,n.port=t.port),n.scheme=t.scheme),n.fragment=e.fragment,n}function st(t,e,i){var n=o({scheme:"null"},i);return it(nt(K(t,n),K(e,n),n,!0),n)}function rt(t,e){return"string"==typeof t?t=it(K(t,e),e):"object"===n(t)&&(t=K(it(t,e),e)),t}function ot(t,e,i){return"string"==typeof t?t=it(K(t,i),i):"object"===n(t)&&(t=it(t,i)),"string"==typeof e?e=it(K(e,i),i):"object"===n(e)&&(e=it(e,i)),t===e}function at(t,e){return t&&t.toString().replace(e&&e.iri?c.ESCAPE:l.ESCAPE,V)}function lt(t,e){return t&&t.toString().replace(e&&e.iri?c.PCT_ENCODED:l.PCT_ENCODED,Q)}var ct={scheme:"http",domainHost:!0,parse:function(t,e){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t},serialize:function(t,e){var i="https"===String(t.scheme).toLowerCase();return t.port!==(i?443:80)&&""!==t.port||(t.port=void 0),t.path||(t.path="/"),t}},ht={scheme:"https",domainHost:ct.domainHost,parse:ct.parse,serialize:ct.serialize};function ut(t){return"boolean"==typeof t.secure?t.secure:"wss"===String(t.scheme).toLowerCase()}var dt={scheme:"ws",domainHost:!0,parse:function(t,e){var i=t;return i.secure=ut(i),i.resourceName=(i.path||"/")+(i.query?"?"+i.query:""),i.path=void 0,i.query=void 0,i},serialize:function(t,e){if(t.port!==(ut(t)?443:80)&&""!==t.port||(t.port=void 0),"boolean"==typeof t.secure&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){var i=t.resourceName.split("?"),n=h(i,2),s=n[0],r=n[1];t.path=s&&"/"!==s?s:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}},pt={scheme:"wss",domainHost:dt.domainHost,parse:dt.parse,serialize:dt.serialize},ft={},gt="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",mt="[0-9A-Fa-f]",At=i(i("%[EFef]"+mt+"%"+mt+mt+"%"+mt+mt)+"|"+i("%[89A-Fa-f]"+mt+"%"+mt+mt)+"|"+i("%"+mt+mt)),vt="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",yt=e("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),bt="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",_t=new RegExp(gt,"g"),xt=new RegExp(At,"g"),wt=new RegExp(e("[^]",vt,"[\\.]",'[\\"]',yt),"g"),Et=new RegExp(e("[^]",gt,bt),"g"),Ct=Et;function St(t){var e=Q(t);return e.match(_t)?e:t}var It={scheme:"mailto",parse:function(t,e){var i=t,n=i.to=i.path?i.path.split(","):[];if(i.path=void 0,i.query){for(var s=!1,r={},o=i.query.split("&"),a=0,l=o.length;a<l;++a){var c=o[a].split("=");switch(c[0]){case"to":for(var h=c[1].split(","),u=0,d=h.length;u<d;++u)n.push(h[u]);break;case"subject":i.subject=lt(c[1],e);break;case"body":i.body=lt(c[1],e);break;default:s=!0,r[lt(c[0],e)]=lt(c[1],e)}}s&&(i.headers=r)}i.query=void 0;for(var p=0,f=n.length;p<f;++p){var g=n[p].split("@");if(g[0]=lt(g[0]),e.unicodeSupport)g[1]=lt(g[1],e).toLowerCase();else try{g[1]=F.toASCII(lt(g[1],e).toLowerCase())}catch(t){i.error=i.error||"Email address's domain name can not be converted to ASCII via punycode: "+t}n[p]=g.join("@")}return i},serialize:function(t,e){var i=t,n=r(t.to);if(n){for(var o=0,a=n.length;o<a;++o){var l=String(n[o]),c=l.lastIndexOf("@"),h=l.slice(0,c).replace(xt,St).replace(xt,s).replace(wt,V),u=l.slice(c+1);try{u=e.iri?F.toUnicode(u):F.toASCII(lt(u,e).toLowerCase())}catch(t){i.error=i.error||"Email address's domain name can not be converted to "+(e.iri?"Unicode":"ASCII")+" via punycode: "+t}n[o]=h+"@"+u}i.path=n.join(",")}var d=t.headers=t.headers||{};t.subject&&(d.subject=t.subject),t.body&&(d.body=t.body);var p=[];for(var f in d)d[f]!==ft[f]&&p.push(f.replace(xt,St).replace(xt,s).replace(Et,V)+"="+d[f].replace(xt,St).replace(xt,s).replace(Ct,V));return p.length&&(i.query=p.join("&")),i}},Mt=/^([^\:]+)\:(.*)/,Tt={scheme:"urn",parse:function(t,e){var i=t.path&&t.path.match(Mt),n=t;if(i){var s=e.scheme||n.scheme||"urn",r=i[1].toLowerCase(),o=i[2],a=s+":"+(e.nid||r),l=z[a];n.nid=r,n.nss=o,n.path=void 0,l&&(n=l.parse(n,e))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(t,e){var i=e.scheme||t.scheme||"urn",n=t.nid,s=i+":"+(e.nid||n),r=z[s];r&&(t=r.serialize(t,e));var o=t,a=t.nss;return o.path=(n||e.nid)+":"+a,o}},Bt=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Rt={scheme:"urn:uuid",parse:function(t,e){var i=t;return i.uuid=i.nss,i.nss=void 0,e.tolerant||i.uuid&&i.uuid.match(Bt)||(i.error=i.error||"UUID is not valid."),i},serialize:function(t,e){var i=t;return i.nss=(t.uuid||"").toLowerCase(),i}};z[ct.scheme]=ct,z[ht.scheme]=ht,z[dt.scheme]=dt,z[pt.scheme]=pt,z[It.scheme]=It,z[Tt.scheme]=Tt,z[Rt.scheme]=Rt,t.SCHEMES=z,t.pctEncChar=V,t.pctDecChars=Q,t.parse=K,t.removeDotSegments=et,t.serialize=it,t.resolveComponents=nt,t.resolve=st,t.normalize=rt,t.equal=ot,t.escapeComponent=at,t.unescapeComponent=lt,Object.defineProperty(t,"__esModule",{value:!0})}(e)},6342:(t,e,i)=>{"use strict";i.d(e,{q:()=>r,u:()=>s});const n=new WeakMap,s=t=>(...e)=>{const i=t(...e);return n.set(i,!0),i},r=t=>"function"==typeof t&&n.has(t)},6345:(t,e)=>{"use strict";function i(t){for(var e=1;e<t.length;e++)t[e][0]+=t[e-1][0]+1;return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=new Map(i([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(i([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(i([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(i([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]))},6351:(t,e,i)=>{"use strict";i.d(e,{DI:()=>a,Dl:()=>l,g6:()=>h,nZ:()=>c});var n=i(4640);const s=new n.Pq0,r=new n.kn4,o=new n.O9p;new n.PTz;function a(t,e,i){const r=i||new n.PTz;return s.fromArray(t).multiplyScalar(n.cj9.DEG2RAD),o.setFromVector3(s,e),r.setFromEuler(o),r}function l(t,e,i){const r=i||[0,0,0];return o.setFromQuaternion(t,e),s.setFromEuler(o),s.multiplyScalar(n.cj9.RAD2DEG).toArray(r),r}function c(t){const e=new Map,i=new Map,n=new Map;t.traverse(t=>{const s=t;if(s.isMesh){const t=s.geometry;t&&e.set(t.uuid,t);const r=s.material;if(r){i.set(r.uuid,r);for(let t in r){const e=r[t];e&&e.isTexture&&n.set(e.uuid,e)}}}});for(let t of n)t[1].dispose();for(let t of i)t[1].dispose();for(let t of e)t[1].dispose()}function h(t,e,i){if(i||(i=t),!t.visible||t.layers.mask>1)return;const n=t.geometry;if(n&&t.visible){let o=t;for(r.identity();o&&o!==i;)r.premultiply(o.matrix),o=o.parent;if(n.isGeometry){const t=n.vertices;for(let i=0,n=t.length;i<n;++i)s.copy(t[i]).applyMatrix4(r),e.expandByPoint(s)}else if(n.isBufferGeometry){const t=n.attributes.position;if(void 0!==t)for(let i=0,n=t.count;i<n;++i)s.fromBufferAttribute(t,i).applyMatrix4(r),e.expandByPoint(s)}}const o=t.children;for(let t=0,n=o.length;t<n;++t)h(o[t],e,i)}},6389:(t,e,i)=>{"use strict";i.d(e,{A:()=>m});var n=i(4640),s=i(9979),r=i(3423),o=i(3600),a=i(6436),l=i(3889);const c=Math.PI/180;Math.PI;var h=i(1266),u=i(8313),d=i(5623),p=i(9616);const f=["studio_small_08_1k.hdr","capture_tent_mockup-v2-1k.hdr","spruit_sunrise_1k_HDR.hdr"],g=new n.O9p;class m extends r.Ay{constructor(){super(...arguments),this.ins=this.addInputs(m.envIns),this._target=null,this._pmremGenerator=null,this._currentIdx=0,this._imageOptions=f.slice(),this._loadingCount=0,this._isLegacy=!1,this._isLegacyRefl=!1}get settingProperties(){return[this.ins.intensity,this.ins.rotation,this.ins.imageIndex,this.ins.visible]}get assetReader(){return this.getMainComponent(o.A)}get background(){return this.getSystemComponent(h.A)}get sceneNode(){return this.getSystemComponent(a.A)}get renderer(){return this.getSystemComponent(l.A)}create(){super.create(),this.system.components.on(u.A,this.onMetaComponent,this),this.graph.components.on(p.A,this.onModelComponent,this)}dispose(){var t;this.graph.components.off(p.A,this.onModelComponent,this),this.system.components.off(u.A,this.onMetaComponent,this),this.sceneNode.scene.environment&&(this.sceneNode.scene.environment=null),this.sceneNode.scene.background&&(this.sceneNode.scene.background=null),this._target&&(this._target.dispose(),this._target=null),null===(t=this._pmremGenerator)||void 0===t||t.dispose(),this._pmremGenerator=null,super.dispose()}update(){var t,e;const i=this.ins;if(i.initialize.changed&&(this._isLegacy=!1,this._isLegacyRefl=!1,this.graph.hasComponent(d.A)||this.addLightComponent(!1)),i.imageIndex.changed&&(i.enabled.value||i.visible.value)&&this.loadEnvironmentMap(),i.intensity.changed&&(this.sceneNode.scene.environmentIntensity=i.intensity.value,i.visible.value&&(this.sceneNode.scene.backgroundIntensity=i.intensity.value)),i.rotation.changed){const t=i.rotation.value;g.set(t[0]*c,t[1]*c,t[2]*c)}return i.enabled.changed&&(i.enabled.value&&this.loadEnvironmentMap(),this.sceneNode.scene.environment=i.enabled.value?null===(t=this._target)||void 0===t?void 0:t.texture:null),i.visible.changed&&0==this._loadingCount&&(i.visible.value&&this.loadEnvironmentMap(),this.sceneNode.scene.background=i.visible.value?null===(e=this._target)||void 0===e?void 0:e.texture:null,i.visible.value&&this.sceneNode.scene.background&&(this.sceneNode.scene.background.needsUpdate=!0),this.background.ins.visible.setValue(!i.visible.value)),!this._target||i.enabled.value||i.visible.value||(this._target.dispose(),this._target=null,this.sceneNode.scene.environment=null,this.sceneNode.scene.background=null),!0}fromData(t){const e=this.ins;t.rotation&&e.rotation.setValue(t.rotation),t.index&&e.imageIndex.setValue(t.index),t.visible&&e.visible.setValue(t.visible)}toData(){const t=this.ins;return{index:t.imageIndex.value,visible:t.visible.value,rotation:t.rotation.cloneValue()}}loadEnvironmentMap(){const t=this.ins;if(t.imageIndex.value!=this._currentIdx||null===this._target){try{if(null===this._pmremGenerator){if(!this.renderer.views[0].renderer)throw new Error("No renderer found : can't generate environment");this._pmremGenerator=new s.BdL(this.renderer.views[0].renderer)}}catch(t){console.error("Failed to compile environment map : ",t)}const e=this._imageOptions[t.imageIndex.value];f.includes(e)?(this._loadingCount++,this.assetReader.getSystemTexture("images/"+e).then(t=>{this.updateEnvironmentMap(t,e)})):(this._loadingCount++,this.assetReader.getTexture(e).then(t=>{this.updateEnvironmentMap(t,e)})),this._currentIdx=t.imageIndex.value}}updateEnvironmentMap(t,e){const i=this.ins;this._imageOptions.indexOf(e)==i.imageIndex.value&&(this._target=this._pmremGenerator.fromEquirectangular(t,this._target),this.sceneNode.scene.environment=i.enabled.value?this._target.texture:null,this.sceneNode.scene.background=i.visible.value?this._target.texture:null,this.sceneNode.scene.environmentRotation=g,this.sceneNode.scene.backgroundRotation=g,this.renderer.forceRender()),t.dispose(),t=null,this._loadingCount--}onMetaComponent(t){const e=t.object;t.add&&e.once("load",()=>{const t=e.images.dictionary;Object.keys(t).forEach(e=>{const i=t[e];i.usage&&"Environment"===i.usage&&(this._imageOptions.push(i.uri),this.ins.imageIndex.setOptions(this._imageOptions.map(function(t,e){return e.toString()})))})})}addLightComponent(t){const e=this.graph.findNodeByName("Lights"),i=e.graph.createCustomNode(e);i.transform.createComponent(d.A).ins.enabled.setValue(t),e.transform.addChild(i.transform),this._isLegacy=!0}onModelComponent(t){const e=t.object;t.add?e.on("model-load",()=>this.legacyCheck(e),this):t.remove&&e.off("model-load",()=>this.legacyCheck(e),this)}legacyCheck(t){this._isLegacy&&!this._isLegacyRefl&&t.object3D.traverse(t=>{const e=t.material;if(e&&!this._isLegacyRefl&&(e.roughnessMap||e.metalnessMap)){this.graph.getComponent(d.A).transform.dispose(),this.addLightComponent(!0),this._isLegacyRefl=!0}})}}m.typeName="CVEnvironment",m.text="Environment",m.envIns={imageIndex:r.gK.Integer("Environment.MapIndex",{preset:0,options:f.map(function(t,e){return e.toString()})}),initialize:r.gK.Event("Environment.Init"),intensity:r.gK.Number("Environment.Intensity",{preset:1,min:0}),rotation:r.gK.Vector3("Environment.Rotation"),visible:r.gK.Boolean("Environment.Visible",!1),enabled:r.gK.Boolean("Environment.Enabled",!0)}},6436:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var n=i(4640),s=i(3423),r=i(3889),o=i(8424);const a={view:null,viewport:null,renderer:null,scene:null,camera:null},l={type:"before-render",component:null,context:a},c={type:"after-render",component:null,context:a},h={activate:s.gK.Event("Scene.Activate")};class u extends o.Ay{constructor(t,e){super(t,e),this._activeCameraComponent=null,this._preRenderList=[],this._postRenderList=[],this._renderListsNeedUpdate=!0,this.ins=this.addInputs(h,0),this.addEvents("before-render","after-render","active-camera")}get scene(){return this.object3D}get activeCameraComponent(){return this._activeCameraComponent}set activeCameraComponent(t){if(t!==this._activeCameraComponent){const e=this._activeCameraComponent;this._activeCameraComponent=t;const i={type:"active-camera",previous:e,next:t};this.emit(i)}}get activeCamera(){return this._activeCameraComponent?this._activeCameraComponent.camera:null}get renderer(){return this.getMainComponent(r.A)}create(){super.create(),this.on("hierarchy",this.shouldUpdateRenderLists,this),this.on("child",this.shouldUpdateRenderLists,this);const t=this.renderer;t&&!t.activeSceneComponent&&(t.activeSceneComponent=this)}update(t){if(super.update(t),this.ins.activate.changed){const t=this.renderer;t&&(t.activeSceneComponent=this)}return!0}tick(t){return this._renderListsNeedUpdate&&(this.updateRenderLists(),this._renderListsNeedUpdate=!1),!1}dispose(){const t=this.renderer;t&&t.activeSceneComponent===this&&(t.activeSceneComponent=null),this.off("hierarchy",this.shouldUpdateRenderLists,this),this.off("child",this.shouldUpdateRenderLists,this),super.dispose()}preRender(t){const e=this._preRenderList;for(let i=0,n=e.length;i<n;++i)e[i].preRender(t)}postRender(t){const e=this._postRenderList;for(let i=0,n=e.length;i<n;++i)e[i].postRender(t)}createObject3D(){const t=new n.Z58;return t.onBeforeRender=this._onBeforeRender.bind(this),t.onAfterRender=this._onAfterRender.bind(this),t}shouldUpdateRenderLists(){this._renderListsNeedUpdate=!0}updateRenderLists(){this._preRenderList=[],this._postRenderList=[],this.traverseDown(!1,!0,!0,t=>(t.preRender&&this._preRenderList.push(t),t.postRender&&this._postRenderList.push(t),!1)),this.changed=!0}_onBeforeRender(t,e,i){a.view=t.__view,a.viewport=t.__viewport,a.renderer=t,a.scene=e,a.camera=i,this.preRender(a),l.component=this,this.emit(l)}_onAfterRender(t,e,i){a.view=t.__view,a.viewport=t.__viewport,a.renderer=t,a.scene=e,a.camera=i,this.postRender(a),c.component=this,this.emit(c)}}u.typeName="CScene",u.isGraphSingleton=!0},6458:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s=i(3151),r=i(6241),o=i(8541),a={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:t}})=>n.str`must NOT have more than ${t} items`,params:({params:{len:t}})=>n._`{limit: ${t}}`},code(t){const{schema:e,parentSchema:i,it:n}=t,{prefixItems:a}=i;n.items=!0,(0,s.alwaysValidSchema)(n,e)||(a?(0,o.validateAdditionalItems)(t,a):t.ok((0,r.validateArray)(t)))}};e.default=a},6552:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(7550),s=i(4035),r=i(935),o=i(3570),a=i(5370),l=i(8167),c=i(9551),h=i(637),u=i(1155),d=i(423),p=[n.default,s.default,r.default,o.default,a.default,l.default,c.default,h.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},u.default,d.default];e.default=p},6578:(t,e,i)=>{"use strict";let n=i(301),s=i(2610),r=i(8759),o=i(6216);class a{constructor(t=[]){this.version="8.5.6",this.plugins=this.normalize(t)}normalize(t){let e=[];for(let i of t)if(!0===i.postcss?i=i():i.postcss&&(i=i.postcss),"object"==typeof i&&Array.isArray(i.plugins))e=e.concat(i.plugins);else if("object"==typeof i&&i.postcssPlugin)e.push(i);else if("function"==typeof i)e.push(i);else{if("object"!=typeof i||!i.parse&&!i.stringify)throw new Error(i+" is not a PostCSS plugin")}return e}process(t,e={}){return this.plugins.length||e.parser||e.stringifier||e.syntax?new s(this,t,e):new r(this,t,e)}use(t){return this.plugins=this.plugins.concat(this.normalize([t])),this}}t.exports=a,a.default=a,o.registerProcessor(a),n.registerProcessor(a)},6613:(t,e,i)=>{"use strict";let n,s,r,o,a=i(9623),l=i(8290),c=i(3172),{isClean:h,my:u}=i(3963);function d(t){return t.map(t=>(t.nodes&&(t.nodes=d(t.nodes)),delete t.source,t))}function p(t){if(t[h]=!1,t.proxyOf.nodes)for(let e of t.proxyOf.nodes)p(e)}class f extends c{get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}append(...t){for(let e of t){let t=this.normalize(e,this.last);for(let e of t)this.proxyOf.nodes.push(e)}return this.markDirty(),this}cleanRaws(t){if(super.cleanRaws(t),this.nodes)for(let e of this.nodes)e.cleanRaws(t)}each(t){if(!this.proxyOf.nodes)return;let e,i,n=this.getIterator();for(;this.indexes[n]<this.proxyOf.nodes.length&&(e=this.indexes[n],i=t(this.proxyOf.nodes[e],e),!1!==i);)this.indexes[n]+=1;return delete this.indexes[n],i}every(t){return this.nodes.every(t)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let t=this.lastEach;return this.indexes[t]=0,t}getProxyProcessor(){return{get:(t,e)=>"proxyOf"===e?t:t[e]?"each"===e||"string"==typeof e&&e.startsWith("walk")?(...i)=>t[e](...i.map(t=>"function"==typeof t?(e,i)=>t(e.toProxy(),i):t)):"every"===e||"some"===e?i=>t[e]((t,...e)=>i(t.toProxy(),...e)):"root"===e?()=>t.root().toProxy():"nodes"===e?t.nodes.map(t=>t.toProxy()):"first"===e||"last"===e?t[e].toProxy():t[e]:t[e],set:(t,e,i)=>(t[e]===i||(t[e]=i,"name"!==e&&"params"!==e&&"selector"!==e||t.markDirty()),!0)}}index(t){return"number"==typeof t?t:(t.proxyOf&&(t=t.proxyOf),this.proxyOf.nodes.indexOf(t))}insertAfter(t,e){let i,n=this.index(t),s=this.normalize(e,this.proxyOf.nodes[n]).reverse();n=this.index(t);for(let t of s)this.proxyOf.nodes.splice(n+1,0,t);for(let t in this.indexes)i=this.indexes[t],n<i&&(this.indexes[t]=i+s.length);return this.markDirty(),this}insertBefore(t,e){let i,n=this.index(t),s=0===n&&"prepend",r=this.normalize(e,this.proxyOf.nodes[n],s).reverse();n=this.index(t);for(let t of r)this.proxyOf.nodes.splice(n,0,t);for(let t in this.indexes)i=this.indexes[t],n<=i&&(this.indexes[t]=i+r.length);return this.markDirty(),this}normalize(t,e){if("string"==typeof t)t=d(s(t).nodes);else if(void 0===t)t=[];else if(Array.isArray(t)){t=t.slice(0);for(let e of t)e.parent&&e.parent.removeChild(e,"ignore")}else if("root"===t.type&&"document"!==this.type){t=t.nodes.slice(0);for(let e of t)e.parent&&e.parent.removeChild(e,"ignore")}else if(t.type)t=[t];else if(t.prop){if(void 0===t.value)throw new Error("Value field is missed in node creation");"string"!=typeof t.value&&(t.value=String(t.value)),t=[new l(t)]}else if(t.selector||t.selectors)t=[new o(t)];else if(t.name)t=[new n(t)];else{if(!t.text)throw new Error("Unknown node type in node creation");t=[new a(t)]}return t.map(t=>(t[u]||f.rebuild(t),(t=t.proxyOf).parent&&t.parent.removeChild(t),t[h]&&p(t),t.raws||(t.raws={}),void 0===t.raws.before&&e&&void 0!==e.raws.before&&(t.raws.before=e.raws.before.replace(/\S/g,"")),t.parent=this.proxyOf,t))}prepend(...t){t=t.reverse();for(let e of t){let t=this.normalize(e,this.first,"prepend").reverse();for(let e of t)this.proxyOf.nodes.unshift(e);for(let e in this.indexes)this.indexes[e]=this.indexes[e]+t.length}return this.markDirty(),this}push(t){return t.parent=this,this.proxyOf.nodes.push(t),this}removeAll(){for(let t of this.proxyOf.nodes)t.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(t){let e;t=this.index(t),this.proxyOf.nodes[t].parent=void 0,this.proxyOf.nodes.splice(t,1);for(let i in this.indexes)e=this.indexes[i],e>=t&&(this.indexes[i]=e-1);return this.markDirty(),this}replaceValues(t,e,i){return i||(i=e,e={}),this.walkDecls(n=>{e.props&&!e.props.includes(n.prop)||e.fast&&!n.value.includes(e.fast)||(n.value=n.value.replace(t,i))}),this.markDirty(),this}some(t){return this.nodes.some(t)}walk(t){return this.each((e,i)=>{let n;try{n=t(e,i)}catch(t){throw e.addToError(t)}return!1!==n&&e.walk&&(n=e.walk(t)),n})}walkAtRules(t,e){return e?t instanceof RegExp?this.walk((i,n)=>{if("atrule"===i.type&&t.test(i.name))return e(i,n)}):this.walk((i,n)=>{if("atrule"===i.type&&i.name===t)return e(i,n)}):(e=t,this.walk((t,i)=>{if("atrule"===t.type)return e(t,i)}))}walkComments(t){return this.walk((e,i)=>{if("comment"===e.type)return t(e,i)})}walkDecls(t,e){return e?t instanceof RegExp?this.walk((i,n)=>{if("decl"===i.type&&t.test(i.prop))return e(i,n)}):this.walk((i,n)=>{if("decl"===i.type&&i.prop===t)return e(i,n)}):(e=t,this.walk((t,i)=>{if("decl"===t.type)return e(t,i)}))}walkRules(t,e){return e?t instanceof RegExp?this.walk((i,n)=>{if("rule"===i.type&&t.test(i.selector))return e(i,n)}):this.walk((i,n)=>{if("rule"===i.type&&i.selector===t)return e(i,n)}):(e=t,this.walk((t,i)=>{if("rule"===t.type)return e(t,i)}))}}f.registerParse=t=>{s=t},f.registerRule=t=>{o=t},f.registerAtRule=t=>{n=t},f.registerRoot=t=>{r=t},t.exports=f,f.default=f,f.rebuild=t=>{"atrule"===t.type?Object.setPrototypeOf(t,n.prototype):"rule"===t.type?Object.setPrototypeOf(t,o.prototype):"decl"===t.type?Object.setPrototypeOf(t,l.prototype):"comment"===t.type?Object.setPrototypeOf(t,a.prototype):"root"===t.type&&Object.setPrototypeOf(t,r.prototype),t[u]=!0,t.nodes&&t.nodes.forEach(t=>{f.rebuild(t)})}},6679:(t,e,i)=>{"use strict";var n,s,r;i.d(e,{Ui:()=>s,mB:()=>n,nf:()=>r}),function(t){t[t.PlayAnimation=0]="PlayAnimation",t[t.PlayAudio=1]="PlayAudio"}(n||(n={})),function(t){t[t.OnClick=0]="OnClick",t[t.OnLoad=1]="OnLoad",t[t.OnAnnotation=2]="OnAnnotation"}(s||(s={})),function(t){t[t.Single=0]="Single",t[t.PingPong=1]="PingPong",t[t.Loop=2]="Loop"}(r||(r={}))},6687:(t,e,i)=>{"use strict";i.d(e,{A:()=>at,h:()=>ot});var n=i(4424),s=i(9309),r=i(4146),o=i(4955),a=i(4222),l=i(3889),c=i(319),h=i(3644),u=i(6436),d=i(1860),p=i(8604),f=i(161),g=i(3600),m=i(1229),A=i(2902),v=i(8172),y=i(1721),b=i(1086),_=i(8313),x=i(9616),w=i(3423);class E extends w.Ay{constructor(){super(...arguments),this.ins=this.addInputs(E.ins)}get model(){return this.getComponent(x.A)}update(t){return!0}}E.typeName="CVAnnotations",E.ins={};var C=i(3350),S=i(9640),I=i(9610),M=i(2552),T=i(6884),B=i(4965),R=i(5623),P=i(5007),L=i(2652),D=i(7801),N=i(2654),O=i(1266),k=i(7137),U=i(7109),F=i(4340),z=i(2566),V=i(5659),Q=i(4085),j=i(6389),G=i(2791),H=i(9337),q=i(3019),$=i(9909),W=i(7504),K=i(2154),X=i(3164),Y=i(2222),J=i(5852),Z=i(4088);class tt extends Z.A{get settingProperties(){return[this.ins.name,this.ins.enabled,this.ins.color,this.ins.intensity,this.ins.ground]}get snapshotProperties(){return[this.ins.color,this.ins.intensity,this.ins.ground]}dispose(){super.dispose()}fromDocument(t,e){var i,n;if(!isFinite(e.light))throw new Error("light property missing in node");const s=t.lights[e.light],r=this.ins;if(s.type!==tt.type)throw new Error("light type mismatch: not an hemisphere light");return r.name.setValue(e.name),s.point=s.point||{},r.copyValues({enabled:void 0!==s.enabled?s.enabled:r.enabled.schema.preset,color:void 0!==s.color?s.color:r.color.schema.preset,intensity:void 0!==s.intensity?s.intensity:r.intensity.schema.preset,ground:null!==(n=null===(i=s.hemisphere)||void 0===i?void 0:i.ground)&&void 0!==n?n:r.ground.schema.preset}),e.light}toDocument(t,e){const i=this.ins,n={enabled:i.enabled.value,color:i.color.cloneValue(),intensity:i.intensity.value,hemisphere:{ground:i.ground.cloneValue()}};n.type=tt.type,t.lights=t.lights||[];const s=t.lights.length;return t.lights.push(n),s}}tt.typeName="CVHemisphereLight",tt.type="hemisphere",tt.text="Hemisphere Light",tt.icon="half-sun";var et=i(4640),it=i(2464);class nt extends it.A{constructor(t,e){super(t,e),this.ins=this.addInputs(nt.rectLightIns),this.object3D=new et.ure,this.light.width=1,this.light.height=1,this.object3D.matrixAutoUpdate=!1,this.transform.ins.scale.addEventListener("value",this.update,this)}get light(){return this.object3D}update(t){super.update(t);const e=this.light,i=this.ins;return(i.position.changed||i.target.changed)&&(e.position.fromArray(i.position.value),e.lookAt((new et.Pq0).fromArray(i.target.value)),e.updateMatrix()),this.light.width=10*this.transform.ins.scale.value[0],this.light.height=10*this.transform.ins.scale.value[2],!0}dispose(){this.transform.ins.scale.removeEventListener("value",this.update),super.dispose()}}nt.typeName="CRectLight",nt.rectLightIns={position:w.gK.Vector3("Light.Position",[0,0,0]),target:w.gK.Vector3("Light.Target",[0,-1,0]),size:w.gK.Vector2("Light.Size",[10,10])};class st extends nt{get settingProperties(){return[this.ins.name,this.ins.enabled,this.ins.color,this.ins.intensity]}get snapshotProperties(){return[this.ins.color,this.ins.intensity]}dispose(){super.dispose()}fromDocument(t,e){if(!isFinite(e.light))throw new Error("light property missing in node");const i=t.lights[e.light],n=this.ins;if(i.type!==st.type)throw new Error(`light type mismatch: not a directional light (${i.type})`);return n.name.setValue(e.name),n.copyValues({enabled:void 0!==i.enabled?i.enabled:n.enabled.schema.preset,color:void 0!==i.color?i.color:n.color.schema.preset,intensity:void 0!==i.intensity?i.intensity:n.intensity.schema.preset,position:n.position.schema.preset,target:n.target.schema.preset}),e.light}toDocument(t,e){const i=this.ins,n={enabled:i.enabled.value,color:i.color.cloneValue(),intensity:i.intensity.value};n.type=st.type,t.lights=t.lights||[];const s=t.lights.length;return t.lights.push(n),s}}st.typeName="CVRectLight",st.type="rect",st.text="Rectangular Light",st.icon="area";var rt=i(66);const ot=[M.A,T.A,B.A,J.A,tt,st,R.A],at=[n.Ay,s.A,r.A,o.A,a.A,l.A,c.A,h.A,u.A,d.A,p.A,G.A,f.A,g.A,m.A,A.A,v.A,y.A,b.A,_.A,x.A,E,C.A,S.A,I.A,...ot,P.A,L.A,D.Ay,N.Ay,rt.Ay,O.A,k.A,U.A,F.A,z.A,V.A,Q.A,j.A,H.A,q.A,$.A,W.A,K.A,X.A,Y.A]},6719:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resolveSchema=e.getCompilingSchema=e.resolveRef=e.compileSchema=e.SchemaEnv=void 0;const n=i(5265),s=i(2874),r=i(2363),o=i(5391),a=i(3151),l=i(2310),c=i(6335);class h{constructor(t){var e;let i;this.refs={},this.dynamicAnchors={},"object"==typeof t.schema&&(i=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=null!==(e=t.baseId)&&void 0!==e?e:(0,o.normalizeId)(null==i?void 0:i[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=null==i?void 0:i.$async,this.refs={}}}function u(t){const e=p.call(this,t);if(e)return e;const i=(0,o.getFullPath)(t.root.baseId),{es5:a,lines:c}=this.opts.code,{ownProperties:h}=this.opts,u=new n.CodeGen(this.scope,{es5:a,lines:c,ownProperties:h});let d;t.$async&&(d=u.scopeValue("Error",{ref:s.default,code:n._`require("ajv/dist/runtime/validation_error").default`}));const f=u.scopeName("validate");t.validateName=f;const g={gen:u,allErrors:this.opts.allErrors,data:r.default.data,parentData:r.default.parentData,parentDataProperty:r.default.parentDataProperty,dataNames:[r.default.data],dataPathArr:[n.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:u.scopeValue("schema",!0===this.opts.code.source?{ref:t.schema,code:(0,n.stringify)(t.schema)}:{ref:t.schema}),validateName:f,ValidationError:d,schema:t.schema,schemaEnv:t,rootId:i,baseId:t.baseId||i,schemaPath:n.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:n._`""`,opts:this.opts,self:this};let m;try{this._compilations.add(t),(0,l.validateFunctionCode)(g),u.optimize(this.opts.code.optimize);const e=u.toString();m=`${u.scopeRefs(r.default.scope)}return ${e}`,this.opts.code.process&&(m=this.opts.code.process(m,t));const i=new Function(`${r.default.self}`,`${r.default.scope}`,m)(this,this.scope.get());if(this.scope.value(f,{ref:i}),i.errors=null,i.schema=t.schema,i.schemaEnv=t,t.$async&&(i.$async=!0),!0===this.opts.code.source&&(i.source={validateName:f,validateCode:e,scopeValues:u._values}),this.opts.unevaluated){const{props:t,items:e}=g;i.evaluated={props:t instanceof n.Name?void 0:t,items:e instanceof n.Name?void 0:e,dynamicProps:t instanceof n.Name,dynamicItems:e instanceof n.Name},i.source&&(i.source.evaluated=(0,n.stringify)(i.evaluated))}return t.validate=i,t}catch(e){throw delete t.validate,delete t.validateName,m&&this.logger.error("Error compiling schema, function code:",m),e}finally{this._compilations.delete(t)}}function d(t){return(0,o.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:u.call(this,t)}function p(t){for(const e of this._compilations)if(f(e,t))return e}function f(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function g(t,e){let i;for(;"string"==typeof(i=this.refs[e]);)e=i;return i||this.schemas[e]||m.call(this,t,e)}function m(t,e){const i=c.parse(e),n=(0,o._getFullPath)(i);let s=(0,o.getFullPath)(t.baseId);if(Object.keys(t.schema).length>0&&n===s)return v.call(this,i,t);const r=(0,o.normalizeId)(n),a=this.refs[r]||this.schemas[r];if("string"==typeof a){const e=m.call(this,t,a);if("object"!=typeof(null==e?void 0:e.schema))return;return v.call(this,i,e)}if("object"==typeof(null==a?void 0:a.schema)){if(a.validate||u.call(this,a),r===(0,o.normalizeId)(e)){const{schema:e}=a,{schemaId:i}=this.opts,n=e[i];return n&&(s=(0,o.resolveUrl)(s,n)),new h({schema:e,schemaId:i,root:t,baseId:s})}return v.call(this,i,a)}}e.SchemaEnv=h,e.compileSchema=u,e.resolveRef=function(t,e,i){var n;i=(0,o.resolveUrl)(e,i);const s=t.refs[i];if(s)return s;let r=g.call(this,t,i);if(void 0===r){const s=null===(n=t.localRefs)||void 0===n?void 0:n[i],{schemaId:o}=this.opts;s&&(r=new h({schema:s,schemaId:o,root:t,baseId:e}))}return void 0!==r?t.refs[i]=d.call(this,r):void 0},e.getCompilingSchema=p,e.resolveSchema=m;const A=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function v(t,{baseId:e,schema:i,root:n}){var s;if("/"!==(null===(s=t.fragment)||void 0===s?void 0:s[0]))return;for(const n of t.fragment.slice(1).split("/")){if("boolean"==typeof i)return;const t=i[(0,a.unescapeFragment)(n)];if(void 0===t)return;const s="object"==typeof(i=t)&&i[this.opts.schemaId];!A.has(n)&&s&&(e=(0,o.resolveUrl)(e,s))}let r;if("boolean"!=typeof i&&i.$ref&&!(0,a.schemaHasRulesButRef)(i,this.RULES)){const t=(0,o.resolveUrl)(e,i.$ref);r=m.call(this,n,t)}const{schemaId:l}=this.opts;return r=r||new h({schema:i,schemaId:l,root:n,baseId:e}),r.schema!==r.root.schema?r:void 0}},6748:t=>{"use strict";let e={comma:t=>e.split(t,[","],!0),space:t=>e.split(t,[" ","\n","\t"]),split(t,e,i){let n=[],s="",r=!1,o=0,a=!1,l="",c=!1;for(let i of t)c?c=!1:"\\"===i?c=!0:a?i===l&&(a=!1):'"'===i||"'"===i?(a=!0,l=i):"("===i?o+=1:")"===i?o>0&&(o-=1):0===o&&e.includes(i)&&(r=!0),r?(""!==s&&n.push(s.trim()),s="",r=!1):s+=i;return(i||""!==s)&&n.push(s.trim()),n}};t.exports=e,e.default=e},6763:(t,e,i)=>{"use strict";i.d(e,{EM:()=>j,Ay:()=>Q,qy:()=>u.qy,MZ:()=>C,XX:()=>u.XX});var n=i(6187),s=i(4709);function r(t,e){const{element:{content:i},parts:n}=t,s=document.createTreeWalker(i,133,null,!1);let r=a(n),o=n[r],l=-1,c=0;const h=[];let u=null;for(;s.nextNode();){l++;const t=s.currentNode;for(t.previousSibling===u&&(u=null),e.has(t)&&(h.push(t),null===u&&(u=t)),null!==u&&c++;void 0!==o&&o.index===l;)o.index=null!==u?-1:o.index-c,r=a(n,r),o=n[r]}h.forEach(t=>t.parentNode.removeChild(t))}const o=t=>{let e=11===t.nodeType?0:1;const i=document.createTreeWalker(t,133,null,!1);for(;i.nextNode();)e++;return e},a=(t,e=-1)=>{for(let i=e+1;i<t.length;i++){const e=t[i];if((0,s.s9)(e))return i}return-1};var l=i(8135),c=i(1046),h=i(1757),u=i(4743);const d=(t,e)=>`${t}--${e}`;let p=!0;void 0===window.ShadyCSS?p=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),p=!1);const f=t=>e=>{const i=d(e.type,t);let n=c.c.get(i);void 0===n&&(n={stringsArray:new WeakMap,keyString:new Map},c.c.set(i,n));let r=n.stringsArray.get(e.strings);if(void 0!==r)return r;const o=e.strings.join(s.xL);if(r=n.keyString.get(o),void 0===r){const i=e.getTemplateElement();p&&window.ShadyCSS.prepareTemplateDom(i,t),r=new s.Bj(e,i),n.keyString.set(o,r)}return n.stringsArray.set(e.strings,r),r},g=["html","svg"],m=new Set,A=(t,e,i)=>{m.add(t);const n=i?i.element:document.createElement("template"),s=e.querySelectorAll("style"),{length:l}=s;if(0===l)return void window.ShadyCSS.prepareTemplateStyles(n,t);const h=document.createElement("style");for(let t=0;t<l;t++){const e=s[t];e.parentNode.removeChild(e),h.textContent+=e.textContent}(t=>{g.forEach(e=>{const i=c.c.get(d(e,t));void 0!==i&&i.keyString.forEach(t=>{const{element:{content:e}}=t,i=new Set;Array.from(e.querySelectorAll("style")).forEach(t=>{i.add(t)}),r(t,i)})})})(t);const u=n.content;i?function(t,e,i=null){const{element:{content:n},parts:s}=t;if(null==i)return void n.appendChild(e);const r=document.createTreeWalker(n,133,null,!1);let l=a(s),c=0,h=-1;for(;r.nextNode();)for(h++,r.currentNode===i&&(c=o(e),i.parentNode.insertBefore(e,i));-1!==l&&s[l].index===h;){if(c>0){for(;-1!==l;)s[l].index+=c,l=a(s,l);return}l=a(s,l)}}(i,h,u.firstChild):u.insertBefore(h,u.firstChild),window.ShadyCSS.prepareTemplateStyles(n,t);const p=u.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==p)e.insertBefore(p.cloneNode(!0),e.firstChild);else if(i){u.insertBefore(h,u.firstChild);const t=new Set;t.add(h),r(i,t)}};window.JSCompiler_renameProperty=(t,e)=>t;const v={toAttribute(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},y=(t,e)=>e!==t&&(e==e||t==t),b={attribute:!0,type:String,converter:v,reflect:!1,hasChanged:y},_="finalized";class x extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const t=[];return this._classProperties.forEach((e,i)=>{const n=this._attributeNameForProperty(i,e);void 0!==n&&(this._attributeToPropertyMap.set(n,i),t.push(n))}),t}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach((t,e)=>this._classProperties.set(e,t))}}static createProperty(t,e=b){if(this._ensureClassProperties(),this._classProperties.set(t,e),e.noAccessor||this.prototype.hasOwnProperty(t))return;const i="symbol"==typeof t?Symbol():`__${t}`,n=this.getPropertyDescriptor(t,i,e);void 0!==n&&Object.defineProperty(this.prototype,t,n)}static getPropertyDescriptor(t,e,i){return{get(){return this[e]},set(n){const s=this[t];this[e]=n,this.requestUpdateInternal(t,s,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this._classProperties&&this._classProperties.get(t)||b}static finalize(){const t=Object.getPrototypeOf(this);if(t.hasOwnProperty(_)||t.finalize(),this[_]=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const t=this.properties,e=[...Object.getOwnPropertyNames(t),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]];for(const i of e)this.createProperty(i,t[i])}}static _attributeNameForProperty(t,e){const i=e.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}static _valueHasChanged(t,e,i=y){return i(t,e)}static _propertyValueFromAttribute(t,e){const i=e.type,n=e.converter||v,s="function"==typeof n?n:n.fromAttribute;return s?s(t,i):t}static _propertyValueToAttribute(t,e){if(void 0===e.reflect)return;const i=e.type,n=e.converter;return(n&&n.toAttribute||v.toAttribute)(t,i)}initialize(){this._updateState=0,this._updatePromise=new Promise(t=>this._enableUpdatingResolver=t),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((t,e)=>{if(this.hasOwnProperty(e)){const t=this[e];delete this[e],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(e,t)}})}_applyInstanceProperties(){this._instanceProperties.forEach((t,e)=>this[e]=t),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(t,e,i){e!==i&&this._attributeToProperty(t,i)}_propertyToAttribute(t,e,i=b){const n=this.constructor,s=n._attributeNameForProperty(t,i);if(void 0!==s){const t=n._propertyValueToAttribute(e,i);if(void 0===t)return;this._updateState=8|this._updateState,null==t?this.removeAttribute(s):this.setAttribute(s,t),this._updateState=-9&this._updateState}}_attributeToProperty(t,e){if(8&this._updateState)return;const i=this.constructor,n=i._attributeToPropertyMap.get(t);if(void 0!==n){const t=i.getPropertyOptions(n);this._updateState=16|this._updateState,this[n]=i._propertyValueFromAttribute(e,t),this._updateState=-17&this._updateState}}requestUpdateInternal(t,e,i){let n=!0;if(void 0!==t){const s=this.constructor;i=i||s.getPropertyOptions(t),s._valueHasChanged(this[t],e,i.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,e),!0!==i.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,i))):n=!1}!this._hasRequestedUpdate&&n&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(t,e){return this.requestUpdateInternal(t,e),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(t){}const t=this.performUpdate();return null!=t&&await t,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let t=!1;const e=this._changedProperties;try{t=this.shouldUpdate(e),t?this.update(e):this._markUpdated()}catch(e){throw t=!1,this._markUpdated(),e}t&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(e)),this.updated(e))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(t){return!0}update(t){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((t,e)=>this._propertyToAttribute(e,this[e],t)),this._reflectingProperties=void 0),this._markUpdated()}updated(t){}firstUpdated(t){}}x[_]=!0;const w=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?Object.assign(Object.assign({},e),{finisher(i){i.createProperty(e.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(i){i.createProperty(e.key,t)}},E=(t,e,i)=>{e.constructor.createProperty(i,t)};function C(t){return(e,i)=>void 0!==i?E(t,e,i):w(t,e)}const S=Element.prototype;S.msMatchesSelector||S.webkitMatchesSelector;const I=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,M=Symbol();class T{constructor(t,e){if(e!==M)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){return void 0===this._styleSheet&&(I?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const B={};class R extends x{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const t=this.getStyles();if(Array.isArray(t)){const e=(t,i)=>t.reduceRight((t,i)=>Array.isArray(i)?e(i,t):(t.add(i),t),i),i=e(t,new Set),n=[];i.forEach(t=>n.unshift(t)),this._styles=n}else this._styles=void 0===t?[]:[t];this._styles=this._styles.map(t=>{if(t instanceof CSSStyleSheet&&!I){const e=Array.prototype.slice.call(t.cssRules).reduce((t,e)=>t+e.cssText,"");return new T(String(e),M)}return t})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const t=this.constructor._styles;0!==t.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?I?this.renderRoot.adoptedStyleSheets=t.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t.map(t=>t.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(t){const e=this.render();super.update(t),e!==B&&this.constructor.render(e,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(t=>{const e=document.createElement("style");e.textContent=t.cssText,this.renderRoot.appendChild(e)}))}render(){return B}}R.finalized=!0,R.render=(t,e,i)=>{if(!i||"object"!=typeof i||!i.scopeName)throw new Error("The `scopeName` option is required.");const s=i.scopeName,r=l.r.has(e),o=p&&11===e.nodeType&&!!e.host,a=o&&!m.has(s),c=a?document.createDocumentFragment():e;if((0,l.X)(t,c,Object.assign({templateFactory:f(s)},i)),a){const t=l.r.get(c);l.r.delete(c);const i=t.value instanceof h.i?t.value.template:void 0;A(s,c,i),(0,n.if)(e,e.firstChild),e.appendChild(c),l.r.set(e,t)}!r&&o&&window.ShadyCSS.styleElement(e.host)},R.shadowRootOptions={mode:"open"};const P=(t,e)=>{const i=t.startNode.parentNode,n=void 0===e?t.endNode:e.startNode,s=i.insertBefore((0,u.h5)(),n);i.insertBefore((0,u.h5)(),n);const r=new u.Qh(t.options);return r.insertAfterNode(s),r},L=(t,e)=>(t.setValue(e),t.commit(),t),D=(t,e,i)=>{const n=t.startNode.parentNode,s=i?i.startNode:t.endNode,r=e.endNode.nextSibling;r!==s&&(0,u.Pf)(n,e.startNode,r,s)},N=t=>{(0,u.if)(t.startNode.parentNode,t.startNode,t.endNode.nextSibling)},O=(t,e,i)=>{const n=new Map;for(let s=e;s<=i;s++)n.set(t[s],s);return n},k=new WeakMap,U=new WeakMap;(0,u.u$)((t,e,i)=>{let n;return void 0===i?i=e:void 0!==e&&(n=e),e=>{if(!(e instanceof u.Qh))throw new Error("repeat can only be used in text bindings");const s=k.get(e)||[],r=U.get(e)||[],o=[],a=[],l=[];let c,h,d=0;for(const e of t)l[d]=n?n(e,d):d,a[d]=i(e,d),d++;let p=0,f=s.length-1,g=0,m=a.length-1;for(;p<=f&&g<=m;)if(null===s[p])p++;else if(null===s[f])f--;else if(r[p]===l[g])o[g]=L(s[p],a[g]),p++,g++;else if(r[f]===l[m])o[m]=L(s[f],a[m]),f--,m--;else if(r[p]===l[m])o[m]=L(s[p],a[m]),D(e,s[p],o[m+1]),p++,m--;else if(r[f]===l[g])o[g]=L(s[f],a[g]),D(e,s[f],s[p]),f--,g++;else if(void 0===c&&(c=O(l,g,m),h=O(r,p,f)),c.has(r[p]))if(c.has(r[f])){const t=h.get(l[g]),i=void 0!==t?s[t]:null;if(null===i){const t=P(e,s[p]);L(t,a[g]),o[g]=t}else o[g]=L(i,a[g]),D(e,i,s[p]),s[t]=null;g++}else N(s[f]),f--;else N(s[p]),p++;for(;g<=m;){const t=P(e,o[m+1]);L(t,a[g]),o[g++]=t}for(;p<=f;){const t=s[p++];null!==t&&N(t)}k.set(e,o),U.set(e,l)}});var F,z=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let V=F=class extends R{constructor(){super(...arguments),this._isFirstConnected=!1}static setStyle(t,e){Object.assign(t.style,e)}static setAttribs(t,e){for(let i in e)t.setAttribute(i,e[i])}get shady(){return this.constructor.shady}appendTo(t){return t.appendChild(this),this}removeChildren(){for(;this.firstChild;)this.removeChild(this.firstChild)}getChildrenArray(){return Array.from(this.children)}appendElement(t,e){return this.createElement(t,e,this)}createElement(t,e,i){let n;return n="string"==typeof t?document.createElement(t):t instanceof HTMLElement?t:new t,e&&Object.assign(n.style,e),i&&i.appendChild(n),n}setStyle(t){return F.setStyle(this,t),this}setAttribute(t,e){return super.setAttribute(t,e),this}setAttributes(t){return F.setAttribs(this,t),this}addClass(...t){return t.forEach(t=>this.classList.add(t)),this}removeClass(...t){return t.forEach(t=>this.classList.remove(t)),this}setClass(t,e){return e?this.classList.add(t):this.classList.remove(t),this}hasFocus(){return document.activeElement===this}on(t,e,i){return this.addEventListener(t,e,i),this}off(t,e,i){return this.removeEventListener(t,e,i),this}connectedCallback(){this._isFirstConnected||(this._isFirstConnected=!0,this.firstConnected()),this.connected(),super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this.disconnected()}createRenderRoot(){return this.shady?super.createRenderRoot():this}firstConnected(){}connected(){}disconnected(){}onUpdate(){this.requestUpdate()}};V.tagName="ff-custom-element",V.shady=!1,V=F=z([j("ff-custom-element")],V);const Q=V;function j(t){return e=>(e.tagName=t,customElements.define(e.tagName,e),e)}},6773:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>h});i(2867);var n,s=i(6763),r=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};const o={info:"ff-info",success:"ff-success",warning:"ff-warning",error:"ff-error"},a={info:"info",success:"check",warning:"warning",error:"error"},l={info:2e3,success:2e3,warning:5e3,error:0};let c=n=class extends s.Ay{static show(t,e,i){new n(t,e,i)}constructor(t,e,i){super(),this._handler=0,this.on("transitionend",this.remove.bind(this)),this.message=t||"<messge>",this.level=e||"info",this.timeout=void 0!==i?i:l[this.level];const s=(n.shadowRootNode||document).getElementById(n.stackId);s?s.appendChild(this):console.warn(`element '#${n.stackId}' not found`)}close(){this._handler>0&&(window.clearTimeout(this._handler),this._handler=0),this.classList.add("ff-out")}firstUpdated(){this.classList.add("ff-notification",o[this.level]),this.timeout>0&&(this._handler=window.setTimeout(()=>this.close(),this.timeout))}render(){const t=a[this.level];return s.qy`<ff-icon name=${t}></ff-icon>
            <div class="ff-text">${this.message}</div>
            <ff-button inline icon="close" @click=${this.onClose}>`}onClose(t){t.stopPropagation(),this.close()}};c.stackId="ff-notification-stack",c.shadowRootNode=null,r([(0,s.MZ)({type:String})],c.prototype,"message",void 0),r([(0,s.MZ)({type:String})],c.prototype,"level",void 0),r([(0,s.MZ)({type:Number})],c.prototype,"timeout",void 0),c=n=r([(0,s.EM)("ff-notification")],c);const h=c},6788:(t,e,i)=>{var n=i(4484),s=i(1327);t.exports=function t(e,i,r,o,a){var l=-1,c=e.length;for(r||(r=s),a||(a=[]);++l<c;){var h=e[l];i>0&&r(h)?i>1?t(h,i-1,r,o,a):n(a,h):o||(a[a.length]=h)}return a}},6842:(t,e,i)=>{"use strict";let{existsSync:n,readFileSync:s}=i(8892),{dirname:r,join:o}=i(5324),{SourceMapConsumer:a,SourceMapGenerator:l}=i(8645);class c{constructor(t,e){if(!1===e.map)return;this.loadAnnotation(t),this.inline=this.startWith(this.annotation,"data:");let i=e.map?e.map.prev:void 0,n=this.loadMap(e.from,i);!this.mapFile&&e.from&&(this.mapFile=e.from),this.mapFile&&(this.root=r(this.mapFile)),n&&(this.text=n)}consumer(){return this.consumerCache||(this.consumerCache=new a(this.text)),this.consumerCache}decodeInline(t){let e=t.match(/^data:application\/json;charset=utf-?8,/)||t.match(/^data:application\/json,/);if(e)return decodeURIComponent(t.substr(e[0].length));let i=t.match(/^data:application\/json;charset=utf-?8;base64,/)||t.match(/^data:application\/json;base64,/);if(i)return n=t.substr(i[0].length),Buffer?Buffer.from(n,"base64").toString():window.atob(n);var n;let s=t.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+s)}getAnnotationURL(t){return t.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(t){return"object"==typeof t&&("string"==typeof t.mappings||"string"==typeof t._mappings||Array.isArray(t.sections))}loadAnnotation(t){let e=t.match(/\/\*\s*# sourceMappingURL=/g);if(!e)return;let i=t.lastIndexOf(e.pop()),n=t.indexOf("*/",i);i>-1&&n>-1&&(this.annotation=this.getAnnotationURL(t.substring(i,n)))}loadFile(t){if(this.root=r(t),n(t))return this.mapFile=t,s(t,"utf-8").toString().trim()}loadMap(t,e){if(!1===e)return!1;if(e){if("string"==typeof e)return e;if("function"!=typeof e){if(e instanceof a)return l.fromSourceMap(e).toString();if(e instanceof l)return e.toString();if(this.isMap(e))return JSON.stringify(e);throw new Error("Unsupported previous source map format: "+e.toString())}{let i=e(t);if(i){let t=this.loadFile(i);if(!t)throw new Error("Unable to load previous source map: "+i.toString());return t}}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let e=this.annotation;return t&&(e=o(r(t),e)),this.loadFile(e)}}}startWith(t,e){return!!t&&t.substr(0,e.length)===e}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}}t.exports=c,c.default=c},6884:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n=i(4640),s=i(3423),r=i(2464);new n.Pq0;class o extends r.A{constructor(t,e){super(t,e),this.ins=this.addInputs(o.pointLightIns),this.object3D=new n.HiM}get light(){return this.object3D}update(t){super.update(t);const e=this.light,i=this.ins;return i.position.changed&&(e.position.fromArray(i.position.value),e.updateMatrix()),(i.distance.changed||i.decay.changed)&&(e.distance=i.distance.value,e.decay=i.decay.value,e.shadow.camera.near=e.distance?e.distance/800:.5),e.updateMatrix(),!0}}o.typeName="CPointLight",o.pointLightIns={position:s.gK.Vector3("Light.Position"),distance:s.gK.Number("Light.Distance",{preset:0,min:0}),decay:s.gK.Number("Light.Decay",{preset:1,min:0})};class a extends o{get settingProperties(){return[this.ins.name,this.ins.enabled,this.ins.color,this.ins.intensity,this.ins.distance,this.ins.decay,this.ins.shadowEnabled,this.ins.shadowResolution,this.ins.shadowBlur,this.ins.shadowIntensity]}get snapshotProperties(){return[this.ins.color,this.ins.intensity]}dispose(){this.ins.shadowEnabled.value&&this.light.shadow.map&&this.light.shadow.map.dispose(),super.dispose()}fromDocument(t,e){if(!isFinite(e.light))throw new Error("light property missing in node");const i=t.lights[e.light],n=this.ins;if(i.type!==a.type)throw new Error("light type mismatch: not a point light");return n.name.setValue(e.name),i.point=i.point||{},n.copyValues({enabled:void 0!==i.enabled?i.enabled:n.enabled.schema.preset,color:void 0!==i.color?i.color:n.color.schema.preset,intensity:void 0!==i.intensity?i.intensity:n.intensity.schema.preset,position:n.position.schema.preset,distance:i.point.distance||n.distance.schema.preset,decay:void 0!==i.point.decay?i.point.decay:n.decay.schema.preset,shadowEnabled:i.shadowEnabled||!1,shadowResolution:void 0!==i.shadowResolution&&r.Y[i.shadowResolution]||1,shadowBlur:void 0!==i.shadowBlur?i.shadowBlur:n.shadowBlur.schema.preset,shadowIntensity:void 0!==i.shadowIntensity?i.shadowIntensity:n.shadowIntensity.schema.preset}),e.light}toDocument(t,e){const i=this.ins,n={enabled:i.enabled.value,color:i.color.cloneValue(),intensity:i.intensity.value,point:{distance:i.distance.value,decay:i.decay.value}};n.type=a.type,i.shadowEnabled.value&&(n.shadowEnabled=!0,i.shadowBlur.isDefault()||(n.shadowBlur=i.shadowBlur.value),i.shadowResolution.isDefault()||(n.shadowResolution=r.Y[i.shadowResolution.value]),i.shadowIntensity.isDefault()||(n.shadowIntensity=i.shadowIntensity.value)),t.lights=t.lights||[];const s=t.lights.length;return t.lights.push(n),s}}a.typeName="CVPointLight",a.type="point",a.text="Point Light",a.icon="bulb"},6888:(t,e,i)=>{var n=i(546),s=i(7926),r=Object.prototype,o=r.hasOwnProperty,a=r.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(t){return s(t)&&o.call(t,"callee")&&!a.call(t,"callee")};t.exports=l},6943:(t,e,i)=>{"use strict";var n=i(5532),s=i(6763),r=(i(9498),i(5632),i(6773)),o=i(3051),a=i(4019),l=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let c=class extends a.A{get alphaEnabled(){return 4===this.property.elementCount}constructor(){super(),this.type="number",this.pickerActive=!1,this.compact=!1,this.floating=!0,this.color=new n.Ay,this.onPointerDown=t=>{this.pickerActive&&(t.composedPath()[0]instanceof Node&&this.contains(t.composedPath()[0])||(this.pickerActive=!1))}}firstConnected(){super.firstConnected(),this.classList.add("sv-property-color")}disconnected(){this.pickerActive=!1}update(t){if(t.has("property")){if("number"!==this.property.type||4<this.property.elementCount||this.property.elementCount<3)throw new Error(`not a color property: '${this.property.path}'`);const e=t.get("property");e&&e.off("value",this.onPropertyChange,this),this.property&&(this.property.on("value",this.onPropertyChange,this),this.color.fromArray(this.property.value))}t.has("pickerActive")&&(this.pickerActive?(this.setPickerFocus(),document.addEventListener("pointerdown",this.onPointerDown,{capture:!0,passive:!0})):document.removeEventListener("pointerdown",this.onPointerDown,{capture:!0})),super.update(t)}render(){const t=this.property,e=this.name||t.name,i=this.color.toString(this.alphaEnabled),n=s.qy`<ff-color-edit .color=${this.color} @keydown=${t=>this.onKeyDown(t)} @change=${this.onColorChange}></ff-color-edit>`,o=s.qy`<ff-popup .keepVisible=${!0} .anchor=${this} .position=${"anchor"} .align=${"end"} .justify=${"end"}>${n}</ff-popup>`;return s.qy`<label class="ff-label ff-off">${e}</label>
            <span class="sv-property-field">
                ${this.compact?null:s.qy`<input ?disabled=${"true"===this.ariaDisabled} class="ff-input"
                        type="text"
                        .value=${i}
                        @change=${t=>{try{this.color.setString(t.target.value),this.onColorChange(),t.target.setCustomValidity("")}catch(e){t.target.setCustomValidity(e.message),r.Ay.show(`Not a valid color: ${t.target.value}`,"warning",1e3)}}}
                    >`}
                <ff-button style="background-color: ${i}" title="${e} Color Picker" @click=${this.onButtonClick}></ff-button>
            </span>
            ${this.pickerActive?this.floating?o:n:null}
        `}async setPickerFocus(){await this.updateComplete;const t=this.getElementsByTagName("ff-color-edit").item(0);(0,o.R)(t)[0].focus()}onButtonClick(t){this.pickerActive=!this.pickerActive}onColorChange(){this.property.setValue(this.alphaEnabled?this.color.toRGBAArray():this.color.toRGBArray())}onPropertyChange(t){this.color.fromArray(t),this.requestUpdate()}onKeyDown(t){if("Escape"===t.code||"Enter"===t.code)t.preventDefault(),t.stopPropagation(),this.pickerActive=!1,this.getElementsByTagName("ff-button")[0].focus();else if("Tab"===t.code){const e=this.getElementsByTagName("ff-color-edit")[0];(0,o.i)((0,o.R)(e),t)}}};l([(0,s.MZ)({attribute:!1,type:Boolean})],c.prototype,"pickerActive",void 0),l([(0,s.MZ)({type:Boolean})],c.prototype,"compact",void 0),l([(0,s.MZ)({type:Boolean})],c.prototype,"floating",void 0),c=l([(0,s.EM)("sv-property-color")],c)},6944:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getFeed=void 0;var n=i(272),s=i(5362);e.getFeed=function(t){var e=l(u,t);return e?"feed"===e.name?function(t){var e,i=t.children,n={type:"atom",items:(0,s.getElementsByTagName)("entry",i).map(function(t){var e,i=t.children,n={media:a(i)};h(n,"id","id",i),h(n,"title","title",i);var s=null===(e=l("link",i))||void 0===e?void 0:e.attribs.href;s&&(n.link=s);var r=c("summary",i)||c("content",i);r&&(n.description=r);var o=c("updated",i);return o&&(n.pubDate=new Date(o)),n})};h(n,"id","id",i),h(n,"title","title",i);var r=null===(e=l("link",i))||void 0===e?void 0:e.attribs.href;r&&(n.link=r);h(n,"description","subtitle",i);var o=c("updated",i);o&&(n.updated=new Date(o));return h(n,"author","email",i,!0),n}(e):function(t){var e,i,n=null!==(i=null===(e=l("channel",t.children))||void 0===e?void 0:e.children)&&void 0!==i?i:[],r={type:t.name.substr(0,3),id:"",items:(0,s.getElementsByTagName)("item",t.children).map(function(t){var e=t.children,i={media:a(e)};h(i,"id","guid",e),h(i,"title","title",e),h(i,"link","link",e),h(i,"description","description",e);var n=c("pubDate",e)||c("dc:date",e);return n&&(i.pubDate=new Date(n)),i})};h(r,"title","title",n),h(r,"link","link",n),h(r,"description","description",n);var o=c("lastBuildDate",n);o&&(r.updated=new Date(o));return h(r,"author","managingEditor",n,!0),r}(e):null};var r=["url","type","lang"],o=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function a(t){return(0,s.getElementsByTagName)("media:content",t).map(function(t){for(var e=t.attribs,i={medium:e.medium,isDefault:!!e.isDefault},n=0,s=r;n<s.length;n++){e[c=s[n]]&&(i[c]=e[c])}for(var a=0,l=o;a<l.length;a++){var c;e[c=l[a]]&&(i[c]=parseInt(e[c],10))}return e.expression&&(i.expression=e.expression),i})}function l(t,e){return(0,s.getElementsByTagName)(t,e,!0,1)[0]}function c(t,e,i){return void 0===i&&(i=!1),(0,n.textContent)((0,s.getElementsByTagName)(t,e,i,1)).trim()}function h(t,e,i,n,s){void 0===s&&(s=!1);var r=c(i,n,s);r&&(t[e]=r)}function u(t){return"rss"===t||"feed"===t||"rdf:RDF"===t}},6945:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s=i(3104),r={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:t,tagName:e}})=>t===s.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:i}})=>n._`{error: ${t}, tag: ${i}, tagValue: ${e}}`},code(t){const{gen:e,data:i,schema:r,parentSchema:o,it:a}=t,{oneOf:l}=o;if(!a.opts.discriminator)throw new Error("discriminator: requires discriminator option");const c=r.propertyName;if("string"!=typeof c)throw new Error("discriminator: requires propertyName");if(r.mapping)throw new Error("discriminator: mapping is not supported");if(!l)throw new Error("discriminator: requires oneOf keyword");const h=e.let("valid",!1),u=e.const("tag",n._`${i}${(0,n.getProperty)(c)}`);function d(i){const s=e.name("valid"),r=t.subschema({keyword:"oneOf",schemaProp:i},s);return t.mergeEvaluated(r,n.Name),s}e.if(n._`typeof ${u} == "string"`,()=>function(){const i=function(){var t;const e={},i=s(o);let n=!0;for(let e=0;e<l.length;e++){const o=l[e],a=null===(t=o.properties)||void 0===t?void 0:t[c];if("object"!=typeof a)throw new Error(`discriminator: oneOf schemas must have "properties/${c}"`);n=n&&(i||s(o)),r(a,e)}if(!n)throw new Error(`discriminator: "${c}" must be required`);return e;function s({required:t}){return Array.isArray(t)&&t.includes(c)}function r(t,e){if(t.const)a(t.const,e);else{if(!t.enum)throw new Error(`discriminator: "properties/${c}" must have "const" or "enum"`);for(const i of t.enum)a(i,e)}}function a(t,i){if("string"!=typeof t||t in e)throw new Error(`discriminator: "${c}" values must be unique strings`);e[t]=i}}();e.if(!1);for(const t in i)e.elseIf(n._`${u} === ${t}`),e.assign(h,d(i[t]));e.else(),t.error(!1,{discrError:s.DiscrError.Mapping,tag:u,tagName:c}),e.endIf()}(),()=>t.error(!1,{discrError:s.DiscrError.Tag,tag:u,tagName:c})),t.ok(h)}};e.default=r},6971:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.boolOrEmptySchema=e.topBoolOrEmptySchema=void 0;const n=i(6280),s=i(5265),r=i(2363),o={message:"boolean schema is false"};function a(t,e){const{gen:i,data:s}=t,r={gen:i,keyword:"false schema",data:s,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,n.reportError)(r,o,void 0,e)}e.topBoolOrEmptySchema=function(t){const{gen:e,schema:i,validateName:n}=t;!1===i?a(t,!1):"object"==typeof i&&!0===i.$async?e.return(r.default.data):(e.assign(s._`${n}.errors`,null),e.return(!0))},e.boolOrEmptySchema=function(t,e){const{gen:i,schema:n}=t;!1===n?(i.var(e,!1),a(t)):i.var(e,!0)}},7022:t=>{"use strict";var e=t.exports=function(t,e,n){"function"==typeof e&&(n=e,e={}),i(e,"function"==typeof(n=e.cb||n)?n:n.pre||function(){},n.post||function(){},t,"",t)};function i(t,s,r,o,a,l,c,h,u,d){if(o&&"object"==typeof o&&!Array.isArray(o)){for(var p in s(o,a,l,c,h,u,d),o){var f=o[p];if(Array.isArray(f)){if(p in e.arrayKeywords)for(var g=0;g<f.length;g++)i(t,s,r,f[g],a+"/"+p+"/"+g,l,a,p,o,g)}else if(p in e.propsKeywords){if(f&&"object"==typeof f)for(var m in f)i(t,s,r,f[m],a+"/"+p+"/"+n(m),l,a,p,o,m)}else(p in e.keywords||t.allKeys&&!(p in e.skipKeywords))&&i(t,s,r,f,a+"/"+p,l,a,p,o)}r(o,a,l,c,h,u,d)}}function n(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}e.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},e.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},e.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},e.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},7078:(t,e,i)=>{"use strict";i.d(e,{I:()=>s.A});var n,s=i(2464);!function(t){t[t.directional=0]="directional",t[t.point=1]="point",t[t.spot=2]="spot",t[t.ambient=3]="ambient",t[t.hemisphere=4]="hemisphere",t[t.rect=5]="rect"}(n||(n={}))},7109:(t,e,i)=>{"use strict";i.d(e,{A:()=>f});var n=i(4640);class s extends n.DXC{constructor(t){super(void 0,new n.mrM({color:4294967295,vertexColors:!0})),this.update(t)}set opacity(t){this.material.opacity=t,this.material.transparent=t<1,this.material.needsUpdate=!0}update(t){this.geometry&&this.geometry.dispose(),this.geometry=s.generate(t)}static generate(t){const e=new n.Q1f(t.mainColor),i=new n.Q1f(t.subColor),s=new n.Q1f(10894154),r=new n.Q1f(7315996),o=new n.Q1f(3113953),a=t.mainDivisions*t.subDivisions,l=t.size/a,c=.5*t.size,h=[],u=[];for(let n=0,r=0,d=-c;n<=a;++n,d+=l)if(h.push(-c,0,d,c,0,d),h.push(d,0,-c,d,0,c),n==a/2&&t.axesEnabled)s.toArray(u,r),r+=3,s.toArray(u,r),r+=3,o.toArray(u,r),r+=3,o.toArray(u,r),r+=3;else{const s=n%t.subDivisions===0?e:i;s.toArray(u,r),r+=3,s.toArray(u,r),r+=3,s.toArray(u,r),r+=3,s.toArray(u,r),r+=3}t.axesEnabled&&(h.push(0,-c,0,0,c,0),u.push(...r.toArray()),u.push(...r.toArray()));const d=new n.LoY;return d.setAttribute("position",new n.qtW(h,3)),d.setAttribute("color",new n.qtW(u,3)),d}}var r=i(3423),o=i(3074),a=i(3675),l=i(8172),c=i(4340);const h=new n.Pq0,u=new n.Pq0,d=(new n.kn4).makeRotationX(.5*Math.PI),p=new n.kn4;class f extends o.Ay{constructor(){super(...arguments),this.tape=null,this.ins=this.addInputs(f.gridIns),this.outs=this.addOutputs(f.gridOuts),this._lastViewport=null,this._gridProps={size:20,mainDivisions:2,subDivisions:10,mainColor:new n.Q1f(.5,.7,.8),subColor:new n.Q1f(.25,.35,.4),axesEnabled:!1}}get settingProperties(){return[this.ins.visible,this.ins.color,this.ins.opacity]}get snapshotProperties(){return[this.ins.opacity]}get grid(){return this.object3D}create(){this.ins.pickable.setValue(!1),this.ins.visible.setValue(!1),this.tape=this.node.createComponent(c.A),this.tape.ins.startPosition.setValue([0,0,0]),this.tape.ins.endPosition.setValue([0,0,0]),this.tape.ins.visible.setValue(!1),this.tape.addTag("no_settings"),super.create()}activate(){this.getGraphComponent(l.A).outs.boundingBox.linkTo(this.ins.boundingBox)}deactivate(){this.getGraphComponent(l.A).outs.boundingBox.unlinkTo(this.ins.boundingBox)}update(){const t=this.ins;if(t.color.changed||t.boundingBox.changed||t.axesEnabled.changed){const e=this._gridProps;if(t.color.changed){const i=e.mainColor,n=e.subColor;i.fromArray(t.color.value),n.r=.5*i.r,n.g=.5*i.g,n.b=.5*i.b}if(t.boundingBox.changed){const t=this.getGraphComponent(l.A),i=t.outs.boundingBox.value,n=t.ins.units.value;i.getSize(h);let s=Math.max(h.x,h.y,h.z),r=1;for(;s/r>5;)r*=10;s=Math.ceil(s/r)*r*2,e.size=s,this.outs.size.setValue(s),this.outs.units.setValue(n),e.mainDivisions=s/r,e.subDivisions=10,u.set(0,i.min.y,0),this.tape.ins.startPosition.setValue([-s/2,i.min.y+s/100,-s/2-s/100]),this.tape.ins.endPosition.setValue([-s/2+s/e.mainDivisions,i.min.y+s/100,-s/2-s/100])}e.axesEnabled=t.axesEnabled.value,this.object3D?this.grid.update(e):this.object3D=new s(e),t.boundingBox.changed&&(this.grid.position.copy(u),this.grid.updateMatrix())}return t.visible.changed&&(this.grid.visible=t.visible.value,this.tape.ins.visible.setValue(this.grid.visible&&t.labelEnabled.value)),t.opacity.changed&&(this.grid.opacity=t.opacity.value),t.labelEnabled.changed&&this.tape.ins.visible.setValue(this.grid.visible&&t.labelEnabled.value),!0}preRender(t){const e=t.viewport,i=this.object3D;if(e!==this._lastViewport){this._lastViewport=e;const n=t.viewport.camera;n?(0!=this._gridProps.axesEnabled&&(this._gridProps.axesEnabled=!1,this.grid.update(this._gridProps)),i.matrix.extractRotation(n.matrixWorld).multiply(d)):(i.matrix.extractRotation(p),this._gridProps.axesEnabled=!0,this.grid.update(this._gridProps)),i.updateMatrixWorld(!0)}}postRender(t){this.object3D.updateMatrix()}fromData(t){t=t||{},this.ins.copyValues({visible:!!t.visible,color:t.color||[.5,.7,.8]})}toData(){const t=this.ins;return{visible:t.visible.cloneValue(),color:t.color.cloneValue()}}}f.typeName="CVGrid",f.text="Grid",f.icon="",f.gridIns={color:r.gK.ColorRGB("Grid.Color",[.5,.7,.8]),opacity:r.gK.Percent("Grid.Opacity",1),boundingBox:r.gK.Object("Scene.BoundingBox",n.NRn),labelEnabled:r.gK.Boolean("Grid.LabelEnabled",!0),axesEnabled:r.gK.Boolean("Grid.AxesEnabled",!1)},f.gridOuts={size:r.gK.Number("Size"),units:r.gK.Enum("Units",a.uj)}},7114:(t,e,i)=>{"use strict";let n=i(6613),s=i(6748);class r extends n{get selectors(){return s.comma(this.selector)}set selectors(t){let e=this.selector?this.selector.match(/,\s*/):null,i=e?e[0]:","+this.raw("between","beforeOpen");this.selector=t.join(i)}constructor(t){super(t),this.type="rule",this.nodes||(this.nodes=[])}}t.exports=r,r.default=r,n.registerRule(r)},7129:(t,e,i)=>{"use strict";let n=i(482);class s{get content(){return this.css}constructor(t,e,i){this.processor=t,this.messages=[],this.root=e,this.opts=i,this.css="",this.map=void 0}toString(){return this.css}warn(t,e={}){e.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(e.plugin=this.lastPlugin.postcssPlugin);let i=new n(t,e);return this.messages.push(i),i}warnings(){return this.messages.filter(t=>"warning"===t.type)}}t.exports=s,s.default=s},7137:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var n=i(3074),s=i(4640);class r extends s.eaF{constructor(){super(new s.bdM(2,2,1,1),new s._4j({transparent:!0})),this.geometry.rotateX(-90*s.cj9.DEG2RAD),this.material.onBeforeCompile=t=>{t.vertexShader=t.vertexShader.replace("#include <uv_pars_vertex>","varying vec2 vUv;\n                 uniform mat3 uvTransform;"),t.vertexShader=t.vertexShader.replace("#include <uv_vertex>","#include <uv_vertex>\n                 vUv = ( vec3( uv, 1 ) ).xy;"),t.fragmentShader=t.fragmentShader.replace("#include <uv_pars_fragment>","varying vec2 vUv;"),t.fragmentShader=t.fragmentShader.replace("#include <opaque_fragment>","#include <opaque_fragment>\n                 \n                 vec2 coords = vUv * 2.0 - 1.0;\n                 float f = dot(coords, coords);\n \t            gl_FragColor = vec4(outgoingLight, mix(diffuseColor.a, 0.0, f));\n                 \n")},this.receiveShadow=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}class o extends n.Ay{constructor(t,e){super(t,e),this.ins=this.addInputs(o.floorIns),this.object3D=new r}get floor(){return this.object3D}update(t){super.update(t);const e=this.ins,i=this.floor;return(e.position.changed||e.radius.changed)&&(i.position.fromArray(e.position.value),i.scale.setScalar(e.radius.value),i.updateMatrix()),e.color.changed&&i.material.color.fromArray(e.color.value),e.opacity.changed&&(i.material.opacity=e.opacity.value),!0}dispose(){this.floor.dispose(),super.dispose()}}o.typeName="CFloor",o.floorIns={position:n.gK.Vector3("Floor.Position",[0,-25,0]),radius:n.gK.Number("Floor.Radius",50),color:n.gK.ColorRGB("Floor.Color",[.6,.75,.8]),opacity:n.gK.Percent("Floor.Opacity",.5),castShadow:n.gK.Boolean("Shadow.Cast"),receiveShadow:n.gK.Boolean("Shadow.Receive")};var a=i(3423),l=i(8172);const c=new s.Pq0;class h extends o{get settingProperties(){return[this.ins.visible,this.ins.position,this.ins.radius,this.ins.color,this.ins.opacity,this.ins.receiveShadow,this.addIns.autoSize]}get snapshotProperties(){return[this.ins.opacity]}get sceneNode(){return this.getSystemComponent(l.A)}constructor(t,e){super(t,e),this.addIns=this.addInputs(h.floorAddIns),this.ins.visible.setValue(!1),this.ins.receiveShadow.setValue(!0),this.floor.renderOrder=-1}create(){super.create(),this.sceneNode.outs.boundingBox.on("value",this.recalculateSize,this)}dispose(){this.sceneNode.outs.boundingBox.off("value",this.recalculateSize,this),super.dispose()}update(t){const e=this.addIns;return e.autoSize.changed&&e.autoSize.value&&this.recalculateSize(),super.update(t),!0}recalculateSize(){const{addIns:t}=this;if(t.autoSize.value){const t=this.sceneNode.outs.boundingBox.value;t.getSize(c);const e=Math.max(c.x,c.y,c.z),{min:i,max:n}=t;this.ins.radius.setValue(e),this.ins.position.setValue([(i.x+n.x)/2,i.y,(i.z+n.z)/2])}}fromData(t){t=t||{},this.ins.copyValues({visible:!!t.visible,position:t.position||[0,-25,0],radius:void 0!==t.size?t.size:50,color:t.color||[.6,.75,.8],opacity:void 0!==t.opacity?t.opacity:.5,receiveShadow:!!t.receiveShadow,autoSize:void 0===t.autoSize||t.autoSize})}toData(){const t=this.ins;return{visible:t.visible.value,position:t.position.cloneValue(),size:t.radius.value,color:t.color.cloneValue(),opacity:t.opacity.value,receiveShadow:t.receiveShadow.value,autoSize:this.addIns.autoSize.value}}}h.typeName="CVFloor",h.text="Floor",h.icon="",h.floorAddIns={autoSize:a.gK.Boolean("Floor.AutoSize",!0)}},7229:(t,e,i)=>{"use strict";i.d(e,{AG:()=>s,zv:()=>r});const n=new(i(4640).Pq0)(1,0,0);function s(t){var e;null!==(e=t.defines)&&void 0!==e||(t.defines={}),t.defines.OBJECTSPACE_NORMALMAP=!1,t.defines.MODE_NORMALS=!1,t.defines.MODE_XRAY=!1,t.defines.CUT_PLANE=!1,t.defines.USE_ZONEMAP=!1,t.defines.OVERLAY_ALPHA=!1}function r(t){const e={cutPlaneColor:{value:n},zoneMap:{value:null}};t.onBeforeCompile=i=>{i.vertexShader=function(t){return(t="// Zone map support\n         #if defined(USE_ZONEMAP)\n             varying vec2 vZoneUv;\n         #endif\n         \n         #ifdef MODE_XRAY\n             varying float vIntensity;\n         #endif\n         \n".concat(t)).slice(0,t.lastIndexOf("}")).concat("\n         #ifdef MODE_NORMALS\n             vNormal = normal;\n         #endif\n         \n         #ifdef MODE_XRAY\n             vIntensity = pow(abs(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0)))), 3.0);\n         #endif\n         \n         // Zone map support\n         #if defined(USE_ZONEMAP)\n             #if defined(USE_MAP)\n                 vZoneUv = (mapTransform * vec3(vMapUv, 1)).xy;\n             #else\n                 vZoneUv = uv;\n             #endif\n         #endif\n         }")}(i.vertexShader),i.fragmentShader=function(t){return(t=(t=(t=t.replace("void main() {","// Zone map support\n         #if defined(USE_ZONEMAP)\n             varying vec2 vZoneUv;\n             uniform sampler2D zoneMap;\n         #endif\n         \n         #ifdef MODE_XRAY\n             varying float vIntensity;\n         #endif\n         \n         #ifdef CUT_PLANE\n             uniform vec3 cutPlaneColor;\n         #endif\n         \n         void main() {")).replace("#include <opaque_fragment>","#include <opaque_fragment>\n         \n         #ifdef USE_ZONEMAP\n             vec4 zoneColor = texture2D(zoneMap, vZoneUv);\n         \n             #ifdef OVERLAY_ALPHA\n                 gl_FragColor += mix(vec4(0.0, 0.0, 0.0, 1.0), vec4(zoneColor.rgb, 1.0), zoneColor.a);\n             #endif\n             #ifndef OVERLAY_ALPHA\n                 gl_FragColor = mix(gl_FragColor, vec4(zoneColor.rgb, 1.0), zoneColor.a);\n             #endif\n         #endif\n         \n")).slice(0,t.lastIndexOf("}")).concat("\n         #ifdef CUT_PLANE\n         if (!gl_FrontFacing) {\n             gl_FragColor = vec4(cutPlaneColor.rgb, 1.0);\n         }\n         #endif\n         \n         #ifdef MODE_NORMALS\n             gl_FragColor = vec4(vec3(normal * 0.5 + 0.5), 1.0);\n         #endif\n         \n         #ifdef MODE_XRAY\n             gl_FragColor = vec4(vec3(0.4, 0.7, 1.0) * vIntensity, 1.0);\n         #endif\n         }")).replace("#include <aomap_fragment>","#include <aomap_fragment>\n         \n         #ifdef USE_AOMAP\n             if(length(reflectedLight.indirectDiffuse) == 0.0) {\n                 reflectedLight.directDiffuse *= ambientOcclusion;\n             }\n         #endif\n         \n")}(i.fragmentShader),i.uniforms.cutPlaneColor=e.cutPlaneColor,i.uniforms.zoneMap=e.zoneMap,t.userData.shader=i}}},7264:t=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},7280:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});class n{constructor(t){this.isEnabled=!0,this._isDragging=!1,this._startX=0,this._startY=0,this._lastX=0,this._lastY=0,this.target=t,this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),t.addEventListener("pointercancel",this.onPointerUp)}get isDragging(){return this._isDragging}get startX(){return this._startX}get startY(){return this._startY}onPointerDown(t){t.isPrimary&&this.isEnabled&&(this._isDragging=!0,this._startX=this._lastX=t.clientX,this._startY=this._lastY=t.clientY,this.target.setPointerCapture(t.pointerId),this.target.dragStart(t)),t.stopPropagation(),t.preventDefault()}onPointerMove(t){if(t.isPrimary&&this._isDragging){const e=t.clientX-this._lastX;this._lastX=t.clientX;const i=t.clientY-this._lastY;this._lastY=t.clientY,this.target.dragMove(t,e,i)}t.stopPropagation(),t.preventDefault()}onPointerUp(t){this._isDragging&&t.isPrimary&&(this.target.dragEnd(t),this.target.releasePointerCapture(t.pointerId),this._isDragging=!1),t.stopPropagation(),t.preventDefault()}}},7297:(t,e,i)=>{"use strict";i.d(e,{Jb:()=>a,UH:()=>n,a9:()=>s,iO:()=>r,oo:()=>o,uj:()=>l.uj});var n,s,r,o,a,l=i(3675);!function(t){t[t.Image2D=0]="Image2D",t[t.Web3D=1]="Web3D",t[t.App3D=2]="App3D",t[t.iOSApp3D=3]="iOSApp3D",t[t.Print3D=4]="Print3D",t[t.Editorial3D=5]="Editorial3D"}(n||(n={})),function(t){t[t.Thumb=0]="Thumb",t[t.Low=1]="Low",t[t.Medium=2]="Medium",t[t.High=3]="High",t[t.Highest=4]="Highest",t[t.AR=5]="AR"}(s||(s={})),function(t){t[t.Model=0]="Model",t[t.Geometry=1]="Geometry",t[t.Image=2]="Image",t[t.Texture=3]="Texture",t[t.Points=4]="Points",t[t.Volume=5]="Volume"}(r||(r={})),function(t){t[t.Color=0]="Color",t[t.Emissive=1]="Emissive",t[t.Occlusion=2]="Occlusion",t[t.Normal=3]="Normal",t[t.MetallicRoughness=4]="MetallicRoughness",t[t.Zone=5]="Zone"}(o||(o={})),function(t){t[t.Front=0]="Front",t[t.Back=1]="Back",t[t.Double=2]="Double"}(a||(a={}))},7350:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var n=i(449),s=i(3331);class r{constructor(){this.visited={},this.visiting={},this.sorted=[]}sort(t){for(let e=0,i=t.length;e<i;++e)this.visit(t[e]);const e=this.sorted;return this.visited={},this.visiting={},this.sorted=[],e}visit(t){const e=this.visited,i=this.visiting;if(e[t.id]||i[t.id])return;i[t.id]=!0;const n=t.outs.properties.concat(t.ins.properties);for(let t=0,e=n.length;t<e;++t){const e=n[t].outLinks;for(let t=0,i=e.length;t<i;++t){const i=e[t].destination.group,n=i.properties;for(let t=0,e=n.length;t<e;++t){const e=n[t].outLinks;for(let t=0,i=e.length;t<i;++t){const i=e[t].destination.group;this.visit(i.linkable)}}this.visit(i.linkable)}}i[t.id]=void 0,e[t.id]=!0,this.sorted.unshift(t)}}var o=i(3423),a=i(1860),l=i(3627);class c extends s.A{constructor(t,e){super({knownEvents:!1}),this.nodes=new l.A(a.A),this.components=new l.A(o.Ay),this.roots=[],this._sorter=new r,this._sortRequested=!0,this._sortedList=null,this._tockList=[],this._isActive=!1,this.system=t,this.parent=e}get isActive(){return this._isActive}getComponent(t,e=!1){return this.components.get(t,e)}getComponents(t){return this.components.getArray(t)}getComponentsByTag(t){return this.components.getByTag(t)}hasComponent(t){return this.components.has(t)}getMainComponent(t,e=!1){return this.system.graph.components.get(t,e)}getMainComponents(t){return this.system.graph.components.getArray(t)}getMainComponentsByTag(t){return this.system.graph.components.getByTag(t)}hasMainComponent(t){return this.system.graph.components.has(t)}getSystemComponent(t,e=!1){return this.system.components.get(t,e)}getSystemComponents(t){return this.system.components.getArray(t)}getSystemComponentsByTag(t){return this.system.components.getByTag(t)}hasSystemComponent(t){return this.system.components.has(t)}getComponentById(t){return this.system.components.getById(t)}getNode(t,e=!1){return this.nodes.get(t,e)}getNodes(t){return this.nodes.getArray(t)}getNodesByTag(t){return this.nodes.getByTag(t)}hasNode(t){return this.nodes.has(t)}getMainNode(t,e=!1){return this.system.graph.nodes.get(t,e)}getMainNodes(t){return this.system.graph.nodes.getArray(t)}getMainNodesByTag(t){return this.system.graph.nodes.getByTag(t)}hasMainNode(t){return this.system.graph.nodes.has(t)}getSystemNode(t,e=!1){return this.system.nodes.get(t,e)}getSystemNodes(t){return this.system.nodes.getArray(t)}getSystemNodesByTag(t){return this.system.nodes.getByTag(t)}hasSystemNode(t){return this.system.nodes.has(t)}getNodeById(t){return this.system.nodes.getById(t)}activate(){if(this._isActive)return;this._isActive=!0,this._sortRequested&&(this._sortRequested=!1,this.sort());const t=this._sortedList;for(let e=0,i=t.length;e<i;++e){const i=t[e];i.activate&&i.activate()}}deactivate(){if(!this._isActive)return;this._isActive=!1;const t=this._sortedList;for(let e=0,i=t.length;e<i;++e){const i=t[e];i.deactivate&&i.deactivate()}}tick(t){if(!this._isActive)return;this._sortRequested&&(this._sortRequested=!1,this.sort());const e=this._sortedList;let i=!1;for(let n=0,s=e.length;n<s;++n){const s=e[n];s.updated=!1,s.changed?(s.update&&s.update(t)&&(s.updated=!0),s.tick&&s.tick(t)&&(s.updated=!0),s.resetChanged()):s.tick&&s.tick(t)&&(s.updated=!0),s.updated&&(i=!0,s.emit("update"))}return i}tock(t){if(!this._isActive)return;const e=this._tockList;let i=!1;for(let n=0,s=e.length;n<s;++n)i=e[n].tock(t)||i;return i}clear(){const t=this.nodes.cloneArray().reverse();for(let e=0,i=t.length;e<i;++e)t[e].dispose();if(this.nodes.length>0)throw new Error("graph not empty")}requestSort(){this._sortRequested=!0}sort(){this._sortedList=this._sorter.sort(this.components.getArray());this.parent&&(this.parent.name||this.parent.typeName)}createCustomNode(t,e,i){const s=this.system.registry.getType(t);if(!s)throw new Error(`node type '${a.A.getTypeName(t)}' not registered`);const r=new s(this,i||(0,n.A)(12,this.system.nodes.getDictionary()));return r.create(),e&&(r.name=e),i||(r.createComponents(),r.unlock()),r}createNode(t,e){const i=new a.A(this,e||(0,n.A)(12,this.system.nodes.getDictionary()));return i.create(),t&&(i.name=t),i.unlock(),i}findNodeByName(t,e){const i=this.nodes.getArray(e);for(let e=0,n=i.length;e<n;++e)if(i[e].name===t)return i[e]}findRootNodes(t){const e=this.nodes.getArray(t),i=[];for(let t=0,n=e.length;t<n;++t){const n=e[t].components.get("CHierarchy",!0);n&&n.parent||i.push(e[t])}return i}toString(t=!1){const e=this.nodes.getArray(),i=this.components.count(),n=`Graph - ${e.length} nodes, ${i} components.`;return t?n+"\n"+e.map(t=>t.toString(!0)).join("\n"):n}dump(t=""){console.log(t+"%cGraph","color: red");this.findRootNodes().forEach(e=>e.dump(t+"  "))}toJSON(){const t={},e=[],i=this.nodes.getArray();for(let t=0,n=i.length;t<n;++t){const n=i[t],s=this.nodeToJSON(n);s.type=n.typeName,s.id=n.id,n.name&&(s.name=n.name),e.push(s)}return e.length>0&&(t.nodes=e),t}fromJSON(t){t.nodes&&(t.nodes.forEach(t=>{this.createCustomNode(t.type,t.name,t.id).fromJSON(t)}),t.nodes.forEach(t=>{this.nodes.getById(t.id).referencesFromJSON(t)}))}nodeToJSON(t){return t.toJSON()}_addNode(t){this.nodes.add(t),this.system._addNode(t)}_removeNode(t){this.system._removeNode(t),this.nodes.remove(t)}_addNodeTag(t,e){this.nodes.addByTag(t,e),this.system._addNodeTag(t,e)}_removeNodeTag(t,e){this.system._removeNodeTag(t,e),this.nodes.removeByTag(t,e)}_addComponent(t){if(t.isGraphSingleton&&this.components.has(t))throw new Error(`only one component of type '${t.typeName}' allowed per graph`);this.components.add(t),this.system._addComponent(t),t.tock&&this._tockList.push(t),this._sortRequested=!0}_removeComponent(t){this.system._removeComponent(t),this.components.remove(t),t.tock&&this._tockList.splice(this._tockList.indexOf(t),1),this._sortRequested=!0}_addComponentTag(t,e){this.components.addByTag(t,e),this.system._addComponentTag(t,e)}_removeComponentTag(t,e){this.system._removeComponentTag(t,e),this.components.removeByTag(t,e)}_addRoot(t){this.roots.push(t),this.parent&&this.parent.onAddInnerRoot(t)}_removeRoot(t){this.parent&&this.parent.onRemoveInnerRoot(t),this.roots.splice(this.roots.indexOf(t),1)}}},7405:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const n=i(5265),s=i(3151),r=i(6241);e.error={message:({params:{property:t,depsCount:e,deps:i}})=>{const s=1===e?"property":"properties";return n.str`must have ${s} ${i} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:i,missingProperty:s}})=>n._`{property: ${t},
    missingProperty: ${s},
    depsCount: ${e},
    deps: ${i}}`};const o={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(t){const[e,i]=function({schema:t}){const e={},i={};for(const n in t){if("__proto__"===n)continue;(Array.isArray(t[n])?e:i)[n]=t[n]}return[e,i]}(t);a(t,e),l(t,i)}};function a(t,e=t.schema){const{gen:i,data:s,it:o}=t;if(0===Object.keys(e).length)return;const a=i.let("missing");for(const l in e){const c=e[l];if(0===c.length)continue;const h=(0,r.propertyInData)(i,s,l,o.opts.ownProperties);t.setParams({property:l,depsCount:c.length,deps:c.join(", ")}),o.allErrors?i.if(h,()=>{for(const e of c)(0,r.checkReportMissingProp)(t,e)}):(i.if(n._`${h} && (${(0,r.checkMissingProp)(t,c,a)})`),(0,r.reportMissingProp)(t,a),i.else())}}function l(t,e=t.schema){const{gen:i,data:n,keyword:o,it:a}=t,l=i.name("valid");for(const c in e)(0,s.alwaysValidSchema)(a,e[c])||(i.if((0,r.propertyInData)(i,n,c,a.opts.ownProperties),()=>{const e=t.subschema({keyword:o,schemaProp:c},l);t.mergeValidEvaluated(e,l)},()=>i.var(l,!0)),t.ok(l))}e.validatePropertyDeps=a,e.validateSchemaDeps=l,e.default=o},7430:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(1365);n.code='require("ajv/dist/runtime/equal").default',e.default=n},7482:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var n=i(4640),s=i(2464);class r extends s.A{constructor(t,e){super(t,e),this.object3D=new n.$p8}get light(){return this.object3D}}r.typeName="CAmbientLight"},7504:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var n=i(1860),s=i(9309),r=i(3889),o=i(3644),a=i(319),l=i(161),c=i(3600),h=i(8604),u=i(2791);class d extends n.A{get pulse(){return this.components.get(s.A)}get renderer(){return this.components.get(r.A)}get fullscreen(){return this.components.get(a.A)}get selection(){return this.components.get(o.A)}get assetManager(){return this.components.get(l.A)}get assetReader(){return this.components.get(c.A)}get analytics(){return this.components.get(h.A)}get arManager(){return this.components.get(u.A)}createComponents(){this.createComponent(s.A),this.createComponent(r.A),this.createComponent(a.A),this.createComponent(l.A),this.createComponent(c.A),this.createComponent(h.A),this.createComponent(u.A);this.createComponent(o.A).ins.viewportBrackets.setValue(!1)}}d.typeName="NVEngine"},7550:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s=n.operators,r={maximum:{okStr:"<=",ok:s.LTE,fail:s.GT},minimum:{okStr:">=",ok:s.GTE,fail:s.LT},exclusiveMaximum:{okStr:"<",ok:s.LT,fail:s.GTE},exclusiveMinimum:{okStr:">",ok:s.GT,fail:s.LTE}},o={message:({keyword:t,schemaCode:e})=>n.str`must be ${r[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>n._`{comparison: ${r[t].okStr}, limit: ${e}}`},a={keyword:Object.keys(r),type:"number",schemaType:"number",$data:!0,error:o,code(t){const{keyword:e,data:i,schemaCode:s}=t;t.fail$data(n._`${i} ${r[e].fail} ${s} || isNaN(${i})`)}};e.default=a},7616:(t,e,i)=>{"use strict";let{dirname:n,relative:s,resolve:r,sep:o}=i(5324),{SourceMapConsumer:a,SourceMapGenerator:l}=i(8645),{pathToFileURL:c}=i(588),h=i(8262),u=Boolean(a&&l),d=Boolean(n&&r&&s&&o);t.exports=class{constructor(t,e,i,n){this.stringify=t,this.mapOpts=i.map||{},this.root=e,this.opts=i,this.css=n,this.originalCSS=n,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let t;t=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";let e="\n";this.css.includes("\r\n")&&(e="\r\n"),this.css+=e+"/*# sourceMappingURL="+t+" */"}applyPrevMaps(){for(let t of this.previous()){let e,i=this.toUrl(this.path(t.file)),s=t.root||n(t.file);!1===this.mapOpts.sourcesContent?(e=new a(t.text),e.sourcesContent&&(e.sourcesContent=null)):e=t.consumer(),this.map.applySourceMap(e,i,this.toUrl(this.path(s)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root){let t;for(let e=this.root.nodes.length-1;e>=0;e--)t=this.root.nodes[e],"comment"===t.type&&t.text.startsWith("# sourceMappingURL=")&&this.root.removeChild(e)}else this.css&&(this.css=this.css.replace(/\n*\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),d&&u&&this.isMap())return this.generateMap();{let t="";return this.stringify(this.root,e=>{t+=e}),[t]}}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){let t=this.previous()[0].consumer();t.file=this.outputFile(),this.map=l.fromSourceMap(t,{ignoreInvalidMapping:!0})}else this.map=new l({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new l({file:this.outputFile(),ignoreInvalidMapping:!0});let t,e,i=1,n=1,s="<no source>",r={generated:{column:0,line:0},original:{column:0,line:0},source:""};this.stringify(this.root,(o,a,l)=>{if(this.css+=o,a&&"end"!==l&&(r.generated.line=i,r.generated.column=n-1,a.source&&a.source.start?(r.source=this.sourcePath(a),r.original.line=a.source.start.line,r.original.column=a.source.start.column-1,this.map.addMapping(r)):(r.source=s,r.original.line=1,r.original.column=0,this.map.addMapping(r))),e=o.match(/\n/g),e?(i+=e.length,t=o.lastIndexOf("\n"),n=o.length-t):n+=o.length,a&&"start"!==l){let t=a.parent||{raws:{}};("decl"===a.type||"atrule"===a.type&&!a.nodes)&&a===t.last&&!t.raws.semicolon||(a.source&&a.source.end?(r.source=this.sourcePath(a),r.original.line=a.source.end.line,r.original.column=a.source.end.column-1,r.generated.line=i,r.generated.column=n-2,this.map.addMapping(r)):(r.source=s,r.original.line=1,r.original.column=0,r.generated.line=i,r.generated.column=n-1,this.map.addMapping(r)))}})}isAnnotation(){return!!this.isInline()||(void 0!==this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some(t=>t.annotation))}isInline(){if(void 0!==this.mapOpts.inline)return this.mapOpts.inline;let t=this.mapOpts.annotation;return(void 0===t||!0===t)&&(!this.previous().length||this.previous().some(t=>t.inline))}isMap(){return void 0!==this.opts.map?!!this.opts.map:this.previous().length>0}isSourcesContent(){return void 0!==this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some(t=>t.withContent())}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(t){if(this.mapOpts.absolute)return t;if(60===t.charCodeAt(0))return t;if(/^\w+:\/\//.test(t))return t;let e=this.memoizedPaths.get(t);if(e)return e;let i=this.opts.to?n(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(i=n(r(i,this.mapOpts.annotation)));let o=s(i,t);return this.memoizedPaths.set(t,o),o}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(t=>{if(t.source&&t.source.input.map){let e=t.source.input.map;this.previousMaps.includes(e)||this.previousMaps.push(e)}});else{let t=new h(this.originalCSS,this.opts);t.map&&this.previousMaps.push(t.map)}return this.previousMaps}setSourcesContent(){let t={};if(this.root)this.root.walk(e=>{if(e.source){let i=e.source.input.from;if(i&&!t[i]){t[i]=!0;let n=this.usesFileUrls?this.toFileUrl(i):this.toUrl(this.path(i));this.map.setSourceContent(n,e.source.input.css)}}});else if(this.css){let t=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(t,this.css)}}sourcePath(t){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(t.source.input.from):this.toUrl(this.path(t.source.input.from))}toBase64(t){return Buffer?Buffer.from(t).toString("base64"):window.btoa(unescape(encodeURIComponent(t)))}toFileUrl(t){let e=this.memoizedFileURLs.get(t);if(e)return e;if(c){let e=c(t).toString();return this.memoizedFileURLs.set(t,e),e}throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(t){let e=this.memoizedURLs.get(t);if(e)return e;"\\"===o&&(t=t.replace(/\\/g,"/"));let i=encodeURI(t).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(t,i),i}}},7738:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assignDefaults=void 0;const n=i(5265),s=i(3151);function r(t,e,i){const{gen:r,compositeRule:o,data:a,opts:l}=t;if(void 0===i)return;const c=n._`${a}${(0,n.getProperty)(e)}`;if(o)return void(0,s.checkStrictMode)(t,`default is ignored for: ${c}`);let h=n._`${c} === undefined`;"empty"===l.useDefaults&&(h=n._`${h} || ${c} === null || ${c} === ""`),r.if(h,n._`${c} = ${(0,n.stringify)(i)}`)}e.assignDefaults=function(t,e){const{properties:i,items:n}=t.schema;if("object"===e&&i)for(const e in i)r(t,e,i[e].default);else"array"===e&&Array.isArray(n)&&n.forEach((e,i)=>r(t,i,e.default))}},7748:(t,e,i)=>{"use strict";var n=i(3567),s=Array.prototype.concat,r=Array.prototype.slice,o=t.exports=function(t){for(var e=[],i=0,o=t.length;i<o;i++){var a=t[i];n(a)?e=s.call(e,r.call(a)):e.push(a)}return e};o.wrap=function(t){return function(){return t(o(arguments))}}},7776:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=[i(5253).default];e.default=n},7784:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=new Uint16Array('ᵁ<Õıʊҝջאٵ۞ޢߖࠏ੊ઑඡ๭༉༦჊ረዡᐕᒝᓃᓟᔥ\0\0\0\0\0\0ᕫᛍᦍᰒᷝ὾⁠↰⊍⏀⏻⑂⠤⤒ⴈ⹈⿎〖㊺㘹㞬㣾㨨㩱㫠㬮ࠀEMabcfglmnoprstu\\bfms¦³¹ÈÏlig耻Æ䃆P耻&䀦cute耻Á䃁reve;䄂Āiyx}rc耻Â䃂;䐐r;쀀𝔄rave耻À䃀pha;䎑acr;䄀d;橓Āgp¡on;䄄f;쀀𝔸plyFunction;恡ing耻Å䃅Ācs¾Ãr;쀀𝒜ign;扔ilde耻Ã䃃ml耻Ä䃄ЀaceforsuåûþėĜĢħĪĀcrêòkslash;或Ŷöø;櫧ed;挆y;䐑ƀcrtąċĔause;戵noullis;愬a;䎒r;쀀𝔅pf;쀀𝔹eve;䋘còēmpeq;扎܀HOacdefhilorsuōőŖƀƞƢƵƷƺǜȕɳɸɾcy;䐧PY耻©䂩ƀcpyŝŢźute;䄆Ā;iŧŨ拒talDifferentialD;慅leys;愭ȀaeioƉƎƔƘron;䄌dil耻Ç䃇rc;䄈nint;戰ot;䄊ĀdnƧƭilla;䂸terDot;䂷òſi;䎧rcleȀDMPTǇǋǑǖot;抙inus;抖lus;投imes;抗oĀcsǢǸkwiseContourIntegral;戲eCurlyĀDQȃȏoubleQuote;思uote;怙ȀlnpuȞȨɇɕonĀ;eȥȦ户;橴ƀgitȯȶȺruent;扡nt;戯ourIntegral;戮ĀfrɌɎ;愂oduct;成nterClockwiseContourIntegral;戳oss;樯cr;쀀𝒞pĀ;Cʄʅ拓ap;才րDJSZacefiosʠʬʰʴʸˋ˗ˡ˦̳ҍĀ;oŹʥtrahd;椑cy;䐂cy;䐅cy;䐏ƀgrsʿ˄ˇger;怡r;憡hv;櫤Āayː˕ron;䄎;䐔lĀ;t˝˞戇a;䎔r;쀀𝔇Āaf˫̧Ācm˰̢riticalȀADGT̖̜̀̆cute;䂴oŴ̋̍;䋙bleAcute;䋝rave;䁠ilde;䋜ond;拄ferentialD;慆Ѱ̽\0\0\0͔͂\0Ѕf;쀀𝔻ƀ;DE͈͉͍䂨ot;惜qual;扐blèCDLRUVͣͲ΂ϏϢϸontourIntegraìȹoɴ͹\0\0ͻ»͉nArrow;懓Āeo·ΤftƀARTΐΖΡrrow;懐ightArrow;懔eåˊngĀLRΫτeftĀARγιrrow;柸ightArrow;柺ightArrow;柹ightĀATϘϞrrow;懒ee;抨pɁϩ\0\0ϯrrow;懑ownArrow;懕erticalBar;戥ǹABLRTaВЪаўѿͼrrowƀ;BUНОТ憓ar;椓pArrow;懵reve;䌑eft˒к\0ц\0ѐightVector;楐eeVector;楞ectorĀ;Bљњ憽ar;楖ightǔѧ\0ѱeeVector;楟ectorĀ;BѺѻ懁ar;楗eeĀ;A҆҇护rrow;憧ĀctҒҗr;쀀𝒟rok;䄐ࠀNTacdfglmopqstuxҽӀӄӋӞӢӧӮӵԡԯԶՒ՝ՠեG;䅊H耻Ð䃐cute耻É䃉ƀaiyӒӗӜron;䄚rc耻Ê䃊;䐭ot;䄖r;쀀𝔈rave耻È䃈ement;戈ĀapӺӾcr;䄒tyɓԆ\0\0ԒmallSquare;旻erySmallSquare;斫ĀgpԦԪon;䄘f;쀀𝔼silon;䎕uĀaiԼՉlĀ;TՂՃ橵ilde;扂librium;懌Āci՗՚r;愰m;橳a;䎗ml耻Ë䃋Āipժկsts;戃onentialE;慇ʀcfiosօֈ֍ֲ׌y;䐤r;쀀𝔉lledɓ֗\0\0֣mallSquare;旼erySmallSquare;斪Ͱֺ\0ֿ\0\0ׄf;쀀𝔽All;戀riertrf;愱cò׋؀JTabcdfgorstר׬ׯ׺؀ؒؖ؛؝أ٬ٲcy;䐃耻>䀾mmaĀ;d׷׸䎓;䏜reve;䄞ƀeiy؇،ؐdil;䄢rc;䄜;䐓ot;䄠r;쀀𝔊;拙pf;쀀𝔾eater̀EFGLSTصلَٖٛ٦qualĀ;Lؾؿ扥ess;招ullEqual;执reater;檢ess;扷lantEqual;橾ilde;扳cr;쀀𝒢;扫ЀAacfiosuڅڋږڛڞڪھۊRDcy;䐪Āctڐڔek;䋇;䁞irc;䄤r;愌lbertSpace;愋ǰگ\0ڲf;愍izontalLine;攀Āctۃۅòکrok;䄦mpńېۘownHumðįqual;扏܀EJOacdfgmnostuۺ۾܃܇܎ܚܞܡܨ݄ݸދޏޕcy;䐕lig;䄲cy;䐁cute耻Í䃍Āiyܓܘrc耻Î䃎;䐘ot;䄰r;愑rave耻Ì䃌ƀ;apܠܯܿĀcgܴܷr;䄪inaryI;慈lieóϝǴ݉\0ݢĀ;eݍݎ戬Āgrݓݘral;戫section;拂isibleĀCTݬݲomma;恣imes;恢ƀgptݿރވon;䄮f;쀀𝕀a;䎙cr;愐ilde;䄨ǫޚ\0ޞcy;䐆l耻Ï䃏ʀcfosuެ޷޼߂ߐĀiyޱ޵rc;䄴;䐙r;쀀𝔍pf;쀀𝕁ǣ߇\0ߌr;쀀𝒥rcy;䐈kcy;䐄΀HJacfosߤߨ߽߬߱ࠂࠈcy;䐥cy;䐌ppa;䎚Āey߶߻dil;䄶;䐚r;쀀𝔎pf;쀀𝕂cr;쀀𝒦րJTaceflmostࠥࠩࠬࡐࡣ঳সে্਷ੇcy;䐉耻<䀼ʀcmnpr࠷࠼ࡁࡄࡍute;䄹bda;䎛g;柪lacetrf;愒r;憞ƀaeyࡗ࡜ࡡron;䄽dil;䄻;䐛Āfsࡨ॰tԀACDFRTUVarࡾࢩࢱࣦ࣠ࣼयज़ΐ४Ānrࢃ࢏gleBracket;柨rowƀ;BR࢙࢚࢞憐ar;懤ightArrow;懆eiling;挈oǵࢷ\0ࣃbleBracket;柦nǔࣈ\0࣒eeVector;楡ectorĀ;Bࣛࣜ懃ar;楙loor;挊ightĀAV࣯ࣵrrow;憔ector;楎Āerँगeƀ;AVउऊऐ抣rrow;憤ector;楚iangleƀ;BEतथऩ抲ar;槏qual;抴pƀDTVषूौownVector;楑eeVector;楠ectorĀ;Bॖॗ憿ar;楘ectorĀ;B॥०憼ar;楒ightáΜs̀EFGLSTॾঋকঝঢভqualGreater;拚ullEqual;扦reater;扶ess;檡lantEqual;橽ilde;扲r;쀀𝔏Ā;eঽা拘ftarrow;懚idot;䄿ƀnpw৔ਖਛgȀLRlr৞৷ਂਐeftĀAR০৬rrow;柵ightArrow;柷ightArrow;柶eftĀarγਊightáοightáϊf;쀀𝕃erĀLRਢਬeftArrow;憙ightArrow;憘ƀchtਾੀੂòࡌ;憰rok;䅁;扪Ѐacefiosuਗ਼੝੠੷੼અઋ઎p;椅y;䐜Ādl੥੯iumSpace;恟lintrf;愳r;쀀𝔐nusPlus;戓pf;쀀𝕄cò੶;䎜ҀJacefostuણધભીଔଙඑ඗ඞcy;䐊cute;䅃ƀaey઴હાron;䅇dil;䅅;䐝ƀgswે૰଎ativeƀMTV૓૟૨ediumSpace;怋hiĀcn૦૘ë૙eryThiî૙tedĀGL૸ଆreaterGreateòٳessLesóੈLine;䀊r;쀀𝔑ȀBnptଢନଷ଺reak;恠BreakingSpace;䂠f;愕ڀ;CDEGHLNPRSTV୕ୖ୪୼஡௫ఄ౞಄ದ೘ൡඅ櫬Āou୛୤ngruent;扢pCap;扭oubleVerticalBar;戦ƀlqxஃஊ஛ement;戉ualĀ;Tஒஓ扠ilde;쀀≂̸ists;戄reater΀;EFGLSTஶஷ஽௉௓௘௥扯qual;扱ullEqual;쀀≧̸reater;쀀≫̸ess;批lantEqual;쀀⩾̸ilde;扵umpń௲௽ownHump;쀀≎̸qual;쀀≏̸eĀfsఊధtTriangleƀ;BEచఛడ拪ar;쀀⧏̸qual;括s̀;EGLSTవశ఼ౄోౘ扮qual;扰reater;扸ess;쀀≪̸lantEqual;쀀⩽̸ilde;扴estedĀGL౨౹reaterGreater;쀀⪢̸essLess;쀀⪡̸recedesƀ;ESಒಓಛ技qual;쀀⪯̸lantEqual;拠ĀeiಫಹverseElement;戌ghtTriangleƀ;BEೋೌ೒拫ar;쀀⧐̸qual;拭ĀquೝഌuareSuĀbp೨೹setĀ;E೰ೳ쀀⊏̸qual;拢ersetĀ;Eഃആ쀀⊐̸qual;拣ƀbcpഓതൎsetĀ;Eഛഞ쀀⊂⃒qual;抈ceedsȀ;ESTലള഻െ抁qual;쀀⪰̸lantEqual;拡ilde;쀀≿̸ersetĀ;E൘൛쀀⊃⃒qual;抉ildeȀ;EFT൮൯൵ൿ扁qual;扄ullEqual;扇ilde;扉erticalBar;戤cr;쀀𝒩ilde耻Ñ䃑;䎝܀Eacdfgmoprstuvලෂ෉෕ෛ෠෧෼ขภยา฿ไlig;䅒cute耻Ó䃓Āiy෎ීrc耻Ô䃔;䐞blac;䅐r;쀀𝔒rave耻Ò䃒ƀaei෮ෲ෶cr;䅌ga;䎩cron;䎟pf;쀀𝕆enCurlyĀDQฎบoubleQuote;怜uote;怘;橔Āclวฬr;쀀𝒪ash耻Ø䃘iŬื฼de耻Õ䃕es;樷ml耻Ö䃖erĀBP๋๠Āar๐๓r;怾acĀek๚๜;揞et;掴arenthesis;揜Ҁacfhilors๿ງຊຏຒດຝະ໼rtialD;戂y;䐟r;쀀𝔓i;䎦;䎠usMinus;䂱Āipຢອncareplanåڝf;愙Ȁ;eio຺ູ໠໤檻cedesȀ;EST່້໏໚扺qual;檯lantEqual;扼ilde;找me;怳Ādp໩໮uct;戏ortionĀ;aȥ໹l;戝Āci༁༆r;쀀𝒫;䎨ȀUfos༑༖༛༟OT耻"䀢r;쀀𝔔pf;愚cr;쀀𝒬؀BEacefhiorsu༾གྷཇའཱིྦྷྪྭ႖ႩႴႾarr;椐G耻®䂮ƀcnrཎནབute;䅔g;柫rĀ;tཛྷཝ憠l;椖ƀaeyཧཬཱron;䅘dil;䅖;䐠Ā;vླྀཹ愜erseĀEUྂྙĀlq྇ྎement;戋uilibrium;懋pEquilibrium;楯r»ཹo;䎡ghtЀACDFTUVa࿁࿫࿳ဢဨၛႇϘĀnr࿆࿒gleBracket;柩rowƀ;BL࿜࿝࿡憒ar;懥eftArrow;懄eiling;按oǵ࿹\0စbleBracket;柧nǔည\0နeeVector;楝ectorĀ;Bဝသ懂ar;楕loor;挋Āerိ၃eƀ;AVဵံြ抢rrow;憦ector;楛iangleƀ;BEၐၑၕ抳ar;槐qual;抵pƀDTVၣၮၸownVector;楏eeVector;楜ectorĀ;Bႂႃ憾ar;楔ectorĀ;B႑႒懀ar;楓Āpuႛ႞f;愝ndImplies;楰ightarrow;懛ĀchႹႼr;愛;憱leDelayed;槴ڀHOacfhimoqstuფჱჷჽᄙᄞᅑᅖᅡᅧᆵᆻᆿĀCcჩხHcy;䐩y;䐨FTcy;䐬cute;䅚ʀ;aeiyᄈᄉᄎᄓᄗ檼ron;䅠dil;䅞rc;䅜;䐡r;쀀𝔖ortȀDLRUᄪᄴᄾᅉownArrow»ОeftArrow»࢚ightArrow»࿝pArrow;憑gma;䎣allCircle;战pf;쀀𝕊ɲᅭ\0\0ᅰt;戚areȀ;ISUᅻᅼᆉᆯ斡ntersection;抓uĀbpᆏᆞsetĀ;Eᆗᆘ抏qual;抑ersetĀ;Eᆨᆩ抐qual;抒nion;抔cr;쀀𝒮ar;拆ȀbcmpᇈᇛሉላĀ;sᇍᇎ拐etĀ;Eᇍᇕqual;抆ĀchᇠህeedsȀ;ESTᇭᇮᇴᇿ扻qual;檰lantEqual;扽ilde;承Tháྌ;我ƀ;esሒሓሣ拑rsetĀ;Eሜም抃qual;抇et»ሓրHRSacfhiorsሾቄ቉ቕ቞ቱቶኟዂወዑORN耻Þ䃞ADE;愢ĀHc቎ቒcy;䐋y;䐦Ābuቚቜ;䀉;䎤ƀaeyብቪቯron;䅤dil;䅢;䐢r;쀀𝔗Āeiቻ኉ǲኀ\0ኇefore;戴a;䎘Ācn኎ኘkSpace;쀀  Space;怉ldeȀ;EFTካኬኲኼ戼qual;扃ullEqual;扅ilde;扈pf;쀀𝕋ipleDot;惛Āctዖዛr;쀀𝒯rok;䅦ૡዷጎጚጦ\0ጬጱ\0\0\0\0\0ጸጽ፷ᎅ\0᏿ᐄᐊᐐĀcrዻጁute耻Ú䃚rĀ;oጇገ憟cir;楉rǣጓ\0጖y;䐎ve;䅬Āiyጞጣrc耻Û䃛;䐣blac;䅰r;쀀𝔘rave耻Ù䃙acr;䅪Ādiፁ፩erĀBPፈ፝Āarፍፐr;䁟acĀekፗፙ;揟et;掵arenthesis;揝onĀ;P፰፱拃lus;抎Āgp፻፿on;䅲f;쀀𝕌ЀADETadps᎕ᎮᎸᏄϨᏒᏗᏳrrowƀ;BDᅐᎠᎤar;椒ownArrow;懅ownArrow;憕quilibrium;楮eeĀ;AᏋᏌ报rrow;憥ownáϳerĀLRᏞᏨeftArrow;憖ightArrow;憗iĀ;lᏹᏺ䏒on;䎥ing;䅮cr;쀀𝒰ilde;䅨ml耻Ü䃜ҀDbcdefosvᐧᐬᐰᐳᐾᒅᒊᒐᒖash;披ar;櫫y;䐒ashĀ;lᐻᐼ抩;櫦Āerᑃᑅ;拁ƀbtyᑌᑐᑺar;怖Ā;iᑏᑕcalȀBLSTᑡᑥᑪᑴar;戣ine;䁼eparator;杘ilde;所ThinSpace;怊r;쀀𝔙pf;쀀𝕍cr;쀀𝒱dash;抪ʀcefosᒧᒬᒱᒶᒼirc;䅴dge;拀r;쀀𝔚pf;쀀𝕎cr;쀀𝒲Ȁfiosᓋᓐᓒᓘr;쀀𝔛;䎞pf;쀀𝕏cr;쀀𝒳ҀAIUacfosuᓱᓵᓹᓽᔄᔏᔔᔚᔠcy;䐯cy;䐇cy;䐮cute耻Ý䃝Āiyᔉᔍrc;䅶;䐫r;쀀𝔜pf;쀀𝕐cr;쀀𝒴ml;䅸ЀHacdefosᔵᔹᔿᕋᕏᕝᕠᕤcy;䐖cute;䅹Āayᕄᕉron;䅽;䐗ot;䅻ǲᕔ\0ᕛoWidtè૙a;䎖r;愨pf;愤cr;쀀𝒵௡ᖃᖊᖐ\0ᖰᖶᖿ\0\0\0\0ᗆᗛᗫᙟ᙭\0ᚕ᚛ᚲᚹ\0ᚾcute耻á䃡reve;䄃̀;Ediuyᖜᖝᖡᖣᖨᖭ戾;쀀∾̳;房rc耻â䃢te肻´̆;䐰lig耻æ䃦Ā;r²ᖺ;쀀𝔞rave耻à䃠ĀepᗊᗖĀfpᗏᗔsym;愵èᗓha;䎱ĀapᗟcĀclᗤᗧr;䄁g;樿ɤᗰ\0\0ᘊʀ;adsvᗺᗻᗿᘁᘇ戧nd;橕;橜lope;橘;橚΀;elmrszᘘᘙᘛᘞᘿᙏᙙ戠;榤e»ᘙsdĀ;aᘥᘦ戡ѡᘰᘲᘴᘶᘸᘺᘼᘾ;榨;榩;榪;榫;榬;榭;榮;榯tĀ;vᙅᙆ戟bĀ;dᙌᙍ抾;榝Āptᙔᙗh;戢»¹arr;捼Āgpᙣᙧon;䄅f;쀀𝕒΀;Eaeiop዁ᙻᙽᚂᚄᚇᚊ;橰cir;橯;扊d;手s;䀧roxĀ;e዁ᚒñᚃing耻å䃥ƀctyᚡᚦᚨr;쀀𝒶;䀪mpĀ;e዁ᚯñʈilde耻ã䃣ml耻ä䃤Āciᛂᛈoninôɲnt;樑ࠀNabcdefiklnoprsu᛭ᛱᜰ᜼ᝃᝈ᝸᝽០៦ᠹᡐᜍ᤽᥈ᥰot;櫭Ācrᛶ᜞kȀcepsᜀᜅᜍᜓong;扌psilon;䏶rime;怵imĀ;e᜚᜛戽q;拍Ŷᜢᜦee;抽edĀ;gᜬᜭ挅e»ᜭrkĀ;t፜᜷brk;掶Āoyᜁᝁ;䐱quo;怞ʀcmprtᝓ᝛ᝡᝤᝨausĀ;eĊĉptyv;榰séᜌnoõēƀahwᝯ᝱ᝳ;䎲;愶een;扬r;쀀𝔟g΀costuvwឍឝឳេ៕៛៞ƀaiuបពរðݠrc;旯p»፱ƀdptឤឨឭot;樀lus;樁imes;樂ɱឹ\0\0ើcup;樆ar;昅riangleĀdu៍្own;施p;斳plus;樄eåᑄåᒭarow;植ƀako៭ᠦᠵĀcn៲ᠣkƀlst៺֫᠂ozenge;槫riangleȀ;dlr᠒᠓᠘᠝斴own;斾eft;旂ight;斸k;搣Ʊᠫ\0ᠳƲᠯ\0ᠱ;斒;斑4;斓ck;斈ĀeoᠾᡍĀ;qᡃᡆ쀀=⃥uiv;쀀≡⃥t;挐Ȁptwxᡙᡞᡧᡬf;쀀𝕓Ā;tᏋᡣom»Ꮜtie;拈؀DHUVbdhmptuvᢅᢖᢪᢻᣗᣛᣬ᣿ᤅᤊᤐᤡȀLRlrᢎᢐᢒᢔ;敗;敔;敖;敓ʀ;DUduᢡᢢᢤᢦᢨ敐;敦;敩;敤;敧ȀLRlrᢳᢵᢷᢹ;敝;敚;敜;教΀;HLRhlrᣊᣋᣍᣏᣑᣓᣕ救;敬;散;敠;敫;敢;敟ox;槉ȀLRlrᣤᣦᣨᣪ;敕;敒;攐;攌ʀ;DUduڽ᣷᣹᣻᣽;敥;敨;攬;攴inus;抟lus;択imes;抠ȀLRlrᤙᤛᤝ᤟;敛;敘;攘;攔΀;HLRhlrᤰᤱᤳᤵᤷ᤻᤹攂;敪;敡;敞;攼;攤;攜Āevģ᥂bar耻¦䂦Ȁceioᥑᥖᥚᥠr;쀀𝒷mi;恏mĀ;e᜚᜜lƀ;bhᥨᥩᥫ䁜;槅sub;柈Ŭᥴ᥾lĀ;e᥹᥺怢t»᥺pƀ;Eeįᦅᦇ;檮Ā;qۜۛೡᦧ\0᧨ᨑᨕᨲ\0ᨷᩐ\0\0᪴\0\0᫁\0\0ᬡᬮ᭍᭒\0᯽\0ᰌƀcpr᦭ᦲ᧝ute;䄇̀;abcdsᦿᧀᧄ᧊᧕᧙戩nd;橄rcup;橉Āau᧏᧒p;橋p;橇ot;橀;쀀∩︀Āeo᧢᧥t;恁îړȀaeiu᧰᧻ᨁᨅǰ᧵\0᧸s;橍on;䄍dil耻ç䃧rc;䄉psĀ;sᨌᨍ橌m;橐ot;䄋ƀdmnᨛᨠᨦil肻¸ƭptyv;榲t脀¢;eᨭᨮ䂢räƲr;쀀𝔠ƀceiᨽᩀᩍy;䑇ckĀ;mᩇᩈ朓ark»ᩈ;䏇r΀;Ecefms᩟᩠ᩢᩫ᪤᪪᪮旋;槃ƀ;elᩩᩪᩭ䋆q;扗eɡᩴ\0\0᪈rrowĀlr᩼᪁eft;憺ight;憻ʀRSacd᪒᪔᪖᪚᪟»ཇ;擈st;抛irc;抚ash;抝nint;樐id;櫯cir;槂ubsĀ;u᪻᪼晣it»᪼ˬ᫇᫔᫺\0ᬊonĀ;eᫍᫎ䀺Ā;qÇÆɭ᫙\0\0᫢aĀ;t᫞᫟䀬;䁀ƀ;fl᫨᫩᫫戁îᅠeĀmx᫱᫶ent»᫩eóɍǧ᫾\0ᬇĀ;dኻᬂot;橭nôɆƀfryᬐᬔᬗ;쀀𝕔oäɔ脀©;sŕᬝr;愗Āaoᬥᬩrr;憵ss;朗Ācuᬲᬷr;쀀𝒸Ābpᬼ᭄Ā;eᭁᭂ櫏;櫑Ā;eᭉᭊ櫐;櫒dot;拯΀delprvw᭠᭬᭷ᮂᮬᯔ᯹arrĀlr᭨᭪;椸;椵ɰ᭲\0\0᭵r;拞c;拟arrĀ;p᭿ᮀ憶;椽̀;bcdosᮏᮐᮖᮡᮥᮨ截rcap;橈Āauᮛᮞp;橆p;橊ot;抍r;橅;쀀∪︀Ȁalrv᮵ᮿᯞᯣrrĀ;mᮼᮽ憷;椼yƀevwᯇᯔᯘqɰᯎ\0\0ᯒreã᭳uã᭵ee;拎edge;拏en耻¤䂤earrowĀlrᯮ᯳eft»ᮀight»ᮽeäᯝĀciᰁᰇoninôǷnt;戱lcty;挭ঀAHabcdefhijlorstuwz᰸᰻᰿ᱝᱩᱵᲊᲞᲬᲷ᳻᳿ᴍᵻᶑᶫᶻ᷆᷍rò΁ar;楥Ȁglrs᱈ᱍ᱒᱔ger;怠eth;愸òᄳhĀ;vᱚᱛ怐»ऊūᱡᱧarow;椏aã̕Āayᱮᱳron;䄏;䐴ƀ;ao̲ᱼᲄĀgrʿᲁr;懊tseq;橷ƀglmᲑᲔᲘ耻°䂰ta;䎴ptyv;榱ĀirᲣᲨsht;楿;쀀𝔡arĀlrᲳᲵ»ࣜ»သʀaegsv᳂͸᳖᳜᳠mƀ;oș᳊᳔ndĀ;ș᳑uit;晦amma;䏝in;拲ƀ;io᳧᳨᳸䃷de脀÷;o᳧ᳰntimes;拇nø᳷cy;䑒cɯᴆ\0\0ᴊrn;挞op;挍ʀlptuwᴘᴝᴢᵉᵕlar;䀤f;쀀𝕕ʀ;emps̋ᴭᴷᴽᵂqĀ;d͒ᴳot;扑inus;戸lus;戔quare;抡blebarwedgåúnƀadhᄮᵝᵧownarrowóᲃarpoonĀlrᵲᵶefôᲴighôᲶŢᵿᶅkaro÷གɯᶊ\0\0ᶎrn;挟op;挌ƀcotᶘᶣᶦĀryᶝᶡ;쀀𝒹;䑕l;槶rok;䄑Ādrᶰᶴot;拱iĀ;fᶺ᠖斿Āah᷀᷃ròЩaòྦangle;榦Āci᷒ᷕy;䑟grarr;柿ऀDacdefglmnopqrstuxḁḉḙḸոḼṉṡṾấắẽỡἪἷὄ὎὚ĀDoḆᴴoôᲉĀcsḎḔute耻é䃩ter;橮ȀaioyḢḧḱḶron;䄛rĀ;cḭḮ扖耻ê䃪lon;払;䑍ot;䄗ĀDrṁṅot;扒;쀀𝔢ƀ;rsṐṑṗ檚ave耻è䃨Ā;dṜṝ檖ot;檘Ȁ;ilsṪṫṲṴ檙nters;揧;愓Ā;dṹṺ檕ot;檗ƀapsẅẉẗcr;䄓tyƀ;svẒẓẕ戅et»ẓpĀ1;ẝẤĳạả;怄;怅怃ĀgsẪẬ;䅋p;怂ĀgpẴẸon;䄙f;쀀𝕖ƀalsỄỎỒrĀ;sỊị拕l;槣us;橱iƀ;lvỚớở䎵on»ớ;䏵ȀcsuvỪỳἋἣĀioữḱrc»Ḯɩỹ\0\0ỻíՈantĀglἂἆtr»ṝess»Ṻƀaeiἒ἖Ἒls;䀽st;扟vĀ;DȵἠD;橸parsl;槥ĀDaἯἳot;打rr;楱ƀcdiἾὁỸr;愯oô͒ĀahὉὋ;䎷耻ð䃰Āmrὓὗl耻ë䃫o;悬ƀcipὡὤὧl;䀡sôծĀeoὬὴctatioîՙnentialåչৡᾒ\0ᾞ\0ᾡᾧ\0\0ῆῌ\0ΐ\0ῦῪ \0 ⁚llingdotseñṄy;䑄male;晀ƀilrᾭᾳ῁lig;耀ﬃɩᾹ\0\0᾽g;耀ﬀig;耀ﬄ;쀀𝔣lig;耀ﬁlig;쀀fjƀaltῙ῜ῡt;晭ig;耀ﬂns;斱of;䆒ǰ΅\0ῳf;쀀𝕗ĀakֿῷĀ;vῼ´拔;櫙artint;樍Āao‌⁕Ācs‑⁒α‚‰‸⁅⁈\0⁐β•‥‧‪‬\0‮耻½䂽;慓耻¼䂼;慕;慙;慛Ƴ‴\0‶;慔;慖ʴ‾⁁\0\0⁃耻¾䂾;慗;慜5;慘ƶ⁌\0⁎;慚;慝8;慞l;恄wn;挢cr;쀀𝒻ࢀEabcdefgijlnorstv₂₉₟₥₰₴⃰⃵⃺⃿℃ℒℸ̗ℾ⅒↞Ā;lٍ₇;檌ƀcmpₐₕ₝ute;䇵maĀ;dₜ᳚䎳;檆reve;䄟Āiy₪₮rc;䄝;䐳ot;䄡Ȁ;lqsؾق₽⃉ƀ;qsؾٌ⃄lanô٥Ȁ;cdl٥⃒⃥⃕c;檩otĀ;o⃜⃝檀Ā;l⃢⃣檂;檄Ā;e⃪⃭쀀⋛︀s;檔r;쀀𝔤Ā;gٳ؛mel;愷cy;䑓Ȁ;Eajٚℌℎℐ;檒;檥;檤ȀEaesℛℝ℩ℴ;扩pĀ;p℣ℤ檊rox»ℤĀ;q℮ℯ檈Ā;q℮ℛim;拧pf;쀀𝕘Āci⅃ⅆr;愊mƀ;el٫ⅎ⅐;檎;檐茀>;cdlqr׮ⅠⅪⅮⅳⅹĀciⅥⅧ;檧r;橺ot;拗Par;榕uest;橼ʀadelsↄⅪ←ٖ↛ǰ↉\0↎proø₞r;楸qĀlqؿ↖lesó₈ií٫Āen↣↭rtneqq;쀀≩︀Å↪ԀAabcefkosy⇄⇇⇱⇵⇺∘∝∯≨≽ròΠȀilmr⇐⇔⇗⇛rsðᒄf»․ilôکĀdr⇠⇤cy;䑊ƀ;cwࣴ⇫⇯ir;楈;憭ar;意irc;䄥ƀalr∁∎∓rtsĀ;u∉∊晥it»∊lip;怦con;抹r;쀀𝔥sĀew∣∩arow;椥arow;椦ʀamopr∺∾≃≞≣rr;懿tht;戻kĀlr≉≓eftarrow;憩ightarrow;憪f;쀀𝕙bar;怕ƀclt≯≴≸r;쀀𝒽asè⇴rok;䄧Ābp⊂⊇ull;恃hen»ᱛૡ⊣\0⊪\0⊸⋅⋎\0⋕⋳\0\0⋸⌢⍧⍢⍿\0⎆⎪⎴cute耻í䃭ƀ;iyݱ⊰⊵rc耻î䃮;䐸Ācx⊼⊿y;䐵cl耻¡䂡ĀfrΟ⋉;쀀𝔦rave耻ì䃬Ȁ;inoܾ⋝⋩⋮Āin⋢⋦nt;樌t;戭fin;槜ta;愩lig;䄳ƀaop⋾⌚⌝ƀcgt⌅⌈⌗r;䄫ƀelpܟ⌏⌓inåގarôܠh;䄱f;抷ed;䆵ʀ;cfotӴ⌬⌱⌽⍁are;愅inĀ;t⌸⌹戞ie;槝doô⌙ʀ;celpݗ⍌⍐⍛⍡al;抺Āgr⍕⍙eróᕣã⍍arhk;樗rod;樼Ȁcgpt⍯⍲⍶⍻y;䑑on;䄯f;쀀𝕚a;䎹uest耻¿䂿Āci⎊⎏r;쀀𝒾nʀ;EdsvӴ⎛⎝⎡ӳ;拹ot;拵Ā;v⎦⎧拴;拳Ā;iݷ⎮lde;䄩ǫ⎸\0⎼cy;䑖l耻ï䃯̀cfmosu⏌⏗⏜⏡⏧⏵Āiy⏑⏕rc;䄵;䐹r;쀀𝔧ath;䈷pf;쀀𝕛ǣ⏬\0⏱r;쀀𝒿rcy;䑘kcy;䑔Ѐacfghjos␋␖␢␧␭␱␵␻ppaĀ;v␓␔䎺;䏰Āey␛␠dil;䄷;䐺r;쀀𝔨reen;䄸cy;䑅cy;䑜pf;쀀𝕜cr;쀀𝓀஀ABEHabcdefghjlmnoprstuv⑰⒁⒆⒍⒑┎┽╚▀♎♞♥♹♽⚚⚲⛘❝❨➋⟀⠁⠒ƀart⑷⑺⑼rò৆òΕail;椛arr;椎Ā;gঔ⒋;檋ar;楢ॣ⒥\0⒪\0⒱\0\0\0\0\0⒵Ⓔ\0ⓆⓈⓍ\0⓹ute;䄺mptyv;榴raîࡌbda;䎻gƀ;dlࢎⓁⓃ;榑åࢎ;檅uo耻«䂫rЀ;bfhlpst࢙ⓞⓦⓩ⓫⓮⓱⓵Ā;f࢝ⓣs;椟s;椝ë≒p;憫l;椹im;楳l;憢ƀ;ae⓿─┄檫il;椙Ā;s┉┊檭;쀀⪭︀ƀabr┕┙┝rr;椌rk;杲Āak┢┬cĀek┨┪;䁻;䁛Āes┱┳;榋lĀdu┹┻;榏;榍Ȁaeuy╆╋╖╘ron;䄾Ādi═╔il;䄼ìࢰâ┩;䐻Ȁcqrs╣╦╭╽a;椶uoĀ;rนᝆĀdu╲╷har;楧shar;楋h;憲ʀ;fgqs▋▌উ◳◿扤tʀahlrt▘▤▷◂◨rrowĀ;t࢙□aé⓶arpoonĀdu▯▴own»њp»०eftarrows;懇ightƀahs◍◖◞rrowĀ;sࣴࢧarpoonó྘quigarro÷⇰hreetimes;拋ƀ;qs▋ও◺lanôবʀ;cdgsব☊☍☝☨c;檨otĀ;o☔☕橿Ā;r☚☛檁;檃Ā;e☢☥쀀⋚︀s;檓ʀadegs☳☹☽♉♋pproøⓆot;拖qĀgq♃♅ôউgtò⒌ôছiíলƀilr♕࣡♚sht;楼;쀀𝔩Ā;Eজ♣;檑š♩♶rĀdu▲♮Ā;l॥♳;楪lk;斄cy;䑙ʀ;achtੈ⚈⚋⚑⚖rò◁orneòᴈard;楫ri;旺Āio⚟⚤dot;䅀ustĀ;a⚬⚭掰che»⚭ȀEaes⚻⚽⛉⛔;扨pĀ;p⛃⛄檉rox»⛄Ā;q⛎⛏檇Ā;q⛎⚻im;拦Ѐabnoptwz⛩⛴⛷✚✯❁❇❐Ānr⛮⛱g;柬r;懽rëࣁgƀlmr⛿✍✔eftĀar০✇ightá৲apsto;柼ightá৽parrowĀlr✥✩efô⓭ight;憬ƀafl✶✹✽r;榅;쀀𝕝us;樭imes;樴š❋❏st;戗áፎƀ;ef❗❘᠀旊nge»❘arĀ;l❤❥䀨t;榓ʀachmt❳❶❼➅➇ròࢨorneòᶌarĀ;d྘➃;業;怎ri;抿̀achiqt➘➝ੀ➢➮➻quo;怹r;쀀𝓁mƀ;egল➪➬;檍;檏Ābu┪➳oĀ;rฟ➹;怚rok;䅂萀<;cdhilqrࠫ⟒☹⟜⟠⟥⟪⟰Āci⟗⟙;檦r;橹reå◲mes;拉arr;楶uest;橻ĀPi⟵⟹ar;榖ƀ;ef⠀भ᠛旃rĀdu⠇⠍shar;楊har;楦Āen⠗⠡rtneqq;쀀≨︀Å⠞܀Dacdefhilnopsu⡀⡅⢂⢎⢓⢠⢥⢨⣚⣢⣤ઃ⣳⤂Dot;戺Ȁclpr⡎⡒⡣⡽r耻¯䂯Āet⡗⡙;時Ā;e⡞⡟朠se»⡟Ā;sျ⡨toȀ;dluျ⡳⡷⡻owîҌefôएðᏑker;斮Āoy⢇⢌mma;権;䐼ash;怔asuredangle»ᘦr;쀀𝔪o;愧ƀcdn⢯⢴⣉ro耻µ䂵Ȁ;acdᑤ⢽⣀⣄sôᚧir;櫰ot肻·Ƶusƀ;bd⣒ᤃ⣓戒Ā;uᴼ⣘;横ţ⣞⣡p;櫛ò−ðઁĀdp⣩⣮els;抧f;쀀𝕞Āct⣸⣽r;쀀𝓂pos»ᖝƀ;lm⤉⤊⤍䎼timap;抸ఀGLRVabcdefghijlmoprstuvw⥂⥓⥾⦉⦘⧚⧩⨕⨚⩘⩝⪃⪕⪤⪨⬄⬇⭄⭿⮮ⰴⱧⱼ⳩Āgt⥇⥋;쀀⋙̸Ā;v⥐௏쀀≫⃒ƀelt⥚⥲⥶ftĀar⥡⥧rrow;懍ightarrow;懎;쀀⋘̸Ā;v⥻ే쀀≪⃒ightarrow;懏ĀDd⦎⦓ash;抯ash;抮ʀbcnpt⦣⦧⦬⦱⧌la»˞ute;䅄g;쀀∠⃒ʀ;Eiop඄⦼⧀⧅⧈;쀀⩰̸d;쀀≋̸s;䅉roø඄urĀ;a⧓⧔普lĀ;s⧓ସǳ⧟\0⧣p肻 ଷmpĀ;e௹ఀʀaeouy⧴⧾⨃⨐⨓ǰ⧹\0⧻;橃on;䅈dil;䅆ngĀ;dൾ⨊ot;쀀⩭̸p;橂;䐽ash;怓΀;Aadqsxஒ⨩⨭⨻⩁⩅⩐rr;懗rĀhr⨳⨶k;椤Ā;oᏲᏰot;쀀≐̸uiöୣĀei⩊⩎ar;椨í஘istĀ;s஠டr;쀀𝔫ȀEest௅⩦⩹⩼ƀ;qs஼⩭௡ƀ;qs஼௅⩴lanô௢ií௪Ā;rஶ⪁»ஷƀAap⪊⪍⪑rò⥱rr;憮ar;櫲ƀ;svྍ⪜ྌĀ;d⪡⪢拼;拺cy;䑚΀AEadest⪷⪺⪾⫂⫅⫶⫹rò⥦;쀀≦̸rr;憚r;急Ȁ;fqs఻⫎⫣⫯tĀar⫔⫙rro÷⫁ightarro÷⪐ƀ;qs఻⪺⫪lanôౕĀ;sౕ⫴»శiíౝĀ;rవ⫾iĀ;eచథiäඐĀpt⬌⬑f;쀀𝕟膀¬;in⬙⬚⬶䂬nȀ;Edvஉ⬤⬨⬮;쀀⋹̸ot;쀀⋵̸ǡஉ⬳⬵;拷;拶iĀ;vಸ⬼ǡಸ⭁⭃;拾;拽ƀaor⭋⭣⭩rȀ;ast୻⭕⭚⭟lleì୻l;쀀⫽⃥;쀀∂̸lint;樔ƀ;ceಒ⭰⭳uåಥĀ;cಘ⭸Ā;eಒ⭽ñಘȀAait⮈⮋⮝⮧rò⦈rrƀ;cw⮔⮕⮙憛;쀀⤳̸;쀀↝̸ghtarrow»⮕riĀ;eೋೖ΀chimpqu⮽⯍⯙⬄୸⯤⯯Ȁ;cerല⯆ഷ⯉uå൅;쀀𝓃ortɭ⬅\0\0⯖ará⭖mĀ;e൮⯟Ā;q൴൳suĀbp⯫⯭å೸åഋƀbcp⯶ⰑⰙȀ;Ees⯿ⰀഢⰄ抄;쀀⫅̸etĀ;eഛⰋqĀ;qണⰀcĀ;eലⰗñസȀ;EesⰢⰣൟⰧ抅;쀀⫆̸etĀ;e൘ⰮqĀ;qൠⰣȀgilrⰽⰿⱅⱇìௗlde耻ñ䃱çృiangleĀlrⱒⱜeftĀ;eచⱚñదightĀ;eೋⱥñ೗Ā;mⱬⱭ䎽ƀ;esⱴⱵⱹ䀣ro;愖p;怇ҀDHadgilrsⲏⲔⲙⲞⲣⲰⲶⳓⳣash;抭arr;椄p;쀀≍⃒ash;抬ĀetⲨⲬ;쀀≥⃒;쀀>⃒nfin;槞ƀAetⲽⳁⳅrr;椂;쀀≤⃒Ā;rⳊⳍ쀀<⃒ie;쀀⊴⃒ĀAtⳘⳜrr;椃rie;쀀⊵⃒im;쀀∼⃒ƀAan⳰⳴ⴂrr;懖rĀhr⳺⳽k;椣Ā;oᏧᏥear;椧ቓ᪕\0\0\0\0\0\0\0\0\0\0\0\0\0ⴭ\0ⴸⵈⵠⵥ⵲ⶄᬇ\0\0ⶍⶫ\0ⷈⷎ\0ⷜ⸙⸫⸾⹃Ācsⴱ᪗ute耻ó䃳ĀiyⴼⵅrĀ;c᪞ⵂ耻ô䃴;䐾ʀabios᪠ⵒⵗǈⵚlac;䅑v;樸old;榼lig;䅓Ācr⵩⵭ir;榿;쀀𝔬ͯ⵹\0\0⵼\0ⶂn;䋛ave耻ò䃲;槁Ābmⶈ෴ar;榵Ȁacitⶕ⶘ⶥⶨrò᪀Āir⶝ⶠr;榾oss;榻nå๒;槀ƀaeiⶱⶵⶹcr;䅍ga;䏉ƀcdnⷀⷅǍron;䎿;榶pf;쀀𝕠ƀaelⷔ⷗ǒr;榷rp;榹΀;adiosvⷪⷫⷮ⸈⸍⸐⸖戨rò᪆Ȁ;efmⷷⷸ⸂⸅橝rĀ;oⷾⷿ愴f»ⷿ耻ª䂪耻º䂺gof;抶r;橖lope;橗;橛ƀclo⸟⸡⸧ò⸁ash耻ø䃸l;折iŬⸯ⸴de耻õ䃵esĀ;aǛ⸺s;樶ml耻ö䃶bar;挽ૡ⹞\0⹽\0⺀⺝\0⺢⺹\0\0⻋ຜ\0⼓\0\0⼫⾼\0⿈rȀ;astЃ⹧⹲຅脀¶;l⹭⹮䂶leìЃɩ⹸\0\0⹻m;櫳;櫽y;䐿rʀcimpt⺋⺏⺓ᡥ⺗nt;䀥od;䀮il;怰enk;怱r;쀀𝔭ƀimo⺨⺰⺴Ā;v⺭⺮䏆;䏕maô੶ne;明ƀ;tv⺿⻀⻈䏀chfork»´;䏖Āau⻏⻟nĀck⻕⻝kĀ;h⇴⻛;愎ö⇴sҀ;abcdemst⻳⻴ᤈ⻹⻽⼄⼆⼊⼎䀫cir;樣ir;樢Āouᵀ⼂;樥;橲n肻±ຝim;樦wo;樧ƀipu⼙⼠⼥ntint;樕f;쀀𝕡nd耻£䂣Ԁ;Eaceinosu່⼿⽁⽄⽇⾁⾉⾒⽾⾶;檳p;檷uå໙Ā;c໎⽌̀;acens່⽙⽟⽦⽨⽾pproø⽃urlyeñ໙ñ໎ƀaes⽯⽶⽺pprox;檹qq;檵im;拨iíໟmeĀ;s⾈ຮ怲ƀEas⽸⾐⽺ð⽵ƀdfp໬⾙⾯ƀals⾠⾥⾪lar;挮ine;挒urf;挓Ā;t໻⾴ï໻rel;抰Āci⿀⿅r;쀀𝓅;䏈ncsp;怈̀fiopsu⿚⋢⿟⿥⿫⿱r;쀀𝔮pf;쀀𝕢rime;恗cr;쀀𝓆ƀaeo⿸〉〓tĀei⿾々rnionóڰnt;樖stĀ;e【】䀿ñἙô༔઀ABHabcdefhilmnoprstux぀けさすムㄎㄫㅇㅢㅲㆎ㈆㈕㈤㈩㉘㉮㉲㊐㊰㊷ƀartぇおがròႳòϝail;検aròᱥar;楤΀cdenqrtとふへみわゔヌĀeuねぱ;쀀∽̱te;䅕iãᅮmptyv;榳gȀ;del࿑らるろ;榒;榥å࿑uo耻»䂻rր;abcfhlpstw࿜ガクシスゼゾダッデナp;極Ā;f࿠ゴs;椠;椳s;椞ë≝ð✮l;楅im;楴l;憣;憝Āaiパフil;椚oĀ;nホボ戶aló༞ƀabrョリヮrò៥rk;杳ĀakンヽcĀekヹ・;䁽;䁝Āes㄂㄄;榌lĀduㄊㄌ;榎;榐Ȁaeuyㄗㄜㄧㄩron;䅙Ādiㄡㄥil;䅗ì࿲âヺ;䑀Ȁclqsㄴㄷㄽㅄa;椷dhar;楩uoĀ;rȎȍh;憳ƀacgㅎㅟངlȀ;ipsླྀㅘㅛႜnåႻarôྩt;断ƀilrㅩဣㅮsht;楽;쀀𝔯ĀaoㅷㆆrĀduㅽㅿ»ѻĀ;l႑ㆄ;楬Ā;vㆋㆌ䏁;䏱ƀgns㆕ㇹㇼht̀ahlrstㆤㆰ㇂㇘㇤㇮rrowĀ;t࿜ㆭaéトarpoonĀduㆻㆿowîㅾp»႒eftĀah㇊㇐rrowó࿪arpoonóՑightarrows;應quigarro÷ニhreetimes;拌g;䋚ingdotseñἲƀahm㈍㈐㈓rò࿪aòՑ;怏oustĀ;a㈞㈟掱che»㈟mid;櫮Ȁabpt㈲㈽㉀㉒Ānr㈷㈺g;柭r;懾rëဃƀafl㉇㉊㉎r;榆;쀀𝕣us;樮imes;樵Āap㉝㉧rĀ;g㉣㉤䀩t;榔olint;樒arò㇣Ȁachq㉻㊀Ⴜ㊅quo;怺r;쀀𝓇Ābu・㊊oĀ;rȔȓƀhir㊗㊛㊠reåㇸmes;拊iȀ;efl㊪ၙᠡ㊫方tri;槎luhar;楨;愞ൡ㋕㋛㋟㌬㌸㍱\0㍺㎤\0\0㏬㏰\0㐨㑈㑚㒭㒱㓊㓱\0㘖\0\0㘳cute;䅛quï➺Ԁ;Eaceinpsyᇭ㋳㋵㋿㌂㌋㌏㌟㌦㌩;檴ǰ㋺\0㋼;檸on;䅡uåᇾĀ;dᇳ㌇il;䅟rc;䅝ƀEas㌖㌘㌛;檶p;檺im;择olint;樓iíሄ;䑁otƀ;be㌴ᵇ㌵担;橦΀Aacmstx㍆㍊㍗㍛㍞㍣㍭rr;懘rĀhr㍐㍒ë∨Ā;oਸ਼਴t耻§䂧i;䀻war;椩mĀin㍩ðnuóñt;朶rĀ;o㍶⁕쀀𝔰Ȁacoy㎂㎆㎑㎠rp;景Āhy㎋㎏cy;䑉;䑈rtɭ㎙\0\0㎜iäᑤaraì⹯耻­䂭Āgm㎨㎴maƀ;fv㎱㎲㎲䏃;䏂Ѐ;deglnprካ㏅㏉㏎㏖㏞㏡㏦ot;橪Ā;q኱ኰĀ;E㏓㏔檞;檠Ā;E㏛㏜檝;檟e;扆lus;樤arr;楲aròᄽȀaeit㏸㐈㐏㐗Āls㏽㐄lsetmé㍪hp;樳parsl;槤Ādlᑣ㐔e;挣Ā;e㐜㐝檪Ā;s㐢㐣檬;쀀⪬︀ƀflp㐮㐳㑂tcy;䑌Ā;b㐸㐹䀯Ā;a㐾㐿槄r;挿f;쀀𝕤aĀdr㑍ЂesĀ;u㑔㑕晠it»㑕ƀcsu㑠㑹㒟Āau㑥㑯pĀ;sᆈ㑫;쀀⊓︀pĀ;sᆴ㑵;쀀⊔︀uĀbp㑿㒏ƀ;esᆗᆜ㒆etĀ;eᆗ㒍ñᆝƀ;esᆨᆭ㒖etĀ;eᆨ㒝ñᆮƀ;afᅻ㒦ְrť㒫ֱ»ᅼaròᅈȀcemt㒹㒾㓂㓅r;쀀𝓈tmîñiì㐕aræᆾĀar㓎㓕rĀ;f㓔ឿ昆Āan㓚㓭ightĀep㓣㓪psiloîỠhé⺯s»⡒ʀbcmnp㓻㕞ሉ㖋㖎Ҁ;Edemnprs㔎㔏㔑㔕㔞㔣㔬㔱㔶抂;櫅ot;檽Ā;dᇚ㔚ot;櫃ult;櫁ĀEe㔨㔪;櫋;把lus;檿arr;楹ƀeiu㔽㕒㕕tƀ;en㔎㕅㕋qĀ;qᇚ㔏eqĀ;q㔫㔨m;櫇Ābp㕚㕜;櫕;櫓c̀;acensᇭ㕬㕲㕹㕻㌦pproø㋺urlyeñᇾñᇳƀaes㖂㖈㌛pproø㌚qñ㌗g;晪ڀ123;Edehlmnps㖩㖬㖯ሜ㖲㖴㗀㗉㗕㗚㗟㗨㗭耻¹䂹耻²䂲耻³䂳;櫆Āos㖹㖼t;檾ub;櫘Ā;dሢ㗅ot;櫄sĀou㗏㗒l;柉b;櫗arr;楻ult;櫂ĀEe㗤㗦;櫌;抋lus;櫀ƀeiu㗴㘉㘌tƀ;enሜ㗼㘂qĀ;qሢ㖲eqĀ;q㗧㗤m;櫈Ābp㘑㘓;櫔;櫖ƀAan㘜㘠㘭rr;懙rĀhr㘦㘨ë∮Ā;oਫ਩war;椪lig耻ß䃟௡㙑㙝㙠ዎ㙳㙹\0㙾㛂\0\0\0\0\0㛛㜃\0㜉㝬\0\0\0㞇ɲ㙖\0\0㙛get;挖;䏄rë๟ƀaey㙦㙫㙰ron;䅥dil;䅣;䑂lrec;挕r;쀀𝔱Ȁeiko㚆㚝㚵㚼ǲ㚋\0㚑eĀ4fኄኁaƀ;sv㚘㚙㚛䎸ym;䏑Ācn㚢㚲kĀas㚨㚮pproø዁im»ኬsðኞĀas㚺㚮ð዁rn耻þ䃾Ǭ̟㛆⋧es膀×;bd㛏㛐㛘䃗Ā;aᤏ㛕r;樱;樰ƀeps㛡㛣㜀á⩍Ȁ;bcf҆㛬㛰㛴ot;挶ir;櫱Ā;o㛹㛼쀀𝕥rk;櫚á㍢rime;怴ƀaip㜏㜒㝤dåቈ΀adempst㜡㝍㝀㝑㝗㝜㝟ngleʀ;dlqr㜰㜱㜶㝀㝂斵own»ᶻeftĀ;e⠀㜾ñम;扜ightĀ;e㊪㝋ñၚot;旬inus;樺lus;樹b;槍ime;樻ezium;揢ƀcht㝲㝽㞁Āry㝷㝻;쀀𝓉;䑆cy;䑛rok;䅧Āio㞋㞎xô᝷headĀlr㞗㞠eftarro÷ࡏightarrow»ཝऀAHabcdfghlmoprstuw㟐㟓㟗㟤㟰㟼㠎㠜㠣㠴㡑㡝㡫㢩㣌㣒㣪㣶ròϭar;楣Ācr㟜㟢ute耻ú䃺òᅐrǣ㟪\0㟭y;䑞ve;䅭Āiy㟵㟺rc耻û䃻;䑃ƀabh㠃㠆㠋ròᎭlac;䅱aòᏃĀir㠓㠘sht;楾;쀀𝔲rave耻ù䃹š㠧㠱rĀlr㠬㠮»ॗ»ႃlk;斀Āct㠹㡍ɯ㠿\0\0㡊rnĀ;e㡅㡆挜r»㡆op;挏ri;旸Āal㡖㡚cr;䅫肻¨͉Āgp㡢㡦on;䅳f;쀀𝕦̀adhlsuᅋ㡸㡽፲㢑㢠ownáᎳarpoonĀlr㢈㢌efô㠭ighô㠯iƀ;hl㢙㢚㢜䏅»ᏺon»㢚parrows;懈ƀcit㢰㣄㣈ɯ㢶\0\0㣁rnĀ;e㢼㢽挝r»㢽op;挎ng;䅯ri;旹cr;쀀𝓊ƀdir㣙㣝㣢ot;拰lde;䅩iĀ;f㜰㣨»᠓Āam㣯㣲rò㢨l耻ü䃼angle;榧ހABDacdeflnoprsz㤜㤟㤩㤭㦵㦸㦽㧟㧤㧨㧳㧹㧽㨁㨠ròϷarĀ;v㤦㤧櫨;櫩asèϡĀnr㤲㤷grt;榜΀eknprst㓣㥆㥋㥒㥝㥤㦖appá␕othinçẖƀhir㓫⻈㥙opô⾵Ā;hᎷ㥢ïㆍĀiu㥩㥭gmá㎳Ābp㥲㦄setneqĀ;q㥽㦀쀀⊊︀;쀀⫋︀setneqĀ;q㦏㦒쀀⊋︀;쀀⫌︀Āhr㦛㦟etá㚜iangleĀlr㦪㦯eft»थight»ၑy;䐲ash»ံƀelr㧄㧒㧗ƀ;beⷪ㧋㧏ar;抻q;扚lip;拮Ābt㧜ᑨaòᑩr;쀀𝔳tré㦮suĀbp㧯㧱»ജ»൙pf;쀀𝕧roð໻tré㦴Ācu㨆㨋r;쀀𝓋Ābp㨐㨘nĀEe㦀㨖»㥾nĀEe㦒㨞»㦐igzag;榚΀cefoprs㨶㨻㩖㩛㩔㩡㩪irc;䅵Ādi㩀㩑Ābg㩅㩉ar;機eĀ;qᗺ㩏;扙erp;愘r;쀀𝔴pf;쀀𝕨Ā;eᑹ㩦atèᑹcr;쀀𝓌ૣណ㪇\0㪋\0㪐㪛\0\0㪝㪨㪫㪯\0\0㫃㫎\0㫘ៜ៟tré៑r;쀀𝔵ĀAa㪔㪗ròσrò৶;䎾ĀAa㪡㪤ròθrò৫að✓is;拻ƀdptឤ㪵㪾Āfl㪺ឩ;쀀𝕩imåឲĀAa㫇㫊ròώròਁĀcq㫒ីr;쀀𝓍Āpt៖㫜ré។Ѐacefiosu㫰㫽㬈㬌㬑㬕㬛㬡cĀuy㫶㫻te耻ý䃽;䑏Āiy㬂㬆rc;䅷;䑋n耻¥䂥r;쀀𝔶cy;䑗pf;쀀𝕪cr;쀀𝓎Ācm㬦㬩y;䑎l耻ÿ䃿Ԁacdefhiosw㭂㭈㭔㭘㭤㭩㭭㭴㭺㮀cute;䅺Āay㭍㭒ron;䅾;䐷ot;䅼Āet㭝㭡træᕟa;䎶r;쀀𝔷cy;䐶grarr;懝pf;쀀𝕫cr;쀀𝓏Ājn㮅㮇;怍j;怌'.split("").map(function(t){return t.charCodeAt(0)}))},7795:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var n=i(4640);class s extends n.BKk{constructor(){super(...arguments),this.isIndexShader=!0,this.uniformsNeedUpdate=!1,this.lights=!1,this.uniforms={index:{value:[0,0,0]}},this.vertexShader=["void main() {","  #include <begin_vertex>","  #include <project_vertex>","}"].join("\n"),this.fragmentShader=["uniform vec3 index;","void main() {","  gl_FragColor = vec4(index, 1.0);","}"].join("\n")}static indexFromPixel(t){return t[0]+t[1]<<8+t[2]<<16}static zoneFromPixel(t){return t[3]}setIndex(t){const e=t>>16,i=(t>>8)-(e<<8),n=t-(e<<16)-(i<<8),s=this.uniforms.index.value;s[0]=n/255,s[1]=i/255,s[2]=e/255,this.uniformsNeedUpdate=!0}}class r extends n.BKk{constructor(){super(...arguments),this.isPositionShader=!0,this.uniforms={index:{value:0},range:{value:[-1,1]}},this.vertexShader=["varying vec3 vLocalPosition;","void main() {","  #include <begin_vertex>","  #include <project_vertex>","  vLocalPosition = vec3(position);","}"].join("\n"),this.fragmentShader=["uniform float index;","uniform vec2 range;","varying vec3 vLocalPosition;","vec4 toVec4(float v) {","  float vn = (v - range.x) / (range.y - range.x);","  float b0 = floor(vn * 255.0) / 255.0; vn = (vn - b0) * 256.0;","  float b1 = floor(vn * 255.0) / 255.0; vn = (vn - b1) * 256.0;","  float b2 = floor(vn * 255.0) / 255.0; vn = (vn - b2) * 256.0;","  float b3 = floor(vn * 255.0) / 255.0;","  return vec4(clamp(b0, 0.0, 1.0), clamp(b1, 0.0, 1.0), clamp(b2, 0.0, 1.0), clamp(b3, 0.0, 1.0));","}","void main() {","  gl_FragColor = (index == 0.0 ? toVec4(vLocalPosition.x)","    : (index == 1.0 ? toVec4(vLocalPosition.y) : toVec4(vLocalPosition.z)));","}"].join("\n")}}class o extends n.BKk{constructor(){super(...arguments),this.isNormalShader=!0,this.uniforms={index:{value:0}},this.vertexShader=["varying vec3 vLocalNormal;","void main() {","  #include <beginnormal_vertex>","  #include <begin_vertex>","  #include <project_vertex>","  vLocalNormal = vec3(normal);","}"].join("\n"),this.fragmentShader=["uniform vec3 index;","varying vec3 vLocalNormal;","void main() {","  vec3 normal = normalize(vLocalNormal);","  gl_FragColor = vec4(normal * 0.5 + 0.5, 1.0);","}"].join("\n")}}const a=new n.Pq0,l=new n.Q1f,c=1e4,h=new n.NRn(new n.Pq0(-1e4,-1e4,-1e4),new n.Pq0(c,c,c));class u{static add(t,e){const i=t=>{t.material&&(t.onBeforeRender=function(e,i,n,s,r){r.isIndexShader&&r.setIndex(t.id)},t.onAfterRender=function(t,e,i,n,s){s.isIndexShader&&s.setIndex(0)})};e?t.traverse(t=>i(t)):i(t)}static remove(t,e){const i=t=>{t.material&&(t.onBeforeRender=null,t.onAfterRender=null)};e?t.traverse(t=>i(t)):i(t)}constructor(t){this.renderer=t,this.pickTextures=[];for(let t=0;t<3;++t)this.pickTextures[t]=new n.nWS(1,1,{stencilBuffer:!1});this.pickBuffer=new Uint8Array(4),this.indexShader=new s,this.positionShader=new r,this.normalShader=new o}pickObject(t,e,i){const n=this.pickIndex(t,e,i);if(n>0)return t.getObjectById(n)}pickIndex(t,e,i){const n=i.viewport;(e=n.updateCamera(e)).layers.disable(1);const s=t.overrideMaterial;t.overrideMaterial=this.indexShader;const r=this.renderer,o=this.pickTextures[0];r.getClearColor(l),n.applyPickViewport(o,i),r.setRenderTarget(o),r.setClearColor(0);const a=r.xr.enabled;r.xr.enabled=!1,r.clear(),r.render(t,e),r.xr.enabled=a,r.setRenderTarget(null),r.setClearColor(l),t.overrideMaterial=s,e.layers.enable(1);const c=this.pickBuffer;return r.readRenderTargetPixels(o,0,0,1,1,c),c[0]+256*c[1]+65536*c[2]}pickPosition(t,e,i,s,r){s=s||h,r=r||new n.Pq0;const o=i.viewport;(e=o.updateCamera(e)).layers.disable(1);const c=t.overrideMaterial,u=t.overrideMaterial=this.positionShader,d=this.renderer,p=this.pickTextures;d.getClearColor(l),d.setClearColor(0);for(let n=0;n<3;++n)u.uniforms.index.value=n,u.uniforms.range.value[0]=s.min.getComponent(n),u.uniforms.range.value[1]=s.max.getComponent(n),o.applyPickViewport(p[n],i),d.setRenderTarget(p[n]),d.clear(),d.render(t,e);d.setRenderTarget(null),d.setClearColor(l),t.overrideMaterial=c,e.layers.enable(1);const f=this.pickBuffer;for(let t=0;t<3;++t)d.readRenderTargetPixels(p[t],0,0,1,1,f),r.setComponent(t,2.337437050015319e-10*f[3]+5.983838848039216e-8*f[2]+1531862745098039e-20*f[1]+.003921568627451*f[0]);return s.getSize(a),r.multiply(a).add(s.min)}pickNormal(t,e,i,s){s=s||new n.Pq0;const r=i.viewport;(e=r.updateCamera(e)).layers.disable(1);const o=t.overrideMaterial;t.overrideMaterial=this.normalShader;const a=this.renderer,c=this.pickTextures[0];a.getClearColor(l),r.applyPickViewport(c,i),a.setRenderTarget(c),a.setClearColor(0),a.clear(),a.render(t,e),a.setRenderTarget(null),a.setClearColor(l),t.overrideMaterial=o,e.layers.enable(1);const h=this.pickBuffer;return a.readRenderTargetPixels(c,0,0,1,1,h),s.set(h[0]/255*2-1,h[1]/255*2-1,h[2]/255*2-1).normalize()}}},7801:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>d});var n=i(3423),s=i(6773),r=i(2997),o=i(3911),a=i(8313),l=i(161),c=i(3600),h=i(8604),u=i(9337);class d extends n.Ay{constructor(){super(...arguments),this.ins=this.addInputs(d.ins),this.outs=this.addOutputs(d.outs)}get settingProperties(){return[this.ins.enabled,this.ins.position]}get snapshotProperties(){return[this.ins.enabled,this.ins.position,this.ins.articleId]}get articles(){return Object.keys(this._articles).map(t=>this._articles[t])}get activeArticle(){return this.outs.article.value}get assetManager(){return this.getMainComponent(l.A)}get assetReader(){return this.getMainComponent(c.A)}get analytics(){return this.getMainComponent(h.A)}get language(){return this.getGraphComponent(u.A)}create(){super.create(),this.getGraphComponents(a.A).forEach(t=>t.on("update",this.updateArticles,this)),this.graph.components.on(a.A,this.onMetaComponent,this),this.graph.components.on(u.A,this.onLanguageComponent,this),this.updateArticles()}dispose(){this.graph.components.off(u.A,this.onLanguageComponent,this),this.graph.components.off(a.A,this.onMetaComponent,this),this.getGraphComponents(a.A).forEach(t=>t.off("update",this.updateArticles,this)),super.dispose()}update(t){const e=this.ins,i=this.outs;if(e.enabled.changed,e.position.changed&&e.position.value==r.Yf.Left&&(s.Ay.show("Reader position not available. Using Overlay."),e.position.setValue(r.Yf.Overlay)),e.articleId.changed){const t=this._articles[e.articleId.value]||null,n=t&&t.article;i.article.setValue(n),i.content.setValue(""),n&&(this.readArticle(n),this.analytics.sendProperty("Reader_ArticleId",n.defaultTitle))}return e.refresh.changed&&this.refreshArticle(),!0}readArticle(t){const e=this.outs,i=t.uri;if(i)return this.assetReader.getText(i).then(t=>this.parseArticle(t,i)).then(t=>e.content.setValue(t)).catch(t=>e.content.setValue(`<h2>Article not found at ${i}</h2>`));e.content.setValue("<h2>Can't display article: no URI.</h2>")}parseArticle(t,e){t=t.replace(/[\n\r]/g,"");const i=this.assetManager.getAssetBasePath(e);return t=t.replace(/(src=\")(.*?)(\")/g,(t,e,n,s)=>(n.startsWith("/")||n.startsWith("http")||(n=this.assetManager.getAssetUrl(i+n)),e+n+s)),Promise.resolve(t)}onMetaComponent(t){t.add&&t.object.articles.on("update",this.updateArticles,this),t.remove&&t.object.articles.off("update",this.updateArticles,this),this.updateArticles()}onLanguageComponent(t){t.add&&t.object.outs.activeLanguage.on("value",this.updateLanguage,this),t.remove&&t.object.outs.activeLanguage.off("value",this.updateLanguage,this)}refreshArticle(){const t=this._articles[this.ins.articleId.value]||null,e=t&&t.article;e&&this.readArticle(e)}updateArticles(){const t=this.getGraphComponents(a.A),e=this._articles={};t.forEach(t=>{const i=t.articles,n=t.node;i.items.forEach(t=>{e[t.id]={article:t,node:n}})})}updateLanguage(){this.ins;this.articles.forEach(t=>{t.article.language=this.language.outs.activeLanguage.value}),this.ins.refresh.set()}fromData(t){t=t||{},this.ins.setValues({enabled:!!t.enabled,position:r.Yf[t.position]||r.Yf.Overlay})}toData(){const t=this.ins;return{enabled:t.enabled.value,position:r.Yf[t.position.value]||"Overlay"}}}d.typeName="CVReader",d.text="Reader",d.icon="",d.ins={enabled:n.gK.Boolean("Reader.Enabled"),visible:n.gK.Boolean("Reader.Visible",!0),closed:n.gK.Event("Reader.Closed"),refresh:n.gK.Event("Reader.Refresh"),position:n.gK.Enum("Reader.Position",r.Yf),articleId:n.gK.String("Article.ID"),focus:n.gK.Boolean("Reader.Focus")},d.outs={article:n.gK.Object("Article.Active",o.A),content:n.gK.String("Article.Content"),count:n.gK.Integer("Article.Count")}},7832:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var n=i(8446),s=i(3198),r=i(3675);class o extends n.A{constructor(){super(...arguments),this._language=r.aL[r.Nm],this._leadChanged=!1}get title(){return 0===Object.keys(this.data.titles).length&&(this.data.titles[r.aL[this.language]]=this.data.title),this.data.titles[r.aL[this.language]]||"Missing content"}set title(t){this.data.titles[r.aL[this.language]]=t,this.update()}titleIn(t){return 0===Object.keys(this.data.titles).length&&(this.data.titles[r.aL[this.language]]=this.data.title),this.data.titles[r.aL[t]]}get lead(){return 0===Object.keys(this.data.leads).length&&(this.data.leads[r.aL[this.language]]=this.data.lead),this.data.leads[r.aL[this.language]]||""}set lead(t){this.data.leads[r.aL[this.language]]=t,this.update()}leadIn(t){return 0===Object.keys(this.data.leads).length&&(this.data.leads[r.aL[this.language]]=this.data.lead),this.data.leads[r.aL[t]]||""}get tags(){return 0===Object.keys(this.data.taglist).length&&this.data.tags.length>0&&(this.data.taglist[r.aL[this.language]]=this.data.tags),this.data.taglist[r.aL[this.language]]||[]}set tags(t){this.data.taglist[r.aL[this.language]]=t,this.update()}get language(){return this._language}set language(t){this._language=t}get imageCredit(){return this.data.imageCredit[r.aL[this.language]]||""}set imageCredit(t){this.data.imageCredit[r.aL[this.language]]=t,this.update()}get imageAltText(){return this.data.imageAltText[r.aL[this.language]]||""}set imageAltText(t){this.data.imageAltText[r.aL[this.language]]=t,this.update()}get leadChanged(){return this._leadChanged}set leadChanged(t){this._leadChanged=t}static fromJSON(t){return new o(t)}init(){return{id:n.A.generateId(),title:"New Annotation",titles:{},lead:"",leads:{},marker:"",tags:[],taglist:{},articleId:"",imageUri:"",imageCredit:{},imageAltText:{},audioId:"",viewId:"",style:s.A.defaultTypeName,visible:!0,expanded:!1,position:null,direction:null,scale:1,offset:0,tilt:0,azimuth:0,color:[0,.61,.87],zoneIndex:-1}}deflate(t,e){e.id=t.id,Object.keys(this.data.titles).length>0?(e.titles={},Object.keys(this.data.titles).forEach(i=>{e.titles[i]=t.titles[i]})):t.title&&(e.title=t.title),Object.keys(this.data.leads).length>0?(e.leads={},Object.keys(this.data.leads).forEach(i=>{e.leads[i]=t.leads[i]})):t.lead&&(e.lead=t.lead),t.marker&&(e.marker=t.marker),Object.keys(this.data.taglist).length>0?(e.taglist={},Object.keys(this.data.taglist).forEach(i=>{e.taglist[i]=t.taglist[i].slice()})):t.tags.length>0&&(e.tags=t.tags),t.articleId&&(e.articleId=t.articleId),t.imageUri&&(e.imageUri=t.imageUri),t.imageUri&&(e.imageUri=t.imageUri),Object.keys(this.data.imageCredit).length>0&&(e.imageCredit={},Object.keys(this.data.imageCredit).forEach(i=>{e.imageCredit[i]=t.imageCredit[i]})),Object.keys(this.data.imageAltText).length>0&&(e.imageAltText={},Object.keys(this.data.imageAltText).forEach(i=>{e.imageAltText[i]=t.imageAltText[i]})),t.audioId&&(e.audioId=t.audioId),t.viewId&&(e.viewId=t.viewId),t.style!==s.A.defaultTypeName&&(e.style=t.style),!1===t.visible&&(e.visible=t.visible),t.position&&(e.position=t.position.slice()),t.direction&&(e.direction=t.direction.slice()),1!==t.scale&&(e.scale=t.scale),0!==t.offset&&(e.offset=t.offset),0!==t.tilt&&(e.tilt=t.tilt),0!==t.azimuth&&(e.azimuth=t.azimuth);const i=t.color;return!i||0===i[0]&&.61===i[1]&&.87===i[2]||(e.color=i.slice()),t.zoneIndex>-1&&(e.zoneIndex=t.zoneIndex),t}inflate(t,e){e.id=t.id,e.title=t.title||"",e.titles=t.titles||{},e.lead=t.lead||"",e.leads=t.leads||{},e.marker=t.marker||"",e.tags=t.tags||[],e.taglist=t.taglist||{},e.articleId=t.articleId||"",e.imageUri=t.imageUri||"",e.imageCredit=t.imageCredit||{},e.imageAltText=t.imageAltText||{},e.audioId=t.audioId||"",e.viewId=t.viewId||"",e.style=t.style||s.A.defaultTypeName,e.visible=void 0===t.visible||t.visible,e.expanded=!1,e.position=t.position.slice(),e.direction=t.direction.slice(),e.scale=void 0!==t.scale?t.scale:1,e.offset=t.offset||0,e.tilt=t.tilt||0,e.azimuth=t.azimuth||0,e.color=t.color||o.defaultColor.slice(),e.zoneIndex=void 0!==t.zoneIndex?t.zoneIndex:-1}}o.defaultColor=[0,.61,.87]},7891:(t,e,i)=>{"use strict";var n=i(4640),s=i(8337),r=i(5532),o=i(6763),a=(i(9498),i(9521)),l=i(3198),c=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};const h=["sv-q0","sv-q1","sv-q2","sv-q3"],u=new r.Ay,d=new n.Pq0(0,1,0);class p extends a.Ay{constructor(t){super(t),this.quadrant=-1,this.adaptive=!0;const e=[];e.push(new n.Pq0(0,0,0)),e.push(new n.Pq0(0,1,0));const i=(new n.LoY).setFromPoints(e),s=new n.mrM({color:"#009cde",transparent:!0});s.toneMapped=!1,this.stemLine=new n.N1A(i,s),this.stemLine.frustumCulled=!1,this.stemLine.matrixAutoUpdate=!1,this.add(this.stemLine),this.update()}update(){const t=this.annotation.data;this.stemLine.scale.setScalar(t.scale),this.stemLine.position.y=t.offset,this.stemLine.updateMatrix();this.stemLine.material.color.fromArray(t.color),super.update()}renderHTMLElement(t,e,i){super.renderHTMLElement(t,e,i,this.stemLine,d);const n=s.A.scaleLimit(this.viewAngle*s.A.RAD2DEG,90,100,1,0),r=this.annotation.data.visible?n:0;this.stemLine.material.opacity=r,t.setOpacity(r),this.orientationQuadrant!==this.quadrant&&(t.classList.remove(h[this.quadrant]),t.classList.add(h[this.orientationQuadrant]),this.quadrant=this.orientationQuadrant),this.adaptive!==this.isAdaptive&&(this.isAdaptive?t.classList.remove("sv-static-width"):t.classList.add("sv-static-width"),this.adaptive=this.isAdaptive),this.setVisible(!this.isBehindCamera(this.stemLine,i)&&this.annotation.data.visible)}createHTMLElement(){return new f(this)}dispose(){super.dispose(),this.stemLine.geometry.dispose(),this.stemLine.material.dispose()}}p.typeName="Standard",l.A.registerDefaultType(p);let f=class extends a.sf{constructor(t){super(t),this.onClickTitle=this.onClickTitle.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.titleElement=this.appendElement("div"),this.titleElement.classList.add("sv-title"),this.titleElement.addEventListener("click",this.onClickTitle),this.titleElement.addEventListener("keydown",this.onKeyDown),this.titleElement.setAttribute("tabindex","0")}firstConnected(){super.firstConnected(),this.classList.add("sv-standard-annotation")}update(t){super.update(t);const e=this.sprite.annotation.data;e.viewId.length?this.classList.add("sv-enable-events"):this.classList.remove("sv-enable-events"),this.titleElement.innerText=this.sprite.annotation.title,u.fromArray(e.color),this.style.borderColor=u.toString()}onClickTitle(t){t.stopPropagation(),this.sprite.emitClickEvent()}onKeyDown(t){"Space"!==t.code&&"Enter"!==t.code||(t.stopPropagation(),this.sprite.emitClickEvent())}};f=c([(0,o.EM)("sv-standard-annotation")],f)},7926:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},7988:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class i{}e._CodeOrName=i,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends i{constructor(t){if(super(),!e.IDENTIFIER.test(t))throw new Error("CodeGen: name must be a valid identifier");this.str=t}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=n;class s extends i{constructor(t){super(),this._items="string"==typeof t?[t]:t}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const t=this._items[0];return""===t||'""'===t}get str(){var t;return null!==(t=this._str)&&void 0!==t?t:this._str=this._items.reduce((t,e)=>`${t}${e}`,"")}get names(){var t;return null!==(t=this._names)&&void 0!==t?t:this._names=this._items.reduce((t,e)=>(e instanceof n&&(t[e.str]=(t[e.str]||0)+1),t),{})}}function r(t,...e){const i=[t[0]];let n=0;for(;n<e.length;)l(i,e[n]),i.push(t[++n]);return new s(i)}e._Code=s,e.nil=new s(""),e._=r;const o=new s("+");function a(t,...e){const i=[h(t[0])];let n=0;for(;n<e.length;)i.push(o),l(i,e[n]),i.push(o,h(t[++n]));return function(t){let e=1;for(;e<t.length-1;){if(t[e]===o){const i=c(t[e-1],t[e+1]);if(void 0!==i){t.splice(e-1,3,i);continue}t[e++]="+"}e++}}(i),new s(i)}function l(t,e){var i;e instanceof s?t.push(...e._items):e instanceof n?t.push(e):t.push("number"==typeof(i=e)||"boolean"==typeof i||null===i?i:h(Array.isArray(i)?i.join(","):i))}function c(t,e){if('""'===e)return t;if('""'===t)return e;if("string"==typeof t){if(e instanceof n||'"'!==t[t.length-1])return;return"string"!=typeof e?`${t.slice(0,-1)}${e}"`:'"'===e[0]?t.slice(0,-1)+e.slice(1):void 0}return"string"!=typeof e||'"'!==e[0]||t instanceof n?void 0:`"${t}${e.slice(1)}`}function h(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.str=a,e.addCodeArg=l,e.strConcat=function(t,e){return e.emptyStr()?t:t.emptyStr()?e:a`${t}${e}`},e.stringify=function(t){return new s(h(t))},e.safeStringify=h,e.getProperty=function(t){return"string"==typeof t&&e.IDENTIFIER.test(t)?new s(`.${t}`):r`[${t}]`},e.regexpCode=function(t){return new s(t.toString())}},8031:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s=i(3151),r={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:t})=>n._`{passingSchemas: ${t.passing}}`},code(t){const{gen:e,schema:i,parentSchema:r,it:o}=t;if(!Array.isArray(i))throw new Error("ajv implementation error");if(o.opts.discriminator&&r.discriminator)return;const a=i,l=e.let("valid",!1),c=e.let("passing",null),h=e.name("_valid");t.setParams({passing:c}),e.block(function(){a.forEach((i,r)=>{let a;(0,s.alwaysValidSchema)(o,i)?e.var(h,!0):a=t.subschema({keyword:"oneOf",schemaProp:r,compositeRule:!0},h),r>0&&e.if(n._`${h} && ${l}`).assign(l,!1).assign(c,n._`[${c}, ${r}]`).else(),e.if(h,()=>{e.assign(l,!0),e.assign(c,r),a&&t.mergeEvaluated(a,n.Name)})})}),t.result(l,()=>t.reset(),()=>t.error(!0))}};e.default=r},8086:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5626),s={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,n.validateTuple)(t,"items")};e.default=s},8089:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const n=i(7988);class s extends Error{constructor(t){super(`CodeGen: "code" for ${t} not defined`),this.value=t.value}}var r;!function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"}(r=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new n.Name("const"),let:new n.Name("let"),var:new n.Name("var")};class o{constructor({prefixes:t,parent:e}={}){this._names={},this._prefixes=t,this._parent=e}toName(t){return t instanceof n.Name?t:this.name(t)}name(t){return new n.Name(this._newName(t))}_newName(t){return`${t}${(this._names[t]||this._nameGroup(t)).index++}`}_nameGroup(t){var e,i;if((null===(i=null===(e=this._parent)||void 0===e?void 0:e._prefixes)||void 0===i?void 0:i.has(t))||this._prefixes&&!this._prefixes.has(t))throw new Error(`CodeGen: prefix "${t}" is not allowed in this scope`);return this._names[t]={prefix:t,index:0}}}e.Scope=o;class a extends n.Name{constructor(t,e){super(e),this.prefix=t}setValue(t,{property:e,itemIndex:i}){this.value=t,this.scopePath=n._`.${new n.Name(e)}[${i}]`}}e.ValueScopeName=a;const l=n._`\n`;e.ValueScope=class extends o{constructor(t){super(t),this._values={},this._scope=t.scope,this.opts={...t,_n:t.lines?l:n.nil}}get(){return this._scope}name(t){return new a(t,this._newName(t))}value(t,e){var i;if(void 0===e.ref)throw new Error("CodeGen: ref must be passed in value");const n=this.toName(t),{prefix:s}=n,r=null!==(i=e.key)&&void 0!==i?i:e.ref;let o=this._values[s];if(o){const t=o.get(r);if(t)return t}else o=this._values[s]=new Map;o.set(r,n);const a=this._scope[s]||(this._scope[s]=[]),l=a.length;return a[l]=e.ref,n.setValue(e,{property:s,itemIndex:l}),n}getValue(t,e){const i=this._values[t];if(i)return i.get(e)}scopeRefs(t,e=this._values){return this._reduceValues(e,e=>{if(void 0===e.scopePath)throw new Error(`CodeGen: name "${e}" has no value`);return n._`${t}${e.scopePath}`})}scopeCode(t=this._values,e,i){return this._reduceValues(t,t=>{if(void 0===t.value)throw new Error(`CodeGen: name "${t}" has no value`);return t.value.code},e,i)}_reduceValues(t,i,o={},a){let l=n.nil;for(const c in t){const h=t[c];if(!h)continue;const u=o[c]=o[c]||new Map;h.forEach(t=>{if(u.has(t))return;u.set(t,r.Started);let o=i(t);if(o){const i=this.opts.es5?e.varKinds.var:e.varKinds.const;l=n._`${l}${i} ${t} = ${o};${this.opts._n}`}else{if(!(o=null==a?void 0:a(t)))throw new s(t);l=n._`${l}${o}${this.opts._n}`}u.set(t,r.Completed)})}return l}}},8093:(t,e,i)=>{"use strict";let n=i(6613),s=i(8262),r=i(8495);function o(t,e){let i=new s(t,e),n=new r(i);try{n.parse()}catch(t){throw t}return n.root}t.exports=o,o.default=o,n.registerParse(o)},8135:(t,e,i)=>{"use strict";i.d(e,{X:()=>a,r:()=>o});var n=i(6187),s=i(3869),r=i(1046);const o=new WeakMap,a=(t,e,i)=>{let a=o.get(e);void 0===a&&((0,n.if)(e,e.firstChild),o.set(e,a=new s.Qh(Object.assign({templateFactory:r.v},i))),a.appendInto(e)),a.setValue(t),a.commit()}},8167:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(6241),s=i(5265),r=i(3151),o={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:t}})=>s.str`must have required property '${t}'`,params:({params:{missingProperty:t}})=>s._`{missingProperty: ${t}}`},code(t){const{gen:e,schema:i,schemaCode:o,data:a,$data:l,it:c}=t,{opts:h}=c;if(!l&&0===i.length)return;const u=i.length>=h.loopRequired;if(c.allErrors?function(){if(u||l)t.block$data(s.nil,d);else for(const e of i)(0,n.checkReportMissingProp)(t,e)}():function(){const r=e.let("missing");if(u||l){const i=e.let("valid",!0);t.block$data(i,()=>function(i,r){t.setParams({missingProperty:i}),e.forOf(i,o,()=>{e.assign(r,(0,n.propertyInData)(e,a,i,h.ownProperties)),e.if((0,s.not)(r),()=>{t.error(),e.break()})},s.nil)}(r,i)),t.ok(i)}else e.if((0,n.checkMissingProp)(t,i,r)),(0,n.reportMissingProp)(t,r),e.else()}(),h.strictRequired){const e=t.parentSchema.properties,{definedProperties:n}=t.it;for(const t of i)if(void 0===(null==e?void 0:e[t])&&!n.has(t)){const e=`required property "${t}" is not defined at "${c.schemaEnv.baseId+c.errSchemaPath}" (strictRequired)`;(0,r.checkStrictMode)(c,e,c.opts.strictRequired)}}function d(){e.forOf("prop",o,i=>{t.setParams({missingProperty:i}),e.if((0,n.noPropertyInData)(e,a,i,h.ownProperties),()=>t.error())})}}};e.default=o},8172:(t,e,i)=>{"use strict";i.d(e,{A:()=>_});var n=i(4640),s=i(3423),r=i(3675),o=i(1086),a=i(9616),l=i(9519),c=i(8424),h=i(9610),u=i(1721),d=i(3889),p=i(7078),f=i(5590),g=i(7482),m=i(4088);const A=new n.Pq0,v=new n.Pq0;function y(t){return"shadowSize"in t.ins}function b(t){return"distance"in t.ins}class _ extends o.A{constructor(){super(...arguments),this.ins=this.addInputs(_.ins),this.outs=this.addOutputs(_.outs),this.updateCameraHelper=()=>{const t=this.setup.navigation.ins.offset.value,e=A.set(t[0],t[1],t[2]).length();if(!this.system.getComponent("CVStoryApplication",!0)){const t=2.5*Math.max(e,this.outs.boundingRadius.value),i=this.setup.navigation.ins.maxOffset.value;this.setup.navigation.ins.maxOffset.setValue([i[0],i[1],t])}this.cameras.forEach(t=>{if(t.addIns.autoNearFar.value){const i=4*Math.max(e,this.outs.boundingRadius.value),n=Math.min(i/1e3,this.outs.boundingRadius.value/100);(i<t.ins.far.value||t.ins.far.value<2*this.setup.navigation.ins.maxOffset.value[2])&&(t.ins.far.setValue(i),t.ins.near.setValue(n),this.setup.navigation.ins.projection.set())}})}}get settingProperties(){return null}get snapshotProperties(){return null}get models(){return this.getGraphComponents(a.A)}get cameras(){return this.getGraphComponents(h.A)}get setup(){return this.getGraphComponent(u.A)}get renderer(){return this.getMainComponent(d.A)}create(){super.create(),this.outs.boundingBox.setValue(new n.NRn),this.graph.components.on(a.A,this.onModelComponent,this),this.models.forEach(t=>{t.ins.globalUnits.linkFrom(this.ins.units),this.ins.modelUpdated.linkFrom(t.outs.updated)})}update(t){const e=this.ins,i=this.outs;return e.units.changed&&(this.updateTransformHierarchy(),this.updateModelBoundingBox(),this.updateLights(),this.updateCameras(),i.units.setValue(e.units.value)),e.modelUpdated.changed&&(this.updateModelBoundingBox(),this.updateLights(),this.updateCameras()),e.sceneTransformed.changed&&this.updateModelBoundingBox(),e.lightUpdated.changed&&this.updateLights(),!0}dispose(){this.graph.components.off(a.A,this.onModelComponent,this),super.dispose()}fromDocument(t,e){this.ins.units.setValue(r.uj[e.units]||0),this.outs.units.setValue(r.uj[e.units]||0)}toDocument(t,e){e.units=r.uj[this.ins.units.getValidatedValue()]}onModelComponent(t){const e=t.object;t.add&&(e.ins.globalUnits.linkFrom(this.ins.units),this.ins.modelUpdated.linkFrom(e.outs.updated))}updateModelBoundingBox(){const t=this.outs.boundingBox.value;t.makeEmpty(),this.models.forEach(e=>{e.object3D.visible&&t.expandByObject(e.object3D)}),t.getSize(A),A.length()>0?(this.outs.boundingBox.set(),this.outs.boundingRadius.setValue(.5*A.length())):this.outs.boundingRadius.setValue(10)}updateTransformHierarchy(){if(0===this.models.length)return;const{ins:t,outs:e}=this,i=(0,l.A)(e.units.value,t.units.value),n=this.models[0].object3D.parent.parent;n.position.multiplyScalar(i),n.updateMatrix(),n.updateMatrixWorld(!0),this.models.forEach(t=>{const e=t.object3D.parent;e.position.multiplyScalar(i),e.updateMatrix(),e.updateMatrixWorld(!0)})}updateLights(){const{ins:t,outs:e}=this,i=this.graph.findNodeByName("Lights");if(i){const n=i.getComponent(c.Ay,!0),s=(0,l.A)(e.units.value,t.units.value);n.ins.scale.setValue([1,1,1]),n.children.forEach(t=>{var e,i;const n=t.getComponents(p.I);for(let t of n){if(t instanceof f.A){A.copy(t.light.position),v.copy(t.light.target.position);const e=v.sub(A).normalize();e.applyEuler(t.transform.object3D.rotation),A.copy(e.negate().multiplyScalar(1.2*this.outs.boundingRadius.value)),A.multiplyScalar(s),t.transform.ins.position.setValue(A.toArray()),A.setScalar(this.outs.boundingRadius.value*s*.2),t.transform.ins.scale.setValue(A.toArray()),t.light.updateMatrix()}else A.fromArray(t.transform.ins.position.value),A.multiplyScalar(s),t.transform.ins.position.setValue(A.toArray()),t instanceof g.A||t instanceof m.A?A.setScalar(this.outs.boundingRadius.value*s*.2):(A.fromArray(t.transform.ins.scale.value),A.multiplyScalar(s)),t.transform.ins.scale.setValue(A.toArray()),null===(e=t.light)||void 0===e||e.updateMatrix();y(t)?t.ins.shadowSize.setValue(2*this.outs.boundingRadius.value):b(t)&&(t.ins.distance.value?t.ins.distance.setValue(t.ins.distance.value*s):"far"in(null===(i=t.light.shadow)||void 0===i?void 0:i.camera)&&(t.light.shadow.camera.far=t.light.shadow.camera.far*s))}})}}updateCameras(){this.renderer.views[0]&&this.renderer.views[0].renderer.xr.isPresenting||this.updateCameraHelper()}}_.typeName="CVScene",_.text="Scene",_.icon="hierarchy",_.ins={units:s.gK.Enum("Scene.Units",r.uj,r.uj.cm),modelUpdated:s.gK.Event("Scene.ModelUpdated"),lightUpdated:s.gK.Event("Scene.LightUpdated"),sceneTransformed:s.gK.Event("Scene.Transformed")},_.outs={units:s.gK.Enum("Scene.Units",r.uj,r.uj.cm),boundingBox:s.gK.Object("Models.BoundingBox",n.NRn),boundingRadius:s.gK.Number("Models.BoundingRadius")}},8177:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>o,EM:()=>n.EM,qy:()=>n.qy});var n=i(6763),s=i(5933),r=i(2902);class o extends s.Ay{constructor(){super(...arguments),this.activeDocument=null}get documentProvider(){return this.system.getMainComponent(r.A)}connected(){const t=this.documentProvider;t.on("active-component",this.onActiveDocumentEvent,this);const e=t.activeComponent;e&&(this.activeDocument=e,this.onActiveDocument(null,e))}disconnected(){this.documentProvider.off("active-component",this.onActiveDocumentEvent,this);const t=this.activeDocument;t&&(this.activeDocument=null,this.onActiveDocument(t,null))}onActiveDocument(t,e){}onActiveDocumentEvent(t){this.activeDocument=t.next,this.onActiveDocument(t.previous,t.next)}}},8203:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extendSubschemaMode=e.extendSubschemaData=e.getSubschema=void 0;const n=i(5265),s=i(3151);e.getSubschema=function(t,{keyword:e,schemaProp:i,schema:r,schemaPath:o,errSchemaPath:a,topSchemaRef:l}){if(void 0!==e&&void 0!==r)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==e){const r=t.schema[e];return void 0===i?{schema:r,schemaPath:n._`${t.schemaPath}${(0,n.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:r[i],schemaPath:n._`${t.schemaPath}${(0,n.getProperty)(e)}${(0,n.getProperty)(i)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,s.escapeFragment)(i)}`}}if(void 0!==r){if(void 0===o||void 0===a||void 0===l)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:r,schemaPath:o,topSchemaRef:l,errSchemaPath:a}}throw new Error('either "keyword" or "schema" must be passed')},e.extendSubschemaData=function(t,e,{dataProp:i,dataPropType:r,data:o,dataTypes:a,propertyName:l}){if(void 0!==o&&void 0!==i)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:c}=e;if(void 0!==i){const{errorPath:o,dataPathArr:a,opts:l}=e;h(c.let("data",n._`${e.data}${(0,n.getProperty)(i)}`,!0)),t.errorPath=n.str`${o}${(0,s.getErrorPath)(i,r,l.jsPropertySyntax)}`,t.parentDataProperty=n._`${i}`,t.dataPathArr=[...a,t.parentDataProperty]}if(void 0!==o){h(o instanceof n.Name?o:c.let("data",o,!0)),void 0!==l&&(t.propertyName=l)}function h(i){t.data=i,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,i]}a&&(t.dataTypes=a)},e.extendSubschemaMode=function(t,{jtdDiscriminator:e,jtdMetadata:i,compositeRule:n,createErrors:s,allErrors:r}){void 0!==n&&(t.compositeRule=n),void 0!==s&&(t.createErrors=s),void 0!==r&&(t.allErrors=r),t.jtdDiscriminator=e,t.jtdMetadata=i}},8227:(t,e,i)=>{"use strict";let n=i(1352);function s(t,e){new n(e).stringify(t)}t.exports=s,s.default=s},8262:(t,e,i)=>{"use strict";let{nanoid:n}=i(945),{isAbsolute:s,resolve:r}=i(5324),{SourceMapConsumer:o,SourceMapGenerator:a}=i(8645),{fileURLToPath:l,pathToFileURL:c}=i(588),h=i(50),u=i(6842),d=i(3215),p=Symbol("lineToIndexCache"),f=Boolean(o&&a),g=Boolean(r&&s);function m(t){if(t[p])return t[p];let e=t.css.split("\n"),i=new Array(e.length),n=0;for(let t=0,s=e.length;t<s;t++)i[t]=n,n+=e[t].length+1;return t[p]=i,i}class A{get from(){return this.file||this.id}constructor(t,e={}){if(null==t||"object"==typeof t&&!t.toString)throw new Error(`PostCSS received ${t} instead of CSS string`);if(this.css=t.toString(),"\ufeff"===this.css[0]||"￾"===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,this.document=this.css,e.document&&(this.document=e.document.toString()),e.from&&(!g||/^\w+:\/\//.test(e.from)||s(e.from)?this.file=e.from:this.file=r(e.from)),g&&f){let t=new u(this.css,e);if(t.text){this.map=t;let e=t.consumer().file;!this.file&&e&&(this.file=this.mapResolve(e))}}this.file||(this.id="<input css "+n(6)+">"),this.map&&(this.map.file=this.from)}error(t,e,i,n={}){let s,r,o,a,l;if(e&&"object"==typeof e){let t=e,n=i;if("number"==typeof t.offset){a=t.offset;let n=this.fromOffset(a);e=n.line,i=n.col}else e=t.line,i=t.column,a=this.fromLineAndColumn(e,i);if("number"==typeof n.offset){o=n.offset;let t=this.fromOffset(o);r=t.line,s=t.col}else r=n.line,s=n.column,o=this.fromLineAndColumn(n.line,n.column)}else if(i)a=this.fromLineAndColumn(e,i);else{a=e;let t=this.fromOffset(a);e=t.line,i=t.col}let u=this.origin(e,i,r,s);return l=u?new h(t,void 0===u.endLine?u.line:{column:u.column,line:u.line},void 0===u.endLine?u.column:{column:u.endColumn,line:u.endLine},u.source,u.file,n.plugin):new h(t,void 0===r?e:{column:i,line:e},void 0===r?i:{column:s,line:r},this.css,this.file,n.plugin),l.input={column:i,endColumn:s,endLine:r,endOffset:o,line:e,offset:a,source:this.css},this.file&&(c&&(l.input.url=c(this.file).toString()),l.input.file=this.file),l}fromLineAndColumn(t,e){return m(this)[t-1]+e-1}fromOffset(t){let e=m(this),i=0;if(t>=e[e.length-1])i=e.length-1;else{let n,s=e.length-2;for(;i<s;)if(n=i+(s-i>>1),t<e[n])s=n-1;else{if(!(t>=e[n+1])){i=n;break}i=n+1}}return{col:t-e[i]+1,line:i+1}}mapResolve(t){return/^\w+:\/\//.test(t)?t:r(this.map.consumer().sourceRoot||this.map.root||".",t)}origin(t,e,i,n){if(!this.map)return!1;let r,o,a=this.map.consumer(),h=a.originalPositionFor({column:e,line:t});if(!h.source)return!1;"number"==typeof i&&(r=a.originalPositionFor({column:n,line:i})),o=s(h.source)?c(h.source):new URL(h.source,this.map.consumer().sourceRoot||c(this.map.mapFile));let u={column:h.column,endColumn:r&&r.column,endLine:r&&r.line,line:h.line,url:o.toString()};if("file:"===o.protocol){if(!l)throw new Error("file: protocol is not available in this PostCSS build");u.file=l(o)}let d=a.sourceContentFor(h.source);return d&&(u.source=d),u}toJSON(){let t={};for(let e of["hasBOM","css","file","id"])null!=this[e]&&(t[e]=this[e]);return this.map&&(t.map={...this.map},t.map.consumerCache&&(t.map.consumerCache=void 0)),t}}t.exports=A,A.default=A,d&&d.registerInput&&d.registerInput(A)},8290:(t,e,i)=>{"use strict";let n=i(3172);class s extends n{get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}constructor(t){t&&void 0!==t.value&&"string"!=typeof t.value&&(t={...t,value:String(t.value)}),super(t),this.type="decl"}}t.exports=s,s.default=s},8313:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var n=i(3331);class s extends n.A{constructor(t){super(),this.addEvent("update"),this._list=t||[],this._dict={},t&&t.forEach(t=>{t.id&&(this._dict[t.id]=t)})}get length(){return this._list.length}get ids(){return Object.keys(this._dict)}get items(){return this._list}set items(t){this._list=t,this._dict={},t.forEach(t=>{t.id&&(this._dict[t.id]=t)}),this.emit({type:"update",item:null,what:"update"})}append(t){this._list.push(t),t.id&&(this._dict[t.id]=t),this.emit({type:"update",item:t,what:"add"})}insertBefore(t,e){const i=this._list.indexOf(e);i>=0&&this.insertAt(t,i)}insertAt(t,e){this._list.splice(e,0,t),t.id&&(this._dict[t.id]=t),this.emit({type:"update",item:t,what:"add"})}replaceItem(t,e){const i=this._list.indexOf(e);i>=0&&this.replaceAt(t,i)}replaceAt(t,e){const i=this._list[e];i.id&&delete this._dict[i.id],this._list[e]=t,t.id&&(this._dict[t.id]=t),this.emit({type:"update",item:t,what:"replace"})}moveItem(t,e){const i=this._list.indexOf(t);this.moveAt(i,e)}moveAt(t,e){const i=this._list;if(t+e<0||t+e>=i.length)return;const n=i[t];if(e>0){for(let n=0;n<e;++n)i[t+n]=i[t+n+1];i[t+e]=n}else{if(!(e<0))return;for(let n=0;n>e;--n)i[t+n]=i[t+n-1];i[t+e]=n}this.emit({type:"update",item:n,what:"move"})}removeById(t){const e=this._dict[t];return e&&this.removeItem(e),e}removeItem(t){const e=this._list.indexOf(t);return this.removeAt(e),e}removeAt(t){const e=this._list;if(t<0||t>=e.length)return;const i=e[t];return e.splice(t,1),i.id&&delete this._dict[i.id],this.emit({type:"update",item:i,what:"remove"}),i}getAt(t){return this._list[t]}getById(t){return this._dict[t]}getIndexOf(t){return this._list.indexOf(t)}copy(t){this.items=t.slice()}clone(){return this._list.slice()}}s.prototype[Symbol.iterator]=function(){return{index:0,list:this._list,next:function(){return this.index<this.list.length?{value:this.list[this.index++],done:!1}:{done:!0}}}};class r extends n.A{get length(){return this.ids.length}get items(){return this.ids.map(t=>this._dict[t])}set items(t){t.forEach(t=>{t.id&&(this._dict[t.id]=t)}),this.emit({type:"update",item:null,what:"update"})}get ids(){return Object.keys(this._dict)}get dictionary(){return this._dict}set dictionary(t){this._dict=t,this.emit({type:"update",item:null,what:"update"})}constructor(t){super(),this.addEvent("update"),this._dict={},t&&t.forEach(t=>{t.id&&(this._dict[t.id]=t)})}insert(t,e){if(!(e=e||t.id))throw new Error("can't insert, missing id");this._dict[e]=t,this.emit({type:"update",item:t,what:"insert"})}remove(t){const e="string"==typeof t?t:t.id,i=this._dict[e];void 0!==i&&(delete this._dict[e],this.emit({type:"update",item:i,what:"remove"}))}get(t){return this._dict[t]}getOrCreate(t,e){let i=this._dict[t];return i||(i=this._dict[t]=e,this.emit({type:"update",item:i,what:"insert"})),i}copy(t){this.dictionary=Object.assign({},t)}clone(){return Object.assign({},this._dict)}}var o=i(3423),a=i(3911),l=i(3675),c=i(9337);class h extends o.Ay{constructor(){super(...arguments),this.collection=new r,this.process=new r,this.images=new r,this.articles=new s,this.leadArticle=null,this.notes=[],this.audio=new r,this.actions=new r}get language(){return this.getGraphComponent(c.A,!0)}fromDocument(t,e){if(!isFinite(e.meta))throw new Error("info property missing in node");const i=t.metas[e.meta];if(i.collection&&(this.collection.dictionary=i.collection,this.collection.get("titles")&&Object.keys(this.collection.get("titles")).forEach(t=>{this.language.addLanguage(l.aL[t])})),i.process&&(this.process.dictionary=i.process),i.images){const t={};i.images.forEach(e=>t[e.quality]=e),this.images.dictionary=t}if(i.articles&&(this.articles.items=i.articles.map(t=>a.A.fromJSON(t)),void 0!==i.leadArticle&&(this.leadArticle=this.articles.getAt(i.leadArticle)),this.articles.items.forEach(t=>{Object.keys(t.data.titles).forEach(t=>{this.language.addLanguage(l.aL[t])}),t.language=this.language.outs.activeLanguage.value})),i.audio){const t={};i.audio.forEach(e=>{e.captionUris=e.captionUris||{},e.durations={},t[e.id]=e}),this.audio.dictionary=t}if(i.actions){const t={};i.actions.forEach(e=>{var i,n;null!==(i=e.animation)&&void 0!==i||(e.animation=""),null!==(n=e.audioId)&&void 0!==n||(e.audioId=""),t[e.id]=e}),this.actions.dictionary=t}return this.emit("load"),e.meta}toDocument(t,e){let i=null;if(this.collection.length>0&&(i={collection:this.collection.dictionary}),this.process.length>0&&(i=i||{},i.process=this.process.dictionary),this.images.length>0&&(i=i||{},i.images=this.images.items),this.articles.length>0){i=i||{};const t=this.articles.items;i.articles=t.map(t=>t.toJSON()),this.leadArticle&&(i.leadArticle=t.indexOf(this.leadArticle))}if(this.audio.length>0&&(i=i||{},i.audio=this.audio.items,i.audio.forEach(t=>{t.durations={}})),this.actions.length>0&&(i=i||{},i.actions=this.actions.items,i.actions.forEach(t=>{var e,i,n;(null===(e=t.animation)||void 0===e?void 0:e.length)<1&&delete t.animation,(null===(i=t.audioId)||void 0===i?void 0:i.length)<1&&delete t.audioId,(null===(n=t.annotationId)||void 0===n?void 0:n.length)<1&&delete t.annotationId})),i){t.metas=t.metas||[];const e=t.metas.length;return t.metas.push(i),e}}}h.typeName="CVMeta",h.text="Meta",h.icon="document"},8337:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});const n={PI:3.141592653589793,DOUBLE_PI:6.283185307179586,HALF_PI:1.5707963267948966,QUARTER_PI:.7853981633974483,DEG2RAD:.017453292519943295,RAD2DEG:57.29577951308232,limit:(t,e,i)=>t<e?e:t>i?i:t,limitInt:function(t,e,i){return(t=Math.trunc(t))<e?e:t>i?i:t},normalize:(t,e,i)=>(t-e)/(i-e),normalizeLimit:(t,e,i)=>(t=(t-e)/(i-e))<0?0:t>1?1:t,denormalize:(t,e,i)=>(e+t)*(i-e),scale:(t,e,i,n,s)=>n+(t-e)/(i-e)*(s-n),scaleLimit:(t,e,i,n,s)=>n+((t=t<e?e:t>i?i:t)-e)/(i-e)*(s-n),deg2rad:function(t){return.017453292519943295*t},rad2deg:function(t){return 57.29577951308232*t},deltaRadians:function(t,e){return t=(t%=n.DOUBLE_PI)<0?t+n.DOUBLE_PI:t,(e=(e%=n.DOUBLE_PI)<0?e+n.DOUBLE_PI:e)-t>n.PI&&(t+=n.DOUBLE_PI),e-t},deltaDegrees:function(t,e){return t=(t%=n.DOUBLE_PI)<0?t+n.DOUBLE_PI:t,(e=(e%=n.DOUBLE_PI)<0?e+n.DOUBLE_PI:e)-t>n.PI&&(t+=n.DOUBLE_PI),e-t},curves:{linear:t=>t,easeIn:t=>Math.sin(t*n.HALF_PI),easeOut:t=>Math.cos(t*n.HALF_PI-n.PI)+1,ease:t=>.5*Math.cos(t*n.PI-n.PI)+.5,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeQuad:t=>t<.5?2*t*t:(4-2*t)*t-1,easeInCubic:t=>t*t*t,easeOutCubic:t=>--t*t*t+1,easeCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1- --t*t*t*t,easeQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t}},s=n},8385:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s=i(3151),r={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:t,max:e}})=>void 0===e?n.str`must contain at least ${t} valid item(s)`:n.str`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>void 0===e?n._`{minContains: ${t}}`:n._`{minContains: ${t}, maxContains: ${e}}`},code(t){const{gen:e,schema:i,parentSchema:r,data:o,it:a}=t;let l,c;const{minContains:h,maxContains:u}=r;a.opts.next?(l=void 0===h?1:h,c=u):l=1;const d=e.const("len",n._`${o}.length`);if(t.setParams({min:l,max:c}),void 0===c&&0===l)return void(0,s.checkStrictMode)(a,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==c&&l>c)return(0,s.checkStrictMode)(a,'"minContains" > "maxContains" is always invalid'),void t.fail();if((0,s.alwaysValidSchema)(a,i)){let e=n._`${d} >= ${l}`;return void 0!==c&&(e=n._`${e} && ${d} <= ${c}`),void t.pass(e)}a.items=!0;const p=e.name("valid");function f(){const t=e.name("_valid"),i=e.let("count",0);g(t,()=>e.if(t,()=>function(t){e.code(n._`${t}++`),void 0===c?e.if(n._`${t} >= ${l}`,()=>e.assign(p,!0).break()):(e.if(n._`${t} > ${c}`,()=>e.assign(p,!1).break()),1===l?e.assign(p,!0):e.if(n._`${t} >= ${l}`,()=>e.assign(p,!0)))}(i)))}function g(i,n){e.forRange("i",0,d,e=>{t.subschema({keyword:"contains",dataProp:e,dataPropType:s.Type.Num,compositeRule:!0},i),n()})}void 0===c&&1===l?g(p,()=>e.if(p,()=>e.break())):(e.let(p,!1),0===l?e.if(n._`${o}.length > 0`,f,()=>e.assign(p,!0)):f()),t.result(p,()=>t.reset())}};e.default=r},8415:(t,e,i)=>{"use strict";var n=i(4640),s=i(8337),r=i(5532),o=i(6763),a=i(3534),l=(i(9498),i(9521)),c=i(3198),h=i(8948),u=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};const d=["sv-q0","sv-q1","sv-q2","sv-q3"],p=new r.Ay,f=new n.Pq0(0,1,0);class g extends l.Ay{constructor(t){super(t),this.quadrant=-1,this.adaptive=!0;const e=[];e.push(new n.Pq0(0,0,0)),e.push(new n.Pq0(0,1,0));const i=(new n.LoY).setFromPoints(e),s=new n.mrM({color:"#009cde",transparent:!0});s.toneMapped=!1,this.stemLine=new n.N1A(i,s),this.stemLine.frustumCulled=!1,this.stemLine.matrixAutoUpdate=!1,this.add(this.stemLine),this.update()}dispose(){this.stemLine.geometry.dispose(),this.stemLine.material.dispose(),super.dispose()}update(){const t=this.annotation.data;this.stemLine.scale.setScalar(t.scale),this.stemLine.position.y=t.offset,this.stemLine.updateMatrix();this.stemLine.material.color.fromArray(t.color),super.update()}renderHTMLElement(t,e,i){super.renderHTMLElement(t,e,i,this.stemLine,f);const n=s.A.scaleLimit(this.viewAngle*s.A.RAD2DEG,90,100,1,0),r=this.annotation.data.visible?n:0;if(this.stemLine.material.opacity=r,t.setOpacity(r),this.orientationQuadrant!==this.quadrant&&(t.classList.remove(d[this.quadrant]),t.classList.add(d[this.orientationQuadrant]),this.quadrant=this.orientationQuadrant),this.adaptive!==this.isAdaptive&&(this.isAdaptive?t.classList.remove("sv-static-width"):(t.classList.add("sv-static-width"),t.truncated=!1,t.classList.remove("sv-short"),t.requestUpdate()),this.adaptive=this.isAdaptive),this.setVisible(!this.isBehindCamera(this.stemLine,i)&&this.annotation.data.visible),this.adaptive&&!this.isAnimating&&this.annotation.data.expanded){if(!t.truncated){if(!t.classList.contains("sv-expanded"))return void t.requestUpdate().then(()=>{this.originalHeight=t.offsetHeight,this.originalWidth=t.offsetWidth,this.checkTruncate(t,e)});this.originalHeight=t.offsetHeight,this.originalWidth=t.offsetWidth}this.checkTruncate(t,e)}}createHTMLElement(){return new m(this)}checkTruncate(t,e){const i=this.quadrant==h.ox.TopLeft||this.quadrant==h.ox.TopRight,n=this.quadrant==h.ox.TopRight||this.quadrant==h.ox.BottomRight,s=n?t.getBoundingClientRect().left-e.left:t.getBoundingClientRect().right-e.left,r=i?t.getBoundingClientRect().bottom-e.top:t.getBoundingClientRect().top-e.top,o=i?r-this.originalHeight<=0:r+this.originalHeight>=e.height,a=n?s+this.originalWidth>=e.width:s-this.originalWidth<=0,l=o||a;l!==t.truncated&&(t.truncated=l,l?t.classList.add("sv-short"):t.classList.remove("sv-short"),t.requestUpdate().then(()=>{}))}}g.typeName="Extended",c.A.registerType(g);let m=class extends l.sf{constructor(t){super(t),this.isExpanded=void 0,this.onClickTitle=this.onClickTitle.bind(this),this.onClickArticle=this.onClickArticle.bind(this),this.onClickAudio=this.onClickAudio.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyDownArticle=this.onKeyDownArticle.bind(this),this.onClickOverlay=this.onClickOverlay.bind(this),this.addEventListener("keydown",this.onKeyDown),this.titleElement=this.appendElement("div"),this.titleElement.classList.add("sv-title"),this.titleElement.addEventListener("click",this.onClickTitle),this.titleElement.setAttribute("tabindex","0"),this.wrapperElement=this.appendElement("div"),this.contentElement=this.createElement("div",null,this.wrapperElement),this.contentElement.classList.add("sv-annotation-body"),this.contentElement.style.display="none"}firstConnected(){super.firstConnected(),this.classList.add("sv-extended-annotation")}update(t){super.update(t);const e=this.sprite.annotation,i=this.sprite.annotation.data,n=this.sprite.audioManager,s=!this.overlayed&&this.truncated&&(i.imageUri||i.articleId||e.lead.length>0);this.titleElement.innerText=this.sprite.annotation.title;const r=o.qy`
        ${i.imageUri&&!s?o.qy`<div><img alt="${e.imageAltText}" src="${this.sprite.assetManager.getAssetUrl(i.imageUri)}">${e.imageCredit?o.qy`<div class="sv-img-credit">${e.imageCredit}</div>`:null}</div>`:null}
        ${s?null:o.qy`<p>${(0,a._)(e.lead)}</p>`}
        ${i.audioId&&!this.overlayed?o.qy`<div id="audio_container" @pointerdown=${this.onClickAudio}></div>`:null}
        ${i.articleId&&!s?o.qy`<ff-button inline id="read-more" text="Read more..." icon="document" @keydown=${this.onKeyDownArticle} @pointerdown=${this.onClickArticle}></ff-button>`:null}
        ${s?o.qy`<ff-button inline id="more-info" text="+more info" @pointerdown=${this.onClickOverlay} ></ff-button>`:null}`;if((0,o.XX)(r,this.contentElement),p.fromArray(i.color),this.style.borderColor=p.toString(),this.isExpanded&&(this.contentElement.style.height="auto"),this.isExpanded!==i.expanded&&!this.overlayed)if(this.isExpanded=i.expanded,this.isExpanded){if(i.audioId){const t=this.querySelector("#audio_container");t.firstChild&&t.removeChild(t.firstChild),t.append(n.getPlayerById(i.audioId))}this.classList.add("sv-expanded"),this.style.minWidth=this.sprite.annotation.lead.length<40&&(!i.audioId||0==i.audioId.length)?"0":"",this.contentElement.style.display="block",this.contentElement.style.height="auto"}else this.classList.remove("sv-expanded"),this.contentElement.style.height="0",this.contentElement.style.display="none",n.activeId==i.audioId&&this.sprite.audioManager.stop();const l=this.querySelector(".sv-audio-view");if(i.audioId&&!this.overlayed)if(i.expanded){const t=this.querySelector("#audio_container");l&&t.removeChild(l),t.append(n.getPlayerById(i.audioId))}else!i.expanded&&l&&n.activeId==i.audioId&&n.stop()}onClickTitle(t){t.stopPropagation(),this.sprite.emitClickEvent()}onClickArticle(t){t.stopPropagation(),this.sprite.emitLinkEvent(this.sprite.annotation.data.articleId)}onClickAudio(t){t.stopPropagation()}onClickOverlay(t){t.stopPropagation();const e=this.contentElement;this.overlayed=!0,this.showOverlay(e)}onKeyDown(t){if("Space"===t.code||"Enter"===t.code){"more-info"===t.target.id?this.onClickOverlay(t):this.sprite.emitClickEvent()}}onKeyDownArticle(t){if("Space"===t.code||"Enter"===t.code){"read-more"===t.target.id&&this.onClickArticle(t)}}};m=u([(0,o.EM)("sv-extended-annotation")],m)},8424:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>d,I8:()=>u});var n=i(4640),s=i(8337),r=i(3423),o=i(2799);const a=new n.Pq0,l=new n.Pq0,c=new n.PTz,h=new n.O9p;var u;!function(t){t[t.XYZ=0]="XYZ",t[t.YZX=1]="YZX",t[t.ZXY=2]="ZXY",t[t.XZY=3]="XZY",t[t.YXZ=4]="YXZ",t[t.ZYX=5]="ZYX"}(u||(u={}));class d extends o.A{constructor(t,e){super(t,e),this.ins=this.addInputs(d.transformIns),this.outs=this.addOutputs(d.transformOuts),this._object3D=this.createObject3D(),this._object3D.matrixAutoUpdate=!1}get transform(){return this}get object3D(){return this._object3D}get children(){return this._children||[]}get matrix(){return this._object3D.matrix}update(t){const e=this._object3D,{position:i,rotation:n,order:r,scale:o}=this.ins,{matrix:l}=this.outs;e.position.fromArray(i.value),a.fromArray(n.value).multiplyScalar(s.A.DEG2RAD);const c=r.getOptionText();return e.rotation.setFromVector3(a,c),e.scale.fromArray(o.value),e.updateMatrix(),e.matrix.toArray(l.value),l.set(),!0}dispose(){this._object3D&&(this._object3D.children.slice().forEach(t=>this._object3D.remove(t)),this._object3D.parent&&this._object3D.parent.remove(this._object3D)),super.dispose()}setPropertiesFromMatrix(t){const e=!t;t=t||this._object3D.matrix;const{position:i,rotation:n,order:r,scale:o}=this.ins;t.decompose(a,c,l),a.toArray(i.value);const u=r.getOptionText();h.setFromQuaternion(c,u),a.setFromEuler(h),a.multiplyScalar(s.A.RAD2DEG).toArray(n.value),l.toArray(o.value),i.set(e),n.set(e),o.set(e)}addChild(t){super.addChild(t),this._object3D.add(t._object3D)}removeChild(t){this._object3D.remove(t._object3D),super.removeChild(t)}createObject3D(){let t=new n.B69;return t.name="Transform",t}}d.typeName="CTransform",d.transformIns={position:r.gK.Vector3("Transform.Position"),rotation:r.gK.Vector3("Transform.Rotation"),order:r.gK.Enum("Transform.Order",u),scale:r.gK.Scale3("Transform.Scale")},d.transformOuts={matrix:r.gK.Matrix4("Transform.Matrix")}},8428:(t,e,i)=>{"use strict";var n=i(6763),s=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let r=class extends n.Ay{constructor(){super(...arguments),this.name="",this.index=0,this.text="",this.placeholder="",this.align="left",this.initialValue="",this.requestFocus=!1}get inputElement(){return this.getElementsByTagName("input").item(0)}focus(){this.requestFocus=!0,this.performUpdate()}hasFocus(){const t=document.activeElement.shadowRoot?document.activeElement.shadowRoot.activeElement:document.activeElement;return this.inputElement===t}firstConnected(){this.classList.add("ff-control","ff-line-edit")}shouldUpdate(t){return!this.hasFocus()&&super.shouldUpdate(t)}render(){return n.qy`<input
            type="text" .value=${this.text} placeholder=${this.placeholder}
            @keydown=${this.onKeyDown} @change=${this.onChange} @input=${this.onInput}
            @focus=${this.onFocus} @blur=${this.onBlur}
            style="box-sizing: border-box; width:100%; text-align: ${this.align};">`}updated(){this.requestFocus&&(this.requestFocus=!1,this.inputElement.focus())}onKeyDown(t){const e=t.target;"Enter"===t.key?(this.commit(e),e.blur()):"Escape"===t.key&&(this.revert(e),e.blur())}onChange(t){t.stopPropagation(),t.preventDefault(),this.text=t.target.value,this.dispatchChangeEvent(this.text,!1)}onInput(t){t.stopPropagation(),t.preventDefault(),this.text=t.target.value,this.dispatchChangeEvent(this.text,!0)}onFocus(t){this.initialValue=t.target.value,t.target.select()}onBlur(t){this.commit(t.target),this.requestUpdate()}revert(t){t.value=this.initialValue,this.dispatchChangeEvent(t.value,!1)}commit(t){this.initialValue=t.value,this.dispatchChangeEvent(t.value,!1)}dispatchChangeEvent(t,e){this.dispatchEvent(new CustomEvent("change",{detail:{text:t,isEditing:e}}))}};s([(0,n.MZ)({type:String})],r.prototype,"name",void 0),s([(0,n.MZ)({type:Number})],r.prototype,"index",void 0),s([(0,n.MZ)({type:String})],r.prototype,"text",void 0),s([(0,n.MZ)({type:String})],r.prototype,"placeholder",void 0),s([(0,n.MZ)({type:String})],r.prototype,"align",void 0),r=s([(0,n.EM)("ff-line-edit")],r)},8446:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var n=i(3331),s=i(449);class r extends n.A{static generateId(){return(0,s.A)()}constructor(t){super(),this.addEvents("update","dispose"),t?this.fromJSON(t):this._data=this.init()}get id(){return this._data.id}get data(){return this._data}set(t,e){this._data[t]=e,this.update()}get(t){return this._data[t]}update(){this.emit({type:"update",document:this})}dispose(){this.emit({type:"dispose",document:this}),this._data=null}fromJSON(t){return this._data={},this.inflate(t,this._data),this.update(),this}toJSON(t){return t=t||{},this.deflate(this._data,t),t}init(){return{}}inflate(t,e){Object.assign(e,t)}deflate(t,e){e=e||{},Object.assign(e,this._data)}}},8466:t=>{"use strict";t.exports=JSON.parse('{"asset":{"type":"application/si-dpo-3d.document+json","version":"2.0","generator":"Voyager"},"scene":0,"scenes":[{"nodes":[0,1],"setup":0}],"nodes":[{"translation":[0,0,15],"camera":0},{"name":"Lights","children":[2,3,4]},{"translation":[0,0,2],"rotation":[0.4829741,-0.1070728,0.1880998,0.8484633],"scale":[1,1,1],"name":"Shadow Caster #1","light":0},{"rotation":[0.3546969,0.163893,-0.3861077,0.8356136],"scale":[1,1,1],"name":"Shadow Caster #2","light":1},{"name":"Environment","light":2}],"setups":[{"units":"cm","interface":{"visible":true,"logo":true,"menu":true,"tools":true},"viewer":{"shader":"Default","toneMapping":true,"exposure":1,"gamma":2,"annotationsVisible":false},"reader":{"enabled":false,"position":"Overlay"},"navigation":{"type":"Orbit","enabled":true,"autoZoom":true,"lightsFollowCamera":true,"autoRotation":false,"orbit":{"orbit":[-24,-26,0],"offset":[0,0,150],"minOrbit":[-90,null,null],"maxOrbit":[90,null,null],"minOffset":[null,null,0.1],"maxOffset":[null,null,10000]}},"background":{"style":"RadialGradient","color0":[0.2,0.25,0.3],"color1":[0.01,0.03,0.05]},"floor":{"visible":false,"position":[0,-25,0],"size":50,"color":[0.6,0.75,0.8],"opacity":0.5,"receiveShadow":false},"grid":{"visible":false,"color":[0.5,0.7,0.8]},"tape":{"enabled":false,"startPosition":[0,0,0],"startDirection":[0,0,0],"endPosition":[0,0,0],"endDirection":[0,0,0]},"slicer":{"enabled":false,"axis":"X","inverted":false,"position":0.5}}],"cameras":[{"type":"perspective","perspective":{"yfov":52,"znear":0.1,"zfar":100000}}],"lights":[{"enabled":false,"color":[1,0.95,0.9],"intensity":0.01,"type":"directional","shadowEnabled":true,"shadowIntensity":50},{"enabled":false,"color":[0.9,0.95,1],"intensity":0.01,"type":"directional","shadowEnabled":true,"shadowIntensity":60},{"enabled":true,"intensity":1,"type":"environment"}]}')},8495:(t,e,i)=>{"use strict";let n=i(1024),s=i(9623),r=i(8290),o=i(6216),a=i(7114),l=i(6257);const c={empty:!0,space:!0};t.exports=class{constructor(t){this.input=t,this.root=new o,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:t,start:{column:1,line:1,offset:0}}}atrule(t){let e,i,s,r=new n;r.name=t[1].slice(1),""===r.name&&this.unnamedAtrule(r,t),this.init(r,t[2]);let o=!1,a=!1,l=[],c=[];for(;!this.tokenizer.endOfFile();){if(e=(t=this.tokenizer.nextToken())[0],"("===e||"["===e?c.push("("===e?")":"]"):"{"===e&&c.length>0?c.push("}"):e===c[c.length-1]&&c.pop(),0===c.length){if(";"===e){r.source.end=this.getPosition(t[2]),r.source.end.offset++,this.semicolon=!0;break}if("{"===e){a=!0;break}if("}"===e){if(l.length>0){for(s=l.length-1,i=l[s];i&&"space"===i[0];)i=l[--s];i&&(r.source.end=this.getPosition(i[3]||i[2]),r.source.end.offset++)}this.end(t);break}l.push(t)}else l.push(t);if(this.tokenizer.endOfFile()){o=!0;break}}r.raws.between=this.spacesAndCommentsFromEnd(l),l.length?(r.raws.afterName=this.spacesAndCommentsFromStart(l),this.raw(r,"params",l),o&&(t=l[l.length-1],r.source.end=this.getPosition(t[3]||t[2]),r.source.end.offset++,this.spaces=r.raws.between,r.raws.between="")):(r.raws.afterName="",r.params=""),a&&(r.nodes=[],this.current=r)}checkMissedSemicolon(t){let e=this.colon(t);if(!1===e)return;let i,n=0;for(let s=e-1;s>=0&&(i=t[s],"space"===i[0]||(n+=1,2!==n));s--);throw this.input.error("Missed semicolon","word"===i[0]?i[3]+1:i[2])}colon(t){let e,i,n,s=0;for(let[r,o]of t.entries()){if(i=o,n=i[0],"("===n&&(s+=1),")"===n&&(s-=1),0===s&&":"===n){if(e){if("word"===e[0]&&"progid"===e[1])continue;return r}this.doubleColon(i)}e=i}return!1}comment(t){let e=new s;this.init(e,t[2]),e.source.end=this.getPosition(t[3]||t[2]),e.source.end.offset++;let i=t[1].slice(2,-2);if(/^\s*$/.test(i))e.text="",e.raws.left=i,e.raws.right="";else{let t=i.match(/^(\s*)([^]*\S)(\s*)$/);e.text=t[2],e.raws.left=t[1],e.raws.right=t[3]}}createTokenizer(){this.tokenizer=l(this.input)}decl(t,e){let i=new r;this.init(i,t[0][2]);let n,s=t[t.length-1];for(";"===s[0]&&(this.semicolon=!0,t.pop()),i.source.end=this.getPosition(s[3]||s[2]||function(t){for(let e=t.length-1;e>=0;e--){let i=t[e],n=i[3]||i[2];if(n)return n}}(t)),i.source.end.offset++;"word"!==t[0][0];)1===t.length&&this.unknownWord(t),i.raws.before+=t.shift()[1];for(i.source.start=this.getPosition(t[0][2]),i.prop="";t.length;){let e=t[0][0];if(":"===e||"space"===e||"comment"===e)break;i.prop+=t.shift()[1]}for(i.raws.between="";t.length;){if(n=t.shift(),":"===n[0]){i.raws.between+=n[1];break}"word"===n[0]&&/\w/.test(n[1])&&this.unknownWord([n]),i.raws.between+=n[1]}"_"!==i.prop[0]&&"*"!==i.prop[0]||(i.raws.before+=i.prop[0],i.prop=i.prop.slice(1));let o,a=[];for(;t.length&&(o=t[0][0],"space"===o||"comment"===o);)a.push(t.shift());this.precheckMissedSemicolon(t);for(let e=t.length-1;e>=0;e--){if(n=t[e],"!important"===n[1].toLowerCase()){i.important=!0;let n=this.stringFrom(t,e);n=this.spacesFromEnd(t)+n," !important"!==n&&(i.raws.important=n);break}if("important"===n[1].toLowerCase()){let n=t.slice(0),s="";for(let t=e;t>0;t--){let e=n[t][0];if(s.trim().startsWith("!")&&"space"!==e)break;s=n.pop()[1]+s}s.trim().startsWith("!")&&(i.important=!0,i.raws.important=s,t=n)}if("space"!==n[0]&&"comment"!==n[0])break}t.some(t=>"space"!==t[0]&&"comment"!==t[0])&&(i.raws.between+=a.map(t=>t[1]).join(""),a=[]),this.raw(i,"value",a.concat(t),e),i.value.includes(":")&&!e&&this.checkMissedSemicolon(t)}doubleColon(t){throw this.input.error("Double colon",{offset:t[2]},{offset:t[2]+t[1].length})}emptyRule(t){let e=new a;this.init(e,t[2]),e.selector="",e.raws.between="",this.current=e}end(t){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(t[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(t)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(t){if(this.spaces+=t[1],this.current.nodes){let e=this.current.nodes[this.current.nodes.length-1];e&&"rule"===e.type&&!e.raws.ownSemicolon&&(e.raws.ownSemicolon=this.spaces,this.spaces="",e.source.end=this.getPosition(t[2]),e.source.end.offset+=e.raws.ownSemicolon.length)}}getPosition(t){let e=this.input.fromOffset(t);return{column:e.col,line:e.line,offset:t}}init(t,e){this.current.push(t),t.source={input:this.input,start:this.getPosition(e)},t.raws.before=this.spaces,this.spaces="","comment"!==t.type&&(this.semicolon=!1)}other(t){let e=!1,i=null,n=!1,s=null,r=[],o=t[1].startsWith("--"),a=[],l=t;for(;l;){if(i=l[0],a.push(l),"("===i||"["===i)s||(s=l),r.push("("===i?")":"]");else if(o&&n&&"{"===i)s||(s=l),r.push("}");else if(0===r.length){if(";"===i){if(n)return void this.decl(a,o);break}if("{"===i)return void this.rule(a);if("}"===i){this.tokenizer.back(a.pop()),e=!0;break}":"===i&&(n=!0)}else i===r[r.length-1]&&(r.pop(),0===r.length&&(s=null));l=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(e=!0),r.length>0&&this.unclosedBracket(s),e&&n){if(!o)for(;a.length&&(l=a[a.length-1][0],"space"===l||"comment"===l);)this.tokenizer.back(a.pop());this.decl(a,o)}else this.unknownWord(a)}parse(){let t;for(;!this.tokenizer.endOfFile();)switch(t=this.tokenizer.nextToken(),t[0]){case"space":this.spaces+=t[1];break;case";":this.freeSemicolon(t);break;case"}":this.end(t);break;case"comment":this.comment(t);break;case"at-word":this.atrule(t);break;case"{":this.emptyRule(t);break;default:this.other(t)}this.endFile()}precheckMissedSemicolon(){}raw(t,e,i,n){let s,r,o,a,l=i.length,h="",u=!0;for(let t=0;t<l;t+=1)s=i[t],r=s[0],"space"!==r||t!==l-1||n?"comment"===r?(a=i[t-1]?i[t-1][0]:"empty",o=i[t+1]?i[t+1][0]:"empty",c[a]||c[o]||","===h.slice(-1)?u=!1:h+=s[1]):h+=s[1]:u=!1;if(!u){let n=i.reduce((t,e)=>t+e[1],"");t.raws[e]={raw:n,value:h}}t[e]=h}rule(t){t.pop();let e=new a;this.init(e,t[0][2]),e.raws.between=this.spacesAndCommentsFromEnd(t),this.raw(e,"selector",t),this.current=e}spacesAndCommentsFromEnd(t){let e,i="";for(;t.length&&(e=t[t.length-1][0],"space"===e||"comment"===e);)i=t.pop()[1]+i;return i}spacesAndCommentsFromStart(t){let e,i="";for(;t.length&&(e=t[0][0],"space"===e||"comment"===e);)i+=t.shift()[1];return i}spacesFromEnd(t){let e,i="";for(;t.length&&(e=t[t.length-1][0],"space"===e);)i=t.pop()[1]+i;return i}stringFrom(t,e){let i="";for(let n=e;n<t.length;n++)i+=t[n][1];return t.splice(e,t.length-e),i}unclosedBlock(){let t=this.current.source.start;throw this.input.error("Unclosed block",t.line,t.column)}unclosedBracket(t){throw this.input.error("Unclosed bracket",{offset:t[2]},{offset:t[2]+1})}unexpectedClose(t){throw this.input.error("Unexpected }",{offset:t[2]},{offset:t[2]+1})}unknownWord(t){throw this.input.error("Unknown word "+t[0][1],{offset:t[0][2]},{offset:t[0][2]+t[0][1].length})}unnamedAtrule(t,e){throw this.input.error("At-rule without name",{offset:e[2]},{offset:e[2]+e[1].length})}}},8541:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateAdditionalItems=void 0;const n=i(5265),s=i(3151),r={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:t}})=>n.str`must NOT have more than ${t} items`,params:({params:{len:t}})=>n._`{limit: ${t}}`},code(t){const{parentSchema:e,it:i}=t,{items:n}=e;Array.isArray(n)?o(t,n):(0,s.checkStrictMode)(i,'"additionalItems" is ignored when "items" is not an array of schemas')}};function o(t,e){const{gen:i,schema:r,data:o,keyword:a,it:l}=t;l.items=!0;const c=i.const("len",n._`${o}.length`);if(!1===r)t.setParams({len:e.length}),t.pass(n._`${c} <= ${e.length}`);else if("object"==typeof r&&!(0,s.alwaysValidSchema)(l,r)){const r=i.var("valid",n._`${c} <= ${e.length}`);i.if((0,n.not)(r),()=>function(r){i.forRange("i",e.length,c,e=>{t.subschema({keyword:a,dataProp:e,dataPropType:s.Type.Num},r),l.allErrors||i.if((0,n.not)(r),()=>i.break())})}(r)),t.ok(r)}}e.validateAdditionalItems=o,e.default=r},8569:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(6241),s=i(5265),r=i(3151),o=i(3151),a={keyword:"patternProperties",type:"object",schemaType:"object",code(t){const{gen:e,schema:i,data:a,parentSchema:l,it:c}=t,{opts:h}=c,u=(0,n.allSchemaProperties)(i),d=u.filter(t=>(0,r.alwaysValidSchema)(c,i[t]));if(0===u.length||d.length===u.length&&(!c.opts.unevaluated||!0===c.props))return;const p=h.strictSchema&&!h.allowMatchingProperties&&l.properties,f=e.name("valid");!0===c.props||c.props instanceof s.Name||(c.props=(0,o.evaluatedPropsToName)(e,c.props));const{props:g}=c;function m(t){for(const e in p)new RegExp(t).test(e)&&(0,r.checkStrictMode)(c,`property ${e} matches pattern ${t} (use allowMatchingProperties)`)}function A(i){e.forIn("key",a,r=>{e.if(s._`${(0,n.usePattern)(t,i)}.test(${r})`,()=>{const n=d.includes(i);n||t.subschema({keyword:"patternProperties",schemaProp:i,dataProp:r,dataPropType:o.Type.Str},f),c.opts.unevaluated&&!0!==g?e.assign(s._`${g}[${r}]`,!0):n||c.allErrors||e.if((0,s.not)(f),()=>e.break())})})}!function(){for(const t of u)p&&m(t),c.allErrors?A(t):(e.var(f,!0),A(t),e.if(f))}()}};e.default=a},8570:(t,e,i)=>{var n=i(7264),s=i(7748),r=Object.hasOwnProperty,o=Object.create(null);for(var a in n)r.call(n,a)&&(o[n[a]]=a);var l=t.exports={to:{},get:{}};function c(t,e,i){return Math.min(Math.max(e,t),i)}function h(t){var e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}l.get=function(t){var e,i;switch(t.substring(0,3).toLowerCase()){case"hsl":e=l.get.hsl(t),i="hsl";break;case"hwb":e=l.get.hwb(t),i="hwb";break;default:e=l.get.rgb(t),i="rgb"}return e?{model:i,value:e}:null},l.get.rgb=function(t){if(!t)return null;var e,i,s,o=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(s=e[2],e=e[1],i=0;i<3;i++){var a=2*i;o[i]=parseInt(e.slice(a,a+2),16)}s&&(o[3]=parseInt(s,16)/255)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(s=(e=e[1])[3],i=0;i<3;i++)o[i]=parseInt(e[i]+e[i],16);s&&(o[3]=parseInt(s+s,16)/255)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(i=0;i<3;i++)o[i]=parseInt(e[i+1],0);e[4]&&(e[5]?o[3]=.01*parseFloat(e[4]):o[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(e=t.match(/^(\w+)$/))?"transparent"===e[1]?[0,0,0,0]:r.call(n,e[1])?((o=n[e[1]])[3]=1,o):null:null;for(i=0;i<3;i++)o[i]=Math.round(2.55*parseFloat(e[i+1]));e[4]&&(e[5]?o[3]=.01*parseFloat(e[4]):o[3]=parseFloat(e[4]))}for(i=0;i<3;i++)o[i]=c(o[i],0,255);return o[3]=c(o[3],0,1),o},l.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var i=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,c(parseFloat(e[2]),0,100),c(parseFloat(e[3]),0,100),c(isNaN(i)?1:i,0,1)]}return null},l.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var i=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,c(parseFloat(e[2]),0,100),c(parseFloat(e[3]),0,100),c(isNaN(i)?1:i,0,1)]}return null},l.to.hex=function(){var t=s(arguments);return"#"+h(t[0])+h(t[1])+h(t[2])+(t[3]<1?h(Math.round(255*t[3])):"")},l.to.rgb=function(){var t=s(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},l.to.rgb.percent=function(){var t=s(arguments),e=Math.round(t[0]/255*100),i=Math.round(t[1]/255*100),n=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+i+"%, "+n+"%)":"rgba("+e+"%, "+i+"%, "+n+"%, "+t[3]+")"},l.to.hsl=function(){var t=s(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},l.to.hwb=function(){var t=s(arguments),e="";return t.length>=4&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},l.to.keyword=function(t){return o[t.slice(0,3)]}},8604:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var n=i(3423);class s extends n.Ay{constructor(){super(...arguments),this._title="Untitled",this._timerStart=0}startTimer(){0===this._timerStart&&(this._timerStart=Date.now())}resetTimer(){this._timerStart=0}getTimerTime(){return this._timerStart>0?Date.now()-this._timerStart:0}setTitle(t){this._title=t}sendProperty(t,e){if("function"==typeof gtag){const i=void 0!==e?e.toString():"undefined";gtag("event",t.toLowerCase(),{scene_title:this._title,event_value:i})}}}s.typeName="CVAnalytics",s.text="Analytics",s.icon="",s.isSystemSingleton=!0},8645:()=>{},8722:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var n=i(4640),s=i(8337);const r=new n.IUQ,o=(new n.IUQ,new n.Pq0),a=new n.Pq0,l=new n.kn4,c=new n.O9p,h=new n.PTz,u={PI:3.141592653589793,DOUBLE_PI:6.283185307179586,HALF_PI:1.5707963267948966,QUARTER_PI:.7853981633974483,DEG2RAD:.017453292519943295,RAD2DEG:57.29577951308232,composeOrbitMatrix:function(t,e,i){const s=t.x,r=t.y,o=t.z,a=e.x,l=e.y,c=e.z,h=Math.sin(s),u=Math.cos(s),d=Math.sin(r),p=Math.cos(r),f=Math.sin(o),g=Math.cos(o),m=p*g,A=g*d*h-f*u,v=g*d*u+f*h,y=p*f,b=h*d*f+g*u,_=f*d*u-g*h,x=-d,w=p*h,E=p*u,C=(i=i||new n.kn4).elements;return C[0]=m,C[1]=y,C[2]=x,C[3]=0,C[4]=A,C[5]=b,C[6]=w,C[7]=0,C[8]=v,C[9]=_,C[10]=E,C[11]=0,C[12]=a*m+l*A+c*v,C[13]=a*y+l*b+c*_,C[14]=a*x+l*w+c*E,C[15]=1,i},decomposeOrbitMatrix:function(t,e,i){c.setFromRotationMatrix(t,"ZYX"),e.setFromEuler(c),l.copy(t).invert(),r.set(0,0,0,1),r.applyMatrix4(l),i.x=-r.x,i.y=-r.y,i.z=-r.z},isMatrix4Identity:function(t){const e=t.elements;return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]},decomposeTransformMatrix:function(t,e,i,n){l.fromArray(t),l.decompose(o,h,a),c.setFromQuaternion(h,"XYZ"),o.toArray(e),a.toArray(n),o.setFromEuler(c),r.multiplyScalar(s.A.RAD2DEG),o.toArray(i)}}},8738:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var n=i(8337),s=i(6763),r=i(7280),o=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let a=class extends s.Ay{constructor(){super(),this.direction="horizontal",this.value=0,this._isVertical=!1,this._offsetX=0,this._offsetY=0,this._knob=(new s.Ay).addClass("ff-knob").setStyle({display:"block",position:"relative "}),new r.A(this)}dragStart(t){const e=this._knob,i=this.getBoundingClientRect();t.target===this._knob?(this._offsetX=t.clientX-e.offsetLeft+.5*(e.clientWidth-e.offsetWidth),this._offsetY=t.clientY-e.offsetTop+.5*(e.clientHeight-e.offsetHeight)):(this._offsetX=i.left+.8*e.clientWidth,this._offsetY=i.top+.8*e.clientHeight),this.dragMove(t)}dragMove(t){const e=this._knob,i=t.clientX-this._offsetX,s=t.clientY-this._offsetY;let r=this._isVertical?1-s/(this.clientHeight-e.clientHeight):i/(this.clientWidth-e.clientWidth);r=n.A.limit(r,0,1),r!==this.value&&(this.value=r,this.emitChangeEvent(!0))}dragEnd(){this.emitChangeEvent(!1)}firstConnected(){this.setStyle({position:"relative",touchAction:"none"}),this.setAttribute("touch-action","none"),this.setAttribute("tabindex","0"),this.classList.add("ff-control","ff-linear-slider"),this.appendChild(this._knob)}update(t){if(t.has("direction")&&(this._isVertical="vertical"===this.direction,this.setClass("ff-horizontal",!this._isVertical),this.setClass("ff-vertical",this._isVertical)),t.has("value")){const t=n.A.limit(this.value,0,1),e=this._isVertical?0:100*t,i=this._isVertical?100*(1-t):0;this._knob.style.left=`${e.toFixed(3)}%`,this._knob.style.top=`${i.toFixed(3)}%`}super.update(t)}emitChangeEvent(t){this.dispatchEvent(new CustomEvent("change",{detail:{value:this.value,isDragging:t},bubbles:!0}))}};o([(0,s.MZ)({type:String})],a.prototype,"direction",void 0),o([(0,s.MZ)({type:Number})],a.prototype,"value",void 0),a=o([(0,s.EM)("ff-linear-slider")],a);const l=a},8759:(t,e,i)=>{"use strict";let n=i(7616),s=i(8093);const r=i(7129);let o=i(8227);i(4376);class a{get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let t,e=s;try{t=e(this._css,this._opts)}catch(t){this.error=t}if(this.error)throw this.error;return this._root=t,t}get[Symbol.toStringTag](){return"NoWorkResult"}constructor(t,e,i){let s;e=e.toString(),this.stringified=!1,this._processor=t,this._css=e,this._opts=i,this._map=void 0;let a=o;this.result=new r(this._processor,s,this._opts),this.result.css=e;let l=this;Object.defineProperty(this.result,"root",{get:()=>l.root});let c=new n(a,s,this._opts,e);if(c.isMap()){let[t,e]=c.generate();t&&(this.result.css=t),e&&(this.result.map=e)}else c.clearAnnotation(),this.result.css=c.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(t){return this.async().catch(t)}finally(t){return this.async().then(t,t)}sync(){if(this.error)throw this.error;return this.result}then(t,e){return this.async().then(t,e)}toString(){return this._css}warnings(){return[]}}t.exports=a,a.default=a},8892:()=>{},8948:(t,e,i)=>{"use strict";i.d(e,{AZ:()=>f,Ay:()=>p,ox:()=>d});var n=i(4640),s=i(6763),r=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};const o=new n.Pq0,a=new n.Pq0,l=new n.Pq0,c=new n.Pq0,h=new n.I9Y,u=new n.I9Y;var d;!function(t){t[t.TopRight=0]="TopRight",t[t.TopLeft=1]="TopLeft",t[t.BottomLeft=2]="BottomLeft",t[t.BottomRight=3]="BottomRight"}(d||(d={}));class p extends n.B69{constructor(){super(),this.isHTMLSprite=!0,this.viewAngle=0,this.orientationAngle=0,this.orientationQuadrant=d.TopLeft,this._elements=new Map,this._visible=!0,this.frustumCulled=!1}getVisible(){return this._visible}setVisible(t){t!==this._visible&&this._elements&&(this._visible=t,this._elements.forEach(e=>{e&&e.setVisible(t)}))}dispose(){this._elements.forEach((t,e)=>{t&&e.removeChild(t)}),this._elements.clear()}disposeHTMLElement(t){const e=this._elements.get(t);e&&(this._elements.delete(t),t.removeChild(e))}update(){this._elements.forEach(t=>{t&&this.updateHTMLElement(t)})}renderHTMLElement(t,e,i,n,s){n=n||this,o.set(0,0,0),o.applyMatrix4(n.modelViewMatrix),s?a.copy(s):a.set(0,1,0),a.applyMatrix4(n.modelViewMatrix),l.copy(a).sub(o).normalize(),c.set(0,0,1),this.viewAngle=l.angleTo(c),o.applyMatrix4(i.projectionMatrix),a.applyMatrix4(i.projectionMatrix),u.set(a.x,a.y),h.set(o.x,o.y),u.sub(h);const r=.5*(a.x+1)*e.width,d=.5*(1-a.y)*e.height;t.setPosition(r,d);const p=this.orientationAngle=u.angle();this.orientationQuadrant=Math.floor(2*p/Math.PI)}getHTMLElement(t){let e=this._elements.get(t);return e||(e=this.createHTMLElement(),e&&(e.setVisible(this._visible),t.appendChild(e),this._elements.set(t,e))),e}createHTMLElement(){return null}updateHTMLElement(t){t.requestUpdate()}}let f=class extends s.Ay{setVisible(t){this.style.display=t?"block":"none"}setOpacity(t){this.style.opacity=t.toString(),this.style.pointerEvents=t>0?"auto":"none"}setPosition(t,e){this.style.left=t.toString()+"px",this.style.top=e.toString()+"px"}};f=r([(0,s.EM)("ff-sprite-element")],f)},9038:function(t,e){var i,n,s;n=[],void 0===(s="function"==typeof(i=function(){return function(t){function e(t){return" "===t||"\t"===t||"\n"===t||"\f"===t||"\r"===t}function i(e){var i,n=e.exec(t.substring(g));if(n)return i=n[0],g+=i.length,i}for(var n,s,r,o,a,l=t.length,c=/^[ \t\n\r\u000c]+/,h=/^[, \t\n\r\u000c]+/,u=/^[^ \t\n\r\u000c]+/,d=/[,]+$/,p=/^\d+$/,f=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,g=0,m=[];;){if(i(h),g>=l)return m;n=i(u),s=[],","===n.slice(-1)?(n=n.replace(d,""),v()):A()}function A(){for(i(c),r="",o="in descriptor";;){if(a=t.charAt(g),"in descriptor"===o)if(e(a))r&&(s.push(r),r="",o="after descriptor");else{if(","===a)return g+=1,r&&s.push(r),void v();if("("===a)r+=a,o="in parens";else{if(""===a)return r&&s.push(r),void v();r+=a}}else if("in parens"===o)if(")"===a)r+=a,o="in descriptor";else{if(""===a)return s.push(r),void v();r+=a}else if("after descriptor"===o)if(e(a));else{if(""===a)return void v();o="in descriptor",g-=1}g+=1}}function v(){var e,i,r,o,a,l,c,h,u,d=!1,g={};for(o=0;o<s.length;o++)l=(a=s[o])[a.length-1],c=a.substring(0,a.length-1),h=parseInt(c,10),u=parseFloat(c),p.test(c)&&"w"===l?((e||i)&&(d=!0),0===h?d=!0:e=h):f.test(c)&&"x"===l?((e||i||r)&&(d=!0),u<0?d=!0:i=u):p.test(c)&&"h"===l?((r||i)&&(d=!0),0===h?d=!0:r=h):d=!0;d?console&&console.log&&console.log("Invalid srcset descriptor found in '"+t+"' at '"+a+"'."):(g.url=n,e&&(g.w=e),i&&(g.d=i),r&&(g.h=r),m.push(g))}}})?i.apply(e,n):i)||(t.exports=s)},9052:(t,e,i)=>{var n=i(1741),s=i(2143),r=i(1274),o=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":o&&o in Object(t)?s(t):r(t)}},9085:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var n=i(3331),s=i(3627),r=i(5624),o=i(3423),a=i(1860),l=i(7350);class c extends n.A{constructor(t){super({knownEvents:!1}),this.nodes=new s.A(a.A),this.components=new s.A(o.Ay),this.registry=t||new r.A,this.graph=new l.A(this,null),this.graph.activate()}getComponent(t,e=!1){return this.components.get(t,e)}getComponents(t){return this.components.getArray(t)}getComponentsByTag(t){return this.components.getByTag(t)}hasComponents(t){return this.components.has(t)}getMainComponent(t,e=!1){return this.graph.components.get(t,e)}getMainComponents(t){return this.graph.components.getArray(t)}getMainComponentsByTag(t){return this.graph.components.getByTag(t)}hasMainComponents(t){return this.graph.components.has(t)}getNode(t,e=!1){return this.nodes.get(t,e)}getNodes(t){return this.nodes.getArray(t)}getNodesByTag(t){return this.nodes.getByTag(t)}hasNodes(t){return this.nodes.has(t)}getMainNode(t,e=!1){return this.graph.nodes.get(t,e)}getMainNodes(t){return this.graph.nodes.getArray(t)}getMainNodesByTag(t){return this.graph.nodes.getByTag(t)}hasMainNodes(t){return this.graph.nodes.has(t)}findNodeByName(t,e){const i=this.nodes.getArray(e);for(let e=0,n=i.length;e<n;++e)if(i[e].name===t)return i[e]}toJSON(){return this.graph.toJSON()}fromJSON(t){this.graph.clear(),this.graph.fromJSON(t)}toString(t=!1){const e=this.nodes.getArray(),i=this.components.count(),n=`System - ${e.length} nodes, ${i} components.`;return t?n+"\n"+e.map(t=>t.toString(!0)).join("\n"):n}_addNode(t){this.nodes.add(t)}_removeNode(t){this.nodes.remove(t)}_addNodeTag(t,e){this.nodes.addByTag(t,e)}_removeNodeTag(t,e){this.nodes.removeByTag(t,e)}_addComponent(t){if(t.isSystemSingleton&&this.components.has(t))throw new Error(`only one component of type '${t.typeName}' allowed per system`);this.components.add(t)}_removeComponent(t){this.components.remove(t)}_addComponentTag(t,e){this.components.addByTag(t,e)}_removeComponentTag(t,e){this.components.removeByTag(t,e)}}},9163:(t,e,i)=>{"use strict";i.d(e,{A:()=>g,d:()=>d});var n=i(4640),s=i(8337),r=i(8722);const o=new n.kn4,a=new n.NRn,l=new n.Pq0,c=new n.Pq0,h=new n.PTz,u=new n.O9p;var d,p,f;!function(t){t[t.Orbit=0]="Orbit",t[t.Fly=1]="Fly",t[t.Walk=2]="Walk"}(d||(d={})),function(t){t[t.Off=0]="Off",t[t.Pan=1]="Pan",t[t.Orbit=2]="Orbit",t[t.Dolly=3]="Dolly",t[t.Zoom=4]="Zoom",t[t.PanDolly=5]="PanDolly",t[t.Roll=6]="Roll"}(p||(p={})),function(t){t[t.Off=0]="Off",t[t.Active=1]="Active",t[t.Release=2]="Release"}(f||(f={}));class g{constructor(t){this.orbit=new n.Pq0(0,0,0),this.offset=new n.Pq0(0,0,50),this.minOrbit=new n.Pq0(-90,-1/0,-1/0),this.maxOrbit=new n.Pq0(90,1/0,1/0),this.minOffset=new n.Pq0(-1/0,-1/0,.1),this.maxOffset=new n.Pq0(1/0,1/0,1e3),this.boundsRadius=0,this.orientationEnabled=!0,this.offsetEnabled=!0,this.controllerMode=d.Orbit,this.mode=p.Off,this.phase=f.Off,this.prevPinchDist=0,this.prevOffset=new n.Pq0(0,0,0),this.prevOrbit=new n.Pq0(0,0,0),this.deltaX=0,this.deltaY=0,this.deltaPinch=0,this.deltaWheel=0,this.viewportWidth=100,this.viewportHeight=100,this.camera=t}onPointer(t){if(t.isPrimary)if("pointer-down"===t.type)this.phase=f.Active;else if("pointer-up"===t.type)return this.phase=f.Release,!0;"pointer-down"===t.type&&(this.mode=this.getModeFromEvent(t));if(this.deltaX+=1*t.movementX,this.deltaY+=1*t.movementY,2===t.pointerCount){const e=t.activePositions,i=e[1].clientX-e[0].clientX,n=e[1].clientY-e[0].clientY,s=Math.sqrt(i*i+n*n),r=this.prevPinchDist||s;this.deltaPinch*=r>0?s/r:1,this.prevPinchDist=s}else this.deltaPinch=1,this.prevPinchDist=0;return!0}onTrigger(t){return"wheel"===t.type&&(this.deltaWheel+=s.A.limit(t.wheel,-1,1),!0)}onKeypress(t){const e=this.controllerMode==d.Orbit;if("ArrowUp"===t.key||"ArrowDown"===t.key){const i="ArrowUp"===t.key?-1:1;return this.deltaY=i*(e?20:6),this.mode=t.shiftKey?p.Pan:e?t.ctrlKey?p.Dolly:p.Orbit:t.ctrlKey?p.Orbit:p.Dolly,!0}if("ArrowLeft"===t.key||"ArrowRight"===t.key){const i="ArrowLeft"===t.key?-1:1;return this.deltaX=i*(e?20:6),this.mode=t.shiftKey?p.Pan:p.Orbit,!0}return!1}setViewportSize(t,e){this.viewportWidth=t,this.viewportHeight=e}updateController(t,e){const i=this.camera;t=t||i;const n=this.orbit,s=this.offset;r.A.decomposeOrbitMatrix(t.matrix,n,s),this.orbit.multiplyScalar(r.A.RAD2DEG),e&&(this.minOffset.min(s),this.maxOffset.max(s))}zoomExtents(t){if(this.controllerMode!=d.Orbit)return;const e=this.camera,i=this.offset;if(!e)return void console.warn("CameraController.zoomExtents - camera not set");l.copy(this.orbit).multiplyScalar(s.A.DEG2RAD),c.setScalar(0),r.A.composeOrbitMatrix(l,c,o),a.copy(t).applyMatrix4(o.transpose()),a.getSize(l),a.getCenter(c),i.x=c.x,i.y=c.y;const n=Math.max(l.x/e.aspect,l.y);if(e.isOrthographicCamera)i.z=1.1*n;else{const t=1/(2*Math.tan(e.fov*s.A.DEG2RAD*.5));i.z=c.z+n*t+.25*l.z}i.z>this.maxOffset.z&&(this.maxOffset.z=2*i.length())}updateCamera(t,e){const i=this.camera;return t=t||i,!(!this.update()&&!e)&&(l.copy(this.orbit).multiplyScalar(s.A.DEG2RAD),c.copy(this.offset),i.isOrthographicCamera&&(c.z=this.maxOffset.z,i.size=this.offset.z,i.far=2*this.maxOffset.z,i.updateProjectionMatrix()),r.A.composeOrbitMatrix(l,c,t.matrix),t.matrixWorldNeedsUpdate=!0,!0)}update(){const t=this.controllerMode==d.Orbit;if(this.phase===f.Off&&0===this.deltaWheel&&0===this.deltaX&&0===this.deltaY)return!1;if(0!==this.deltaWheel)return this.updatePose(0,0,t?.07*this.deltaWheel+1:this.deltaWheel,0,0,0),this.deltaWheel=0,!0;if(this.phase===f.Active)return(0!==this.deltaX||0!==this.deltaY||1!==this.deltaPinch)&&(this.updateByMode(),this.deltaX=0,this.deltaY=0,this.deltaPinch=1,!0);if(this.phase===f.Release){this.deltaX*=.85,this.deltaY*=.85,this.deltaPinch=1,this.updateByMode();return Math.abs(this.deltaX)+Math.abs(this.deltaY)<.1&&(this.mode=p.Off,this.phase=f.Off),!0}return(0!==this.deltaX||0!==this.deltaY)&&(this.updateByMode(),this.deltaX=0,this.deltaY=0,this.mode=p.Off,!0)}updateByMode(){const t=this.controllerMode==d.Orbit,e=t?1:0;switch(this.mode){case p.Orbit:this.updatePose(0,0,e,this.deltaY,this.deltaX,0);break;case p.Pan:this.updatePose(this.deltaX,this.deltaY,e,0,0,0);break;case p.Roll:this.updatePose(0,0,e,0,0,this.deltaX);break;case p.Dolly:this.updatePose(0,0,t?.0075*this.deltaY+1:.175*this.deltaY,0,0,0);break;case p.PanDolly:const i=.42*(this.deltaPinch-1)+1;this.updatePose(.75*this.deltaX,.75*this.deltaY,t?1/i:-10*(this.deltaPinch-1),0,0,0)}}updatePose(t,e,i,n,r,o){const{orbit:a,minOrbit:p,maxOrbit:f,offset:g,minOffset:m,maxOffset:A,camera:v}=this;this.prevOffset.copy(g),this.prevOrbit.copy(a).multiplyScalar(s.A.DEG2RAD);let y=-1;if(this.orientationEnabled&&(a.x+=y*n*220/this.viewportHeight,a.y+=y*r*220/this.viewportHeight,a.z+=y*o*220/this.viewportHeight,a.x=s.A.limit(a.x,p.x,f.x),a.y=s.A.limit(a.y,p.y,f.y),a.z=s.A.limit(a.z,p.z,f.z)),this.offsetEnabled)if(this.controllerMode==d.Orbit){const n=g.z=i*g.z;g.x+=t*n*y/this.viewportHeight,g.y-=e*n*y/this.viewportHeight,g.x=s.A.limit(g.x,m.x,A.x),g.y=s.A.limit(g.y,m.y,A.y),g.z=s.A.limit(g.z,m.z,A.z)}else{const n=this.controllerMode===d.Walk,r=this.boundsRadius/25;c.set(20*t*r*y/this.viewportHeight,n?0:20*e*r*y/this.viewportHeight,i*r),n&&(u.set(this.prevOrbit.x,0,this.prevOrbit.z),c.applyEuler(u)),g.x+=c.x,g.y-=c.y,g.z+=c.z,l.copy(a).multiplyScalar(s.A.DEG2RAD),v.getWorldQuaternion(h),this.offset.applyQuaternion(h),this.offset.applyEuler(u.set(-l.x,-l.y,-l.z))}}getModeFromEvent(t){if("mouse"===t.source){const e=t.originalEvent.button;if(0===e)return t.ctrlKey?p.Pan:t.altKey?p.Dolly:p.Orbit;if(2===e)return t.altKey?p.Roll:p.Pan;if(1===e)return p.Dolly}else if("touch"===t.source){const e=t.pointerCount;return 1===e?p.Orbit:2===e?p.PanDolly:p.Pan}}}},9171:(t,e)=>{"use strict";function i(t){return"[object Object]"===Object.prototype.toString.call(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.isPlainObject=function(t){var e,n;return!1!==i(t)&&(void 0===(e=t.constructor)||!1!==i(n=e.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf"))}},9185:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=void 0;var o=r(i(3745)),a=i(9585),l=new Set(["input","option","optgroup","select","button","datalist","textarea"]),c=new Set(["p"]),h=new Set(["thead","tbody"]),u=new Set(["dd","dt"]),d=new Set(["rt","rp"]),p=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",c],["h1",c],["h2",c],["h3",c],["h4",c],["h5",c],["h6",c],["select",l],["input",l],["output",l],["button",l],["datalist",l],["textarea",l],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",u],["dt",u],["address",c],["article",c],["aside",c],["blockquote",c],["details",c],["div",c],["dl",c],["fieldset",c],["figcaption",c],["figure",c],["footer",c],["form",c],["header",c],["hr",c],["main",c],["nav",c],["ol",c],["pre",c],["section",c],["table",c],["ul",c],["rt",d],["rp",d],["tbody",h],["tfoot",h]]),f=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),g=new Set(["math","svg"]),m=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),A=/\s|\//,v=function(){function t(t,e){var i,n,s,r,a;void 0===e&&(e={}),this.options=e,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=null!=t?t:{},this.lowerCaseTagNames=null!==(i=e.lowerCaseTags)&&void 0!==i?i:!e.xmlMode,this.lowerCaseAttributeNames=null!==(n=e.lowerCaseAttributeNames)&&void 0!==n?n:!e.xmlMode,this.tokenizer=new(null!==(s=e.Tokenizer)&&void 0!==s?s:o.default)(this.options,this),null===(a=(r=this.cbs).onparserinit)||void 0===a||a.call(r,this)}return t.prototype.ontext=function(t,e){var i,n,s=this.getSlice(t,e);this.endIndex=e-1,null===(n=(i=this.cbs).ontext)||void 0===n||n.call(i,s),this.startIndex=e},t.prototype.ontextentity=function(t){var e,i,n=this.tokenizer.getSectionStart();this.endIndex=n-1,null===(i=(e=this.cbs).ontext)||void 0===i||i.call(e,(0,a.fromCodePoint)(t)),this.startIndex=n},t.prototype.isVoidElement=function(t){return!this.options.xmlMode&&f.has(t)},t.prototype.onopentagname=function(t,e){this.endIndex=e;var i=this.getSlice(t,e);this.lowerCaseTagNames&&(i=i.toLowerCase()),this.emitOpenTag(i)},t.prototype.emitOpenTag=function(t){var e,i,n,s;this.openTagStart=this.startIndex,this.tagname=t;var r=!this.options.xmlMode&&p.get(t);if(r)for(;this.stack.length>0&&r.has(this.stack[this.stack.length-1]);){var o=this.stack.pop();null===(i=(e=this.cbs).onclosetag)||void 0===i||i.call(e,o,!0)}this.isVoidElement(t)||(this.stack.push(t),g.has(t)?this.foreignContext.push(!0):m.has(t)&&this.foreignContext.push(!1)),null===(s=(n=this.cbs).onopentagname)||void 0===s||s.call(n,t),this.cbs.onopentag&&(this.attribs={})},t.prototype.endOpenTag=function(t){var e,i;this.startIndex=this.openTagStart,this.attribs&&(null===(i=(e=this.cbs).onopentag)||void 0===i||i.call(e,this.tagname,this.attribs,t),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""},t.prototype.onopentagend=function(t){this.endIndex=t,this.endOpenTag(!1),this.startIndex=t+1},t.prototype.onclosetag=function(t,e){var i,n,s,r,o,a;this.endIndex=e;var l=this.getSlice(t,e);if(this.lowerCaseTagNames&&(l=l.toLowerCase()),(g.has(l)||m.has(l))&&this.foreignContext.pop(),this.isVoidElement(l))this.options.xmlMode||"br"!==l||(null===(n=(i=this.cbs).onopentagname)||void 0===n||n.call(i,"br"),null===(r=(s=this.cbs).onopentag)||void 0===r||r.call(s,"br",{},!0),null===(a=(o=this.cbs).onclosetag)||void 0===a||a.call(o,"br",!1));else{var c=this.stack.lastIndexOf(l);if(-1!==c)if(this.cbs.onclosetag)for(var h=this.stack.length-c;h--;)this.cbs.onclosetag(this.stack.pop(),0!==h);else this.stack.length=c;else this.options.xmlMode||"p"!==l||(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=e+1},t.prototype.onselfclosingtag=function(t){this.endIndex=t,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=t+1):this.onopentagend(t)},t.prototype.closeCurrentTag=function(t){var e,i,n=this.tagname;this.endOpenTag(t),this.stack[this.stack.length-1]===n&&(null===(i=(e=this.cbs).onclosetag)||void 0===i||i.call(e,n,!t),this.stack.pop())},t.prototype.onattribname=function(t,e){this.startIndex=t;var i=this.getSlice(t,e);this.attribname=this.lowerCaseAttributeNames?i.toLowerCase():i},t.prototype.onattribdata=function(t,e){this.attribvalue+=this.getSlice(t,e)},t.prototype.onattribentity=function(t){this.attribvalue+=(0,a.fromCodePoint)(t)},t.prototype.onattribend=function(t,e){var i,n;this.endIndex=e,null===(n=(i=this.cbs).onattribute)||void 0===n||n.call(i,this.attribname,this.attribvalue,t===o.QuoteType.Double?'"':t===o.QuoteType.Single?"'":t===o.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""},t.prototype.getInstructionName=function(t){var e=t.search(A),i=e<0?t:t.substr(0,e);return this.lowerCaseTagNames&&(i=i.toLowerCase()),i},t.prototype.ondeclaration=function(t,e){this.endIndex=e;var i=this.getSlice(t,e);if(this.cbs.onprocessinginstruction){var n=this.getInstructionName(i);this.cbs.onprocessinginstruction("!".concat(n),"!".concat(i))}this.startIndex=e+1},t.prototype.onprocessinginstruction=function(t,e){this.endIndex=e;var i=this.getSlice(t,e);if(this.cbs.onprocessinginstruction){var n=this.getInstructionName(i);this.cbs.onprocessinginstruction("?".concat(n),"?".concat(i))}this.startIndex=e+1},t.prototype.oncomment=function(t,e,i){var n,s,r,o;this.endIndex=e,null===(s=(n=this.cbs).oncomment)||void 0===s||s.call(n,this.getSlice(t,e-i)),null===(o=(r=this.cbs).oncommentend)||void 0===o||o.call(r),this.startIndex=e+1},t.prototype.oncdata=function(t,e,i){var n,s,r,o,a,l,c,h,u,d;this.endIndex=e;var p=this.getSlice(t,e-i);this.options.xmlMode||this.options.recognizeCDATA?(null===(s=(n=this.cbs).oncdatastart)||void 0===s||s.call(n),null===(o=(r=this.cbs).ontext)||void 0===o||o.call(r,p),null===(l=(a=this.cbs).oncdataend)||void 0===l||l.call(a)):(null===(h=(c=this.cbs).oncomment)||void 0===h||h.call(c,"[CDATA[".concat(p,"]]")),null===(d=(u=this.cbs).oncommentend)||void 0===d||d.call(u)),this.startIndex=e+1},t.prototype.onend=function(){var t,e;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var i=this.stack.length;i>0;this.cbs.onclosetag(this.stack[--i],!0));}null===(e=(t=this.cbs).onend)||void 0===e||e.call(t)},t.prototype.reset=function(){var t,e,i,n;null===(e=(t=this.cbs).onreset)||void 0===e||e.call(t),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,null===(n=(i=this.cbs).onparserinit)||void 0===n||n.call(i,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1},t.prototype.parseComplete=function(t){this.reset(),this.end(t)},t.prototype.getSlice=function(t,e){for(;t-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();for(var i=this.buffers[0].slice(t-this.bufferOffset,e-this.bufferOffset);e-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),i+=this.buffers[0].slice(0,e-this.bufferOffset);return i},t.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()},t.prototype.write=function(t){var e,i;this.ended?null===(i=(e=this.cbs).onerror)||void 0===i||i.call(e,new Error(".write() after done!")):(this.buffers.push(t),this.tokenizer.running&&(this.tokenizer.write(t),this.writeIndex++))},t.prototype.end=function(t){var e,i;this.ended?null===(i=(e=this.cbs).onerror)||void 0===i||i.call(e,new Error(".end() after done!")):(t&&this.write(t),this.ended=!0,this.tokenizer.end())},t.prototype.pause=function(){this.tokenizer.pause()},t.prototype.resume=function(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()},t.prototype.parseChunk=function(t){this.write(t)},t.prototype.done=function(t){this.end(t)},t}();e.Parser=v},9203:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.replaceCodePoint=e.fromCodePoint=void 0;var n=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);function s(t){var e;return t>=55296&&t<=57343||t>1114111?65533:null!==(e=n.get(t))&&void 0!==e?e:t}e.fromCodePoint=null!==(i=String.fromCodePoint)&&void 0!==i?i:function(t){var e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|1023&t),e+=String.fromCharCode(t)},e.replaceCodePoint=s,e.default=function(t){return(0,e.fromCodePoint)(s(t))}},9261:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>r,iO:()=>s.iO,oo:()=>s.oo});var n=i(8446),s=i(7297);class r extends n.A{setModel(t){this.data.uri=t,this.data.type=s.iO.Model,this.data.mimeType=this.guessAssetMimeType()}setGeometry(t){this.data.uri=t,this.data.type=s.iO.Geometry,this.data.mimeType=this.guessAssetMimeType()}setTexture(t,e){this.data.uri=t,this.data.type=s.iO.Image,this.data.mimeType=this.guessAssetMimeType(),this.data.mapType=e}isValid(){return!!this.data.uri&&void 0!==this.data.type}toString(){const t=this.data;return`Asset - type: '${s.iO[t.type]}', uri: '${t.uri}', mime type: '${t.mimeType||"(not set)"}'`}init(){return{uri:"",mimeType:"",type:void 0,mapType:void 0,byteSize:0,numFaces:0,numVertices:0,imageSize:0}}deflate(t,e){e.uri=t.uri,e.type=s.iO[t.type],t.mimeType&&(e.mimeType=t.mimeType),void 0!==t.mapType&&(e.mapType=s.oo[t.mapType]),t.byteSize>0&&(e.byteSize=t.byteSize),t.type!==s.iO.Model&&t.type!==s.iO.Geometry||t.numFaces>0&&(e.numFaces=t.numFaces),t.type!==s.iO.Model&&t.type!==s.iO.Image&&t.type!==s.iO.Texture||t.imageSize>0&&(e.imageSize=t.imageSize)}inflate(t,e){e.uri=t.uri,e.mimeType=t.mimeType,e.type=s.iO[t.type],e.mapType=s.oo[t.mapType],e.byteSize=t.byteSize||0,e.numFaces=t.numFaces||0,e.imageSize=t.imageSize||0,void 0===e.type&&(e.type=this.guessAssetType(),void 0===e.type&&console.warn(`failed to determine asset type from asset: ${e.uri}`)),void 0===e.mimeType&&(e.mimeType=this.guessAssetMimeType())}guessAssetType(){const t=this.data;if(void 0!==t.type&&s.iO[t.type])return t.type;if(t.mimeType){if(t.mimeType===r.mimeType.gltfJson||t.mimeType===r.mimeType.gltfBinary)return s.iO.Model;if(t.mimeType===r.mimeType.imageJpeg||t.mimeType===r.mimeType.imagePng)return s.iO.Image}const e=t.uri.split(".").pop().toLowerCase();return"gltf"===e||"glb"===e?s.iO.Model:"obj"===e||"ply"===e?s.iO.Geometry:"jpg"===e||"png"===e?s.iO.Image:void 0}guessAssetMimeType(){const t=this.data;if(t.mimeType)return t.mimeType;const e=t.uri.split(".").pop().toLowerCase();return"gltf"===e?r.mimeType.gltfJson:"glb"===e?r.mimeType.gltfBinary:"jpg"===e?r.mimeType.imageJpeg:"png"===e?r.mimeType.imagePng:""}}r.mimeType={gltfJson:"model/gltf+json",gltfBinary:"model/gltf-binary",imageJpeg:"image/jpeg",imagePng:"image/png"}},9264:(t,e,i)=>{"use strict";var n=i(6763),s=i(4743);const r=new WeakMap,o=(0,s.u$)(t=>e=>{const i=r.get(e);if(void 0===t&&e instanceof s.ab){if(void 0!==i||!r.has(e)){const t=e.committer.name;e.committer.element.removeAttribute(t)}}else t!==i&&e.setValue(t);r.set(e,t)});var a=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let l=class extends n.Ay{constructor(){super(...arguments),this.name="",this.index=0,this.rows=0,this.text="",this.placeholder="",this.readonly=!1,this.align="left",this.maxLength=0,this.initialValue=""}get textArea(){return this.getElementsByTagName("textarea").item(0)}select(){const t=this.textArea;t&&t.select()}focus(){const t=this.textArea;t&&t.focus()}blur(){const t=this.textArea;t&&t.blur()}hasFocus(){const t=document.activeElement.shadowRoot?document.activeElement.shadowRoot.activeElement:document.activeElement;return this.textArea===t}firstConnected(){this.classList.add("ff-control","ff-text-edit")}shouldUpdate(t){return!this.hasFocus()&&super.shouldUpdate(t)}render(){var t;return n.qy`<textarea
            .value=${this.text} placeholder=${this.placeholder} rows=${this.rows} aria-labelledby=${null!==(t=this.getAttribute("aria-labelledby"))&&void 0!==t?t:""}
            @keydown=${this.onKeyDown} @change=${this.onChange} @input=${this.onInput}
            @focus=${this.onFocus} @blur=${this.onBlur} 
            style="text-align: ${this.align};" ?readonly=${this.readonly} maxlength=${o(this.maxLength>0?this.maxLength:void 0)}}></textarea>`}onKeyDown(t){const e=t.target;"Escape"===t.key&&(this.revert(e),e.blur())}onChange(t){t.stopPropagation(),t.preventDefault(),this.text=t.target.value,this.dispatchChangeEvent(this.text,!1)}onInput(t){t.stopPropagation(),t.preventDefault(),this.text=t.target.value,this.dispatchChangeEvent(this.text,!0)}onFocus(t){this.initialValue=t.target.value}onBlur(t){this.commit(t.target),this.requestUpdate()}revert(t){t.value=this.initialValue,this.dispatchChangeEvent(t.value,!1)}commit(t){this.initialValue=t.value,this.dispatchChangeEvent(t.value,!1)}dispatchChangeEvent(t,e){this.dispatchEvent(new CustomEvent("change",{detail:{text:t,isEditing:e}}))}};a([(0,n.MZ)({type:String})],l.prototype,"name",void 0),a([(0,n.MZ)({type:Number})],l.prototype,"index",void 0),a([(0,n.MZ)({type:Number})],l.prototype,"rows",void 0),a([(0,n.MZ)({type:String})],l.prototype,"text",void 0),a([(0,n.MZ)({type:String})],l.prototype,"placeholder",void 0),a([(0,n.MZ)({type:Boolean})],l.prototype,"readonly",void 0),a([(0,n.MZ)({type:String})],l.prototype,"align",void 0),a([(0,n.MZ)({type:Number})],l.prototype,"maxLength",void 0),l=a([(0,n.EM)("ff-text-edit")],l)},9293:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});class n{constructor(t,e,i){this._type=t,this._callback=e,this._context=i,this._publishers=[]}on(...t){return t.forEach(t=>{this._publishers.push(t),t.on(this._type,this._callback,this._context)}),this}off(){return this._publishers.forEach(t=>t.off(this._type,this._callback,this._context)),this._publishers.length=0,this}}},9309:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var n=i(3423);class s extends n.Ay{constructor(t,e){super(t,e),this.outs=this.addOutputs(s.pulseOuts),this.addEvent("pulse"),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.context={time:new Date,secondsElapsed:0,secondsDelta:0,frameNumber:0,tickUpdated:!1,tockUpdated:!1},this._secondsStarted=.001*Date.now(),this._secondsStopped=this._secondsStarted,this._animHandler=0,this._pulseEvent={type:"pulse",context:this.context,systemUpdated:!1}}start(){0===this._animHandler&&(this._secondsStopped>0&&(this._secondsStarted+=.001*Date.now()-this._secondsStopped,this._secondsStopped=0),this._animHandler=window.requestAnimationFrame(this.onAnimationFrame))}stop(){0!==this._animHandler&&(0===this._secondsStopped&&(this._secondsStopped=.001*Date.now()),window.cancelAnimationFrame(this._animHandler),this._animHandler=0)}pulse(t){const{outs:e,context:i,_pulseEvent:n}=this;i.time.setTime(t);const s=.001*t-this._secondsStarted;i.secondsDelta=s-i.secondsElapsed,i.secondsElapsed=s,i.frameNumber++,e.time.setValue(i.secondsElapsed),e.frame.setValue(i.frameNumber),i.tickUpdated=this.system.graph.tick(i),n.systemUpdated=i.tickUpdated||i.tockUpdated,this.emit(n),i.tockUpdated=this.system.graph.tock(i)}onAnimationFrame(){this.pulse(Date.now()),this._animHandler=window.requestAnimationFrame(this.onAnimationFrame)}}s.typeName="CPulse",s.isSystemSingleton=!0,s.pulseOuts={time:n.gK.Number("Pulse.Time"),frame:n.gK.Integer("Pulse.Frame")}},9337:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n=i(3423),s=i(3675),r=i(3600),o=i(946);class a extends n.Ay{constructor(){super(...arguments),this._sceneSetupTranslations={},this._uiLanguageTranslations={},this._sceneLanguages={},this._activeSeneLanguageTranslations={},this.ins=this.addInputs(a.ins),this.outs=this.addOutputs(a.outs),this.updateLanguage=t=>{const{ins:e,outs:i}=this;e.activeLanguage.value===t&&(i.activeLanguage.setValue(t),this.emit({type:"tag-update"}))},this.updateUILanguage=t=>{const{ins:e,outs:i}=this;e.uiLanguage.value===t&&i.uiLanguage.setValue(t)}}get assetReader(){return this.getMainComponent(r.A)}get sceneLanguages(){return Object.values(this._sceneLanguages)}nameString(){return s.BX[s.aL[this.ins.activeLanguage.value]]}codeString(){return s.aL[this.ins.activeLanguage.value]}create(){super.create()}update(){const{ins:t,outs:e}=this;if(0==this.sceneLanguages.length&&t.activeLanguage.value==e.activeLanguage.value&&this.addLanguage(e.activeLanguage.value),t.activeLanguage.changed&&t.activeLanguage.value!=e.activeLanguage.value){const e=t.activeLanguage.value;this.addLanguage(e),this.assetReader.getSystemJSON("language/string.resources."+s.aL[this.ins.activeLanguage.value].toLowerCase()+".json").then(t=>{this._activeSeneLanguageTranslations=t,this.updateLanguage(e)})}return t.uiLanguage.changed&&this.assetReader.getSystemJSON("language/string.resources."+s.aL[this.ins.uiLanguage.value].toLowerCase()+".json").then(e=>{this._uiLanguageTranslations=e,this.updateUILanguage(t.uiLanguage.value)}),!0}fromData(t){var e,i;const{ins:n,outs:r}=this;t=t||{};const o=null!==(e=s.aL[t.language||"EN"])&&void 0!==e?e:s.aL[s.Nm];this.ins.primarySceneLanguage.setValue(null!==(i=s.aL[t.language||"EN"])&&void 0!==i?i:s.aL[s.Nm]),this.assetReader.getSystemJSON("language/string.resources."+s.aL[this.ins.primarySceneLanguage.value].toLowerCase()+".json").then(t=>{this._sceneSetupTranslations=t}),n.activeLanguage.setValue(o)}toData(){const t=this.ins;return{language:s.aL[t.activeLanguage.getValidatedValue()]}}addLanguage(t){var e,i,n;null!==(e=(i=this._sceneLanguages)[n=s.aL[t]])&&void 0!==e||(i[n]={id:t,name:s.BX[s.aL[t]]})}getLocalizedString(t){return this.getLocalizedStringIn(t,this._activeSeneLanguageTranslations,s.aL[this.outs.activeLanguage.value])}getUILocalizedString(t){return this.getLocalizedStringIn(t,this._uiLanguageTranslations,s.aL[this.outs.uiLanguage.value])}getSceneSetupLocalizedString(t){return this.getLocalizedStringIn(t,this._sceneSetupTranslations,this.ins.primarySceneLanguage.value.toString())}getLocalizedStringIn(t,e={},i){return void 0===e?t:e[t]||t}}a.typeName="CVLanguageManager",a.text="Language",a.icon="",a.isSystemSingleton=!0,a.ins={enabled:n.gK.Boolean("Language.Enabled",!1),uiLanguage:n.gK.Enum("Interface.Language",s.aL,{preset:s.aL[s.Nm],enum:s.aL,options:(0,o.e)(s.BX).map(t=>s.BX[t])}),primarySceneLanguage:n.gK.Enum("Interface.Language",s.aL,{preset:s.aL[s.Nm],enum:s.aL,options:(0,o.e)(s.BX).map(t=>s.BX[t])}),activeLanguage:n.gK.Enum("Interface.Language",s.aL,{preset:s.aL[s.Nm],enum:s.aL,options:(0,o.e)(s.BX).map(t=>s.BX[t])})},a.outs={activeLanguage:n.gK.Enum("Interface.Language",s.aL,s.aL.EN),uiLanguage:n.gK.Enum("Interface.Language",s.aL,s.aL.EN)}},9348:(t,e,i)=>{var n="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g;t.exports=n},9493:t=>{var e=String,i=function(){return{isColorSupported:!1,reset:e,bold:e,dim:e,italic:e,underline:e,inverse:e,hidden:e,strikethrough:e,black:e,red:e,green:e,yellow:e,blue:e,magenta:e,cyan:e,white:e,gray:e,bgBlack:e,bgRed:e,bgGreen:e,bgYellow:e,bgBlue:e,bgMagenta:e,bgCyan:e,bgWhite:e,blackBright:e,redBright:e,greenBright:e,yellowBright:e,blueBright:e,magentaBright:e,cyanBright:e,whiteBright:e,bgBlackBright:e,bgRedBright:e,bgGreenBright:e,bgYellowBright:e,bgBlueBright:e,bgMagentaBright:e,bgCyanBright:e,bgWhiteBright:e}};t.exports=i(),t.exports.createColors=i},9498:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});i(2867);var n=i(6763),s=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let r=class extends n.Ay{constructor(){super(),this.name="",this.index=0,this.selectedIndex=-1,this.tabbingIndex=0,this.selected=!1,this.selectable=!1,this.disabled=!1,this.icon="",this.role="button",this.caret=!1,this.inline=!1,this.transparent=!1,this.addEventListener("click",t=>this.onClick(t)),this.addEventListener("keydown",t=>this.onKeyDown(t))}firstConnected(){this.tabIndex=this.tabbingIndex,this.setAttribute("role",this.role),this.classList.add("ff-button")}shouldUpdate(t){return(t.has("selectedIndex")||t.has("index"))&&this.selectedIndex>=0&&(this.selected=this.index===this.selectedIndex),t.has("disabled")&&this.setClass("ff-disabled",this.disabled),!0}update(t){this.classList.remove("ff-inline","ff-transparent","ff-control"),this.inline?this.classList.add("ff-inline"):this.transparent?this.classList.add("ff-transparent"):this.classList.add("ff-control"),super.update(t)}render(){return this.caret?n.qy`${this.renderIcon()}<div class="ff-caret-container">${this.renderText()}${this.renderCaret()}</div>`:n.qy`${this.renderIcon()}${this.renderText()}`}renderIcon(){return this.icon?n.qy`<ff-icon class="ff-off" name=${this.icon}></ff-icon>`:null}renderText(){return this.text?n.qy`<div class="ff-text ff-off">${this.text}</div>`:null}renderCaret(){return this.caret?n.qy`<div class="ff-caret-down ff-off"></div>`:null}onClick(t){this.selectable&&(this.selected=!this.selected)}onKeyDown(t){(document.activeElement.shadowRoot?document.activeElement.shadowRoot.activeElement:document.activeElement)!==this||"Space"!==t.code&&"Enter"!==t.code||(t.preventDefault(),this.dispatchEvent(new MouseEvent("click",{bubbles:!0})))}};s([(0,n.MZ)({type:String})],r.prototype,"name",void 0),s([(0,n.MZ)({type:Number})],r.prototype,"index",void 0),s([(0,n.MZ)({type:Number})],r.prototype,"selectedIndex",void 0),s([(0,n.MZ)({type:Number})],r.prototype,"tabbingIndex",void 0),s([(0,n.MZ)({type:Boolean,reflect:!0})],r.prototype,"selected",void 0),s([(0,n.MZ)({type:Boolean})],r.prototype,"selectable",void 0),s([(0,n.MZ)({type:Boolean})],r.prototype,"disabled",void 0),s([(0,n.MZ)()],r.prototype,"text",void 0),s([(0,n.MZ)()],r.prototype,"icon",void 0),s([(0,n.MZ)()],r.prototype,"role",void 0),s([(0,n.MZ)({type:Boolean})],r.prototype,"caret",void 0),s([(0,n.MZ)({type:Boolean})],r.prototype,"inline",void 0),s([(0,n.MZ)({type:Boolean})],r.prototype,"transparent",void 0),r=s([(0,n.EM)("ff-button")],r);const o=r},9519:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});var n=i(3675);const s={mm:{mm:1,cm:.1,m:.001,km:1,in:.0393701,ft:.00328084,yd:.00109361,mi:1},cm:{mm:10,cm:1,m:.01,km:1,in:.393701,ft:.0328084,yd:.0109361,mi:1},m:{mm:1e3,cm:100,m:1,km:1,in:39.3701,ft:3.28084,yd:1.09361,mi:1},km:{mm:1e6,cm:1e5,m:1e3,km:1,in:39370.1,ft:3280.84,yd:1093.61,mi:1},in:{mm:25.4,cm:2.54,m:.0254,km:1,in:1,ft:.0833333,yd:.0277778,mi:1},ft:{mm:304.8,cm:30.48,m:.3048,km:1,in:12,ft:1,yd:.333334,mi:1},yd:{mm:914.4,cm:91.44,m:.9144,km:1,in:36,ft:3,yd:1,mi:1},mi:{mm:1609e3,cm:160900,m:1609,km:1,in:63346456.693,ft:5278871.391,yd:1759623.797,mi:1}};function r(t,e){const i=n.uj[t],r=n.uj[e];return s[i][r]||1}},9521:(t,e,i)=>{"use strict";i.d(e,{sf:()=>m,Ay:()=>g});var n,s=i(4640),r=i(8948),o=(i(7832),i(3818)),a=(i(9498),i(9264),i(3051)),l=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let c=n=class extends o.Ay{static show(t,e,i){const s=new n(t,e,i);return t.appendChild(s),new Promise((t,e)=>{s.on("close",()=>t())})}constructor(t,e,i){super(),this.content=null,this.sprite=null,this.resizeObserver=null,this.close=this.close.bind(this),this.onKeyDownMain=this.onKeyDownMain.bind(this),this.content=e,this.title="",this.sprite=i,this.position="center",this.portal=t,this.modal=!0}close(){this.dispatchEvent(new CustomEvent("close")),this.remove()}firstConnected(){super.firstConnected(),this.classList.add("sv-annotation-overlay","sv-annotation")}connected(){super.connected(),this.sprite.addEventListener("link",this.close),this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>this.onResize())),this.resizeObserver.observe(this)}disconnected(){this.resizeObserver.disconnect(),this.sprite.removeEventListener("link",this.close),super.disconnected()}render(){return o.qy`
        <div class="sv-help-region" id="anno_container" role="region" @wheel=${t=>this.discardEvents(t)} @pointerdown=${t=>this.discardEvents(t)} aria-label="Annotation pop-up" aria-live="polite" aria-atomic="true" @keydown=${t=>this.onKeyDownMain(t)}>
            <div class="ff-flex-row">
                <div id="ovr_title" class="ff-flex-spacer ff-title"><b>${this.title}</b></div>
                <ff-button icon="close" transparent class="ff-close-button" title="Close" @click=${this.close}></ff-button>
            </div>
        </div>
        `}firstUpdated(t){super.firstUpdated(t),this.getElementsByClassName("ff-close-button")[0].focus();this.querySelector("#anno_container").append(this.content),setTimeout(()=>{this.title=this.sprite.annotation.title,this.requestUpdate()},100)}onKeyDownMain(t){"Escape"===t.code?this.close():"Tab"===t.code&&(t.stopPropagation(),(0,a.i)((0,a.R)(this),t))}discardEvents(t){t.stopPropagation()}};c=n=l([(0,o.EM)("sv-annotation-overlay")],c);const h=c,u=new s.Pq0(0,1,0),d=new s.Pq0,p=new s.Pq0,f=new s.Pq0;class g extends r.Ay{get typeName(){return this.constructor.typeName}constructor(t,e){super(),this.isAdaptive=!0,this.isAnimating=!1,this.assetManager=null,this.audioManager=null,this.annotation=t,this.matrixAutoUpdate=!1}update(){super.update();const t=this.annotation.data;this.position.fromArray(t.position),d.fromArray(t.direction).normalize(),this.quaternion.setFromUnitVectors(u,d),this.updateMatrix()}emitClickEvent(){const t={type:"click",annotation:this.annotation,sprite:this};this.dispatchEvent(t)}emitLinkEvent(t){const e={type:"link",annotation:this.annotation,sprite:this,link:t};this.dispatchEvent(e)}isBehindCamera(t,e){let i=null;i=e instanceof s.nZQ&&e.cameras.length>0?e.cameras[0]:e;const n=i.matrixWorld.elements;return t.updateMatrixWorld(),p.setFromMatrixPosition(t.matrixWorld),f.setFromMatrixPosition(i.matrixWorld),d.set(-n[8],-n[9],-n[10]).normalize(),f.addScaledVector(d,i.near),f.sub(p),f.angleTo(d)<=Math.PI/2}}g.typeName="Annotation";class m extends r.AZ{get truncated(){return this.isTruncated}set truncated(t){this.isTruncated=t}get overlayed(){return this.isOverlayed}set overlayed(t){this.isOverlayed=t}constructor(t){super(),this.isTruncated=!1,this.isOverlayed=!1,this.sprite=t,this.discardEvent=this.discardEvent.bind(this),this.addEventListener("pointercancel",this.discardEvent),this.addEventListener("click",this.discardEvent),this.setAttribute("aria-label","annotation"),this.setAttribute("aria-live","polite"),this.setAttribute("role","button")}firstConnected(){super.firstConnected(),this.classList.add("sv-annotation")}discardEvent(t){t.stopPropagation()}showOverlay(t){this.requestUpdate().then(()=>{h.show(this.parentElement,t,this.sprite).then(()=>{this.overlayed=!1,this.append(t),this.querySelector('[tabindex="0"]').focus(),this.requestUpdate()})})}}},9551:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(5265),s={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:t,schemaCode:e}){const i="maxItems"===t?"more":"fewer";return n.str`must NOT have ${i} than ${e} items`},params:({schemaCode:t})=>n._`{limit: ${t}}`},code(t){const{keyword:e,data:i,schemaCode:s}=t,r="maxItems"===e?n.operators.GT:n.operators.LT;t.fail$data(n._`${i}.length ${r} ${s}`)}};e.default=s},9585:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.decodeXML=e.decodeHTMLStrict=e.decodeHTMLAttribute=e.decodeHTML=e.determineBranch=e.EntityDecoder=e.DecodingMode=e.BinTrieFlags=e.fromCodePoint=e.replaceCodePoint=e.decodeCodePoint=e.xmlDecodeTree=e.htmlDecodeTree=void 0;var a=o(i(7784));e.htmlDecodeTree=a.default;var l=o(i(1192));e.xmlDecodeTree=l.default;var c=r(i(9203));e.decodeCodePoint=c.default;var h,u=i(9203);Object.defineProperty(e,"replaceCodePoint",{enumerable:!0,get:function(){return u.replaceCodePoint}}),Object.defineProperty(e,"fromCodePoint",{enumerable:!0,get:function(){return u.fromCodePoint}}),function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"}(h||(h={}));var d,p,f;function g(t){return t>=h.ZERO&&t<=h.NINE}function m(t){return t>=h.UPPER_A&&t<=h.UPPER_F||t>=h.LOWER_A&&t<=h.LOWER_F}function A(t){return t===h.EQUALS||function(t){return t>=h.UPPER_A&&t<=h.UPPER_Z||t>=h.LOWER_A&&t<=h.LOWER_Z||g(t)}(t)}!function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"}(d=e.BinTrieFlags||(e.BinTrieFlags={})),function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"}(p||(p={})),function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"}(f=e.DecodingMode||(e.DecodingMode={}));var v=function(){function t(t,e,i){this.decodeTree=t,this.emitCodePoint=e,this.errors=i,this.state=p.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=f.Strict}return t.prototype.startEntity=function(t){this.decodeMode=t,this.state=p.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},t.prototype.write=function(t,e){switch(this.state){case p.EntityStart:return t.charCodeAt(e)===h.NUM?(this.state=p.NumericStart,this.consumed+=1,this.stateNumericStart(t,e+1)):(this.state=p.NamedEntity,this.stateNamedEntity(t,e));case p.NumericStart:return this.stateNumericStart(t,e);case p.NumericDecimal:return this.stateNumericDecimal(t,e);case p.NumericHex:return this.stateNumericHex(t,e);case p.NamedEntity:return this.stateNamedEntity(t,e)}},t.prototype.stateNumericStart=function(t,e){return e>=t.length?-1:(32|t.charCodeAt(e))===h.LOWER_X?(this.state=p.NumericHex,this.consumed+=1,this.stateNumericHex(t,e+1)):(this.state=p.NumericDecimal,this.stateNumericDecimal(t,e))},t.prototype.addToNumericResult=function(t,e,i,n){if(e!==i){var s=i-e;this.result=this.result*Math.pow(n,s)+parseInt(t.substr(e,s),n),this.consumed+=s}},t.prototype.stateNumericHex=function(t,e){for(var i=e;e<t.length;){var n=t.charCodeAt(e);if(!g(n)&&!m(n))return this.addToNumericResult(t,i,e,16),this.emitNumericEntity(n,3);e+=1}return this.addToNumericResult(t,i,e,16),-1},t.prototype.stateNumericDecimal=function(t,e){for(var i=e;e<t.length;){var n=t.charCodeAt(e);if(!g(n))return this.addToNumericResult(t,i,e,10),this.emitNumericEntity(n,2);e+=1}return this.addToNumericResult(t,i,e,10),-1},t.prototype.emitNumericEntity=function(t,e){var i;if(this.consumed<=e)return null===(i=this.errors)||void 0===i||i.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===h.SEMI)this.consumed+=1;else if(this.decodeMode===f.Strict)return 0;return this.emitCodePoint((0,c.replaceCodePoint)(this.result),this.consumed),this.errors&&(t!==h.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},t.prototype.stateNamedEntity=function(t,e){for(var i=this.decodeTree,n=i[this.treeIndex],s=(n&d.VALUE_LENGTH)>>14;e<t.length;e++,this.excess++){var r=t.charCodeAt(e);if(this.treeIndex=b(i,n,this.treeIndex+Math.max(1,s),r),this.treeIndex<0)return 0===this.result||this.decodeMode===f.Attribute&&(0===s||A(r))?0:this.emitNotTerminatedNamedEntity();if(0!==(s=((n=i[this.treeIndex])&d.VALUE_LENGTH)>>14)){if(r===h.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==f.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1},t.prototype.emitNotTerminatedNamedEntity=function(){var t,e=this.result,i=(this.decodeTree[e]&d.VALUE_LENGTH)>>14;return this.emitNamedEntityData(e,i,this.consumed),null===(t=this.errors)||void 0===t||t.missingSemicolonAfterCharacterReference(),this.consumed},t.prototype.emitNamedEntityData=function(t,e,i){var n=this.decodeTree;return this.emitCodePoint(1===e?n[t]&~d.VALUE_LENGTH:n[t+1],i),3===e&&this.emitCodePoint(n[t+2],i),i},t.prototype.end=function(){var t;switch(this.state){case p.NamedEntity:return 0===this.result||this.decodeMode===f.Attribute&&this.result!==this.treeIndex?0:this.emitNotTerminatedNamedEntity();case p.NumericDecimal:return this.emitNumericEntity(0,2);case p.NumericHex:return this.emitNumericEntity(0,3);case p.NumericStart:return null===(t=this.errors)||void 0===t||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case p.EntityStart:return 0}},t}();function y(t){var e="",i=new v(t,function(t){return e+=(0,c.fromCodePoint)(t)});return function(t,n){for(var s=0,r=0;(r=t.indexOf("&",r))>=0;){e+=t.slice(s,r),i.startEntity(n);var o=i.write(t,r+1);if(o<0){s=r+i.end();break}s=r+o,r=0===o?s+1:s}var a=e+t.slice(s);return e="",a}}function b(t,e,i,n){var s=(e&d.BRANCH_LENGTH)>>7,r=e&d.JUMP_TABLE;if(0===s)return 0!==r&&n===r?i:-1;if(r){var o=n-r;return o<0||o>=s?-1:t[i+o]-1}for(var a=i,l=a+s-1;a<=l;){var c=a+l>>>1,h=t[c];if(h<n)a=c+1;else{if(!(h>n))return t[c+s];l=c-1}}return-1}e.EntityDecoder=v,e.determineBranch=b;var _=y(a.default),x=y(l.default);e.decodeHTML=function(t,e){return void 0===e&&(e=f.Legacy),_(t,e)},e.decodeHTMLAttribute=function(t){return _(t,f.Attribute)},e.decodeHTMLStrict=function(t){return _(t,f.Strict)},e.decodeXML=function(t){return x(t,f.Strict)}},9610:(t,e,i)=>{"use strict";i.d(e,{A:()=>p});var n=i(4640),s=i(3423),r=i(5676),o=i(3074),a=i(8337);const l=new n.Pq0,c=new n.Pq0,h=new n.O9p,u=new n.PTz;class d extends o.Ay{constructor(t,e){super(t,e),this.ins=this.addInputs(d.camIns),this.object3D=new r.Ay}get camera(){return this.object3D}update(){const{autoActivate:t,activate:e}=this.ins;if(e.changed||t.changed&&t.value){const t=this.scene;t&&(t.activeCameraComponent=this)}const i=this.camera,{position:n,rotation:s,projection:r,fov:o,size:a,zoom:l,near:c,far:h}=this.ins;if(n.changed||s.changed){i.position.fromArray(n.value);const t=[s.value[0],s.value[1],s.value[2]];i.rotation.fromArray(t),i.updateMatrix()}return r.changed&&i.setProjection(r.getValidatedValue()),i.fov=o.value,i.size=a.value,i.zoom=l.value,i.near=c.value,i.far=h.value,i.updateProjectionMatrix(),!0}dispose(){const t=this.scene;t&&t.activeCameraComponent===this&&(t.activeCameraComponent=null),super.dispose()}setPropertiesFromMatrix(t){const e=!t;t=t||this.object3D.matrix;const{position:i,rotation:n,order:s}=this.ins;t.decompose(l,u,c),l.toArray(i.value);const r=s.getOptionText();h.setFromQuaternion(u,r),l.setFromEuler(h),l.multiplyScalar(a.A.RAD2DEG).toArray(n.value),i.set(e),n.set(e)}}d.typeName="CCamera",d.camIns={autoActivate:s.gK.Boolean("Camera.AutoActivate",!0),activate:s.gK.Event("Camera.Activate"),position:s.gK.Vector3("Transform.Position"),rotation:s.gK.Vector3("Transform.Rotation"),order:s.gK.Enum("Transform.Order",o.I8,o.I8.ZYX),projection:s.gK.Enum("Projection.Type",r.$R,r.$R.Perspective),fov:s.gK.Number("Projection.FovY",52),size:s.gK.Number("Projection.Size",20),zoom:s.gK.Number("Projection.Zoom",1),near:s.gK.Number("Frustum.ZNear",.01),far:s.gK.Number("Frustum.ZFar",1e4)};class p extends d{get settingProperties(){return[this.ins.projection,this.ins.fov,this.ins.size,this.ins.near,this.ins.far,this.addIns.autoNearFar]}constructor(t,e){super(t,e),this.addIns=this.addInputs(p.cameraAddIns),this.object3D.layers.enable(1)}fromDocument(t,e){if(!isFinite(e.camera))throw new Error("camera property missing in node");const i=t.cameras[e.camera];return null!=i.autoNearFar&&this.addIns.autoNearFar.setValue(i.autoNearFar),"perspective"===i.type?this.ins.copyValues({projection:r.$R.Perspective,fov:i.perspective.yfov,near:i.perspective.znear,far:i.perspective.zfar}):this.ins.copyValues({projection:r.$R.Orthographic,size:i.orthographic.ymag,near:i.orthographic.znear,far:i.orthographic.zfar}),e.camera}toDocument(t,e){const i=this.ins,n={};i.projection.getValidatedValue()===r.$R.Perspective?(n.type="perspective",n.perspective={yfov:i.fov.value,znear:i.near.value,zfar:i.far.value}):(n.type="orthographic",n.orthographic={ymag:i.size.value,znear:i.near.value,zfar:i.far.value}),n.autoNearFar=this.addIns.autoNearFar.value,t.cameras=t.cameras||[];const s=t.cameras.length;return t.cameras.push(n),s}}p.typeName="CVCamera",p.text="Camera",p.icon="video",p.cameraAddIns={autoNearFar:o.gK.Boolean("Frustum.AutoNearFar",!0)}},9616:(t,e,i)=>{"use strict";i.d(e,{A:()=>I});var n=i(4640),s=i(6773),r=i(3423),o=i(3074),a=i(6351),l=i(2997),c=i(7297),h=i(9519),u=i(1572),d=i(9261);const p=[],f=[u.a9.Thumb,u.a9.AR,u.a9.Low,u.a9.Medium,u.a9.High,u.a9.Highest];class g{constructor(){this.derivatives={}}select(t,e){const i=u.UH[t],n=u.a9[e],s=f.indexOf(e);if(s<0)return console.warn(`derivative quality not supported: '${n}'`),null;const r=this.get(t,e);if(r)return r;for(let e=s+1;e<f.length;++e){const i=this.get(t,f[e]);if(i)return i}for(let e=s-1;e>=0;--e){const i=this.get(t,f[e]);if(i)return i}return console.warn(`no suitable derivative found for quality '${n}' and usage '${i}'`),null}getByUsage(t){const e=u.UH[t];return(this.derivatives[e]||p).sort((t,e)=>t.data.quality<e.data.quality?-1:t.data.quality>e.data.quality?1:0)}getByQuality(t){return this.getArray().filter(e=>e.data.quality===t)}getArray(){return Object.keys(this.derivatives).reduce((t,e)=>t.concat(this.derivatives[e]),[])}get(t,e){const i=u.UH[t],n=this.derivatives[i];if(n)for(let t=0,i=n.length;t<i;++t)if(n[t].data.quality===e)return n[t];return null}getOrCreate(t,e){const i=this.getOrCreateBin(t);for(let t=0,n=i.length;t<n;++t)if(i[t].data.quality===e)return i[t];const n=new u.Ay;return n.set("usage",t),n.set("quality",e),i.push(n),n}remove(t,e){const i=this.get(t,e);if(i){const e=this.getOrCreateBin(t),n=e.indexOf(i);n>-1&&e.splice(n,1)}}createModelAsset(t,e){e=null!=(e="string"==typeof e?u.a9[e]:e)?e:u.a9.Medium;const i=this.getOrCreate(u.UH.Web3D,e),n=new d.Ay;return n.setModel(t),i.addAsset(n),i}createMeshAsset(t,e,i,n,s){s=null!=(s="string"==typeof s?u.a9[s]:s)?s:u.a9.Medium;const r=this.getOrCreate(u.UH.Web3D,s),o=new d.Ay;if(o.setGeometry(t),r.addAsset(o),e){const t=new d.Ay;t.setTexture(e,d.oo.Color),r.addAsset(t)}if(i){const t=new d.Ay;t.setTexture(i,d.oo.Occlusion),r.addAsset(t)}if(n){const t=new d.Ay;t.setTexture(n,d.oo.Normal),r.addAsset(t)}return r}clear(){for(let t in this.derivatives)this.derivatives[t].forEach(t=>t.dispose());this.derivatives={}}toJSON(){const t=[];for(let e in this.derivatives)this.derivatives[e].forEach(e=>t.push(e.toJSON()));return t}fromJSON(t){this.clear(),t.forEach(t=>{this.getOrCreateBin(u.UH[t.usage]).push(new u.Ay(t))})}toString(t=!1){const e=this.derivatives,i=Object.keys(e);return t?`Derivatives (${i.length}) \n `+i.map(t=>e[t].map(t=>t.toString(!0)).join("\n ")).join("\n "):`Derivatives (${i.length}) `+i.map(t=>`${t} (${e[t].length})`).join(", ")}getOrCreateBin(t){const e=u.UH[t];return this.derivatives[e]||(this.derivatives[e]=[])}}var m=i(3350),A=i(161),v=i(3600),y=i(3889),b=i(1721);const _=new n.Pq0,x=new n.Pq0,w=new n.PTz,E=new n.PTz,C=new n.NRn,S=new n.kn4;class I extends o.Ay{get settingProperties(){return[this.ins.name,this.ins.visible,this.ins.quality,this.ins.localUnits,this.ins.tags,this.ins.renderOrder,this.ins.shadowSide,this.ins.shader,this.ins.variant,this.ins.overlayMap,this.ins.slicerEnabled,this.ins.override,this.ins.color,this.ins.opacity,this.ins.hiddenOpacity,this.ins.roughness,this.ins.metalness,this.ins.occlusion,this.ins.doubleSided]}constructor(t,e){super(t,e),this.ins=this.addInputs(I.ins),this.outs=this.addOutputs(I.outs),this._derivatives=new g,this._activeDerivative=null,this._loadingDerivative=null,this._visible=!0,this._boxFrame=null,this._localBoundingBox=new n.NRn,this._prevPosition=new n.Pq0(0,0,0),this._prevRotation=new n.Pq0(0,0,0),this._materialCache={},this._clayColor=new n.Q1f("#a67a6c").convertLinearToSRGB(),this._wireColor=new n.Q1f("#004966").convertLinearToSRGB(),this._wireEmissiveColor=new n.Q1f("#004966").convertLinearToSRGB(),this._overlays={},this._needsInit=!0,this.object3D=new n.YJl,this.object3D.name="Model"}get snapshotProperties(){return[this.ins.visible,this.ins.quality,this.ins.overlayMap,this.ins.override,this.ins.opacity,this.ins.variant,this.ins.roughness,this.ins.metalness,this.ins.color,this.ins.slicerEnabled]}get derivatives(){return this._derivatives}get activeDerivative(){return this._activeDerivative}get localBoundingBox(){return this._localBoundingBox}get assetManager(){return this.getMainComponent(A.A)}get assetReader(){return this.getMainComponent(v.A)}get renderer(){return this.getMainComponent(y.A)}getOriginalMaterial(t){return this._materialCache[t]}getOverlay(t){if(t in this._overlays)return this._overlays[t];{const e=this.ins.overlayMap;return e.schema.options.includes(t)||e.setOptions(e.schema.options.concat(t)),this._overlays[t]={texture:null,asset:null,fromFile:!1,isDirty:!1}}}getOverlays(){return Object.keys(this._overlays).filter(t=>this.activeDerivative.findAssets(c.iO.Image).some(e=>e.data.uri==t)).map(t=>this._overlays[t])}deleteOverlay(t){const e=this.ins.overlayMap,i=e.schema.options;i.splice(i.indexOf(t),1),e.setOptions(i),this._overlays[t].texture.dispose(),delete this._overlays[t]}create(){super.create();this.node.createComponent(m.A).ins.unitScale.linkFrom(this.outs.unitScale)}update(){const t=this.ins;if(t.name.changed&&(this.node.name=t.name.value),t.tags.changed||t.activeTags.changed||t.visible.changed){let e=t.visible.value;if(e){const i=t.tags.value.split(",").map(t=>t.trim()).filter(t=>t),n=t.activeTags.value.split(",").map(t=>t.trim()).filter(t=>t);e=!i.length,n.forEach(t=>{i.indexOf(t)>=0&&(e=!0)})}const i=this.ins.override.value;this._visible=e,e?(this.object3D.visible=!0,i&&this.updateMaterial()):t.visible.value&&i&&this.ins.hiddenOpacity.value>0?(this.object3D.visible=!0,this.updateMaterial()):this.object3D.visible=!1,this.outs.updated.set()}if(t.tags.changed&&this.emit({type:"tag-update"}),!this.activeDerivative&&t.autoLoad.changed&&t.autoLoad.value)this.autoLoad().then(()=>{if(!this.getGraphComponent(b.A).derivatives.ins.enabled.value){const t=this.derivatives.select(c.UH.Web3D,c.a9.High);this.ins.quality.setValue(t.data.quality)}});else if(t.quality.changed){const e=this.derivatives.select(c.UH.Web3D,t.quality.value);e&&this.loadDerivative(e).catch(t=>{console.warn("Model.update - failed to load derivative"),console.warn(t)})}return t.renderOrder.changed&&this.updateRenderOrder(this.object3D,t.renderOrder.value),(t.localUnits.changed||t.globalUnits.changed)&&this.updateUnitScale(),t.shader.changed&&this.updateShader(),t.overlayMap.changed&&this.updateOverlayMap(),t.variant.changed&&this.updateVariant(),t.shadowSide.changed&&this.updateShadowSide(),t.override.value&&t.shader.value===l.gw.Default&&(t.override.changed||t.color.changed||t.opacity.changed||t.doubleSided.changed||t.roughness.changed||t.metalness.changed||t.occlusion.changed)?this.updateMaterial():t.override.changed&&!t.override.value&&t.shader.value===l.gw.Default&&this.object3D.traverse(t=>{const e=t.material;if(e){const t=this._materialCache[e.uuid];t&&(e.aoMapIntensity=t.occlusion,e.color.fromArray(t.color),e.opacity=t.opacity,e.transparent=t.transparent,e.roughness=t.roughness,e.metalness=t.metalness,e.side=t.doubleSided?n.$EB:n.hB5,e.needsUpdate=!0)}}),t.center.changed&&this.center(),(t.position.changed||t.rotation.changed||t.scale.changed)&&this.updateMatrixFromProps(),t.dumpDerivatives.changed&&console.log(this.derivatives.toString(!0)),!0}dispose(){this.derivatives.clear(),this._activeDerivative=null;for(let t in this._overlays)this._overlays[t].texture&&this._overlays[t].texture.dispose();super.dispose()}center(){const t=this.object3D,e=this.ins.position;t.matrix.decompose(_,w,x),t.matrix.makeRotationFromQuaternion(w),C.makeEmpty(),a.g6(t,C,t.parent),C.getCenter(_),_.multiplyScalar(-1).toArray(e.value),e.set()}setFromMatrix(t){const e=this.ins;t.decompose(_,w,x),_.multiplyScalar(1/this.outs.unitScale.value).toArray(e.position.value),e.position.set(),a.Dl(w,I.rotationOrder,e.rotation.value),e.rotation.set(),e.scale.setValue(x.x/this.outs.unitScale.value)}fromDocument(t,e){const{ins:i,outs:s}=this;if(!isFinite(e.model))throw new Error("model property missing in node");const r=t.models[e.model];i.name.setValue(e.name);const o=c.uj[r.units||"cm"];i.localUnits.setValue(isFinite(o)?o:c.uj.cm),i.visible.setValue(void 0===r.visible||r.visible),i.tags.setValue(r.tags||""),i.renderOrder.setValue(void 0!==r.renderOrder?r.renderOrder:0);const l=c.Jb[r.shadowSide||"Back"];if(i.shadowSide.setValue(isFinite(l)?l:c.Jb.Back),i.position.reset(),i.rotation.reset(),r.translation&&(i.position.copyValue(r.translation),this._prevPosition.fromArray(r.translation),this._needsInit=!1),r.rotation&&(w.fromArray(r.rotation),a.Dl(w,I.rotationOrder,i.rotation.value),this._prevRotation.fromArray(i.rotation.value),i.rotation.set(),this._needsInit=!1),r.boundingBox){const t=this._localBoundingBox;t.min.fromArray(r.boundingBox.min),t.max.fromArray(r.boundingBox.max),this._boxFrame=new n.BND(t,"#009cde"),this.addObject3D(this._boxFrame),this._boxFrame.updateMatrixWorld(!0);const e=this.getGraphComponent(b.A,!0);e&&e.navigation.ins.autoZoom.value&&e.navigation.ins.zoomExtents.set(),s.updated.set(),this.updateUnitScale()}if(r.derivatives&&this.derivatives.fromJSON(r.derivatives),r.material){const t=r.material;i.copyValues({override:!0,color:t.color||i.color.schema.preset,opacity:void 0!==t.opacity?t.opacity:i.opacity.schema.preset,hiddenOpacity:void 0!==t.hiddenOpacity?t.hiddenOpacity:i.hiddenOpacity.schema.preset,roughness:void 0!==t.roughness?t.roughness:i.roughness.schema.preset,metalness:void 0!==t.metalness?t.metalness:i.metalness.schema.preset,occlusion:void 0!==t.occlusion?t.occlusion:i.occlusion.schema.preset,doubleSided:void 0!==t.doubleSided?t.doubleSided:i.doubleSided.schema.preset})}return r.overlayMap&&i.overlayMap.setValue(r.overlayMap),r.annotations&&this.getComponent(m.A).fromData(r.annotations),this.emit({type:"tag-update"}),this.ins.autoLoad.set(),this.assetManager.initialLoad=!0,e.model}toDocument(t,e){const i={units:c.uj[this.ins.localUnits.getValidatedValue()]},n=this.ins;n.visible.value||(i.visible=!1),n.tags.value&&(i.tags=n.tags.value),0!==n.renderOrder.value&&(i.renderOrder=n.renderOrder.value),n.shadowSide.value!=c.Jb.Back&&(i.shadowSide=c.Jb[this.ins.shadowSide.getValidatedValue()]);const s=n.position.value;0===s[0]&&0===s[1]&&0===s[2]||(i.translation=n.position.value);const r=n.rotation.value;0===r[0]&&0===r[1]&&0===r[2]||(a.DI(r,I.rotationOrder,w),i.rotation=w.toArray()),n.override.value&&(i.material={color:n.color.value,opacity:n.opacity.value,hiddenOpacity:n.hiddenOpacity.value,roughness:n.roughness.value,metalness:n.metalness.value,occlusion:n.occlusion.value,doubleSided:n.doubleSided.value}),0!==n.overlayMap.value&&(i.overlayMap=n.overlayMap.value),i.boundingBox={min:this._localBoundingBox.min.toArray(),max:this._localBoundingBox.max.toArray()},i.derivatives=this.derivatives.toJSON();const o=this.getComponent(m.A).toData();o&&o.length>0&&(i.annotations=o),t.models=t.models||[];const l=t.models.length;return t.models.push(i),l}updateShader(){const t=this.ins.shader.getValidatedValue(),e=[];this.object3D.traverse(i=>{const n=i.material;n&&n.defines&&!e.includes(n.uuid)&&(this.setShaderMode(t,n),e.push(n.uuid))})}updateShadowSide(){this.object3D.traverse(t=>{const e=t.material;e&&(this.ins.shadowSide.value==c.Jb.Front?e.shadowSide=n.hB5:e.shadowSide=n.hsX,e.needsUpdate=!0)})}updateOverlayMap(){const t=this.getGraphComponent(b.A,!0);if(t&&t.snapshots.outs.tweening.value)return void t.snapshots.outs.end.once("value",()=>{this.ins.overlayMap.set(),this.update()});const e=this.getOverlays(),i=this.ins.overlayMap.value-1;if(i>=0&&e.length>i){const t=this.getOverlays()[i].asset.data.uri,e=this.getOverlay(t).texture;e?this.updateOverlayMaterial(e,t):this.assetReader.getTexture(t).then(e=>{this.getOverlay(t).texture=e,this.updateOverlayMaterial(e,t)})}else this.updateOverlayMaterial(null,null)}updateVariant(){if(!this.activeDerivative)return;const t=this.ins.variant.getOptionText(),e=this.activeDerivative.model.userData.variants.findIndex(e=>e.name.includes(t));if(e<0)return;const i=this.activeDerivative.model.userData.parser;this.object3D.traverse(async t=>{var s=t;if(!s.isMesh||!s.userData.gltfExtensions)return;const r=s.userData.gltfExtensions.KHR_materials_variants;if(!r)return;s.userData.originalMaterial||(s.userData.originalMaterial=s.material);const o=r.mappings.find(t=>t.variants.includes(e));o?i.getDependency("material",o.material).then(t=>{const e=s.material.userData.shader;s.material.copy(t),s.material.userData.shader=e,this.activeDerivative.model.userData.variants.variantMaterials[t.uuid]=t;const i=s.material;this._materialCache[i.uuid]={color:i.color.toArray(),opacity:i.opacity,hiddenOpacity:this.ins.hiddenOpacity.schema.preset,roughness:i.roughness,metalness:i.metalness,occlusion:i.aoMapIntensity,doubleSided:i.side==n.$EB,transparent:i.transparent}}):s.material=s.userData.originalMaterial,this.ins.override.value&&this.updateMaterial(),this.outs.variant.setValue(this.ins.variant.value)}),this.outs.updated.set()}updateOverlayMaterial(t,e){this.object3D&&(this.object3D.traverse(i=>{const n=i.material;n&&n.defines&&(t&&(t.flipY=!1,n.defines.OVERLAY_ALPHA=e.endsWith(".jpg")),n.defines.USE_ZONEMAP=null!=t,n.userData.shader.uniforms.zoneMap.value=t,n.needsUpdate=!0)}),this.outs.overlayMap.setValue(this.ins.overlayMap.value))}updateMaterial(){const t=this.ins;this.object3D.traverse(e=>{const i=e.material;i&&i.defines&&(i.aoMapIntensity=t.occlusion.value,i.color.fromArray(t.color.value),i.opacity=this._visible?t.opacity.value:t.hiddenOpacity.value,i.transparent=i.opacity<1||this._materialCache[i.uuid].transparent,i.roughness=t.roughness.value,i.metalness=t.metalness.value,i.side=t.doubleSided.value?n.$EB:n.hB5,i.needsUpdate=!0)})}updateUnitScale(){const t=this.ins.localUnits.getValidatedValue(),e=this.ins.globalUnits.getValidatedValue();this.outs.unitScale.setValue((0,h.A)(t,e)),this.updateMatrixFromProps()}updateMatrixFromProps(){const t=this.ins,e=this.outs.unitScale.value,i=this.object3D;this._needsInit&&(this._prevPosition.copy(_.fromArray(t.position.value)),this._prevRotation.copy(_.fromArray(t.rotation.value)),this._needsInit=!1),_.fromArray(t.position.value).multiplyScalar(e),a.DI(t.rotation.value,I.rotationOrder,w),x.setScalar(t.scale.value).multiplyScalar(e),i.matrix.compose(_,w,x),i.matrixWorldNeedsUpdate=!0,a.DI([this._prevRotation.x,this._prevRotation.y,this._prevRotation.z],I.rotationOrder,E),E.invert(),x.setScalar(1),S.compose(_.fromArray(t.position.value),w,x);const n=this.getComponent(m.A);n.getAnnotations().forEach(t=>{_.fromArray(t.data.position),_.sub(this._prevPosition),_.applyQuaternion(E),_.applyMatrix4(S),t.data.position=_.toArray(),_.fromArray(t.data.direction),_.applyQuaternion(E),_.applyQuaternion(w),t.data.direction=_.toArray(),t.update(),n.updateAnnotation(t,!0)}),this._prevPosition.copy(_.fromArray(t.position.value)),this._prevRotation.copy(_.fromArray(t.rotation.value)),this.outs.updated.set()}updateRenderOrder(t,e){const i=e-t.renderOrder;t.renderOrder=e,t.children.forEach(t=>this.updateRenderOrder(t,i))}autoLoad(){const t=this.derivatives.select(c.UH.Web3D,this.ins.quality.value);return t?this.loadDerivative(t):(s.Ay.show(`No 3D derivatives available for '${this.displayName}'.`),Promise.resolve())}unload(){this._activeDerivative&&(this._activeDerivative.model&&this.removeObject3D(this._activeDerivative.model),this._activeDerivative.unload(),this._activeDerivative=null)}isLoading(){return!!this._loadingDerivative}async loadDerivative(t){if(this.node&&this.assetReader){if(this._loadingDerivative&&this._loadingDerivative!=t&&(this._loadingDerivative.unload(),this._loadingDerivative=null),this._activeDerivative!=t)return this._loadingDerivative==t?new Promise(t=>this._loadingDerivative.on("load",t)):(this._loadingDerivative=t,this.assetManager.initialLoad||this._activeDerivative||(this.assetManager.initialLoad=!0),t.load(this.assetReader).then(()=>{if(!t.model||!this.node||this._activeDerivative&&t.data.quality!=this.ins.quality.value)return void t.unload();if(this._activeDerivative&&this._activeDerivative==t)return;this.unload(),this._activeDerivative=t,this._loadingDerivative=null,this.addObject3D(t.model),this.renderer.activeSceneComponent.scene.updateMatrixWorld(!0),this._boxFrame&&(this.removeObject3D(this._boxFrame),this._boxFrame.dispose(),this._boxFrame=null),this._localBoundingBox.makeEmpty(),a.g6(t.model,this._localBoundingBox),this.outs.updated.set(),this._localBoundingBox.isEmpty()&&(_.setScalar(0),this._localBoundingBox.set(_,_)),this.outs.quality.setValue(t.data.quality),this.object3D.traverse(t=>{const e=t.material;e&&(this._materialCache[e.uuid]={color:e.color.toArray(),opacity:e.opacity,hiddenOpacity:this.ins.hiddenOpacity.schema.preset,roughness:e.roughness,metalness:e.metalness,occlusion:e.aoMapIntensity,doubleSided:e.side==n.$EB,transparent:e.transparent})}),this.ins.override.value&&this.updateMaterial(),this.ins.shadowSide.value!=c.Jb.Back&&this.updateShadowSide(),0!==this.ins.renderOrder.value&&this.updateRenderOrder(this.object3D,this.ins.renderOrder.value);const e=this.ins.overlayMap;e.setOptions(["None"]),t.findAssets(c.iO.Image).filter(t=>t.data.mapType===c.oo.Zone).forEach(t=>{e.setOptions(e.schema.options.concat(t.data.uri));const i=this.getOverlay(t.data.uri);i.asset=t,i.fromFile=!0});const i=t.model.userData.variants?t.model.userData.variants.map(t=>t.name):null;if(i){const t=new Set(this.ins.variant.schema.options);i.forEach(t.add,t),this.ins.variant.setOptions([...t]),this.ins.variant.setOption(i[0],!0,!0),this.updateVariant()}0!==this.ins.overlayMap.value&&this.ins.overlayMap.set(),this.emit({type:"model-load",quality:t.data.quality})}).catch(t=>{"AbortError"!=t.name&&"ABORT_ERR"!=t.name&&(console.error(t),s.Ay.show(`Failed to load model derivative: ${t.message}`))}))}else console.warn("Model load interrupted.")}addObject3D(t){this.object3D.add(t),this.object3D.traverse(t=>{"Mesh"===t.type&&this.registerPickableObject3D(t,!0)})}setShaderMode(t,e){const i=e;switch(Object.assign(i,i.userData.paramCopy),i.defines.MODE_NORMALS=!1,i.defines.MODE_XRAY=!1,i.defines.OBJECTSPACE_NORMALMAP=!(!i.normalMap||i.normalMapType!==n.vyJ),i.side=i.defines.CUT_PLANE?n.$EB:i.side,i.needsUpdate=!0,t){case l.gw.Clay:if(i.userData.paramCopy={color:i.color,map:i.map,roughness:i.roughness,metalness:i.metalness,aoMapIntensity:i.aoMapIntensity,blending:i.blending,transparent:i.transparent,depthWrite:i.depthWrite,envMap:i.envMap},"MeshPhysicalMaterial"==i.type){const t=i;i.userData.paramCopy.transmission=t.transmission,t.transmission=0}i.envMap=null,i.color=this._clayColor,i.map=null,i.roughness=1,i.metalness=0,i.aoMapIntensity*=1,i.blending=n.XIg,i.transparent=!1,i.depthWrite=!0;break;case l.gw.Normals:i.userData.paramCopy={blending:i.blending,transparent:i.transparent,depthWrite:i.depthWrite},i.defines.MODE_NORMALS=!0,i.blending=n.XIg,i.transparent=!1,i.depthWrite=!0;break;case l.gw.XRay:i.userData.paramCopy={side:i.side,blending:i.blending,transparent:i.transparent,depthWrite:i.depthWrite},i.defines.MODE_XRAY=!0,i.side=n.$EB,i.blending=n.EZo,i.transparent=!0,i.depthWrite=!1;break;case l.gw.Wireframe:i.userData.paramCopy={color:i.color,emissive:i.emissive,roughness:i.roughness,metalness:i.metalness,wireframe:i.wireframe,map:i.map,aoMap:i.aoMap,emissiveMap:i.emissiveMap,normalMap:i.normalMap},i.color=this._wireColor,i.emissive=this._wireEmissiveColor,i.roughness=.8,i.metalness=.1,i.wireframe=!0,i.map=null,i.aoMap=null,i.emissiveMap=null,i.normalMap=null,i.defines.OBJECTSPACE_NORMALMAP=!1}}}I.typeName="CVModel2",I.text="Model",I.icon="cube",I.rotationOrder="ZYX",I.ins={name:r.gK.String("Model.Name"),globalUnits:r.gK.Enum("Model.GlobalUnits",c.uj,c.uj.cm),localUnits:r.gK.Enum("Model.LocalUnits",c.uj,c.uj.cm),quality:r.gK.Enum("Model.Quality",c.a9,c.a9.Thumb),tags:r.gK.String("Model.Tags"),renderOrder:r.gK.Number("Model.RenderOrder",0),shadowSide:r.gK.Enum("Model.ShadowSide",c.Jb,c.Jb.Back),activeTags:r.gK.String("Model.ActiveTags"),autoLoad:r.gK.Boolean("Model.AutoLoad",!0),position:r.gK.Vector3("Model.Position"),rotation:r.gK.Vector3("Model.Rotation"),scale:r.gK.Number("Model.Scale",1),center:r.gK.Event("Model.Center"),shader:r.gK.Enum("Material.Shader",l.gw,l.gw.Default),variant:r.gK.Option("Material.Variant",[],0),overlayMap:r.gK.Option("Material.OverlayMap",["None"],0),slicerEnabled:r.gK.Boolean("Material.SlicerEnabled",!0),override:r.gK.Boolean("Material.Override",!1),color:r.gK.ColorRGB("Material.BaseColor"),opacity:r.gK.Percent("Material.Opacity",1),hiddenOpacity:r.gK.Percent("Material.HiddenOpacity",0),roughness:r.gK.Percent("Material.Roughness",.8),metalness:r.gK.Percent("Material.Metalness",.1),occlusion:r.gK.Percent("Material.Occlusion",{preset:.25,max:2}),doubleSided:r.gK.Boolean("Material.DoubleSided",!1),dumpDerivatives:r.gK.Event("Derivatives.Dump")},I.outs={unitScale:r.gK.Number("UnitScale",{preset:1,precision:5}),quality:r.gK.Enum("LoadedQuality",c.a9),updated:r.gK.Event("Updated"),overlayMap:r.gK.Option("Material.OverlayMap",["None"],0),variant:r.gK.Option("Material.Variant",[],0)}},9623:(t,e,i)=>{"use strict";let n=i(3172);class s extends n{constructor(t){super(t),this.type="comment"}}t.exports=s,s.default=s},9640:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var n=i(3423),s=i(4949),r=i(3074),o=(i(7832),i(3198));i(7891),i(8415),i(2642);class a extends r.Ay{constructor(t,e){super(t,e),this.ins=this.addInputs(a.ins),this._annotations={},this._viewports=new Set,this._sprites={},this.object3D=new s.A,this.object3D.setVisible(!1),this.object3D.name="StaticAnnotationView"}update(t){super.update(t);const e=this.ins,i=this.object3D;return e.unitScale.changed&&(i.scale.setScalar(e.unitScale.value),i.updateMatrix()),e.visible.changed&&i.setVisible(e.visible.value),!0}tock(){if(this.updated)return!0}postRender(t){const e=t.viewport;this._viewports.has(e)||(e.on("dispose",this.onViewportDispose,this),this._viewports.add(e));this.object3D.render(e.overlay,t.camera)}dispose(){this.object3D.dispose(),this._viewports.forEach(t=>t.off("dispose",this.onViewportDispose,this)),this._viewports.clear(),super.dispose()}addAnnotation(t){this._annotations[t.id]=t,this.createSprite(t),this.changed=!0}removeAnnotation(t){Object.keys(this._annotations);delete this._annotations[t.id],this.removeSprite(t),this.changed=!0}updateAnnotation(t,e){e&&this.updateSprite(t),this.changed=!0}onViewportDispose(t){this.object3D.disposeHTMLElements(t.viewport.overlay)}createSprite(t){this.removeSprite(t);const e=o.A.createInstance(t);this._sprites[t.id]=e,this.object3D.add(e)}removeSprite(t){const e=this._sprites[t.id];e&&(e.dispose(),this._sprites[t.id]=void 0,this.object3D.remove(e))}updateSprite(t){const e=this._sprites[t.id];e&&e.update()}}a.typeName="CVStaticAnnotationView",a.ins={unitScale:n.gK.Number("Transform.UnitScale",{preset:1,precision:5})}},9660:(t,e,i)=>{"use strict";i.d(e,{z:()=>n,A:()=>c});var n,s=i(3074),r=i(4640);!function(t){t[t.Solid=0]="Solid",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient"}(n||(n={}));class o extends r.eaF{constructor(){super(new a,new l),this.frustumCulled=!1,this.renderOrder=-1/0,this.matrixAutoUpdate=!1}dispose(){this.geometry.dispose(),this.material.dispose()}updateMatrixWorld(t){}}class a extends r.LoY{constructor(){super();const t=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),e=new r.eB$(t,5);this.setIndex([0,1,2,0,2,3]),this.setAttribute("position",new r.eHs(e,3,0,!1)),this.setAttribute("uv",new r.eHs(e,2,3,!1))}}class l extends r.D$Q{constructor(){super(...arguments),this.depthTest=!1,this.depthWrite=!1,this.transparent=!1,this.uniforms={style:{value:n.LinearGradient},color0:{value:new r.Pq0(.15,.2,.25)},color1:{value:new r.Pq0(0,0,0)},noise:{value:.02}},this.vertexShader=["precision highp float;","attribute vec3 position;","attribute vec2 uv;","varying vec2 ndc;","void main() {","  ndc = position.xy;","  gl_Position = vec4(position, 1.0);","}"].join("\n"),this.fragmentShader=["precision highp float;","uniform vec3 color0;","uniform vec3 color1;","uniform float noise;","uniform int style;","varying vec2 ndc;","float rand(vec2 co) {","float dt = dot(co.xy ,vec2(12.9898, 78.233));","float sn = mod(dt, 3.14);","return fract(sin(sn) * 43758.5453);","}","void main() {","  float f = style == 0 ? 0.0 : (style == 1 ? ndc.y * 0.5 + 0.5 : length(ndc) * 0.707);","  gl_FragColor = vec4(mix(color0, color1, f) + noise * rand(ndc), 1.0);","}"].join("\n")}set style(t){this.uniforms.style.value=t}get style(){return this.uniforms.style.value}set color0(t){if(t instanceof r.Q1f){const e=this.uniforms.color0.value;e.x=t.r,e.y=t.g,e.z=t.b}else this.uniforms.color0.value.copy(t)}get color0(){return this.uniforms.color0.value}set color1(t){if(t instanceof r.Q1f){const e=this.uniforms.color1.value;e.x=t.r,e.y=t.g,e.z=t.b}else this.uniforms.color1.value.copy(t)}get color1(){return this.uniforms.color1.value}set noise(t){this.uniforms.noise.value=t}get noise(){return this.uniforms.noise.value}}class c extends s.Ay{constructor(t,e){super(t,e),this.ins=this.addInputs(c.backgroundIns),this.object3D=new o}get background(){return this.object3D}update(t){super.update(t);const e=this.ins,i=this.background.material;return e.style.changed&&(i.style=e.style.getValidatedValue()),e.color0.changed&&i.color0.fromArray(e.color0.value),e.color1.changed&&i.color1.fromArray(e.color1.value),e.noise.changed&&(i.noise=e.noise.value),!0}dispose(){this.background.dispose(),super.dispose()}}c.typeName="CBackground",c.backgroundIns={style:s.gK.Enum("Background.Style",n,n.RadialGradient),color0:s.gK.ColorRGB("Background.Color0",[.2,.25,.3]),color1:s.gK.ColorRGB("Background.Color1",[.01,.03,.05]),noise:s.gK.Number("Background.Noise",{min:0,max:1,bar:!0,preset:.02})}},9683:(t,e,i)=>{"use strict";i.d(e,{A:()=>Wt});var n=i(319),s=i(2791),r=i(2652),o=i(6763),a=i(2867),l=i(6773),c=i(920),h=i(9293),u=i(2997),d=i(8604),p=i(161);class f{constructor(t){this.next=null,this.activePositions=[],this.activeType="",this.centerX=0,this.centerY=0,this.startX=0,this.startY=0,this.isDragging=!1,this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUpOrCancel=this.onPointerUpOrCancel.bind(this),this.onDoubleClick=this.onDoubleClick.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),this.onKeyDown=this.onKeyDown.bind(this),t&&(t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUpOrCancel),t.addEventListener("pointercancel",this.onPointerUpOrCancel),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),t.addEventListener("keydown",this.onKeyDown))}onPointerDown(t){if(this.activeType&&t.pointerType!==this.activeType)return;0===this.activePositions.length&&(this.startX=t.clientX,this.startY=t.clientY,this.isDragging=!1),this.activeType=t.pointerType,this.activePositions.push({id:t.pointerId,clientX:t.clientX,clientY:t.clientY});const e=this.createManipPointerEvent(t,"pointer-down");this.sendPointerEvent(e)&&t.stopPropagation()}onPointerMove(t){const e=this.activePositions;for(let i=0,n=e.length;i<n;++i){const n=e[i];t.pointerId===n.id&&(n.clientX=t.clientX,n.clientY=t.clientY)}if(e.length>0&&!this.isDragging){Math.abs(t.clientX-this.startX)+Math.abs(t.clientY-this.startY)>4&&(this.isDragging=!0)}const i=e.length?"pointer-move":"pointer-hover",n=this.createManipPointerEvent(t,i);this.sendPointerEvent(n)&&t.stopPropagation()}onPointerUpOrCancel(t){const e=this.activePositions;let i=!1;for(let n=0,s=e.length;n<s;++n)if(t.pointerId===e[n].id){e.splice(n,1),i=!0;break}if(!i)return;const n=this.createManipPointerEvent(t,"pointer-up");0===e.length&&(this.activeType=""),this.sendPointerEvent(n)&&t.stopPropagation(),t.preventDefault()}onDoubleClick(t){this.sendTriggerEvent(this.createManipTriggerEvent(t,"double-click"))&&t.preventDefault()}onContextMenu(t){this.sendTriggerEvent(this.createManipTriggerEvent(t,"context-menu")),t.preventDefault()}onWheel(t){this.sendTriggerEvent(this.createManipTriggerEvent(t,"wheel"))&&t.preventDefault()}onKeyDown(t){this.sendKeyboardEvent(this.createManipKeyboardEvent(t))}createManipPointerEvent(t,e){let i=0,n=0,s=0,r=0,o=0,a=0;const l=this.activePositions,c=l.length;if(c>0){for(let t=0;t<c;++t)i+=l[t].clientX,n+=l[t].clientY;i/=c,n/=c,"pointer-move"!==e&&"pointer-hover"!==e||(o=i-this.centerX,a=n-this.centerY),this.centerX=i,this.centerY=n}else i=this.centerX,n=this.centerY;const h=t.currentTarget;if(h instanceof Element){const e=h.getBoundingClientRect();s=t.clientX-e.left,r=t.clientY-e.top}return{originalEvent:t,type:e,source:t.pointerType,isPrimary:t.isPrimary,isDragging:this.isDragging,activePositions:l,pointerCount:c,centerX:i,centerY:n,localX:s,localY:r,movementX:o,movementY:a,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey,metaKey:t.metaKey}}createManipTriggerEvent(t,e){let i=0;"wheel"===e&&(i=t.deltaY);let n=0,s=0;const r=t.currentTarget;if(r instanceof Element){const e=r.getBoundingClientRect();n=t.clientX-e.left,s=t.clientY-e.top}return{originalEvent:t,type:e,wheel:i,centerX:t.clientX,centerY:t.clientY,localX:n,localY:s,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey,metaKey:t.metaKey}}createManipKeyboardEvent(t){return{originalEvent:t,type:"keydown",key:t.code,centerX:0,centerY:0,localX:0,localY:0,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey,metaKey:t.metaKey}}sendPointerEvent(t){return this.next&&this.next.onPointer(t)}sendTriggerEvent(t){return this.next&&this.next.onTrigger(t)}sendKeyboardEvent(t){return this.next&&this.next.onKeypress(t)}}var g,m=i(4482),A=i(5933),v=(i(2709),function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o});!function(t){t[t.Single=0]="Single",t[t.HorizontalSplit=1]="HorizontalSplit",t[t.VerticalSplit=2]="VerticalSplit",t[t.Quad=3]="Quad"}(g||(g={}));let y=class extends o.Ay{constructor(){super(...arguments),this.layout=g.Single,this.horizontalPosition=.5,this.verticalPosition=.5}firstConnected(){this.classList.add("ff-quad-splitter")}render(){const t=this.layout;if(t===g.Single)return o.qy``;const e=[];return t!==g.HorizontalSplit&&t!==g.Quad||e.push(o.qy`
                <div class="ff-horizontal" style="position:absolute; top:0; bottom:0; left:0; right:0; display:flex;">
                    <div class="ff-left" style="flex:1 1;"></div>
                    <ff-splitter direction="horizontal" position=${this.horizontalPosition} @ff-splitter-change=${this.onSplitterChange}></ff-splitter>
                    <div style="flex:1 1;"></div>
                </div>
            `),t!==g.VerticalSplit&&t!==g.Quad||e.push(o.qy`
                <div class="ff-vertical" style="position:absolute; top:0; bottom:0; left:0; right:0; display:flex; flex-direction: column">
                    <div class="ff-top" style="flex:1 1;"></div>
                    <ff-splitter direction="vertical" position=${this.verticalPosition} @ff-splitter-change=${this.onSplitterChange}></ff-splitter>
                    <div style="flex:1 1;"></div>
                </div>
            `),o.qy`${e}`}onSplitterChange(t){"horizontal"===t.detail.direction?this.horizontalPosition=t.detail.position:this.verticalPosition=t.detail.position,this.onChange&&this.onChange({layout:this.layout,horizontalSplit:this.horizontalPosition,verticalSplit:this.verticalPosition,isDragging:t.detail.isDragging})}};v([(0,o.MZ)({attribute:!1})],y.prototype,"layout",void 0),v([(0,o.MZ)({attribute:!1})],y.prototype,"horizontalPosition",void 0),v([(0,o.MZ)({attribute:!1})],y.prototype,"verticalPosition",void 0),y=v([(0,o.EM)("ff-quad-splitter")],y);const b=y;var _=i(2902),x=i(2654),w=i(1721),E=i(3051),C=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let S=class extends A.Ay{getView(){return this.view}constructor(t){super(t),this.view=null,this.canvas=null,this.overlay=null,this.srAnnouncement=null,this.splitter=null,this.resizeObserver=null,this.pointerEventsEnabled=!1,this.measuring=!1,this.onPointerUpOrCancel=this.onPointerUpOrCancel.bind(this),this.onKeyDownOverlay=this.onKeyDownOverlay.bind(this),this.manipTarget=new f,this.addEventListener("pointerdown",this.onPointerDown),this.addEventListener("pointermove",this.manipTarget.onPointerMove),this.addEventListener("pointerup",this.onPointerUpOrCancel),this.addEventListener("pointercancel",this.onPointerUpOrCancel),this.ownerDocument.addEventListener("pointermove",this.manipTarget.onPointerMove),this.ownerDocument.addEventListener("pointerup",this.onPointerUpOrCancel),this.ownerDocument.addEventListener("pointercancel",this.onPointerUpOrCancel),this.addEventListener("wheel",this.manipTarget.onWheel),this.addEventListener("contextmenu",this.manipTarget.onContextMenu),this.addEventListener("keydown",this.manipTarget.onKeyDown),this.pointerEventsEnabled=!0}firstConnected(){if(this.classList.add("sv-scene-view"),this.style.touchAction="none",this.setAttribute("touch-action","none"),this.tabIndex=0,this.id="sv-scene",this.ariaLabel="Interactive 3D Model. Use mouse, touch, or arrow keys to rotate. Escape key to exit annotations.",this.setAttribute("role","application"),this.srAnnouncement=this.appendElement("div"),this.srAnnouncement.classList.add("sr-only"),this.srAnnouncement.setAttribute("aria-live","polite"),this.srAnnouncement.setAttribute("id","sceneview-sr"),this.canvas=this.appendElement("canvas",{display:"block",width:"100%",height:"100%"}),this.overlay=this.appendElement("div",{position:"absolute",top:"0",bottom:"0",left:"0",right:"0",overflow:"hidden"}),this.overlay.classList.add("sv-content-overlay"),this.overlay.addEventListener("keydown",this.onKeyDownOverlay),!this.canvas.getContext("webgl2"))throw this.overlay.innerHTML="<div class='error-msg'>WebGL2 is required and unavailable in your browser.<br>Please see <a href='https://get.webgl.org/webgl2/' target='_blank' rel='noopener noreferrer'>this WebGL2 test page</a> for more information.</div>",new Error("WebGL2 unavailable. Try updating drivers and/or browser.");this.splitter=this.appendElement(b,{position:"absolute",top:"0",bottom:"0",left:"0",right:"0",overflow:"hidden"}),this.splitter.onChange=t=>{this.view.horizontalSplit=t.horizontalSplit,this.view.verticalSplit=t.verticalSplit},this.view=new m.A(this.system,this.canvas,this.overlay),this.view.on("layout",t=>{this.splitter.layout=t.layout,this.dispatchEvent(new CustomEvent("layout"))}),this.view.layout=g.Single,this.splitter.layout=g.Single,this.manipTarget.next=this.view}connected(){this.view.attach(),this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>this.view.resize())),this.resizeObserver.observe(this.view.renderer.domElement),this.system.getMainComponent(_.A).activeComponent.setup.navigation.ins.pointerEnabled.on("value",this.enablePointerEvents,this),this.system.getComponent(x.Ay).ins.keyNavActive.on("value",this.onKeyboardNavigation,this),this.system.getComponent(w.A).tape.ins.enabled.on("value",this.onMeasure,this)}disconnected(){this.resizeObserver.disconnect(),this.system.getComponent(w.A).tape.ins.enabled.off("value",this.onMeasure,this),this.system.getComponent(x.Ay).ins.keyNavActive.off("value",this.onKeyboardNavigation,this),this.system.getMainComponent(_.A).activeComponent.setup.navigation.ins.pointerEnabled.off("value",this.enablePointerEvents,this),this.view.detach()}enablePointerEvents(){const t=this.system.getMainComponent(_.A).activeComponent.setup.navigation.ins.pointerEnabled.value;t&&!this.pointerEventsEnabled?(this.addEventListener("pointerdown",this.onPointerDown),this.addEventListener("pointermove",this.manipTarget.onPointerMove),this.addEventListener("pointerup",this.onPointerUpOrCancel),this.addEventListener("pointercancel",this.onPointerUpOrCancel),this.ownerDocument.addEventListener("pointermove",this.manipTarget.onPointerMove),this.ownerDocument.addEventListener("pointerup",this.onPointerUpOrCancel),this.ownerDocument.addEventListener("pointercancel",this.onPointerUpOrCancel),this.addEventListener("wheel",this.manipTarget.onWheel),this.addEventListener("contextmenu",this.manipTarget.onContextMenu),this.addEventListener("keydown",this.manipTarget.onKeyDown),this.style.touchAction="none",this.setAttribute("touch-action","none"),this.pointerEventsEnabled=!0):!t&&this.pointerEventsEnabled&&(this.removeEventListener("pointerdown",this.onPointerDown),this.removeEventListener("pointermove",this.manipTarget.onPointerMove),this.removeEventListener("pointerup",this.onPointerUpOrCancel),this.removeEventListener("pointercancel",this.onPointerUpOrCancel),this.ownerDocument.removeEventListener("pointermove",this.manipTarget.onPointerMove),this.ownerDocument.removeEventListener("pointerup",this.onPointerUpOrCancel),this.ownerDocument.removeEventListener("pointercancel",this.onPointerUpOrCancel),this.removeEventListener("wheel",this.manipTarget.onWheel),this.removeEventListener("contextmenu",this.manipTarget.onContextMenu),this.removeEventListener("keydown",this.manipTarget.onKeyDown),this.style.touchAction="auto",this.setAttribute("touch-action","auto"),this.pointerEventsEnabled=!1,this.style.cursor="default")}onPointerDown(t){this.pointerEventsEnabled&&(this.style.cursor="default"==this.style.cursor?"default":"grabbing",this.manipTarget.onPointerDown(t))}onPointerUpOrCancel(t){this.pointerEventsEnabled&&(this.style.cursor="default"==this.style.cursor?"default":"grab",this.manipTarget.onPointerUpOrCancel(t))}onKeyboardNavigation(){const t=this.system.getComponent(x.Ay).ins;switch(t.keyNavActive.value){case x.P.Orbit:this.srAnnouncement.textContent="Orbit "+t.orbit.value[0].toFixed(0)+", "+t.orbit.value[1].toFixed(0)+", "+t.orbit.value[2].toFixed(0);break;case x.P.Pan:case x.P.Zoom:this.srAnnouncement.textContent="Offset "+t.offset.value[0].toFixed(0)+", "+t.offset.value[1].toFixed(0)+", "+t.offset.value[2].toFixed(0)}}onMeasure(){this.measuring=this.system.getComponent(w.A).tape.ins.enabled.value,this.style.cursor=this.measuring?"default":"grab"}onKeyDownOverlay(t){const e=this.system.getComponent(w.A).viewer;if("Escape"===t.code)if(t.preventDefault(),e.outs.tagCloud.value.length>0){const t=e.rootElement.shadowRoot.querySelector(".sv-tag-buttons").getElementsByClassName("ff-button")[0];t&&t.focus()}else this.system.getComponent(w.A).viewer.ins.annotationExit.set();else"Tab"===t.code&&(0,E.i)((0,E.R)(this.overlay),t,!0)}};S=C([(0,A.EM)("sv-scene-view")],S);const I=S;var M,T=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let B=M=class extends o.Ay{constructor(){super(...arguments),this.visible=!1,this.assetPath=""}firstConnected(){super.firstConnected(),this.classList.add("sv-spinner")}render(){const t=o.qy`<div class="sv-spinner-wheel"><object data="${this.assetPath}images/spinner.svg" type="image/svg+xml" alt="Spinner">
            ${M.template}
        </object></div>`;return this.style.visibility=this.visible?"visible":"hidden",t}};B.template=o.qy`<div class="sv-spinner-wheel"><svg viewBox="0 0 101.64261 101.4383" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><g transform="translate(-67.120928,-102.35083)"><circle style="fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#bfbfbf;stroke-width:3;stroke-miterlimit:4;stroke-dasharray:12, 12;stroke-dashoffset:0;stroke-opacity:1" id="path77" cx="117.94224" cy="152.9675" r="49.321297" /></g></svg></div>`,T([(0,o.MZ)({type:Boolean})],B.prototype,"visible",void 0),T([(0,o.MZ)({type:String})],B.prototype,"assetPath",void 0),B=M=T([(0,o.EM)("sv-spinner")],B);var R,P=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let L=R=class extends o.Ay{firstConnected(){super.firstConnected(),this.classList.add("sv-action-prompt")}render(){return o.qy`<div class="sv-prompt"><div id="prompt" class="sv-action-prompt">${R.icon}</div></div>`}};L.icon=o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M144 0C108.7 0 80 28.7 80 64V252.8c-5.2 3.6-10.2 7.6-14.9 11.9L44.8 283.2C26.5 299.9 16 323.5 16 348.3v10.2c0 54.1 28.7 104.1 75.4 131.3l2.6 1.5c23.2 13.6 49.7 20.7 76.6 20.7H296c66.3 0 120-53.7 120-120v-8V288c0-35.3-28.7-64-64-64c-2.8 0-5.6 .2-8.3 .5c-11-19.4-31.8-32.5-55.7-32.5c-5.3 0-10.5 .7-15.5 1.9c-10.8-20.2-32-33.9-56.5-33.9c-2.7 0-5.4 .2-8 .5V64c0-35.3-28.7-64-64-64zM128 64c0-8.8 7.2-16 16-16s16 7.2 16 16V200c0 10.3 6.6 19.5 16.4 22.8s20.6-.1 26.8-8.3c3-3.9 7.6-6.4 12.8-6.4c8.8 0 16 7.2 16 16v8c0 10.3 6.6 19.5 16.4 22.8s20.6-.1 26.8-8.3c3-3.9 7.6-6.4 12.8-6.4c8.8 0 16 7.2 16 16c0 9.1 5.1 17.4 13.3 21.5s17.9 3.2 25.1-2.3c2.7-2 6-3.2 9.6-3.2c8.8 0 16 7.2 16 16v96 8c0 39.8-32.2 72-72 72H170.6c-18.4 0-36.5-4.9-52.4-14.2l-11.7 20 11.7-20-2.6-1.5C83.6 429.7 64 395.5 64 358.5V348.3c0-11.3 4.8-22 13.1-29.6L96 301.5V344c0 8.8 7.2 16 16 16s16-7.2 16-16V266v-2V64z"/></svg>`,L=R=P([(0,o.EM)("sv-action-prompt")],L);var D=i(9498),N=i(8177),O=i(3534),k=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let U=class extends N.Ay{constructor(){super(...arguments),this.reader=null,this.tours=null,this.language=null,this.firstRender=!0}firstConnected(){super.firstConnected(),this.classList.add("sv-reader-view")}renderMenuEntry(t,e){const i=t.article;return N.qy`<div role="option" title="article" tabindex=${0===e?"0":"-1"} @keydown=${t=>this.onKeyDown(t,i.id)} class="sv-entry" @click=${t=>this.onClickArticle(t,i.id)}>      
            <div class="sv-titlebar">              
                <h1>${(0,O._)(i.title)}</h1>
                <ff-icon class="ff-off" name="triangle-right">
            </div>
            <p>${i.lead}</p>
        </div>`}render(){const t=this.reader,e=this.language;this.tours;if(!t)return N.qy`<div class="ff-placeholder">Please select a document to display its articles.</div>`;const i=this.tours.ins.enabled.value?null:N.qy`<ff-button class="sv-nav-button" inline title=${e.getLocalizedString("Article Menu")} icon="bars" @click=${this.onClickMenu}></ff-button>`;if(!t.activeArticle){const i=t.articles;return N.qy`<div class="sv-left"></div><div role="listbox" aria-label="articles" class="sv-article">
                <!--ff-button class="sv-nav-button" inline title=${e.getLocalizedString("Close Article Reader")} icon="close" @click=${this.onClickClose}></ff-button-->
                ${i.map((t,e)=>this.renderMenuEntry(t,e))}
            </div><div class="sv-right"></div>`}return N.qy`<div class="sv-left"></div><div class="sv-article" @keydown=${e=>this.onKeyDown(e,t.activeArticle.id)} >
                <ff-button class="sv-nav-button" inline title=${e.getLocalizedString("Close Article Reader")} icon="close" @click=${this.onClickClose}></ff-button>
                ${i}
                <div role="region" aria-live="polite" aria-atomic="true" title="article" class="sv-container"></div>
            </div><div class="sv-right"></div>`}onClickMenu(t){t.stopPropagation(),this.reader.ins.articleId.setValue(""),this.reader.ins.focus.setValue(!0)}onClickClose(t){t.stopPropagation(),this.dispatchEvent(new CustomEvent("close"))}onClickArticle(t,e){this.reader.ins.articleId.setValue(e)}updated(t){super.updated(t);const e=this.reader;if(e){if(e.activeArticle){const t=this.getElementsByClassName("sv-container").item(0);t.innerHTML=e.outs.content.value,this.firstRender&&(setTimeout(()=>{t.insertAdjacentHTML("beforeend","<div class='sr-only'>-end of article-</div>")},200),this.firstRender=!1)}e.ins.focus.value&&(this.setFocus(),e.ins.focus.setValue(!1,!0))}}onActiveDocument(t,e){t&&(t.setup.language.outs.activeLanguage.off("value",this.onUpdate,this),this.reader.outs.content.off("value",this.onUpdate,this),this.reader.outs.article.off("value",this.onUpdate,this),this.tours=null,this.language=null,this.reader=null),e&&(this.reader=e.setup.reader,this.language=e.setup.language,this.tours=e.setup.tours,this.reader.outs.content.on("value",this.onUpdate,this),this.reader.outs.article.on("value",this.onUpdate,this),e.setup.language.outs.activeLanguage.on("value",this.onUpdate,this))}onKeyDown(t,e){const i=this.reader;if("Space"!==t.code&&"Enter"!==t.code||!i||i.activeArticle){if("Escape"===t.code)t.preventDefault(),i.activeArticle?(i.ins.articleId.setValue(""),i.ins.focus.setValue(!0)):this.dispatchEvent(new CustomEvent("close"));else if("Tab"===t.code)(0,E.i)((0,E.R)(this),t);else if(("ArrowUp"===t.code||"ArrowDown"===t.code)&&i&&!i.activeArticle){const e=t.target instanceof Element?t.target:null;if(e){const i="ArrowUp"===t.code?e.previousElementSibling:e.nextElementSibling;i&&(e.setAttribute("tabIndex","-1"),i.setAttribute("tabIndex","0"),i.focus())}}}else t.preventDefault(),this.reader.ins.articleId.setValue(e),this.reader.ins.focus.setValue(!0)}setFocus(){(this.reader.activeArticle?this.getElementsByClassName("sv-nav-button").item(1):this.getElementsByClassName("sv-entry").item(0)).focus()}};U=k([(0,N.EM)("sv-reader-view")],U);var F=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let z=class extends N.Ay{constructor(){super(...arguments),this.audioManager=null,this.documentProps=new h.A("value",this.onUpdate,this)}firstConnected(){super.firstConnected(),this.classList.add("sv-caption-view")}render(){const t=this.audioManager,e=t.ins.activeCaption.value,i=t.ins.captionsEnabled.value;return e.length>0&&i?N.qy`<div class="sv-caption-box" >${e}</div>`:null}onActiveDocument(t,e){if(t&&this.documentProps.off(),e){const t=e.setup;this.audioManager=e.setup.audio,this.documentProps.on(t.audio.ins.captionsEnabled,t.audio.ins.activeCaption)}this.requestUpdate()}};z=F([(0,N.EM)("sv-caption-view")],z);const V=z;var Q=i(3889),j=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let G=class extends N.Ay{get arManager(){return this.system.getMainComponent(s.A)}firstConnected(){super.firstConnected()}render(){const t=this.arManager,e=t.outs,i=!0===t.ins.wallMount.value?"a wall":"the floor";return!e.isPlaced.value&&e.isPresenting.value?N.qy`<div class="sv-ar-prompt">
                <div class="sv-content">
                    <div><ff-icon class="ff-off ff-icon sv-ar-icon" name="device-move"}></ff-icon></div>
                    Point your device at ${i} and move it around to place your Smithsonian object!<br><br>**BETA**
                </div>
            </div>`:null}onActiveDocument(t,e){t&&(this.arManager.outs.isPlaced.off("value",this.onUpdate,this),this.arManager.outs.isPresenting.off("value",this.onUpdate,this)),e&&(this.arManager.outs.isPlaced.on("value",this.onUpdate,this),this.arManager.outs.isPresenting.on("value",this.onUpdate,this)),this.requestUpdate()}};G=j([(0,N.EM)("sv-ar-prompt-container")],G);const H=G;var q=i(3350),$=i(8172),W=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let K=class extends N.Ay{constructor(){super(...arguments),this.documentProps=new h.A("value",this.onUpdate,this),this.shareButtonSelected=!1}get analytics(){return this.system.getMainComponent(d.A)}get arManager(){return this.system.getMainComponent(s.A)}get sceneNode(){return this.system.getComponent($.A)}firstConnected(){super.firstConnected(),this.classList.add("sv-ar-menu-container")}connected(){super.connected()}disconnected(){super.disconnected()}render(){const t=this.activeDocument;if(!t)return N.qy``;const e=this.arManager.outs,i=t.setup,n=this.sceneNode.getGraphComponents(q.A).some(t=>t.hasAnnotations),s=i.viewer.ins.annotationsVisible.value,r=i.audio.outs.narrationEnabled.value,o=i.audio.outs.narrationPlaying.value;return e.isPlaced.value&&e.isPresenting.value?N.qy`<div class="sv-ar-menu">
        ${n?N.qy`<ff-button icon="comment" title="Show/Hide Annotations"
            ?selected=${s} @click=${this.onToggleAnnotations}></ff-button>`:null}
        ${r?N.qy`<ff-button icon="audio" title=${"Play Audio Narration"}
            ?selected=${o} @click=${this.onToggleNarration}></ff-button>`:null}
        </div>`:null}onToggleReader(){const t=this.activeDocument.setup.reader.ins;t.enabled.setValue(!t.enabled.value),this.analytics.sendProperty("Reader_Enabled",t.enabled.value)}onToggleNarration(){const t=this.activeDocument.setup.audio;t.setupAudio(),t.ins.playNarration.set()}onToggleAnnotations(){const t=this.activeDocument.setup.viewer.ins;t.annotationsVisible.setValue(!t.annotationsVisible.value),this.analytics.sendProperty("Annotations_Visible",t.annotationsVisible.value)}onActiveDocument(t,e){if(t&&(this.documentProps.off(),this.arManager.outs.isPlaced.off("value",this.onUpdate,this),this.arManager.outs.isPresenting.off("value",this.onUpdate,this)),e){const t=e.setup;this.documentProps.on(t.viewer.ins.annotationsVisible,t.audio.outs.narrationPlaying),this.arManager.outs.isPlaced.on("value",this.onUpdate,this),this.arManager.outs.isPresenting.on("value",this.onUpdate,this)}this.requestUpdate()}};K=W([(0,N.EM)("sv-ar-menu")],K);const X=K;var Y=i(3600),J=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let Z=class extends N.Ay{constructor(){super(...arguments),this.sceneView=null,this.captionView=null,this.documentProps=new h.A("value",this.onUpdate,this),this.isMobile=null,this.assetPath=""}get analytics(){return this.system.getMainComponent(d.A)}get assetManager(){return this.system.getMainComponent(p.A)}get reader(){return this.activeDocument?this.activeDocument.setup.reader:null}get tours(){return this.activeDocument?this.activeDocument.setup.tours:null}get navigation(){return this.activeDocument?this.activeDocument.setup.navigation:null}get renderer(){return this.system.getMainComponent(Q.A)}get arManager(){return this.system.getMainComponent(s.A)}get assetReader(){return this.system.getMainComponent(Y.A)}firstConnected(){this.classList.add("sv-content-view"),this.sceneView=new I(this.system),this.captionView=new V(this.system),this.isMobile=this.mobileCheck()}connected(){super.connected(),this.assetManager.outs.busy.on("value",this.onUpdate,this),this.sceneView.on("layout",()=>this.onUpdate()),this.assetPath=this.assetReader.getSystemAssetUrl("")}disconnected(){this.sceneView.off("layout",()=>this.onUpdate()),this.assetManager.outs.busy.off("value",this.onUpdate,this),super.disconnected()}render(){const t=this.system,e=this.assetManager.outs.busy.value,i=this.assetManager.initialLoad;let n=!1,s=u.Yf.Overlay,r=!1,o=!1;const a=this.reader,l=this.tours,c=this.navigation,h=this.arManager.shadowRoot.querySelector("ff-viewport-overlay");if(h&&(null===this.arManager.shadowRoot.querySelector("sv-ar-prompt-container")&&h.append(new H(this.system)),null===this.arManager.shadowRoot.querySelector("sv-ar-menu")&&h.append(new X(this.system))),l&&(r=l.ins.enabled.value&&-1===l.outs.tourIndex.value),a&&(n=!r&&a.ins.enabled.value&&a.ins.visible.value,s=a.ins.position.getValidatedValue(),!0===this.isMobile&&(s=u.Yf.Overlay)),c){const t=c.ins.pointerEnabled.value,s=c.ins.promptEnabled.value;if(t&&s){const t=c.ins.isInUse.value;o=!e&&i&&!t&&!n,c.ins.promptActive.setValue(o)}}const d=this.sceneView,p=this.captionView;if((n&&s===u.Yf.Overlay||r)&&this.sceneView.getView().layout==m.y.Single?d.classList.contains("sv-blur")||setTimeout(()=>{d.classList.add("sv-blur"),this.renderer.views[0].render()},1):d.classList.remove("sv-blur"),!e&&i&&(this.analytics.sendProperty("Loading_Time",this.analytics.getTimerTime()/1e3),this.analytics.resetTimer(),this.assetManager.initialLoad=!1),n){if(s===u.Yf.Right)return N.qy`<div class="ff-fullsize sv-content-split">
                    <div class="ff-splitter-section" style="flex-basis: 60%">
                        ${d}
                    </div>
                    <ff-splitter direction="horizontal"></ff-splitter>
                        <div class="ff-splitter-section" style="flex-basis: 40%; max-width: 500px;">
                            <div class="sv-reader-container">
                                <sv-reader-view .system=${t} @close=${this.onReaderClose} ></sv-reader-view>
                            </div>
                        </div>
                    </div>
                    <sv-spinner ?visible=${e} .assetPath=${this.assetPath}></sv-spinner>
                    ${p}`;if(s===u.Yf.Overlay)return N.qy`<div class="ff-fullsize sv-content-stack">${d}
                    <div class="sv-reader-container">
                        <sv-reader-view .system=${t} @close=${this.onReaderClose}></sv-reader-view>
                    </div>
                    <sv-spinner ?visible=${e} .assetPath=${this.assetPath}></sv-spinner>
                    ${p}
                    </div>`}return N.qy`<div class="ff-fullsize sv-content-only">${d}</div>
            <sv-spinner ?visible=${e&&i} .assetPath=${this.assetPath}></sv-spinner>
            ${p}
            ${o?N.qy`<sv-action-prompt></sv-action-prompt>`:null}`}onReaderClose(){this.reader.ins.enabled.setValue(!1),this.reader.ins.closed.set()}onActiveDocument(t,e){t&&this.documentProps.off(),e&&this.documentProps.on(e.setup.reader.ins.position,e.setup.reader.ins.enabled,e.setup.tours.outs.tourIndex,e.setup.navigation.ins.isInUse),this.requestUpdate()}mobileCheck(){var t,e=!1;return t=navigator.userAgent||navigator.vendor,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e}};Z=J([(0,N.EM)("sv-content-view")],Z);const tt=Z;var et=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let it=class extends o.Ay{constructor(){super(),this.mode="radio",this.selectionIndex=-1,this.observer=new MutationObserver(this.onObserver),this.selectedButton=null,this.addEventListener("click",t=>this.onClick(t))}firstConnected(){this.classList.add("ff-button-group"),this.parseChildren()}connected(){this.observer.observe(this,{childList:!0})}disconnected(){this.observer.disconnect()}onObserver(t){t.forEach(t=>{"childList"===t.type&&this.parseChildren()})}onClick(t){let e=t.target;for(;e&&e!==this&&!(e instanceof D.A);)e=e.parentElement;e instanceof D.A&&(e.selected?"exclusive"===this.mode&&(e.selected=!1,this.selectedButton=null,this.selectionIndex=-1):(this.selectedButton&&(this.selectedButton.selected=!1),this.selectedButton=e,this.selectedButton.selected=!0,this.selectionIndex=this.getButtons().indexOf(e)))}parseChildren(){const t=this.getButtons();this.selectedButton&&(this.selectionIndex=t.indexOf(this.selectedButton),this.selectionIndex<0&&(this.selectedButton.selected=!1,this.selectedButton=null)),(this.selectionIndex<0||this.selectionIndex>=t.length)&&(this.selectionIndex="radio"===this.mode?0:-1),this.selectionIndex>=0&&(this.selectedButton=t[this.selectionIndex],this.selectedButton.selected=!0)}getButtons(){return this.getChildrenArray().filter(t=>t instanceof D.A)}};et([(0,o.MZ)({type:String})],it.prototype,"mode",void 0),et([(0,o.MZ)({type:Number})],it.prototype,"selectionIndex",void 0),it=et([(0,o.EM)("ff-button-group")],it);var nt,st=i(6233),rt=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let ot=nt=class extends o.Ay{constructor(){super(...arguments),this.assetPath=""}firstConnected(){super.firstConnected(),this.classList.add("sv-logo")}render(){const t=o.qy`<div class="sv-logo-sm"><object tabIndex="-1" data="${this.assetPath}images/logo-sm.svg" type="image/svg+xml" alt="Logo"></div>
            ${nt.defaultSmall}
        </object></div>`,e=o.qy`<div class="sv-logo-full"><object tabIndex="-1" style="height: 100%; width:100%" data="${this.assetPath}images/logo-full.svg" type="image/svg+xml" alt="Logo">
            ${nt.defaultFull}
        </object></div>`;return o.qy`<div class="sv-short">${t}</div><div class="sv-full">${e}</div>`}};ot.defaultSmall=o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 83.1 83.1"><defs><style>.cls-1{fill:#bfbfbf;}</style></defs><title>voyager-75grey</title><path class="cls-1" d="M72.18,13.48,67.1,18.57c.5,3.19,1.23,12.48-4.76,23L42.66,21.89c10.21-5.84,19.21-5.31,22.68-4.8l5.25-5.25a41.5,41.5,0,1,0,1.59,1.64ZM7.48,52.91s-2.35-12.84,9-24.14c6.6-6.6,14.83-1.45,14.83-1.45A98.12,98.12,0,0,0,17.51,48.47C10.19,49.11,7.48,52.91,7.48,52.91Zm13.83,15.5V65.7l-6,3.07,2.81-6.24-3.53,1.18,2.53-6,9.31,9.31Zm34.17-.59c-11.3,11.3-24.14,9-24.14,9s3.8-2.71,4.43-10A97.8,97.8,0,0,0,56.93,53S62.08,61.22,55.48,67.82ZM54.7,51.5c-5.88,5.88-24.82,15.88-24.82,15.88l-13-13s9.9-18.86,15.86-24.82a48.27,48.27,0,0,1,8-6.47L61.16,43.48A47.53,47.53,0,0,1,54.7,51.5Z"/><path class="cls-1" d="M39.34,44.88a5.88,5.88,0,1,0,0-8.32A5.9,5.9,0,0,0,39.34,44.88Z"/></svg>`,ot.defaultFull=o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 380.54 83.1"><defs><style>.cls-1{fill:#bfbfbf;}</style></defs><title>voyager-75grey</title><path class="cls-1" d="M72.18,13.48,67.1,18.57c.5,3.19,1.23,12.48-4.76,23L42.66,21.89c10.21-5.84,19.21-5.31,22.68-4.8l5.25-5.25a41.5,41.5,0,1,0,1.59,1.64ZM7.48,52.91s-2.35-12.84,9-24.14c6.6-6.6,14.83-1.45,14.83-1.45A98.12,98.12,0,0,0,17.51,48.47C10.19,49.11,7.48,52.91,7.48,52.91Zm13.83,15.5V65.7l-6,3.07,2.81-6.24-3.53,1.18,2.53-6,9.31,9.31Zm34.17-.59c-11.3,11.3-24.14,9-24.14,9s3.8-2.71,4.43-10A97.8,97.8,0,0,0,56.93,53S62.08,61.22,55.48,67.82ZM54.7,51.5c-5.88,5.88-24.82,15.88-24.82,15.88l-13-13s9.9-18.86,15.86-24.82a48.27,48.27,0,0,1,8-6.47L61.16,43.48A47.53,47.53,0,0,1,54.7,51.5Z"/><path class="cls-1" d="M39.34,44.88a5.88,5.88,0,1,0,0-8.32A5.9,5.9,0,0,0,39.34,44.88Z"/><path class="cls-1" d="M131.52,23l-10.26,43.7h-13.4L97.6,23H92V16.42h21.64V23h-5.51l6.42,34.9,7.68-41.46h14.94V23Z"/><path class="cls-1" d="M154.82,67.38c-7.53,0-17.45-2.24-17.45-25.83s10.54-25.83,17.45-25.83,17.46,2.37,17.46,25.83C172.28,65.35,162.15,67.38,154.82,67.38Zm0-44.68c-4.88,0-7.68,3.91-7.68,18.85,0,15.15,3.57,18.85,7.68,18.85,4.26,0,7.68-3.49,7.68-18.85C162.5,26.89,159.57,22.7,154.82,22.7Z"/><path class="cls-1" d="M209.72,23,198.9,48.11v12h7.68v6.56H181.45V60.12h7.68v-12L178.31,23h-5.59V16.42h21V23h-4.81L194,37.92l7.4-21.5h14V23Z"/><path class="cls-1" d="M243.67,66.68,241,54.39H228.6l-1.26,5.73h5.51v6.56H211.63V60.12h5.59L228,16.42h13.68l10.75,43.7h5.65v6.56ZM234.81,24l-4.68,22.83h9.36Z"/><path class="cls-1" d="M278.63,67.38c-9.56,0-19.68-3.21-19.68-25.13s11.31-26.53,21-26.53a32,32,0,0,1,13.89,3.21V30.1h-6.56V24.66A28.73,28.73,0,0,0,280,23.61c-5,0-11.24,3.35-11.24,17.94,0,15.43,5.37,18,9.77,18a27.39,27.39,0,0,0,5.59-.63V44.13h-6.63V36.66h16.4v28.9A88.21,88.21,0,0,1,278.63,67.38Z"/><path class="cls-1" d="M298.93,66.68V60.12h6.28V23h-6.28V16.42h33.51V30.1h-6.56V24.73H315V36.66h14.66V44.2H315V58.37h10.89V52.3h6.56V66.68Z"/><path class="cls-1" d="M366.78,66.68l-8.3-21.78h-5.1V60.12H359v6.56H337.33V60.12h6.28V23h-6.28V16.42h20.38c10.47,0,17.31,2.65,17.31,13.47,0,5.66-1.6,10.19-7.61,12.85L375,60.12h5.59v6.56Zm-9.56-42.51h-3.84V38.06c8.31,0,11.87-1.89,11.87-7.47C365.25,26.47,363.43,24.17,357.22,24.17Z"/></svg>`,rt([(0,o.MZ)({type:String})],ot.prototype,"assetPath",void 0),ot=nt=rt([(0,o.EM)("sv-logo")],ot);var at,lt=i(9616),ct=i(7297),ht=i(3818),ut=(i(9264),function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o});let dt=at=class extends ht.Ay{static show(t,e){const i=new at(t,e);return t.appendChild(i),new Promise((t,e)=>{i.on("close",()=>t())})}constructor(t,e){super(),this.language=null,this.needsFocus=!1,this.language=e,this.position="center",this.portal=t,this.modal=!0,this.url=window.location.href}close(){this.dispatchEvent(new CustomEvent("close")),this.remove()}firstConnected(){super.firstConnected(),this.classList.add("sv-share-menu"),this.needsFocus=!0}render(){const t=encodeURIComponent(this.url),e=encodeURI("Check out this interactive 3D model with Smithsonian Voyager:"),i=this.language,n=`http://twitter.com/share?text=${e}&url=${t}`,s=`https://www.facebook.com/sharer/sharer.php?u=${t}`,r=`https://www.linkedin.com/shareArticle?url=${t}&mini=true&title=${e}`,o=`<iframe name="Smithsonian Voyager" src="${this.url}" width="800" height="450" allow="xr; xr-spatial-tracking; fullscreen"></iframe>`,a=`mailto:?subject=${e}&body=${t}`,l=i.getLocalizedString("Share Experience");return ht.qy`
        <div role="region" aria-label=${l} @keydown=${t=>this.onKeyDown(t)}>
            <div class="ff-flex-row">
                <div id="shareTitle" class="ff-flex-spacer ff-title">${l}</div>
                <ff-button icon="close" transparent class="ff-close-button" title=${i.getLocalizedString("Close")} @click=${this.close}></ff-button>
            </div>
            <div class="ff-flex-row sv-share-buttons">
                <a href=${n} tabindex="-1" target="_blank" rel="noopener noreferrer"><ff-button class="sv-share-button-twitter" icon="twitter" title="Twitter"></ff-button></a>
                <a href=${s} tabindex="-1" target="_blank" rel="noopener noreferrer"><ff-button class="sv-share-button-facebook" icon="facebook" title="Facebook"></ff-button></a>
                <a href=${r} tabindex="-1" target="_blank" rel="noopener noreferrer"><ff-button class="sv-share-button-linkedin" icon="linkedin" title="LinkedIn"></ff-button></a>
                <a href=${a} tabindex="-1" target="_blank"><ff-button class="sv-share-button-email" icon="email" title=${i.getLocalizedString("Email")}></ff-button></a>
            </div>
            <div class="ff-title" id="embedTitle">${i.getLocalizedString("Embed Link")}</div>
            <div class="ff-flex-row sv-embed-link">
                <ff-text-edit readonly aria-labelledby="embedTitle" text=${o}></ff-text-edit>
                <ff-button icon="copy" title=${i.getLocalizedString("Copy link to Clipboard")} @click=${this.onClickCopy}></ff-button>
            </div>
        </div>
        `}update(t){if(super.update(t),this.needsFocus){this.getElementsByClassName("sv-share-button-twitter").item(0).focus(),this.needsFocus=!1}}onClickCopy(){this.getElementsByTagName("ff-text-edit").item(0).select(),document.execCommand("copy")}onKeyDown(t){"Escape"===t.code?(t.preventDefault(),this.close()):"Tab"===t.code&&(0,E.i)((0,E.R)(this),t)}};dt=at=ut([(0,ht.EM)("sv-share-menu")],dt);const pt=dt;var ft,gt=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let mt=ft=class extends ht.Ay{static show(t,e,i){const n=new ft(t,e,i);return t.appendChild(n),new Promise((t,e)=>{n.on("close",()=>t())})}constructor(t,e,i){super(),this.language=null,this.imageUri=null,this.needsFocus=!1,this.language=e,this.imageUri=i,this.position="center",this.portal=t,this.modal=!0,this.url=window.location.href}close(){this.dispatchEvent(new CustomEvent("close")),this.remove()}firstConnected(){super.firstConnected(),this.classList.add("sv-ar-code"),this.needsFocus=!0}render(){const t=this.language,e=t.getLocalizedString("AR Experience");return ht.qy`
        <div role="region" aria-label=${e} @keydown=${t=>this.onKeyDown(t)}>
            <div class="ff-flex-row">
                <div id="arCodeTitle" class="ff-flex-spacer ff-title">${e}</div>
                <ff-button icon="close" transparent class="ff-close-button" title=${t.getLocalizedString("Close")} @click=${this.close}></ff-button>
            </div>
            <div class="ff-title" id="embedTitle">${t.getLocalizedString("1. Scan the code with your mobile device to return here.")}</div>
            <div class="ff-flex-row">
                <img src=${this.imageUri}></img>
            </div>
            <div class="ff-title">${t.getLocalizedString("2. Tap ")}<ff-icon name="ar"></ff-icon>${t.getLocalizedString(" to launch an AR experience! ")}</div>
        </div>
        `}update(t){if(super.update(t),this.needsFocus){this.getElementsByClassName("ff-close-button").item(0).focus(),this.needsFocus=!1}}onKeyDown(t){"Escape"===t.code?(t.preventDefault(),this.close()):"Tab"===t.code&&(0,E.i)((0,E.R)(this),t)}};mt=ft=gt([(0,ht.EM)("sv-ar-code")],mt);const At=mt;var vt=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let yt=class extends N.Ay{constructor(){super(...arguments),this.documentProps=new h.A("value",this.onUpdate,this),this.shareButtonSelected=!1,this.resizeObserver=null,this.isClipped=!1}get fullscreen(){return this.system.getMainComponent(n.A)}get toolProvider(){return this.system.getMainComponent(st.A)}get analytics(){return this.system.getMainComponent(d.A)}get arManager(){return this.system.getMainComponent(s.A)}get sceneNode(){return this.system.getComponent($.A)}firstConnected(){super.firstConnected(),this.classList.add("sv-main-menu")}connected(){super.connected(),this.fullscreen.outs.fullscreenActive.on("value",this.onUpdate,this),this.toolProvider.ins.visible.on("value",this.onUpdate,this),this.activeDocument.setup.language.outs.activeLanguage.on("value",this.onUpdate,this),this.activeDocument.setup.audio.outs.narrationEnabled.on("value",this.onUpdate,this),this.activeDocument.setup.tours.ins.closed.on("value",this.setTourFocus,this),this.activeDocument.setup.reader.ins.closed.on("value",this.setReaderFocus,this),this.activeDocument.setup.viewer.ins.annotationExit.on("value",this.setAnnotationFocus,this),this.toolProvider.ins.closed.on("value",this.setToolsFocus,this),this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>this.onResize())),this.resizeObserver.observe(this)}disconnected(){this.resizeObserver.disconnect(),this.toolProvider.ins.closed.off("value",this.setToolsFocus,this),this.activeDocument.setup.viewer.ins.annotationExit.off("value",this.setAnnotationFocus,this),this.activeDocument.setup.reader.ins.closed.off("value",this.setReaderFocus,this),this.activeDocument.setup.tours.ins.closed.off("value",this.setTourFocus,this),this.activeDocument.setup.audio.outs.narrationEnabled.off("value",this.onUpdate,this),this.activeDocument.setup.language.outs.activeLanguage.off("value",this.onUpdate,this),this.toolProvider.ins.visible.off("value",this.onUpdate,this),this.fullscreen.outs.fullscreenActive.off("value",this.onUpdate,this),super.disconnected()}render(){const t=this.activeDocument;if(!t)return N.qy``;const e=!!this.system.getComponent("CVStoryApplication",!0),i=t.setup,n=this.sceneNode,s=i.tours.outs.count.value>0,r=i.tours.ins.enabled.value,o=r&&!e,a=i.reader.articles.length>0,l=i.reader.ins.enabled.value,c=n.getGraphComponents(q.A).some(t=>t.hasAnnotations),h=i.viewer.ins.annotationsVisible.value,u=this.fullscreen,d=u.outs.fullscreenAvailable.value,p=u.outs.fullscreenActive.value,f=i.interface.ins.tools.value,g=this.toolProvider.ins.visible.value,m=i.audio.outs.narrationEnabled.value,A=i.audio.outs.narrationPlaying.value,v=i.language,y=n.getGraphComponents(lt.A);let b=!1;y.forEach(t=>{b=t.derivatives.getByQuality(ct.a9.AR).length>0||b});const _=(this.arManager.outs.available.value||this.arManager.arCodeImage)&&b&&y.length>=1;return N.qy`
            ${_?N.qy`<ff-button icon="ar" id="ar-btn" title=${v.getLocalizedString("Enter AR View")}
                @click=${this.onEnterAR}></ff-button>`:null}
            ${m?N.qy`<ff-button icon="audio" id="audio-btn" title=${v.getLocalizedString("Play Audio Narration")}
                ?selected=${A} @click=${this.onToggleNarration}></ff-button>`:null}
            ${s?N.qy`<ff-button id="tour-btn" icon="globe" title=${v.getLocalizedString("Interactive Tours")}
                ?selected=${r} @click=${this.onToggleTours}></ff-button>`:null}
            ${a?N.qy`<ff-button id="reader-btn" icon="article" title=${v.getLocalizedString("Read Articles")}
                ?selected=${l} ?disabled=${o} @click=${this.onToggleReader}></ff-button>`:null}
            ${c?N.qy`<ff-button aria-pressed=${h} id="anno-btn" icon="comment" title=${v.getLocalizedString("Show/Hide Annotations")}
                ?selected=${h} ?disabled=${o} @click=${this.onToggleAnnotations}></ff-button>`:null}
            <ff-button icon="share" id="share-btn" title=${v.getLocalizedString("Share Experience")}
                ?selected=${this.shareButtonSelected} @click=${this.onToggleShare}></ff-button>    
            ${d?N.qy`<ff-button id="fullscreen-btn" aria-pressed=${p} icon="expand" title=${v.getLocalizedString("Fullscreen")}
                ?selected=${p} @click=${this.onToggleFullscreen}></ff-button>`:null}
            ${f?N.qy`<ff-button id="tools-btn" icon="tools" title=${v.getLocalizedString("Tools and Settings")}
                ?selected=${g} ?disabled=${o} @click=${this.onToggleTools}></ff-button>`:null}`}onToggleReader(){const t=this.activeDocument.setup.reader,e=t.ins;e.enabled.setValue(!e.enabled.value),e.focus.setValue(e.enabled.value),e.enabled.value&&e.articleId.setValue(1===t.articles.length?t.articles[0].article.id:""),this.analytics.sendProperty("Reader_Enabled",e.enabled.value)}onToggleTours(){const t=this.activeDocument.setup.tours.ins,e=this.activeDocument.setup.reader.ins;t.enabled.value?t.enabled.setValue(!1):(e.enabled.value&&e.enabled.setValue(!1),t.enabled.setValue(!0),t.tourIndex.setValue(-1)),this.analytics.sendProperty("Tours_Enabled",t.enabled.value)}onToggleAnnotations(){const t=this.toolProvider.ins,e=this.activeDocument.setup.viewer.ins;t.visible.value&&t.visible.setValue(!1),e.annotationsVisible.setValue(!e.annotationsVisible.value),e.annotationFocus.setValue(!0),this.analytics.sendProperty("Annotations_Visible",e.annotationsVisible.value)}onToggleShare(){if(!this.shareButtonSelected){this.shareButtonSelected=!0,this.requestUpdate();const t=this.closest("sv-chrome-view");pt.show(t,this.activeDocument.setup.language).then(()=>{this.shareButtonSelected=!1,this.requestUpdate(),this.setElementFocus("share-btn")}),this.analytics.sendProperty("Menu_Share")}}onToggleFullscreen(){this.fullscreen.toggle(),this.analytics.sendProperty("Menu_Fullscreen")}onToggleTools(){const t=this.toolProvider.ins,e=this.activeDocument.setup.viewer.ins;e.annotationsVisible.value&&e.annotationsVisible.setValue(!1),t.visible.setValue(!t.visible.value),this.analytics.sendProperty("Tools_Visible",t.visible.value)}onEnterAR(){const t=this.arManager,e=t.ins;if(t.outs.available.value)e.enabled.setValue(!0);else{const e=this.closest("sv-chrome-view");At.show(e,this.activeDocument.setup.language,t.arCodeImage).then(()=>{this.setElementFocus("ar-btn")})}}onToggleNarration(){const t=this.activeDocument.setup.audio;t.setupAudio(),t.ins.playNarration.set()}setTourFocus(){this.setElementFocus("tour-btn")}setReaderFocus(){this.setElementFocus("reader-btn")}setToolsFocus(){this.setElementFocus("tools-btn")}setAnnotationFocus(){this.setElementFocus("anno-btn")}setElementFocus(t){const e=this.getElementsByTagName("ff-button"),i=Array.from(e).find(e=>e.id===t);void 0!==i?i.focus():console.warn("Can't focus. Element ["+t+"] not found.")}onActiveDocument(t,e){if(t&&this.documentProps.off(),e){const t=e.setup;this.documentProps.on(t.interface.ins.tools,t.reader.ins.enabled,t.reader.outs.count,t.tours.ins.enabled,t.tours.outs.count,t.viewer.ins.annotationsVisible,t.audio.outs.narrationPlaying,this.toolProvider.ins.visible)}this.requestUpdate()}onResize(){const t=this.scrollHeight>this.clientHeight;this.isClipped!==t&&(t&&this.scrollTo({top:this.scrollTop+this.scrollHeight,behavior:"smooth"}),this.isClipped=t)}};yt=vt([(0,N.EM)("sv-main-menu")],yt);var bt=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let _t=class extends A.Ay{constructor(){super(...arguments),this.needsFocus=!1}get toolProvider(){return this.system.getMainComponent(st.A)}get setup(){return this.system.getComponent(w.A)}firstConnected(){super.firstConnected(),this.classList.add("sv-bottom-bar-container","sv-tool-bar"),this.needsFocus=!0}connected(){super.connected(),this.toolProvider.on("active-component",this.onUpdate,this),this.setup.language.outs.activeLanguage.on("value",this.onUpdate,this),this.setup.navigation.ins.mode.on("value",this.onUpdate,this)}disconnected(){this.setup.navigation.ins.mode.off("value",this.onUpdate,this),this.setup.language.outs.activeLanguage.off("value",this.onUpdate,this),this.toolProvider.off("active-component",this.onUpdate,this),super.disconnected()}render(){const t=this.toolProvider.scopedComponents,e=this.toolProvider.activeComponent,i=this.setup.language,n=(e&&A.qy`<div>`,t.map(t=>t.enabled?A.qy`<ff-button class="sv-tool-button" transparent text=${i.getLocalizedString(t.text)} icon=${t.icon}
                ?selected=${t===e} @click=${e=>this.onSelectTool(t)}></ff-button>`:null));return A.qy`<div class="sv-blue-bar"><div id="toolmenu" role="region" aria-label=${e?e.text:null} @close=${this.closeTool} @keydown=${t=>this.onKeyDownTool(t)}>${e?e.createView():null}</div>
            <div id="mainmenu" role="region" @keydown=${t=>this.onKeyDownMain(t)} aria-label="Tools and settings" class="sv-section">
                <ff-button class="sv-section-lead" transparent icon="close" title=${i.getLocalizedString("Close Tools")} @click=${this.onClose}></ff-button>
                <div class="sv-tool-buttons">${n}</div>
                <sv-tool-menu-view .system=${this.system}></sv-tool-menu-view>
            </div></div>`}onSelectTool(t){this.toolProvider.activeComponent=t}onClose(t){this.dispatchEvent(new CustomEvent("close")),t.stopPropagation()}update(t){if(super.update(t),this.needsFocus){this.getElementsByClassName("sv-tool-button").item(0).focus(),this.needsFocus=!1}}onKeyDownMain(t){if("Escape"===t.code)t.preventDefault(),this.dispatchEvent(new CustomEvent("close"));else if("Tab"===t.code){const e=Array.from(this.getElementsByTagName("div")).find(t=>"mainmenu"===t.id);(0,E.i)((0,E.R)(e),t)}}onKeyDownTool(t){if("Escape"===t.code)t.preventDefault(),this.closeTool();else if("Tab"===t.code){const e=Array.from(this.getElementsByTagName("div")).find(t=>"toolmenu"===t.id);(0,E.i)((0,E.R)(e),t)}}closeTool(){const t=this.getElementsByTagName("ff-button");Array.from(t).find(t=>t.getAttribute("text")===this.setup.language.getLocalizedString(this.toolProvider.activeComponent.text)).focus(),this.toolProvider.activeComponent=null}};_t=bt([(0,A.EM)("sv-tool-bar")],_t);var xt=i(5007),wt=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let Et=class extends N.Ay{constructor(){super(...arguments),this.needsFocus=!1,this.firstRender=!0,this.stepTitle=""}firstConnected(){super.firstConnected(),this.classList.add("sv-bottom-bar-container","sv-tour-navigator"),this.needsFocus=!0}render(){const t=this.tours,e=this.language,i=this.interface,n=t.activeTour;let s,r;if(t&&n){const i=t.outs.stepIndex.value+1,n=t.outs.stepCount.value;s=n>0?t.stepTitle:t.title,r=n>0?`${e.getLocalizedString("Step")} ${i} ${e.getLocalizedString("of")} ${n}`:e.getLocalizedString("No tour steps defined")}else s=e.getLocalizedString("No tour selected"),r="---";this.stepTitle=s,this.firstRender&&(s="");const o=i.isShowing(xt.T.tour_exit)?N.qy`<ff-button class="sv-section-lead" transparent icon="close" title=${e.getLocalizedString("Exit Tour")} ?disabled=${!n} @click=${this.onClickExit}></ff-button>`:null;return N.qy`<div class="sv-blue-bar" role=region title="Tour Navigation" @keydown=${t=>this.onKeyDown(t)}><div class="sv-section">
            ${o}
            <div class="ff-ellipsis sv-content" id="title-area" aria-live="polite" aria-atomic="true" aria-relevant="additions text" @click=${this.onClickTitle}>
                <div class="ff-ellipsis" id="title-text"><div class="ff-ellipsis sv-title" id="title-inner">${s}</div></div>
                <div class="ff-ellipsis sv-text">${r}</div>
            </div>
            <ff-button class="sv-section-trail" transparent icon="bars" title=${e.getLocalizedString("Show Tour Menu")} @click=${this.onClickMenu}></ff-button>
            <ff-button class="sv-section-trail" transparent icon="triangle-left" title=${e.getLocalizedString("Go Backward")} ?disabled=${!n} @click=${this.onClickPrevious}></ff-button>
            <ff-button class="sv-section-trail" transparent icon="triangle-right" title=${e.getLocalizedString("Go Forward")} ?disabled=${!n} @click=${this.onClickNext}></ff-button>
        </div></div>`}updated(t){if(super.updated(t),this.needsFocus){this.getElementsByClassName("sv-section-trail").item(2).focus(),this.needsFocus=!1}const e=this.getElementsByClassName("sv-title").item(0);e&&(this.firstRender?(setTimeout(()=>{e.innerText=this.stepTitle},100),this.firstRender=!1):e.innerText=this.stepTitle)}onClickExit(){this.tours.ins.enabled.setValue(!1),this.tours.ins.closed.set()}onClickMenu(){this.tours.ins.tourIndex.setValue(-1)}onClickPrevious(){this.tours.ins.previous.set();this.querySelector("#title-inner").classList.remove("sv-text-scroll")}onClickNext(){this.tours.ins.next.set();this.querySelector("#title-inner").classList.remove("sv-text-scroll")}onClickTitle(){this.textHelper()}onActiveDocument(t,e){t&&(this.tours.outs.tourIndex.off("value",this.onUpdate,this),this.tours.outs.stepIndex.off("value",this.onUpdate,this),this.language.outs.activeLanguage.off("value",this.onUpdate,this)),e&&(this.tours=e.setup.tours,this.language=e.setup.language,this.interface=e.setup.interface,this.tours.outs.tourIndex.on("value",this.onUpdate,this),this.tours.outs.stepIndex.on("value",this.onUpdate,this),this.language.outs.activeLanguage.on("value",this.onUpdate,this)),this.requestUpdate()}onKeyDown(t){"Escape"===t.code?(t.preventDefault(),this.tours.ins.tourIndex.setValue(-1)):"Tab"===t.code&&(0,E.i)((0,E.R)(this),t)}textHelper(){const t=this.querySelector("#title-inner"),e=t.scrollWidth-t.offsetWidth+12;if(e>12){const i=this.querySelector("#title-area"),n=e/30;t.classList.remove("ff-ellipsis"),t.style.setProperty("animation-duration",n.toString()+"s"),t.style.setProperty("--x-offset","-"+e+"px"),i.style.setProperty("pointer-events","none"),t.classList.add("sv-text-scroll"),t.addEventListener("animationend",()=>{t.classList.remove("sv-text-scroll"),t.classList.add("ff-ellipsis"),i.style.setProperty("pointer-events","auto")}),t.addEventListener("animationcancel",()=>{t.classList.remove("sv-text-scroll"),t.classList.add("ff-ellipsis"),i.style.setProperty("pointer-events","auto")})}}};Et=wt([(0,N.EM)("sv-tour-navigator")],Et);var Ct=i(3675),St=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let It=class extends o.Ay{constructor(){super(...arguments),this.needsFocus=!1,this.focusableElements=[]}firstConnected(){super.firstConnected(),this.classList.add("sv-document-overlay","sv-article","sv-tour-menu"),this.needsFocus=!0}renderEntry(t,e){return o.qy`<div role="option" title="tour entry" tabindex=${0===e?"0":"-1"} @keydown=${t=>this.onKeyDown(t,e)} class="sv-entry" @click=${t=>this.onClickTour(t,e)}>
            <div class="sv-titlebar">              
                <h1>${(0,O._)(Object.keys(t.titles).length>0?t.titles[Ct.aL[this.activeLanguage]]||"Missing content":t.title)}</h1>
                <ff-icon class="ff-off" name="triangle-right">
            </div>
            <p>${(0,O._)(Object.keys(t.leads).length>0&&Object.values(t.leads).find(t=>t)?t.leads[Ct.aL[this.activeLanguage]]||"Missing content":t.lead)}</p>
        </div>`}render(){const t=this.tours;return 0===t.length?o.qy`<div class="sv-entry">
                <h1>No tours available.</h1>
            </div>`:o.qy`<div role="listbox" aria-label="interactive tour menu" class="ff-scroll-y">
            ${t.map((t,e)=>this.renderEntry(t,e))}
        </div>`}update(t){if(super.update(t),this.needsFocus){this.getElementsByClassName("sv-entry").item(0).focus(),this.needsFocus=!1}}onClickTour(t,e){t.stopPropagation(),this.dispatchEvent(new CustomEvent("select",{detail:{index:e}}))}onKeyDown(t,e){if("Space"===t.code||"Enter"===t.code)t.preventDefault(),this.dispatchEvent(new CustomEvent("select",{detail:{index:e}}));else if("Escape"===t.code)t.preventDefault(),this.dispatchEvent(new CustomEvent("close",{detail:{index:e}}));else if("Tab"===t.code)0===this.focusableElements.length&&(this.focusableElements=(0,E.R)(this)),(0,E.i)(this.focusableElements,t);else if("ArrowUp"===t.code||"ArrowDown"===t.code){const e=t.target instanceof Element?t.target:null;if(e){const i="ArrowUp"===t.code?e.previousElementSibling:e.nextElementSibling;i&&(e.setAttribute("tabIndex","-1"),i.setAttribute("tabIndex","0"),i.focus())}}}};St([(0,o.MZ)({attribute:!1})],It.prototype,"tours",void 0),St([(0,o.MZ)({attribute:!1})],It.prototype,"activeLanguage",void 0),It=St([(0,o.EM)("sv-tour-menu")],It);var Mt,Tt=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let Bt=Mt=class extends ht.Ay{static show(t,e){const i=new Mt(t,e);return t.appendChild(i),new Promise((t,e)=>{i.on("close",()=>t())})}constructor(t,e){super(),this.language=null,this.language=e,this.position="center",this.modal=!0,this.portal=t,this.url=window.location.href}close(){this.dispatchEvent(new CustomEvent("close")),this.remove()}firstConnected(){super.firstConnected(),this.classList.add("sv-language-menu","sv-option-menu")}renderEntry(t,e){const i=t.name===this.language.nameString();return ht.qy`<div class="sv-entry" role="option" tabindex=${i?"0":"-1"} @click=${t=>this.onClickLanguage(t,e)} @keydown=${t=>this.onKeyDownEntry(t,e)} ?selected=${i}>
            ${t.name}
        </div>`}render(){const t=this.language;return ht.qy`
        <div role="region" aria-label="Language Menu" @keydown=${t=>this.onKeyDownMain(t)}>
            <div class="ff-flex-row">
                <div class="ff-flex-spacer ff-title">${t.getLocalizedString("Set Language")}</div>
                <ff-button icon="close" transparent class="ff-close-button" title=${t.getLocalizedString("Close")} @click=${this.close}></ff-button>
            </div>
            <div class="ff-flex-row">
                <div class="ff-scroll-y sv-scroll-offset" role="listbox">
                    ${t.sceneLanguages.map((t,e)=>this.renderEntry(t,e))}
                </div>
            </div>
        </div>
        `}firstUpdated(t){super.firstUpdated(t),Array.from(this.getElementsByClassName("sv-entry")).find(t=>"0"===t.getAttribute("tabIndex")).focus()}onClickLanguage(t,e){const i=this.language;t.stopPropagation(),i.ins.activeLanguage.setValue(i.sceneLanguages[e].id),this.close()}onKeyDownEntry(t,e){const i=this.language;if("Space"===t.code||"Enter"===t.code)t.preventDefault(),t.stopPropagation(),i.ins.activeLanguage.setValue(i.sceneLanguages[e].id),this.close();else if("ArrowUp"===t.code||"ArrowDown"===t.code){const e=t.target instanceof Element?t.target:null;if(e){const i="ArrowUp"===t.code?e.previousElementSibling:e.nextElementSibling;i&&(e.setAttribute("tabIndex","-1"),i.setAttribute("tabIndex","0"),i.focus())}}else"Tab"===t.code&&this.addEventListener("blur",this.tabReset,{once:!0,capture:!0})}onKeyDownMain(t){"Escape"===t.code?this.close():"Tab"===t.code&&(0,E.i)((0,E.R)(this),t)}tabReset(t){const e=t.target instanceof Element?t.target:null;if(e){const t=Array.from(e.parentElement.children).find(t=>t.hasAttribute("selected"));t!==e&&(e.setAttribute("tabIndex","-1"),t.setAttribute("tabIndex","0"))}}};Bt=Mt=Tt([(0,ht.EM)("sv-language-menu")],Bt);const Rt=Bt;var Pt=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let Lt=class extends N.Ay{get activeTags(){return this.viewer?this.viewer.ins.activeTags.value.split(",").map(t=>t.trim()).filter(t=>!!t):[]}get tagCloud(){return this.viewer?this.viewer.outs.tagCloud.value.split(",").map(t=>t.trim()).filter(t=>!!t):[]}firstConnected(){super.firstConnected(),this.classList.add("sv-bottom-bar-container","sv-tag-cloud","sv-transition"),setTimeout(()=>this.classList.remove("sv-transition"),1)}render(){const t=this.activeTags,e=this.tagCloud.map(e=>N.qy`<ff-button class="sv-tag-button" transparent text=${e}
                ?selected=${t.indexOf(e)>=0}
                @click=${t=>this.onSelectTag(e)}></ff-button>`);return N.qy`<div class="sv-blue-bar" @keydown=${this.onKeyDown} role="region" aria-label="Tag Cloud Menu"><div class="sv-section">
                <ff-button class="sv-section-lead" transparent icon="close" title="Close Tag Menu" @click=${this.onClickClose}></ff-button>
                <div class="sv-tag-buttons">${e}</div>
        </div></div>`}onClickClose(){this.viewer.ins.annotationsVisible.setValue(!1),this.viewer.ins.annotationExit.set()}onSelectTag(t){let e=this.activeTags;const i=this.viewer.ins.radioTags.value,n=e.indexOf(t);n>=0&&!i?e.splice(n,1):n<0&&(i?e=[t]:e.push(t)),this.viewer.ins.annotationFocus.setValue(!0),this.viewer.ins.activeTags.setValue(e.join(", "))}onActiveDocument(t,e){t&&(this.viewer.ins.activeTags.off("value",this.onUpdate,this),this.viewer.outs.tagCloud.off("value",this.onUpdate,this)),e&&(this.viewer=e.setup.viewer,this.viewer.ins.activeTags.on("value",this.onUpdate,this),this.viewer.outs.tagCloud.on("value",this.onUpdate,this))}onKeyDown(t){"Escape"===t.code?(t.preventDefault(),this.onClickClose()):"Tab"===t.code&&(0,E.i)((0,E.R)(this),t)}};Lt=Pt([(0,N.EM)("sv-tag-cloud")],Lt);var Dt,Nt,Ot=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};!function(t){t[t.Nav=0]="Nav",t[t.Menu=1]="Menu"}(Nt||(Nt={}));let kt=Dt=class extends ht.Ay{static show(t,e,i){const n=new Dt(t,e,i);return t.appendChild(n),new Promise((t,e)=>{n.on("close",()=>t())})}constructor(t,e,i){super(),this.language=null,this.navMode=u.Kd.Orbit,this.helpView=Nt.Nav,this.language=e,this.navMode=i,this.position="center",this.modal=!0,this.portal=t,this.url=window.location.href}close(){this.dispatchEvent(new CustomEvent("close")),this.remove()}firstConnected(){super.firstConnected(),this.classList.add("sv-main-help")}render(){const t=this.language,e=this.navMode===u.Kd.Orbit,i=this.helpView,n=!!this.parentElement.querySelector("#ar-btn"),s=!!this.parentElement.querySelector("#audio-btn"),r=!!this.parentElement.querySelector("#tour-btn"),o=!!this.parentElement.querySelector("#reader-btn"),a=!!this.parentElement.querySelector("#anno-btn"),l=!!this.parentElement.querySelector("#fullscreen-btn"),c=!!this.parentElement.querySelector("#tools-btn"),h=ht.qy`<div class="sv-help-text">Ctrl + ${Dt.arrowKeysUD}Arrow keys</div>`,d=ht.qy`<div class="sv-help-row" aria-live="polite" aria-atomic="true">
                                    <div class="sv-help-section">
                                        <ff-icon class="ff-off" name="rotate"></ff-icon>
                                        <div class="sv-help-text"><b>${e?"Orbit":"Look Around"}</b></div>
                                        <div class="sv-help-text">${Dt.leftClick}Left-click and drag</div>
                                        <div class="sr-only"> Or.</div>
                                        <div class="sv-help-text">${Dt.oneFinger}One-finger drag</div>
                                        <div class="sr-only"> Or.</div>
                                        <div class="sv-help-text">${e?Dt.arrowKeys:Dt.arrowKeysLR}Arrow keys</div>
                                        ${e?null:h}
                                    </div>
                                    <div class="sv-help-section">
                                        <ff-icon class="ff-off" name="move"></ff-icon>
                                        <div class="sv-help-text"><b>Pan</b></div>
                                        <div class="sv-help-text">${Dt.rightClick}Right-click and drag</div>
                                        <div class="sr-only"> Or.</div>
                                        <div class="sv-help-text">${Dt.twoFinger}Two-finger drag</div>
                                        <div class="sr-only"> Or.</div>
                                        <div class="sv-help-text">Shift + ${Dt.arrowKeys}Arrow keys</div>
                                    </div>
                                    <div class="sv-help-section">
                                        <ff-icon class="ff-off" name="zoom"></ff-icon>
                                        <div class="sv-help-text"><b>${e?"Zoom":"Forward/Backward"}</b></div>
                                        <div class="sv-help-text">${Dt.mouseWheel}Mouse wheel</div>
                                        <div class="sr-only"> Or.</div>
                                        <div class="sv-help-text">${Dt.pinch}Two-finger pinch</div>
                                        <div class="sr-only"> Or.</div>
                                        <div class="sv-help-text">${e?"Ctrl + ":""}${e?Dt.arrowKeys:Dt.arrowKeysUD}Arrow keys</div>
                                    </div>
                                    <div id="sr-trigger" class="sr-only"></div>
                                </div>`,p=ht.qy`<div class="sv-help-text">The tools below can be accessed by clicking the corresponding icons on the menu bar to the left of the screen.</div>
                                <div class="sv-help-row">
                                    ${n?ht.qy`<div class="sv-help-section sv-help-short">
                                        <ff-icon title="AR." class="ff-off" name="ar"></ff-icon>
                                        <div class="sv-help-text">Launch an augmented<br>reality experience.</div>
                                    </div>`:""}
                                    ${s?ht.qy`<div class="sv-help-section sv-help-short">
                                        <ff-icon title="Play Narration." class="ff-off" name="audio"></ff-icon>
                                        <div class="sv-help-text">Hear an audio<br>narration of the scene.</div>
                                    </div>`:""}
                                    ${r?ht.qy`<div class="sv-help-section sv-help-short">
                                        <ff-icon title="Tours." class="ff-off" name="globe"></ff-icon>
                                        <div class="sv-help-text">Take a curated guided<br>tour of the scene.</div>
                                    </div>`:""}                       
                                    ${o?ht.qy`<div class="sv-help-section sv-help-short">
                                        <ff-icon title="Articles." class="ff-off" name="article"></ff-icon>
                                        <div class="sv-help-text">Read articles about<br>the scene content.</div>
                                    </div>`:""}
                                    ${a?ht.qy`<div class="sv-help-section sv-help-short">
                                        <ff-icon title="Annotations." class="ff-off" name="comment"></ff-icon>
                                        <div class="sv-help-text">Show annotations<br>highlighting key points.</div>
                                    </div>`:""}
                                    <div class="sv-help-section sv-help-short">
                                        <ff-icon title="Share." class="ff-off" name="share"></ff-icon>
                                        <div class="sv-help-text">Share the experience<br>with a friend!</div>
                                    </div>
                                    ${l?ht.qy`<div class="sv-help-section sv-help-short">
                                        <ff-icon title="Fullscreen." class="ff-off" name="expand"></ff-icon>
                                        <div class="sv-help-text">View the experience<br>in fullscreen mode.</div>
                                    </div>`:""}
                                    ${c?ht.qy`<div class="sv-help-section sv-help-short">
                                        <ff-icon title="Advanced Tools." class="ff-off" name="tools"></ff-icon>
                                        <div class="sv-help-text">Open the advanced<br>tool menu.</div>
                                    </div>`:""}
                                </div>`;return ht.qy`
        <div class="sv-help-region" role="region" aria-label="Introduction to Voyager" aria-live="polite" @keydown=${t=>this.onKeyDownMain(t)}>
            <div class="ff-flex-row">
                <div class="ff-flex-spacer ff-title"><b>${t.getLocalizedString("Introduction to Voyager")}</b></div>
                <ff-button icon="close" transparent class="ff-close-button" title=${t.getLocalizedString("Close")} @click=${this.close}></ff-button>
            </div>
            <div class="sv-commands">
                <ff-button text="Navigation" index=${Nt.Nav} selectedIndex=${i} @click=${t=>this.onClickSection(t,Nt.Nav)}></ff-button>
                <ff-button text="Menu Icons" index=${Nt.Menu} selectedIndex=${i} @click=${t=>this.onClickSection(t,Nt.Menu)}></ff-button>
            </div>
            ${i===Nt.Nav?d:p}
        </div>
        `}firstUpdated(t){super.firstUpdated(t),Array.from(this.getElementsByClassName("ff-button")).find(t=>"Navigation"===t.getAttribute("text")).focus(),setTimeout(()=>{this.querySelector("#sr-trigger").textContent="section end"},100)}onClickSection(t,e){this.helpView=e,this.requestUpdate()}onKeyDownMain(t){"Escape"===t.code?this.close():"Tab"===t.code&&(0,E.i)((0,E.R)(this),t)}tabReset(t){const e=t.target instanceof Element?t.target:null;if(e){const t=Array.from(e.parentElement.children).find(t=>t.hasAttribute("selected"));t!==e&&(e.setAttribute("tabIndex","-1"),t.setAttribute("tabIndex","0"))}}};kt.leftClick=ht.qy`<svg class="ff-icon" viewBox="150 150 900 900" xmlns="http://www.w3.org/2000/svg"><path d="m600 930.62c-121.73 0-220.41-98.684-220.41-220.41v-220.42c0-121.73 98.684-220.42 220.41-220.42 121.73 0 220.42 98.684 220.42 220.42v220.42c0 121.73-98.684 220.41-220.42 220.41zm-188.93-346.37h377.86v125.95c0 104.34-84.594 188.93-188.93 188.93s-188.93-84.59-188.93-188.93zm159.28-85.285c4.2188 2.8008 8.9414 4.7539 13.902 5.7617v48.035h-106.02zm-17.586-62.66v29.863c0 2.125 0.17188 4.2383 0.50391 6.3008l-137.46 80.293h-4.7383v-33.691zm62.977-71.668v-63.133c96.969 7.9961 173.18 89.234 173.18 188.28v62.977h-173.18v-48.035c7.5078-1.5273 14.469-5.2266 19.965-10.723 7.3828-7.3828 11.523-17.395 11.523-27.836v-62.977c0-10.438-4.1406-20.449-11.523-27.832-5.4961-5.4961-12.457-9.1953-19.965-10.723zm-31.488-19.664v19.664c-7.5117 1.5273-14.469 5.2266-19.965 10.723-6.5625 6.5625-10.562 15.207-11.367 24.387l-141.71 82.766c0.51953-13.695 2.4883-27.031 5.7773-39.832zm31.488 121.2v-62.977c0-2.0938-0.83594-4.0898-2.3008-5.5703-1.4766-1.4648-3.4766-2.3008-5.5703-2.3008h-15.746c-2.0938 0-4.0938 0.83594-5.5742 2.3008-1.4609 1.4805-2.2969 3.4766-2.2969 5.5703v62.977c0 2.0938 0.83594 4.0938 2.2969 5.5742 1.4805 1.4648 3.4805 2.3008 5.5742 2.3008h15.746c2.0938 0 4.0938-0.83594 5.5703-2.3008 1.4648-1.4805 2.3008-3.4805 2.3008-5.5742zm-31.488-157.66-147.54 86.184c30.262-51.859 84.516-87.992 147.54-93.188z" fill-rule="evenodd"/></svg>`,kt.rightClick=ht.qy`<svg class="ff-icon" viewBox="150 150 900 900" xmlns="http://www.w3.org/2000/svg"><path d="m600 930.62c121.73 0 220.42-98.684 220.42-220.41v-220.42c0-121.73-98.684-220.42-220.42-220.42-121.73 0-220.41 98.684-220.41 220.42v220.42c0 121.73 98.684 220.41 220.41 220.41zm188.93-346.37h-377.86v125.95c0 104.34 84.59 188.93 188.93 188.93s188.93-84.59 188.93-188.93zm-159.28-85.285c-4.2188 2.8008-8.9414 4.7539-13.902 5.7617v48.035h106.02zm17.586-62.66v29.863c0 2.125-0.17188 4.2383-0.50391 6.3008l137.46 80.293h4.7383v-33.691zm-62.977-71.668v-63.133c-96.969 7.9961-173.18 89.234-173.18 188.28v62.977h173.18v-48.035c-7.5117-1.5273-14.469-5.2266-19.965-10.723-7.3828-7.3828-11.523-17.395-11.523-27.836v-62.977c0-10.438 4.1406-20.449 11.523-27.832 5.4961-5.4961 12.453-9.1953 19.965-10.723zm31.488-19.664v19.664c7.5078 1.5273 14.469 5.2266 19.965 10.723 6.5625 6.5625 10.562 15.207 11.367 24.387l141.71 82.766c-0.51953-13.695-2.4883-27.031-5.7773-39.832zm-31.488 121.2v-62.977c0-2.0938 0.83594-4.0898 2.2969-5.5703 1.4805-1.4648 3.4805-2.3008 5.5742-2.3008h15.746c2.0938 0 4.0938 0.83594 5.5703 2.3008 1.4648 1.4805 2.3008 3.4766 2.3008 5.5703v62.977c0 2.0938-0.83594 4.0938-2.3008 5.5742-1.4766 1.4648-3.4766 2.3008-5.5703 2.3008h-15.746c-2.0938 0-4.0938-0.83594-5.5742-2.3008-1.4609-1.4805-2.2969-3.4805-2.2969-5.5742zm31.488-157.66 147.54 86.184c-30.258-51.859-84.512-87.992-147.54-93.188z" fill-rule="evenodd"/></svg>`,kt.mouseWheel=ht.qy`<svg class="ff-icon" viewBox="150 -100 1200 1400" xmlns="http://www.w3.org/2000/svg"><path d="m576.05 422.12v-220.24l-55.078 55.078c-9.3711 9.3711-24.551 9.3711-33.938 0-9.3828-9.3711-9.3828-24.562 0-33.938l96-96c9.3711-9.3711 24.562-9.3711 33.938 0l96 96c9.3711 9.3711 9.3711 24.562 0 33.938-4.6914 4.6953-10.824 7.0352-16.969 7.0352s-12.277-2.3398-16.969-7.0312l-55.152-55.152v220.36l55.152-55.141c9.3711-9.3828 24.562-9.3828 33.938 0 9.3711 9.3711 9.3711 24.551 0 33.938l-96 96c-4.6914 4.6914-10.824 7.0312-16.969 7.0312s-12.277-2.3398-16.969-7.0312l-96-96c-9.3828-9.3711-9.3828-24.562 0-33.938 9.3711-9.3828 24.551-9.3828 33.938 0zm455.95 9.875v336c0 238.2-193.79 432-431.98 432-238.2 0-431.98-193.8-431.98-432v-167.77c0-0.082031-0.046875-0.15625-0.046875-0.22656s0.046875-0.14453 0.046875-0.22656v-167.77c0-238.21 193.78-432 431.98-432 238.19 0 431.98 193.79 431.98 432zm-815.95 0v144h767.95v-144c0-211.74-172.25-384-383.98-384-211.73 0-383.98 172.26-383.98 384zm767.95 336v-144h-767.95v144c0 211.74 172.25 384 383.98 384 211.73 0 383.98-172.26 383.98-384z"/></svg>`,kt.pinch=ht.qy`<svg class="ff-icon" viewBox="150 150 1100 900" xmlns="http://www.w3.org/2000/svg"><g>
        <path d="m250.61 558.14c-5.8594-5.8594-15.352-5.8594-21.211 0l-60 60c-4.2891 4.2812-5.5781 8.8711-3.25 14.469 2.332 5.6016 7.793 7.3906 13.852 7.3906h40v103.75c0 10 10 20 20 20s20-10 20-20v-103.75h40c6.0586 0 11.531-1.7812 13.859-7.3789 2.3281-5.6016 1.0391-11.129-3.25-15.41z"/>
        <path d="m300 400h-40v-96.25c0-10-10-20-20-20s-20 10-20 20v96.25h-40c-6.0586 0-11.531 5.5312-13.859 11.129-2.3281 5.6016-1.0391 12.988 3.25 17.281l60 60.469c5.8594 5.8594 15.352 6.0898 21.211 0.23047l60-59.879c4.2891-4.2891 5.5781-12.551 3.25-18.16-2.332-5.6094-7.793-11.07-13.852-11.07z"/>
        <path d="m951.12 426.6c-8.4414-23.172-31.691-38.738-57.859-38.738-7.3789 0-14.578 1.25-21.398 3.7383-6.3398 2.3008-13.488 6.6406-19.93 11.719-11.34-24.57-36.191-40.699-63.559-40.699-8.1602 0-16.219 1.4297-23.941 4.2383-15.371 5.6016-28.039 16.129-36.262 30.031-13.07-15.41-32.52-24.828-53.441-24.828-8.1602 0-16.211 1.4297-23.941 4.2383-18.199 6.6289-34.172 19.539-43.809 35.422-3.0586 5.0391-5.4492 10.32-7.1602 15.75-15.309-23.609-32.859-47.961-49.23-64.328-29.879-29.879-73.711-65.5-112.82-65.5-6.8906 0-13.461 1.1211-19.512 3.3203-18.988 6.9102-33.469 21.809-39.719 40.859-6.5312 19.941-3.2695 41.891 8.9609 60.238 9.3086 13.961 21.672 22.238 34.762 31.012 19.578 13.109 41.762 27.961 64.699 68.109 27.121 47.449 59.98 133.01 77.52 180.85l-75.461-37.262c-11.012-5.1406-22.68-7.7383-34.691-7.7383-31.52 0-60.551 18.551-73.941 47.281-19.16 41.09-1.4609 90.051 38.73 108.77 0.67969 0.35937 69.57 37.191 164.98 81.68l15.602 7.3008c61.121 28.699 118.85 55.82 185.77 55.82h0.011719c31.871 0 63.789-5.9805 97.559-18.27 118.67-43.191 136.7-117.21 145-189.31 8-69.348-73.438-294.17-76.918-303.71zm47.129 300.28c-7.8086 67.891-22.641 127.12-125.45 164.55-30.441 11.07-58.988 16.461-87.301 16.461h-0.011719c-60.219 0-112.5-24.551-173.02-52.98l-15.672-7.3281c-94.602-44.121-162.81-80.59-164.24-81.309-25.941-12.102-37.129-43.18-24.961-69.281 8.6094-18.48 26.52-29.949 46.75-29.949 7.5898 0 14.988 1.6484 21.699 4.7812l108.46 53.551c5.4609 2.7109 11.988 1.8398 16.551-2.1914 4.5703-4.0195 6.25-10.398 4.2695-16.148-2.1094-6.0898-52.059-150.32-92.289-220.73-26.449-46.27-53.961-64.699-74.051-78.148-11.461-7.6719-20.5-13.73-26.488-22.719-7.0898-10.641-9.0703-23.121-5.4219-34.262 3.3594-10.25 11.191-18.281 21.461-22.02 20.762-7.6016 59.32 13.648 100.87 55.199 37.922 37.922 85.922 128.33 86.398 129.24 3.6797 6.9609 12.121 9.8984 19.352 6.6992 7.2109-3.1992 10.711-11.43 8.0117-18.84l-13.68-37.59c-4.7305-13-3.6602-25.32 3.1797-36.602 6.1484-10.148 16.512-18.461 28.41-22.789 4.4297-1.6094 9.0312-2.4297 13.68-2.4297 16.762 0 31.871 10.59 37.602 26.328l18.809 51.68c2.8281 7.7812 11.449 11.801 19.219 8.9609 7.7812-2.8281 11.801-11.441 8.9609-19.219l-8.5391-23.5c-3.6484-10.039-3.1719-20.898 1.3398-30.59 4.5117-9.6914 12.531-17.031 22.578-20.68 4.4102-1.6094 9.0195-2.4297 13.672-2.4297 16.75 0 31.859 10.59 37.59 26.34l22.238 61.078c2.8398 7.7891 11.469 11.789 19.219 8.9609 7.7891-2.8398 11.809-11.449 8.9609-19.23l-13.18-36.238c4.0586-4.4492 12.559-11.422 18.941-13.738 3.5195-1.2812 7.2695-1.9297 11.129-1.9297 13.398 0 25.602 7.8086 29.68 19 22.93 63.145 81.23 238.27 75.27 290.04z"/></g></svg>`,kt.oneFinger=ht.qy`<svg class="ff-icon" viewBox="150 80 1200 1100" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd">
        <path d="m840 440c-16.465 0-31.77 4.9766-44.492 13.504-10.934-31.16-40.613-53.504-75.508-53.504-14.57 0-28.234 3.8945-40 10.703v-170.7c0-44.184-35.816-80-80-80s-80 35.816-80 80v390.36l-40.387-69.953c-22.09-38.262-71.02-51.371-109.28-29.281-38.262 22.094-51.375 71.02-29.281 109.28 5.0859 8.8164 24.68 42.715 28.75 49.801 31.137 54.199 41.914 146.04 73.188 200.31 43.637 75.727 116.69 175.49 120.79 181.18 6.457 8.9609 18.957 10.992 27.918 4.5352 8.9609-6.457 10.992-18.957 4.5352-27.918-4.0273-5.5859-82.762-115.18-118.68-177.9-24.391-42.598-38.934-141.56-73.109-200.2-4.1055-7.0508-23.664-40.984-28.75-49.801-11.047-19.129-4.4922-43.594 14.641-54.641 19.133-11.043 43.594-4.4883 54.641 14.641l74.84 129.63c7.0039 14.672 40.188 13.93 40.188-10.035v-460c0-22.09 17.91-40 40-40s40 17.91 40 40v340c0 11.047 8.9531 20 20 20s20-8.9531 20-20v-100c0-22.09 17.91-40 40-40s40 17.91 40 40v100c0 11.047 8.9531 20 20 20s20-8.9531 20-20v-60c0-22.09 17.91-40 40-40s40 17.91 40 40v100c0 11.047 8.9531 20 20 20s20-8.9531 20-20v-60c0-22.09 17.91-40 40-40s40 17.91 40 40v140c0 130.99-80 255.81-80 360 0 11.047 8.9531 20 20 20s20-8.9531 20-20c0-89.777 80-228.5 80-360v-140c0-44.184-35.816-80-80-80-16.465 0-31.77 4.9766-44.492 13.504-10.934-31.16-40.613-53.504-75.508-53.504z"/>
        <path d="m234.14 245.86c7.8125 7.8086 7.8125 20.473 0 28.281-7.8086 7.8125-20.473 7.8125-28.281 0l-80-80c-7.8125-7.8086-7.8125-20.473 0-28.281l80-80c7.8086-7.8125 20.473-7.8125 28.281 0 7.8125 7.8086 7.8125 20.473 0 28.281l-45.855 45.859h271.71c11.047 0 20 8.9531 20 20s-8.9531 20-20 20h-271.83z"/>
        <path d="m965.86 245.86c-7.8125 7.8086-7.8125 20.473 0 28.281 7.8086 7.8125 20.473 7.8125 28.281 0l80-80c7.8125-7.8086 7.8125-20.473 0-28.281l-80-80c-7.8086-7.8125-20.473-7.8125-28.281 0-7.8125 7.8086-7.8125 20.473 0 28.281l45.855 45.859h-271.71c-11.047 0-20 8.9531-20 20s8.9531 20 20 20h271.83z"/></g></svg>`,kt.twoFinger=ht.qy`<svg class="ff-icon" viewBox="40 80 1300 1100" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd">
        <path d="m154.14 245.86c7.8125 7.8086 7.8125 20.473 0 28.281-7.8086 7.8125-20.473 7.8125-28.281 0l-80-80c-7.8125-7.8086-7.8125-20.473 0-28.281l80-80c7.8086-7.8125 20.473-7.8125 28.281 0 7.8125 7.8086 7.8125 20.473 0 28.281l-45.855 45.859h271.71c11.047 0 20 8.9531 20 20s-8.9531 20-20 20h-271.83z"/>
        <path d="m1005.9 245.86c-7.8125 7.8086-7.8125 20.473 0 28.281 7.8086 7.8125 20.473 7.8125 28.281 0l80-80c7.8125-7.8086 7.8125-20.473 0-28.281l-80-80c-7.8086-7.8125-20.473-7.8125-28.281 0-7.8125 7.8086-7.8125 20.473 0 28.281l45.855 45.859h-271.71c-11.047 0-20 8.9531-20 20s8.9531 20 20 20h271.83z"/>
        <path d="m760 560c34.895 0 64.574 22.344 75.508 53.504 12.723-8.5273 28.027-13.504 44.492-13.504 44.184 0 80 35.816 80 80v140c0 131.5-80 270.22-80 360 0 11.047-8.9531 20-20 20s-20-8.9531-20-20c0-104.19 80-229.01 80-360v-140c0-22.09-17.91-40-40-40s-40 17.91-40 40v60c0 11.047-8.9531 20-20 20s-20-8.9531-20-20v-100c0-22.09-17.91-40-40-40s-40 17.91-40 40v60c0 11.047-8.9531 20-20 20s-20-8.9531-20-20v-420c0-22.09-17.91-40-40-40s-40 17.91-40 40v420c0 11.047-8.9531 20-20 20s-20-8.9531-20-20v-340c0-22.09-17.91-40-40-40s-40 17.91-40 40v460c0 23.965-33.184 24.707-40.188 10.035l-74.84-129.63c-11.047-19.129-35.508-25.684-54.641-14.641-19.133 11.047-25.688 35.512-14.641 54.641 5.0859 8.8164 24.645 42.75 28.75 49.801 34.176 58.645 48.719 157.61 73.109 200.2 35.914 62.723 114.65 172.31 118.68 177.9 6.457 8.9609 4.4258 21.461-4.5352 27.918-8.9609 6.457-21.461 4.4258-27.918-4.5352-4.0977-5.6875-77.148-105.45-120.79-181.18-31.273-54.27-42.051-146.11-73.188-200.31-4.0703-7.0859-23.664-40.984-28.75-49.801-22.094-38.262-8.9805-87.188 29.281-109.28 38.262-22.09 87.191-8.9805 109.28 29.281l40.387 69.953v-390.36c0-44.184 35.816-80 80-80 14.57 0 28.234 3.8945 40 10.703v-10.703c0-44.184 35.816-80 80-80s80 35.816 80 80v290.7c11.766-6.8086 25.43-10.703 40-10.703z"/></g></svg>`,kt.arrowKeys=ht.qy`<svg class="ff-icon" viewBox="0 200 1300 800" xmlns="http://www.w3.org/2000/svg"><g>
        <path d="m479.04 936.24h238.92c22.559 0 40.922-18.359 40.922-40.922l-0.003906-238.92c0-22.559-18.359-40.922-40.922-40.922l-238.92 0.003907c-22.559 0-40.922 18.359-40.922 40.922v238.92c0.003906 22.555 18.363 40.914 40.922 40.914zm85.562-148.56h24.84v-86.039c0-4.9219 4.0781-9 9-9s9 4.0781 9 9v86.039h24.84c4.9219 0 7.9219 5.2812 5.5195 9.4805l-33.84 58.68c-2.3984 4.1992-8.5195 4.1992-11.039 0l-33.84-58.68c-2.4023-4.1992 0.71875-9.4805 5.5195-9.4805z"/>
        <path d="m717.96 263.76h-238.92c-22.559 0-40.922 18.359-40.922 40.922l0.003906 238.92c0 22.559 18.359 40.922 40.922 40.922h238.92c22.559 0 40.922-18.359 40.922-40.922l-0.007813-238.92c0-22.559-18.359-40.918-40.918-40.918zm-85.562 148.56h-24.84v86.039c0 4.9219-4.0781 9-9 9s-9-4.0781-9-9v-86.039h-24.84c-4.9219 0-7.9219-5.2812-5.5195-9.4805l33.84-58.68c2.3984-4.1992 8.5195-4.1992 11.039 0l33.84 58.68c2.4023 4.1992-0.59766 9.4805-5.5195 9.4805z"/>
        <path d="m1116 895.32v-238.92c0-22.559-18.359-40.922-40.922-40.922l-238.92 0.003907c-22.559 0-40.922 18.359-40.922 40.922v238.92c0 22.559 18.359 40.922 40.922 40.922h238.92c22.68-0.007813 40.918-18.367 40.918-40.926zm-148.44-85.559v-24.961h-86.039c-4.9219 0-9-4.0781-9-9s4.0781-9 9-9h86.039v-24.84c0-4.9219 5.2812-7.9219 9.4805-5.5195l58.68 33.84c4.1992 2.3984 4.1992 8.5195 0 11.039l-58.68 33.84c-4.1992 2.5195-9.4805-0.60156-9.4805-5.3984z"/>
        <path d="m84 656.4v238.92c0 22.559 18.359 40.922 40.922 40.922h238.92c22.559 0 40.922-18.359 40.922-40.922l-0.003906-238.92c0-22.559-18.359-40.922-40.922-40.922l-238.92 0.003907c-22.684 0-40.922 18.359-40.922 40.918zm148.44 85.562v24.84h86.039c4.9219 0 9 4.0781 9 9s-4.0781 9-9 9h-86.039v24.84c0 4.9219-5.2812 7.9219-9.4805 5.5195l-58.68-33.84c-4.1992-2.3984-4.1992-8.5195 0-11.039l58.68-33.84c4.1992-2.4023 9.4805 0.59766 9.4805 5.5195z"/></g></svg>`,kt.arrowKeysUD=ht.qy`<svg class="ff-icon" viewBox="350 200 500 800" xmlns="http://www.w3.org/2000/svg"><g>
        <path d="m479.04 936.24h238.92c22.559 0 40.922-18.359 40.922-40.922l-0.003906-238.92c0-22.559-18.359-40.922-40.922-40.922l-238.92 0.003907c-22.559 0-40.922 18.359-40.922 40.922v238.92c0.003906 22.555 18.363 40.914 40.922 40.914zm85.562-148.56h24.84v-86.039c0-4.9219 4.0781-9 9-9s9 4.0781 9 9v86.039h24.84c4.9219 0 7.9219 5.2812 5.5195 9.4805l-33.84 58.68c-2.3984 4.1992-8.5195 4.1992-11.039 0l-33.84-58.68c-2.4023-4.1992 0.71875-9.4805 5.5195-9.4805z"/>
        <path d="m717.96 263.76h-238.92c-22.559 0-40.922 18.359-40.922 40.922l0.003906 238.92c0 22.559 18.359 40.922 40.922 40.922h238.92c22.559 0 40.922-18.359 40.922-40.922l-0.007813-238.92c0-22.559-18.359-40.918-40.918-40.918zm-85.562 148.56h-24.84v86.039c0 4.9219-4.0781 9-9 9s-9-4.0781-9-9v-86.039h-24.84c-4.9219 0-7.9219-5.2812-5.5195-9.4805l33.84-58.68c2.3984-4.1992 8.5195-4.1992 11.039 0l33.84 58.68c2.4023 4.1992-0.59766 9.4805-5.5195 9.4805z"/>
        </g></svg>`,kt.arrowKeysLR=ht.qy`<svg class="ff-icon" viewBox="350 350 950 800" xmlns="http://www.w3.org/2000/svg"><g>
        <path d="m1116 895.32v-238.92c0-22.559-18.359-40.922-40.922-40.922l-238.92 0.003907c-22.559 0-40.922 18.359-40.922 40.922v238.92c0 22.559 18.359 40.922 40.922 40.922h238.92c22.68-0.007813 40.918-18.367 40.918-40.926zm-148.44-85.559v-24.961h-86.039c-4.9219 0-9-4.0781-9-9s4.0781-9 9-9h86.039v-24.84c0-4.9219 5.2812-7.9219 9.4805-5.5195l58.68 33.84c4.1992 2.3984 4.1992 8.5195 0 11.039l-58.68 33.84c-4.1992 2.5195-9.4805-0.60156-9.4805-5.3984z"/>
        <g transform="translate(350 0)"><path d="m84 656.4v238.92c0 22.559 18.359 40.922 40.922 40.922h238.92c22.559 0 40.922-18.359 40.922-40.922l-0.003906-238.92c0-22.559-18.359-40.922-40.922-40.922l-238.92 0.003907c-22.684 0-40.922 18.359-40.922 40.918zm148.44 85.562v24.84h86.039c4.9219 0 9 4.0781 9 9s-4.0781 9-9 9h-86.039v24.84c0 4.9219-5.2812 7.9219-9.4805 5.5195l-58.68-33.84c-4.1992-2.3984-4.1992-8.5195 0-11.039l58.68-33.84c4.1992-2.4023 9.4805 0.59766 9.4805 5.5195z"/></g></g></svg>`,kt=Dt=Ot([(0,ht.EM)("sv-main-help")],kt);const Ut=kt;var Ft,zt=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let Vt=Ft=class extends ht.Ay{static show(t,e,i){const n=new Ft(t,e,i);return t.appendChild(n),new Promise((t,e)=>{n.on("close",()=>t())})}constructor(t,e,i){super(),this.language=null,this.content="",this.language=e,this.content=i,this.position="center",this.portal=t,this.modal=!0,this.url=window.location.href}close(){this.dispatchEvent(new CustomEvent("close")),this.remove()}firstConnected(){super.firstConnected(),this.contentElement=this.createElement("div",null),this.classList.add("sv-splash")}render(){const t=this.language,e=this.contentElement;return e.innerHTML=this.content,ht.qy`
        <div id="main" tabIndex="-1" role="region" aria-label="Introduction to Voyager" @keydown=${t=>this.onKeyDownMain(t)}>
            <div class="ff-flex-row">
                <div class="ff-flex-spacer ff-title"><b>${t.getLocalizedString("Welcome to Voyager")}</b></div>
                <ff-button icon="close" transparent class="ff-close-button" title=${t.getLocalizedString("Close")} @click=${this.close}></ff-button>
            </div>
            <div>
                ${e}
            </div>
        </div>
        `}firstUpdated(t){super.firstUpdated(t),this.querySelector("#main").focus()}onKeyDownMain(t){"Escape"===t.code?this.close():"Tab"===t.code&&(0,E.i)((0,E.R)(this),t)}};Vt=Ft=zt([(0,ht.EM)("sv-splash")],Vt);const Qt=Vt;var jt=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let Gt=class extends N.Ay{constructor(){super(...arguments),this.documentProps=new h.A("value",this.onUpdate,this),this.assetPath="",this.needsSplash=!0}get toolProvider(){return this.system.getMainComponent(st.A)}get assetReader(){return this.system.getMainComponent(Y.A)}firstConnected(){this.style.pointerEvents="none",this.setAttribute("pointer-events","none"),this.classList.add("sv-chrome-view")}connected(){super.connected(),this.toolProvider.ins.visible.on("value",this.onUpdate,this),this.activeDocument.setup.language.outs.activeLanguage.on("value",this.onUpdate,this),this.activeDocument.setup.audio.outs.isPlaying.on("value",this.onUpdate,this),this.activeDocument.setup.audio.outs.narrationPlaying.on("value",this.onUpdate,this),this.activeDocument.setup.audio.ins.captionsEnabled.on("value",this.onUpdate,this),this.titleElement=this.createElement("div",null),this.titleElement.classList.add("ff-ellipsis"),this.assetPath=this.assetReader.getSystemAssetUrl("")}disconnected(){this.activeDocument.setup.audio.ins.captionsEnabled.off("value",this.onUpdate,this),this.activeDocument.setup.audio.outs.narrationPlaying.off("value",this.onUpdate,this),this.activeDocument.setup.audio.outs.isPlaying.off("value",this.onUpdate,this),this.activeDocument.setup.language.outs.activeLanguage.off("value",this.onUpdate,this),this.toolProvider.ins.visible.off("value",this.onUpdate,this),super.disconnected()}render(){const t=this.activeDocument,e=this.titleElement;if(!t)return N.qy``;const i=t.setup,n=i.interface.ins.visible.value,s=i.interface.ins.logo.value&&i.interface.isShowing(xt.T.logo),r=i.interface.ins.menu.value&&i.interface.isShowing(xt.T.menu),o=i.interface.ins.visibleElements.value&&i.interface.isShowing(xt.T.title),a=i.interface.ins.visibleElements.value&&i.interface.isShowing(xt.T.help),l=i.reader.ins.enabled.value,c=i.tours.tours,h=i.tours.ins.enabled.value,u=i.tours.outs.tourIndex.value>=0,d=i.language,p=d.sceneLanguages,f=d.outs.activeLanguage.value,g=p.length>1&&i.interface.isShowing(xt.T.language),m=i.audio.outs.isPlaying.value&&i.audio.getClipCaptionUri(i.audio.activeId),A=i.audio.ins.captionsEnabled.value,v=i.audio.outs.narrationPlaying.value,y=!!this.system.getComponent("CVStoryApplication",!0)||!h,b=i.viewer.ins.annotationsVisible.value&&i.viewer.outs.tagCloud.value,_=!l&&this.toolProvider.ins.visible.value,x=this.activeDocument.setup.tours.outs.ending.value;this.activeDocument.setup.tours.outs.ending.setValue(!1);const w=this.activeDocument.outs.intro.value;if(w&&(this.needsSplash&&w.length>0&&Qt.show(this,this.activeDocument.setup.language,w).then(()=>{this.getRootNode().getElementById("sv-scene").focus()}),this.needsSplash=!1),!n)return N.qy``;let E;return E=h?u?d.getLocalizedString("Tour")+": "+i.tours.outs.tourTitle.value:d.getLocalizedString("Interactive Tours"):t.outs.title.value||"Missing Title",e.innerHTML=E,N.qy`${x?N.qy`<div class="sr-only" role="alert" id="screen-reader-msg">Tour Ending...</div>`:null}
            ${v?N.qy`<div class="sv-narrate-player">${i.audio.getPlayerById(i.audio.narrationId)}</div>`:null}
            <div class="sv-chrome-header">
                <div class="sv-main-menu-wrapper">
                    ${r?N.qy`<sv-main-menu role="region" aria-label="Main toolbar" .system=${this.system}></sv-main-menu>`:null}
                </div>
                <div class="sv-top-bar">
                    ${o?N.qy`<div role="heading" class="ff-ellipsis sv-main-title">${e}<span class="ff-ellipsis"> </span></div>`:null}
                    ${s?N.qy`<sv-logo .assetPath=${this.assetPath}></sv-logo>`:null}
                </div>
            </div>
            <div class="ff-flex-spacer"></div>
            ${h&&u?N.qy`<sv-tour-navigator @close=${this.closeTours} .system=${this.system}></sv-tour-navigator>`:null}
            ${h&&!u?N.qy`<sv-tour-menu .tours=${c} .activeLanguage=${f} @close=${this.closeTours} @select=${this.onSelectTour}></sv-tour-menu>`:null}
            ${b&&y?N.qy`<sv-tag-cloud .system=${this.system}></sv-tag-cloud>`:null}
            ${_&&y?N.qy`<div class="sv-tool-bar-container"><sv-tool-bar .system=${this.system} @close=${this.closeTools}></sv-tool-bar></div>`:null}
            <div class="sv-chrome-footer">
                <div class="sv-bottom-bar">
                    ${n?N.qy`<ff-button icon="undo" id="main-reset" title=${d.getLocalizedString("Reset")} ?selected=${!1} @click=${this.resetViewer} class="sv-text-icon"></ff-button>`:""}
                    ${m?N.qy`<ff-button icon="caption" id="main-caption" title=${d.getLocalizedString("Captions")} ?selected=${A} @click=${this.updateCaptions} class="sv-text-icon"></ff-button>`:""}
                    ${g?N.qy`<ff-button id="language" style=${i.language.codeString().length>2?"font-size:0.9em":""} text=${i.language.codeString()} title=${d.getLocalizedString("Set Language")} @click=${this.openLanguageMenu} class="sv-text-icon"></ff-button>`:null}
                    ${a?N.qy`<ff-button icon="help" id="main-help" title=${d.getLocalizedString("Help")} ?selected=${!1} @click=${this.openHelp} class="sv-text-icon"></ff-button>`:""}
                </div>
            </div>`}onSelectTour(t){this.activeDocument.setup.tours.ins.tourIndex.setValue(t.detail.index)}closeTours(){const t=this.activeDocument.setup.tours;t.ins.enabled.setValue(!1),t.ins.closed.set()}updateCaptions(){const t=this.activeDocument.setup.audio.ins;t.captionsEnabled.setValue(!t.captionsEnabled.value)}openLanguageMenu(){const t=this.activeDocument.setup.language;t.ins.enabled.value||(t.ins.enabled.setValue(!0),Rt.show(this,this.activeDocument.setup.language).then(()=>{t.ins.enabled.setValue(!1),this.querySelector("#language").focus()}))}openHelp(){const t=this.activeDocument.setup.language,e=this.activeDocument.setup.navigation.ins.mode.value;Ut.show(this,t,e).then(()=>{this.querySelector("#main-help").focus()})}resetViewer(){this.activeDocument.setup.resetViewer()}closeTools(){const t=this.toolProvider.ins;t.visible.setValue(!1),t.closed.set()}onActiveDocument(t,e){if(t&&this.documentProps.off(),e){const t=e.setup;this.documentProps.on(e.outs.title,e.outs.assetPath,t.interface.ins.visible,t.interface.ins.logo,t.interface.ins.menu,t.viewer.ins.annotationsVisible,t.reader.ins.enabled,t.tours.ins.enabled,t.tours.outs.tourIndex)}this.requestUpdate()}};Gt=jt([(0,N.EM)("sv-chrome-view")],Gt);const Ht=Gt;var qt=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};a.A.add("globe",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"/></svg>`),a.A.add("cog",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"/></svg>`),a.A.add("eye",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M569.354 231.631C512.969 135.949 407.81 72 288 72 168.14 72 63.004 135.994 6.646 231.631a47.999 47.999 0 0 0 0 48.739C63.031 376.051 168.19 440 288 440c119.86 0 224.996-63.994 281.354-159.631a47.997 47.997 0 0 0 0-48.738zM288 392c-75.162 0-136-60.827-136-136 0-75.162 60.826-136 136-136 75.162 0 136 60.826 136 136 0 75.162-60.826 136-136 136zm104-136c0 57.438-46.562 104-104 104s-104-46.562-104-104c0-17.708 4.431-34.379 12.236-48.973l-.001.032c0 23.651 19.173 42.823 42.824 42.823s42.824-19.173 42.824-42.823c0-23.651-19.173-42.824-42.824-42.824l-.032.001C253.621 156.431 270.292 152 288 152c57.438 0 104 46.562 104 104z"/></svg>`),a.A.add("palette",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M128 224c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.4-32-32-32zM418.6 58.1C359.2 9.3 281.3-10 204.6 5 104.9 24.4 24.7 104.2 5.1 203.7c-16.7 84.2 8.1 168.3 67.8 230.6 47.3 49.4 109.7 77.8 167.9 77.8 8.8 0 17.5-.6 26.1-2 24.2-3.7 44.6-18.7 56.1-41.1 12.3-24 12.3-52.7.2-76.6-6.1-12-5.5-26.2 1.8-38 7-11.8 18.7-18.4 32-18.4h72.2c46.4 0 82.8-35.7 82.8-81.3-.2-76.4-34.3-148.1-93.4-196.6zM429.2 288H357c-29.9 0-57.2 15.4-73 41.3-16 26.1-17.3 57.8-3.6 84.9 5.1 10.1 5.1 22.7-.2 32.9-2.6 5-8.7 13.7-20.6 15.6-49.3 7.7-108.9-16.6-152-61.6-48.8-50.9-69-119.4-55.4-188 15.9-80.6 80.8-145.3 161.6-161 62.6-12.3 126.1 3.5 174.3 43.1 48.1 39.5 75.7 97.6 75.9 159.6 0 18.6-15.3 33.2-34.8 33.2zM160 128c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.4-32-32-32zm96-32.1c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32c0-17.6-14.3-32-32-32zm96 32.1c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32z"/></svg>`),a.A.add("comment",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32z"/></svg>`),a.A.add("article",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"/></svg>`),a.A.add("document",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M288 248v28c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-28c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm-12 72H108c-6.6 0-12 5.4-12 12v28c0 6.6 5.4 12 12 12h168c6.6 0 12-5.4 12-12v-28c0-6.6-5.4-12-12-12zm108-188.1V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V48C0 21.5 21.5 0 48 0h204.1C264.8 0 277 5.1 286 14.1L369.9 98c9 8.9 14.1 21.2 14.1 33.9zm-128-80V128h76.1L256 51.9zM336 464V176H232c-13.3 0-24-10.7-24-24V48H48v416h288z"/></svg>`),a.A.add("share",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M352 320c-22.608 0-43.387 7.819-59.79 20.895l-102.486-64.054a96.551 96.551 0 0 0 0-41.683l102.486-64.054C308.613 184.181 329.392 192 352 192c53.019 0 96-42.981 96-96S405.019 0 352 0s-96 42.981-96 96c0 7.158.79 14.13 2.276 20.841L155.79 180.895C139.387 167.819 118.608 160 96 160c-53.019 0-96 42.981-96 96s42.981 96 96 96c22.608 0 43.387-7.819 59.79-20.895l102.486 64.054A96.301 96.301 0 0 0 256 416c0 53.019 42.981 96 96 96s96-42.981 96-96-42.981-96-96-96z"/></svg>`),a.A.add("expand",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M241,29V141.53a14,14,0,0,1-14,14h-18.7a14,14,0,0,1-14-14V61.74H114.45a14,14,0,0,1-14-14L100.3,29a14,14,0,0,1,14-14H226.89A14,14,0,0,1,241,29Z"/><path d="M15,226.67V114.11a14,14,0,0,1,14-14h18.7a14,14,0,0,1,14,14V193.9h79.79a14,14,0,0,1,14,14l.12,18.74a14,14,0,0,1-14,14H29.07A14,14,0,0,1,15,226.67Z"/></svg>`),a.A.add("zoom",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 180V56c0-13.3 10.7-24 24-24h124c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H64v84c0 6.6-5.4 12-12 12H12c-6.6 0-12-5.4-12-12zM288 44v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12V56c0-13.3-10.7-24-24-24H300c-6.6 0-12 5.4-12 12zm148 276h-40c-6.6 0-12 5.4-12 12v84h-84c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24V332c0-6.6-5.4-12-12-12zM160 468v-40c0-6.6-5.4-12-12-12H64v-84c0-6.6-5.4-12-12-12H12c-6.6 0-12 5.4-12 12v124c0 13.3 10.7 24 24 24h124c6.6 0 12-5.4 12-12z"/></svg>`),a.A.add("tools",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M501.1 395.7L384 278.6c-23.1-23.1-57.6-27.6-85.4-13.9L192 158.1V96L64 0 0 64l96 128h62.1l106.6 106.6c-13.6 27.8-9.2 62.3 13.9 85.4l117.1 117.1c14.6 14.6 38.2 14.6 52.7 0l52.7-52.7c14.5-14.6 14.5-38.2 0-52.7zM331.7 225c28.3 0 54.9 11 74.9 31l19.4 19.4c15.8-6.9 30.8-16.5 43.8-29.5 37.1-37.1 49.7-89.3 37.9-136.7-2.2-9-13.5-12.1-20.1-5.5l-74.4 74.4-67.9-11.3L334 98.9l74.4-74.4c6.6-6.6 3.4-17.9-5.7-20.2-47.4-11.7-99.6.9-136.6 37.9-28.5 28.5-41.9 66.1-41.2 103.6l82.1 82.1c8.1-1.9 16.5-2.9 24.7-2.9zm-103.9 82l-56.7-56.7L18.7 402.8c-25 25-25 65.5 0 90.5s65.5 25 90.5 0l123.6-123.6c-7.6-19.9-9.9-41.6-5-62.7zM64 472c-13.2 0-24-10.8-24-24 0-13.3 10.7-24 24-24s24 10.7 24 24c0 13.2-10.7 24-24 24z"/></svg>`),a.A.add("environment",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M219.81,14.75H36.19A21.19,21.19,0,0,0,15,35.94V220.06a21.19,21.19,0,0,0,21.19,21.19H219.81A21.19,21.19,0,0,0,241,220.06V35.94A21.19,21.19,0,0,0,219.81,14.75Zm-2.65,205.31H38.84a2.64,2.64,0,0,1-2.65-2.65V38.59a2.64,2.64,0,0,1,2.65-2.65H217.16a2.64,2.64,0,0,1,2.65,2.65V217.41A2.64,2.64,0,0,1,217.16,220.06ZM72.16,71.59A18.32,18.32,0,1,0,90.47,89.91,18.32,18.32,0,0,0,72.16,71.59ZM57.51,198.15H204V141.53l-40.06-40.06a5.49,5.49,0,0,0-7.77,0l-54.72,54.71L83.36,138.09a5.47,5.47,0,0,0-7.76,0L57.51,156.18Z"/></svg>`),a.A.add("bulb",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M44.73 323.21c-7.65 4.42-10.28 14.2-5.86 21.86l8 13.86c4.42 7.65 14.21 10.28 21.86 5.86l93.26-53.84a207.865 207.865 0 0 1-26.83-39.93l-90.43 52.19zM112.46 168H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h100.21a210.423 210.423 0 0 1-3.75-48zm127.6 291.17c0 3.15.93 6.22 2.68 8.84l24.51 36.84c2.97 4.46 7.97 7.14 13.32 7.14h78.85c5.36 0 10.36-2.68 13.32-7.14l24.51-36.84c1.74-2.62 2.67-5.7 2.68-8.84l.05-43.18H240.02l.04 43.18zM44.73 60.78l78.98 45.6c5.37-15.29 12.97-29.48 21.64-42.93L68.73 19.21c-7.65-4.42-17.44-1.8-21.86 5.86l-8 13.86c-4.42 7.65-1.79 17.44 5.86 21.85zm550.54 0c7.65-4.42 10.28-14.2 5.86-21.86l-8-13.86c-4.42-7.65-14.21-10.28-21.86-5.86l-76.61 44.23c8.68 13.41 15.76 27.9 21.2 43.19l79.41-45.84zm0 262.43l-90.97-52.52c-7.33 14.23-15.8 27.88-26.36 40.21l93.33 53.88c7.65 4.42 17.44 1.8 21.86-5.86l8-13.86c4.42-7.64 1.79-17.43-5.86-21.85zM624 168h-96.41c.1 2.68.41 5.3.41 8 0 13.54-1.55 26.89-4.12 40H624c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16zM320 80c-52.94 0-96 43.06-96 96 0 8.84 7.16 16 16 16s16-7.16 16-16c0-35.3 28.72-64 64-64 8.84 0 16-7.16 16-16s-7.16-16-16-16zm0-80C217.72 0 144 82.97 144 176c0 44.37 16.45 84.85 43.56 115.78 16.64 18.99 42.74 58.8 52.42 92.16v.06h48v-.12c-.01-4.77-.72-9.51-2.15-14.07-5.59-17.81-22.82-64.77-62.17-109.67-20.53-23.43-31.52-53.14-31.61-84.14-.2-73.64 59.67-128 127.95-128 70.58 0 128 57.42 128 128 0 30.97-11.24 60.85-31.65 84.14-39.11 44.61-56.42 91.47-62.1 109.46a47.507 47.507 0 0 0-2.22 14.3v.1h48v-.05c9.68-33.37 35.78-73.18 52.42-92.16C479.55 260.85 496 220.37 496 176 496 78.8 417.2 0 320 0z"/></svg>`),a.A.add("spot",o.qy`<svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M301.87 108.727c0 52.94 43.06 96 96 96 8.84 0 16-7.16 16-16s-7.16-16-16-16c-35.3 0-64-28.72-64-64 0-8.84-7.16-16-16-16s-16 7.16-16 16zM478.636 144.265a15.898 15.898 0 0 0 4.356-8.146l8.718-43.38a16.008 16.008 0 0 0-4.37-14.468l-55.755-55.755a15.982 15.982 0 0 0-14.467-4.37l-43.381 8.718a16.084 16.084 0 0 0-8.146 4.356l-30.568 30.498L448.13 174.826zM30.3 216.774c-7.856 4.045-10.956 13.686-6.912 21.55l7.32 14.232c4.044 7.855 13.695 10.956 21.55 6.911l207.354-102.82c-5.12-15.272-4.739-35.452-3.706-49.874zM257.42 455.585c-3.858 7.948-.554 17.522 7.4 21.388l14.393 6.994c7.949 3.858 17.53.549 21.388-7.4l108.397-220.653c-14.872 2.094-34.317 1.858-49.625-2.162zM119.554 363.004c-6.162 6.331-6.037 16.458.298 22.63l11.464 11.165c6.331 6.162 16.468 6.034 22.63-.297L309.885 230.5c-11.419-7.558-22.03-17.993-30.532-31.249z"/></svg>`),a.A.add("area",o.qy`<svg viewBox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path style="stroke-linecap:round;-inkscape-stroke:none" d="M351.053 207.98a25 25 0 0 0-12.014 4.811l-7.65 5.729a25 25 0 0 0-5.028 34.996 25 25 0 0 0 34.996 5.027l7.65-5.729a25 25 0 0 0 5.028-34.996 25 25 0 0 0-22.982-9.838zm-58.348 43.956a25 25 0 0 0-11.848 5.203L45.99 445.346a25 25 0 0 0-3.877 35.14 25 25 0 0 0 35.143 3.877l234.867-188.207a25 25 0 0 0 3.875-35.142 25 25 0 0 0-23.293-9.078zM131.023 68.966c-7.535 0-12.006 1.996-17.07 6.53-5.064 4.535-11.212 17.475-6.45 28.72a25.003 25.003 0 0 0 .017.036l114 267.99a25.003 25.003 0 0 0 .048.115c.146.338.588 2.384 3.852 6.344 3.264 3.96 12.068 9.254 19.603 9.254h335.891c7.51 0 12.01-1.991 17.082-6.539 5.073-4.548 11.19-17.488 6.438-28.709a25.003 25.003 0 0 0-.014-.037l-114-267.99a25.003 25.003 0 0 0-.018-.04c-.155-.363-.602-2.438-3.883-6.42-3.28-3.98-12.096-9.253-19.605-9.253H131.025zM444.428 104.3l.677 1.59c-.513-.992-.653-1.531-.677-1.59zm-276.313 14.668h282.553l93.154 218.988H261.27zm98.705 232.037c.48.923.597 1.378.623 1.467z"/></svg>`),a.A.add("sun",o.qy`<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path style="stroke:none" d="m10.824 3.745 1.711-1.705c.425-.416 1.82 1.005 1.408 1.42l-1.707 1.702zm2.18 3.247 2.416.004c.595.006.576 1.997-.008 2l-2.41-.004zm-.765 3.833 1.704 1.711c.416.425-1.005 1.82-1.42 1.408l-1.701-1.708zM8.997 13l-.004 2.416c-.006.594-1.997.576-2-.01l.004-2.41zm-3.825-.758-1.72 1.697c-.426.414-1.814-1.013-1.4-1.427l1.715-1.693zM2.992 8.99.578 8.986c-.594-.006-.576-1.997.009-2l2.41.004zm.76-3.818L2.045 3.46c-.416-.424 1.005-1.819 1.42-1.408L5.168 3.76zM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM7 3V.584C7.005-.01 8.996.004 9 .59V3z"/></svg>`),a.A.add("half-sun",o.qy`<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path style=";stroke-width:50;stroke-linecap:round;stroke-linejoin:round" d="M.588 9.16h14.84c.212 0 .384.172.384.385v1.124a.384.384 0 0 1-.385.385H.588a.384.384 0 0 1-.384-.385V9.545c0-.213.171-.385.384-.385zM8 .145c-.499-.003-.998.142-1 .439V3h2V.59C8.998.297 8.499.147 8 .145zm4.734 1.82a.274.274 0 0 0-.199.074l-1.71 1.707 1.411 1.416 1.707-1.701c.36-.364-.663-1.497-1.209-1.496zm-9.464.012C2.725 1.974 1.68 3.09 2.045 3.46l1.707 1.71L5.168 3.76 3.467 2.053a.272.272 0 0 0-.197-.076zM8 5a2.997 2.997 0 0 0-2.988 2.785h5.976A2.997 2.997 0 0 0 8 5zM.586 6.986c-.253.002-.4.375-.438.8h2.846l.002-.796zm12.418.006v.793h2.848c-.034-.419-.177-.786-.432-.789z"/></svg>`),a.A.add("tape",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M624 432H362.3c52.1-41 85.7-104.5 85.7-176 0-123.7-100.3-224-224-224S0 132.3 0 256s100.3 224 224 224h400c8.8 0 16-7.2 16-16v-16c0-8.8-7.2-16-16-16zm-400 0c-97 0-176-79-176-176S127 80 224 80s176 79 176 176-79 176-176 176zm0-272c-53 0-96 43-96 96s43 96 96 96 96-43 96-96-43-96-96-96zm0 144c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48z"/></svg>`),a.A.add("knife",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M566.28 88.57c12.96-12.5 12.96-32.76 0-45.25L531.07 9.37c-12.96-12.5-33.98-12.5-46.94 0L319.99 160 4.76 464.14c-8.25 7.96-5.38 22.16 5.53 25.69C53.72 503.86 102.37 512 150.51 512c75.83 0 150.42-20.19 201.49-69.35l104.4-100.04c12.95-12.41 13.17-33.05.49-45.73L448 288v-80L566.28 88.57zM496 64c8.84 0 16 7.16 16 16s-7.16 16-16 16-16-7.16-16-16 7.16-16 16-16zM318.71 408.07C281.24 444.14 221.5 464 150.51 464c-23.16 0-46.79-2.1-70.07-6.17L319.4 227.28l91.99 91.99-92.68 88.8zM432 160c-8.84 0-16-7.16-16-16s7.16-16 16-16 16 7.16 16 16-7.17 16-16 16z"/></svg>`),a.A.add("bars",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>`),a.A.add("triangle-left",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M191.33,31.38V224.62a15,15,0,0,1-25.64,10.62L69.07,138.62a15,15,0,0,1,0-21.24l96.62-96.62A15,15,0,0,1,191.33,31.38Z"/></svg>`),a.A.add("triangle-right",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M64.67,224.62V31.38A15,15,0,0,1,90.31,20.76l96.62,96.62a15,15,0,0,1,0,21.24L90.31,235.24A15,15,0,0,1,64.67,224.62Z"/></svg>`),a.A.add("twitter",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>`),a.A.add("facebook",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"/></svg>`),a.A.add("instagram",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>`),a.A.add("linkedin",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448.1 512"><path d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"/></svg>`),a.A.add("email",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"/></svg>`),a.A.add("copy",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"/></svg>`),a.A.add("ar",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10.844874 7.2009368"><path d="M 4.1805699,5.4542117 H 2.4801904 L 2.2118585,6.5168507 H 1.1187593 L 2.6807334,0.68408928 h 1.296469 L 5.5391781,6.5168507 H 4.4460774 Z M 2.7513476,4.3720517 H 3.9065883 L 3.3303802,2.0514503 Z"/><path d="m 7.5355365,3.2703464 q 0.3417706,0 0.4886463,-0.1758024 0.1497018,-0.1758024 0.1497018,-0.5781942 0,-0.3984876 -0.1497018,-0.5703858 Q 7.8773071,1.7740658 7.5355365,1.7740658 H 7.0779585 V 3.2703464 Z M 7.0779585,4.309544 V 6.5168507 H 5.9905084 V 0.68408928 h 1.6608338 q 0.8332429,0 1.220205,0.38676692 0.3897887,0.3867669 0.3897887,1.2228084 0,0.5781942 -0.2033672,0.9493362 -0.200543,0.371142 -0.607278,0.5469444 0.2231388,0.070308 0.3982608,0.320355 0.1779472,0.2461266 0.358719,0.7500924 L 9.7980008,6.5168507 H 8.6399351 L 8.1258661,5.0674448 Q 7.970517,4.6298909 7.8095182,4.4697134 7.6513422,4.309544 7.3858347,4.309544 Z"/></svg>`),a.A.add("device-move",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 119.4 57.7"><path d="M47.4,20.7h-34c-0.2,0-0.4-0.1-0.5-0.3l-0.1-0.2l0.1-0.3l9-19.5C21.9,0.2,22.1,0,22.3,0h24.5v1H22.6L14,19.7h33.4V20.7z"/><path d="M103,20.7H71v-1h31.6L95,1H46.8V0h48.3c0.3,0,0.6,0.2,0.7,0.5l7.8,19.2c0.1,0.2,0.1,0.5-0.1,0.7C103.5,20.6,103.2,20.7,103,20.7z M94.9,0.9L94.9,0.9z"/><path d="M49,2.9c-1.1,0-2,0.9-2,2v40c0,1.1,0.9,2,2,2h20c1.1,0,2-0.9,2-2v-40c0-1.1-0.9-2-2-2L49,2.9z M49,3.9h3.6l0,0h0l0,0l0,0l0,0l0,0l0,0v0l0,0l0,0l0,0l0,0v0.5c0,0.6,0.4,1,1,1H64c0.6,0,1-0.4,1-1v0l0,0V4.3c0,0,0,0,0-0.1l0,0l0,0l0,0l0,0l0,0l0,0l0,0l0,0l0,0l0,0l0,0h4c0.6,0,1,0.4,1,1v40c0,0.6-0.4,1-1,1H49c-0.6,0-1-0.4-1-1l0-40.2c0.1-0.5,0-0.8,0.4-1.1C48.5,4,48.8,3.9,49,3.9z"/><path d="M53.3,43.9h11.5c0.3,0,0.6,0.2,0.6,0.5c0,0.3-0.3,0.5-0.6,0.5H53.3c-0.3,0-0.6-0.2-0.6-0.5C52.7,44.1,53,43.8,53.3,43.9z"/><path d="M76,37.8c-0.7,0-1.3,0-2-0.1l0.1-1c1.6,0.2,10,0.7,15.7-5.5c1.8-2,3.1-4.4,3.8-7l1,0.3c-0.7,2.8-2.1,5.3-4,7.5C85.8,37,79.3,37.8,76,37.8z"/><polygon points="96.9,28.6 96,29 93.8,24.6 89.5,27.1 89,26.2 94.3,23.2"/><path d="M42.1,37.4c-3.4,0-9.9-0.8-14.5-6c-1.9-2.1-3.3-4.7-4-7.5l1-0.3c0.7,2.6,1.9,5,3.7,7.1c5.6,6.3,14,5.7,15.7,5.5l0.1,1C43.4,37.4,42.8,37.4,42.1,37.4z"/><polygon points="29,25.8 28.5,26.6 24.3,24.2 22.1,28.6 21.2,28.2 23.8,22.8"/></svg>`),a.A.add("audio",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="50 85 300 275"><path d="M144.800 88.415 C 105.869 89.675,75.661 108.730,58.580 142.800 C 42.479 174.915,49.153 218.126,74.086 243.200 C 82.194 251.354,81.622 247.747,81.571 290.400 C 81.526 327.954,81.532 328.075,83.579 331.303 C 85.932 335.013,81.918 334.725,133.200 334.853 L 178.200 334.965 180.317 334.026 C 184.940 331.975,186.179 329.159,187.004 318.834 C 187.966 306.788,188.179 306.609,201.600 306.579 C 223.132 306.529,231.384 304.069,239.712 295.216 C 246.448 288.055,247.778 282.132,247.527 260.400 C 247.353 245.306,247.496 245.061,256.908 244.337 C 272.369 243.147,279.383 238.170,279.366 228.400 C 279.356 222.955,278.475 220.120,267.737 191.000 C 266.520 187.700,263.126 177.980,260.196 169.400 C 249.024 136.687,242.930 126.187,227.400 112.880 C 209.769 97.774,189.461 89.600,166.600 88.407 C 158.610 87.991,157.887 87.991,144.800 88.415 M205.416 171.240 C 218.099 175.986,216.908 195.403,203.667 199.781 C 192.504 203.472,180.685 190.157,185.674 179.509 C 189.403 171.550,197.349 168.222,205.416 171.240 M311.000 220.715 C 304.366 224.871,305.398 229.213,315.511 239.699 C 325.906 250.478,330.441 259.997,334.191 278.909 C 338.184 299.050,330.538 322.088,313.936 339.938 C 307.475 346.885,307.028 347.548,307.030 350.184 C 307.038 359.089,317.896 358.672,326.406 349.440 C 353.041 320.544,357.609 275.463,337.176 243.154 C 326.661 226.527,316.131 217.500,311.000 220.715 M291.392 243.932 C 286.465 247.613,286.911 251.389,293.068 258.095 C 310.600 277.194,310.622 300.169,293.125 319.139 C 287.742 324.975,286.682 328.672,289.377 332.205 C 294.000 338.266,301.447 335.014,309.224 323.540 C 324.531 300.956,324.654 275.911,309.565 254.525 C 302.386 244.350,295.897 240.567,291.392 243.932 M272.664 267.012 C 268.192 270.357,268.344 272.961,273.453 280.549 C 278.010 287.318,277.882 290.657,272.777 298.232 C 267.556 305.977,269.217 312.622,276.361 312.571 C 288.218 312.486,295.338 289.895,288.227 274.922 C 284.588 267.259,277.292 263.551,272.664 267.012 " fill-rule="evenodd"></path></svg>`),a.A.add("help",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 13 14"><text x=3 y=13>?</text></svg>`),a.A.add("move",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M360.549 412.216l-96.064 96.269c-4.686 4.686-12.284 4.686-16.971 0l-96.064-96.269c-4.686-4.686-4.686-12.284 0-16.971l19.626-19.626c4.753-4.753 12.484-4.675 17.14.173L230 420.78h2V280H91.22v2l44.986 41.783c4.849 4.656 4.927 12.387.173 17.14l-19.626 19.626c-4.686 4.686-12.284 4.686-16.971 0L3.515 264.485c-4.686-4.686-4.686-12.284 0-16.971l96.269-96.064c4.686-4.686 12.284-4.686 16.97 0l19.626 19.626c4.753 4.753 4.675 12.484-.173 17.14L91.22 230v2H232V91.22h-2l-41.783 44.986c-4.656 4.849-12.387 4.927-17.14.173l-19.626-19.626c-4.686-4.686-4.686-12.284 0-16.971l96.064-96.269c4.686-4.686 12.284-4.686 16.971 0l96.064 96.269c4.686 4.686 4.686 12.284 0 16.971l-19.626 19.626c-4.753 4.753-12.484 4.675-17.14-.173L282 91.22h-2V232h140.78v-2l-44.986-41.783c-4.849-4.656-4.927-12.387-.173-17.14l19.626-19.626c4.686-4.686 12.284-4.686 16.971 0l96.269 96.064c4.686 4.686 4.686 12.284 0 16.971l-96.269 96.064c-4.686 4.686-12.284 4.686-16.971 0l-19.626-19.626c-4.753-4.753-4.675-12.484.173-17.14L420.78 282v-2H280v140.78h2l41.783-44.986c4.656-4.849 12.387-4.927 17.14-.173l19.626 19.626c4.687 4.685 4.687 12.283 0 16.969z"/></svg>`),a.A.add("rotate",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"/></svg>`),a.A.add("pause",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="m21.84 10.035h22.551v79.93h-22.551zm33.766 0h22.551v79.93h-22.551z" fill-rule="evenodd"/></svg>`),a.A.add("caption",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="m16.668 29.168v41.664h66.664v-41.664zm-6.25-8.3359c-1.1523 0-2.0859 0.93359-2.0859 2.0859v54.164c0 1.1523 0.93359 2.0859 2.0859 2.0859h79.164c1.1523 0 2.0859-0.93359 2.0859-2.0859v-54.164c0-1.1523-0.93359-2.0859-2.0859-2.0859zm25 22.918c-3.4531 0-6.25 2.7969-6.25 6.25s2.7969 6.25 6.25 6.25c1.1172 0 2.168-0.29297 3.0781-0.80859 1-0.57031 2.3086-0.69141 3.1719 0.070313l3.125 2.7578c0.85938 0.76172 0.95312 2.0898 0.074219 2.8359-2.543 2.1641-5.8438 3.4766-9.4492 3.4766-8.0547 0-14.586-6.5273-14.586-14.582s6.5312-14.582 14.586-14.582c4.3555 0 8.2695 1.9141 10.934 4.9336l-4.6836 4.1367c-0.86328 0.76172-2.1719 0.64062-3.1719 0.070313-0.91016-0.51562-1.9609-0.80859-3.0781-0.80859zm27.082 6.25c0-3.4531 2.7969-6.25 6.25-6.25 1.1211 0 2.1719 0.29297 3.0781 0.80859 1 0.57031 2.3086 0.69141 3.1719-0.070313l3.125-2.7578c0.86328-0.76172 0.95312-2.0898 0.078125-2.8359-2.543-2.1641-5.8477-3.4766-9.4531-3.4766-8.0547 0-14.582 6.5273-14.582 14.582s6.5273 14.582 14.582 14.582c3.6055 0 6.9102-1.3125 9.4531-3.4766 0.875-0.74609 0.78516-2.0742-0.078125-2.8359l-3.125-2.7578c-0.86328-0.76172-2.1719-0.64062-3.1719-0.070313-0.90625 0.51562-1.957 0.80859-3.0781 0.80859-3.4531 0-6.25-2.7969-6.25-6.25z" fill-rule="evenodd"/></svg>`),a.A.add("undo",o.qy`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M255.545 8c-66.269.119-126.438 26.233-170.86 68.685L48.971 40.971C33.851 25.851 8 36.559 8 57.941V192c0 13.255 10.745 24 24 24h134.059c21.382 0 32.09-25.851 16.971-40.971l-41.75-41.75c30.864-28.899 70.801-44.907 113.23-45.273 92.398-.798 170.283 73.977 169.484 169.442C423.236 348.009 349.816 424 256 424c-41.127 0-79.997-14.678-110.63-41.556-4.743-4.161-11.906-3.908-16.368.553L89.34 422.659c-4.872 4.872-4.631 12.815.482 17.433C133.798 479.813 192.074 504 256 504c136.966 0 247.999-111.033 248-247.998C504.001 119.193 392.354 7.755 255.545 8z"/></svg>`);let $t=class extends o.Ay{static get observedAttributes(){return["root","document"]}constructor(t){super(),this.application=null,t&&(this.application=t),this.addEventListener("focus",this.onFocus)}get fullscreen(){return this.application.system.getMainComponent(n.A)}get arManager(){return this.application.system.getMainComponent(s.A)}get viewer(){return this.application.system.getComponent(r.A)}firstConnected(){if(super.firstConnected(),!this.application){const t={root:this.getAttribute("root"),dracoRoot:this.getAttribute("dracoRoot"),resourceRoot:this.getAttribute("resourceRoot"),document:this.getAttribute("document"),model:this.getAttribute("model"),geometry:this.getAttribute("geometry"),texture:this.getAttribute("texture"),quality:this.getAttribute("quality"),uiMode:this.getAttribute("uiMode"),bgColor:this.getAttribute("bgColor"),bgStyle:this.getAttribute("bgStyle"),controls:this.getAttribute("controls"),prompt:this.getAttribute("prompt"),reader:this.getAttribute("reader"),lang:this.getAttribute("lang")};this.application=new c.A(null,t)}this.attachShadow({mode:"open"});const t=this.shadowRoot;var e=document.createElement("style");e.innerText='/*! normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:normal;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:rgba(0,0,0,0)}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}.ff-fullsize{position:absolute;left:0;right:0;top:0;bottom:0;box-sizing:border-box}.ff-container{position:absolute;left:0;right:0;top:0;bottom:0;box-sizing:border-box;overflow:hidden}.ff-caret-down{width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-bottom:5px solid #a0a0a0;transform:rotate(180deg);transition:transform .05s}.ff-caret-up{width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-bottom:5px solid #a0a0a0;transform:rotate(0deg);transition:transform .05s}.ff-caret-right{width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-bottom:5px solid #a0a0a0;transform:rotate(90deg);transition:transform .05s}.ff-caret-left{width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-bottom:5px solid #a0a0a0;transform:rotate(270deg);transition:transform .05s}html{color:#c8c8c8}button,input{display:block;padding:0;margin:0;border:none;background-color:inherit;color:inherit;font-size:inherit;cursor:inherit}*:focus{outline:1px solid #0089bf;outline-offset:0}*:focus:not(:focus-visible){outline:0}*:focus-visible{outline:1px solid #0089bf;outline-offset:0}.ff-fullscreen{position:fixed;left:0;right:0;top:0;bottom:0}.ff-noselect{user-select:none;-moz-user-select:none;-webkit-user-select:none}.ff-off{user-select:none;-moz-user-select:none;-webkit-user-select:none;pointer-events:none}.ff-on{user-select:auto;-webkit-user-select:none;pointer-events:auto}.ff-focusable{tab-index:0}.ff-flex-row{display:flex}.ff-flex-column{display:flex;flex-direction:column}.ff-flex-wrap{flex-wrap:wrap}.ff-flex-centered{align-items:center}.ff-flex-item-fixed{flex:0 0 auto;position:relative}.ff-flex-item-stretch,.ff-flex-spacer{flex:1 1 auto;position:relative}.ff-scroll-y{position:absolute;left:0;right:0;top:0;bottom:0;box-sizing:border-box;overflow-y:auto}.ff-scroll-x{overflow-x:auto}.ff-position-above{position:absolute;bottom:0}.ff-position-below{position:absolute;top:100%}.ff-position-left{position:absolute;right:0}.ff-position-right{position:absolute;left:100%}.ff-position-above.ff-align-left,.ff-position-below.ff-align-left{left:0}.ff-position-above.ff-align-right,.ff-position-below.ff-align-right{right:0}.ff-position-left.ff-align-top,.ff-position-right.ff-align-top{top:0}.ff-position-left.ff-align-bottom,.ff-position-right.ff-align-bottom{bottom:0}.ff-ellipsis{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.ff-placeholder{flex:1 1 auto;width:100%;height:100%;display:flex;justify-content:center;align-items:center}.ff-splitter-section{flex:1 1 auto;position:relative;box-sizing:border-box;overflow:hidden}.ff-splitter[direction=vertical]+.ff-splitter-section{border-top:2px solid rgb(26.5,26.5,26.5)}.ff-splitter:not([direction=vertical])+.ff-splitter-section{border-left:2px solid rgb(26.5,26.5,26.5)}.ff-frame{padding:4px}.ff-frame .ff-control{margin:4px}.ff-icon{display:inline-block;position:relative;height:1rem;fill:#a0a0a0}.ff-icon svg{width:inherit;height:inherit}.ff-button{cursor:pointer}.ff-button[vertical]{flex-direction:column}.ff-button.ff-inline .ff-icon+.ff-text{padding-left:.5em}.ff-button.ff-inline .ff-icon{display:inline}.ff-button.ff-inline .ff-text{display:inline}.ff-button.ff-transparent{position:relative;display:flex;justify-content:center;align-items:center;flex:0 1 auto;flex-wrap:wrap;padding:5px;background:rgba(0,0,0,0);fill:#a0a0a0;transition:fill .2s}.ff-button.ff-transparent:hover,.ff-button.ff-transparent:focus{fill:#c8c8c8}.ff-button.ff-transparent[selected]{fill:#c8c8c8}.ff-button.ff-transparent>.ff-text{margin:3px;white-space:nowrap}.ff-button.ff-transparent>.ff-icon{margin:3px;height:1.3em}.ff-button.ff-transparent>.ff-caret-down{margin:3px}.ff-button.ff-transparent.ff-disabled{color:gray;fill:#606060;user-select:none;pointer-events:none}.ff-button.ff-control{position:relative;display:flex;justify-content:center;align-items:center;flex:1 1 auto;flex-wrap:wrap;padding:5px;background:rgb(77.5,77.5,77.5);transition:background-color .2s}.ff-button.ff-control:hover,.ff-button.ff-control:focus{background-color:#676767}.ff-button.ff-control[selected]{background-color:#0089bf}.ff-button.ff-control[selected]:hover,.ff-button.ff-control[selected]:focus{background-color:rgb(0,166.264921466,231.8)}.ff-button.ff-control .ff-text{margin:3px;white-space:nowrap;display:inline-block}.ff-button.ff-control>.ff-icon{margin:3px;height:1.3em}.ff-button.ff-control .ff-caret-container{white-space:nowrap}.ff-button.ff-control .ff-caret-down{margin:3px;display:inline-block}.ff-button.ff-control.ff-disabled{color:gray;fill:#606060;user-select:none;pointer-events:none}.ff-button.ff-control.ff-disabled>.ff-icon{fill:#606060}.ff-menu{background-color:rgb(77.5,77.5,77.5);z-index:100;display:flex;flex-direction:column}.ff-menu .ff-divider{height:1px;padding:0;background:#a0a0a0}.ff-menu .ff-button{justify-content:flex-start;margin:0;padding:4px 4px}.ff-menu .ff-button.ff-control{flex-wrap:nowrap}.ff-menu .ff-button .ff-icon{height:1.2em;width:2.2em;margin-right:4px}.ff-dropdown .ff-menu{min-width:100%;margin-top:3px}.ff-modal-plane{position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(0,0,0,.6);opacity:0;transition:opacity .3s;z-index:990;pointer-events:auto}.ff-modal-plane.ff-transition{opacity:1}ff-dialog{box-sizing:border-box;background:#343434;border:1px solid rgb(77.5,77.5,77.5);box-shadow:3px 3px 24px rgba(0,0,0,.4)}ff-title-bar{background:rgb(26.5,26.5,26.5);padding:2px}ff-title-bar .ff-text{flex:1 1 auto;padding-right:8px}ff-title-bar .ff-icon{padding:2px}ff-popup-button .ff-content{transition:opacity .15s}.ff-line-edit{display:block;overflow:hidden;background-color:rgb(26.5,26.5,26.5);min-height:1.6em}.ff-line-edit input{padding:2px}.ff-text-edit{box-sizing:border-box;flex:1 1 auto;display:flex;background-color:rgb(26.5,26.5,26.5)}.ff-text-edit textarea{display:block;box-sizing:border-box;width:100%;padding:2px;resize:none;background:rgba(0,0,0,0);color:inherit;border:none}.ff-color-edit{font-size:.8rem}.ff-color-edit .ff-control{margin:0}.ff-color-edit .ff-slider-controls{align-items:stretch;flex:1 1 auto}.ff-color-edit .ff-numeric-controls{flex:0 0 auto;align-items:center;margin-top:6px}.ff-color-edit .ff-text{color:#a0a0a0;margin:0 3px}.ff-color-edit .ff-line-edit{flex:4 5 auto}.ff-color-edit .ff-line-edit.ff-wide{flex:5 4 auto}.ff-color-edit .ff-knob{margin:-2px 0 0 -2px;border:2px solid #fff;box-shadow:0 0 5px rgba(0,0,0,.5)}.ff-color-edit .ff-vector-slider{flex:1 0 auto;padding:0 10px 10px 0;background-image:linear-gradient(to bottom, transparent, black),linear-gradient(to right, white, red)}.ff-color-edit .ff-vector-slider .ff-knob{width:10px;height:10px}.ff-color-edit .ff-linear-slider{flex:0 0 24px;margin-left:6px;padding-bottom:10px}.ff-color-edit .ff-linear-slider .ff-knob{width:100%;height:10px}.ff-color-edit .ff-hue-slider{background:linear-gradient(to bottom, #f00, #ff0, #0f0, #0ff, #00f, #f0f, #f00)}.ff-color-edit .ff-alpha-slider{color:rgb(77.5,77.5,77.5)}.ff-quad-splitter .ff-left{box-sizing:border-box;border-right:1px solid #343434}.ff-quad-splitter .ff-top{box-sizing:border-box;border-bottom:1px solid #343434}#ff-notification-stack{position:fixed;z-index:100;bottom:0;right:0;width:30%;min-width:250px;max-width:500px}.ff-notification{position:relative;left:0;display:flex;margin:8px;padding:4px;background:rgb(77.5,77.5,77.5);box-shadow:0 0 20px rgba(0,0,0,.35)}.ff-notification.ff-info>.ff-icon{fill:#73adff}.ff-notification.ff-success>.ff-icon{fill:#8ae65c}.ff-notification.ff-warning>.ff-icon{fill:#e6a345}.ff-notification.ff-error>.ff-icon{fill:#e64545}.ff-notification>.ff-icon{height:2em;padding:8px}.ff-notification.ff-out{transition:left .5s ease-in;left:100%}.ff-notification .ff-text{flex:1;padding:8px;text-overflow:ellipsis;overflow:hidden}.ff-notification .ff-button{flex:0;padding:8px}.ff-message-box{position:relative;min-width:350px;max-width:450px;width:90%;padding:16px;background:#343434;box-shadow:0 0 20px rgba(0,0,0,.35);opacity:0;transition:opacity .15s}.ff-message-box.ff-transition{opacity:1}.ff-message-box .ff-title{align-items:flex-start}.ff-message-box .ff-title .ff-type-icon{margin:0 16px 0 0;height:2.5em}.ff-message-box .ff-title .ff-type-icon[name=prompt]{fill:#e6cf5c}.ff-message-box .ff-title .ff-type-icon[name=info]{fill:#73adff}.ff-message-box .ff-title .ff-type-icon[name=warning]{fill:#e6a345}.ff-message-box .ff-title .ff-type-icon[name=error]{fill:#e64545}.ff-message-box .ff-title .ff-content{flex:1 1 auto;margin:0 0 2em 0}.ff-message-box .ff-title .ff-caption{font-size:1.5em}.ff-message-box .ff-title .ff-text{margin:2em 0 1em 0}.ff-message-box .ff-title .ff-line-edit{margin:0 0 1em 0}.ff-message-box .ff-title .ff-line-edit input{padding:4px}.ff-message-box .ff-title .ff-close-button{margin:0 0 0 16px;padding:0}.ff-message-box .ff-button+.ff-button{margin-left:8px}.ff-popup-options{box-sizing:border-box;background:#343434;border:1px solid rgb(77.5,77.5,77.5);box-shadow:3px 3px 24px rgba(0,0,0,.4);min-width:6rem}.ff-popup-options button{padding:4px 8px;text-align:start;user-select:none}.ff-popup-options button+button{margin-top:1px}.ff-popup-options button:hover{background-color:rgb(77.5,77.5,77.5)}.ff-popup-options button:focus{outline:none;background-color:#0089bf}.ff-list{flex:1 1 auto;background-color:rgb(39.25,39.25,39.25)}.ff-list .ff-list-item{cursor:pointer;user-select:none;padding:2px}.ff-list .ff-list-item:hover{background-color:#343434}.ff-list .ff-list-item[selected]{background-color:#0089bf}.ff-list .ff-list-item+.ff-list-item{border-top:1px solid #343434}.ff-table{position:relative;box-sizing:border-box;width:100%}.ff-table table{box-sizing:border-box;width:100%;table-layout:fixed;border-collapse:collapse;border-spacing:0}.ff-table tr[selected]{background-color:#0089bf}.ff-table th,.ff-table td{padding:4px}.ff-table th{background-color:rgb(26.5,26.5,26.5);color:#a0a0a0;text-align:start}.ff-table .ff-table-sort-icon{height:.8em;margin-left:4px;color:#a0a0a0}.ff-tree{position:relative;overflow-y:auto}.ff-tree .ff-tree-node-container{margin-left:-501px;border-top:1px solid rgb(62.2,62.2,62.2);border-bottom:1px solid rgb(62.2,62.2,62.2);margin-bottom:-1px}.ff-tree .ff-tree-node{margin-left:500px}.ff-tree .ff-tree-node.ff-inner{background-color:rgb(46.9,46.9,46.9)}.ff-tree .ff-tree-node.ff-leaf{background-color:rgb(59.65,59.65,59.65)}.ff-tree .ff-tree-node.ff-root{background-color:rgb(39.25,39.25,39.25)}.ff-tree .ff-tree-node[selected]{background-color:#0089bf}.ff-tree .ff-tree-node .ff-header{position:relative;cursor:pointer;padding-left:14px}.ff-tree .ff-tree-node .ff-header .ff-text{user-select:none}.ff-tree .ff-tree-node.ff-drop-target>.ff-header{outline:1px dashed #0089bf}.ff-tree .ff-tree-node.ff-inner[expanded]>.ff-header:before{content:"";position:absolute;top:.6em;left:3px;width:0;height:0;border-left:4px solid rgba(0,0,0,0);border-right:4px solid rgba(0,0,0,0);border-bottom:4px solid #a0a0a0;transform:rotate(180deg);transition:transform .05s}.ff-tree .ff-tree-node.ff-inner:not([expanded])>.ff-header:before{content:"";position:absolute;top:.6em;left:3px;width:0;height:0;border-left:4px solid rgba(0,0,0,0);border-right:4px solid rgba(0,0,0,0);border-bottom:4px solid #a0a0a0;transform:rotate(90deg);transition:transform .05s}.ff-tree .ff-tree-node.ff-leaf .ff-header{cursor:default}.ff-tree .ff-tree-node .ff-content{margin-left:10px}.ff-tree .ff-tree-node:not([expanded])>.ff-content{display:none}ff-tab-container{background:#343434}ff-tab-container,ff-dock-stack{background:rgb(39.25,39.25,39.25);border:1px solid rgb(26.5,26.5,26.5)}ff-tab-container header,ff-dock-stack header{background:rgb(26.5,26.5,26.5)}ff-tab-header,ff-dock-panel-header{background:rgb(26.5,26.5,26.5);color:#c8c8c8;padding:1px 3px 2px 2px}ff-tab-header[active],ff-dock-panel-header[active]{background:linear-gradient(rgb(97.9, 97.9, 97.9), #343434);color:#c8c8c8}ff-tab-header label,ff-dock-panel-header label{pointer-events:none}ff-tab-header .ff-text,ff-dock-panel-header .ff-text{padding:0 1px}ff-tab-header .ff-icon,ff-dock-panel-header .ff-icon{top:1px;height:.8rem;padding:0 1px}.ff-dock-drop-marker{box-sizing:border-box;background:rgba(0,137,191,.3);border:1px solid #0089bf}.ff-viewport-overlay{padding:6px;font-size:.75rem}.ff-viewport-overlay .ff-row{display:flex;justify-content:space-between}.ff-viewport-overlay .ff-labels{display:flex;flex-direction:column}.ff-viewport-overlay .ff-top-left,.ff-viewport-overlay .ff-bottom-left{align-items:flex-start}.ff-viewport-overlay .ff-top-center,.ff-viewport-overlay .ff-bottom-center{align-items:center}.ff-viewport-overlay .ff-top-right,.ff-viewport-overlay .ff-bottom-right{align-items:flex-end}.ff-viewport-overlay .ff-label-box{box-sizing:border-box;padding:1px 8px 2px 8px;background:rgba(0,0,0,.5);border-radius:2em}.sv-article h1{margin:.3em 0;font-family:"Amiri",serif;font-size:2.3em;font-weight:normal;color:#e8e8e8}.sv-article h1:before{content:"";position:absolute;top:0;left:0;width:75px;height:5px;background-color:#0089bf}.sv-article p,.sv-article h2,.sv-article h3,.sv-article h4,.sv-article h5,.sv-article h6,.sv-article ul,.sv-article ol,.sv-article li{font-family:"Hind Siliguri",sans-serif;color:#c8c8c8}.sv-article p,.sv-article ul,.sv-article ol{font-size:1.15em;margin:.8em 0}.sv-article p{line-height:1.55em}.sv-article ul{padding-inline-start:2.5em;list-style:disc outside}.sv-article ol{padding-inline-start:2.5em;list-style:decimal outside}.sv-article a:link,.sv-article a:visited,.sv-article a:hover,.sv-article a:active{color:#0089bf}.sv-article iframe,.sv-article video{max-width:100%}.sv-article img{max-width:100%;height:auto}.sv-article figure{display:table;margin:1rem auto;font-family:"Hind Siliguri",sans-serif;font-size:1.15em}.sv-article figure.align-left{float:left}.sv-article figure.align-right{float:right}.sv-article figure.align-center{text-align:center}.sv-article figure.image figcaption{color:#999;display:block;margin-top:.25rem;text-align:center;-webkit-user-modify:read-only}.sv-content-view{font-family:"Segoe UI","HelveticaNeue","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:400;font-size:.85em;line-height:1.35;color:#c8c8c8;background-color:#343434;position:absolute;left:0;right:0;top:0;bottom:0;box-sizing:border-box;overflow:hidden;user-select:none;-moz-user-select:none;-webkit-user-select:none}.sv-logo{flex:0 50 180px;min-width:40px;display:flex;flex-wrap:wrap;align-items:center;justify-content:flex-end;overflow:hidden;height:40px;user-select:none}.sv-logo .sv-short{flex-grow:1;width:0;max-width:40px}.sv-logo .sv-full{flex:1 0 180px;display:flex;height:100%}.sv-logo .sv-full .sv-logo-full{flex:auto;height:100%}.ff-flex-spacer{user-select:none;-moz-user-select:none;-webkit-user-select:none}.sr-only{position:absolute;left:-10000px;width:1px;height:1px;overflow:hidden}@keyframes spin{100%{transform:rotate(360deg)}}.sv-prompt,.sv-spinner{position:absolute;left:0;right:0;top:0;bottom:0;box-sizing:border-box;display:flex;justify-content:center;align-items:center;pointer-events:none}.sv-spinner-wheel{height:120px;width:120px;animation:spin 5s linear infinite}*{scrollbar-color:#676767 rgb(26.5,26.5,26.5);scrollbar-width:thin}* ::-webkit-scrollbar{width:8px;height:8px}* ::-webkit-scrollbar-track{background-color:rgb(26.5,26.5,26.5)}* ::-webkit-scrollbar-thumb{background-color:#676767;border-radius:8px}voyager-explorer{font-size:16px}.sv-content-only .sv-scene-view,.sv-content-stack .sv-scene-view{position:absolute;left:0;right:0;top:0;bottom:0;box-sizing:border-box;cursor:grab}.sv-content-only .sv-scene-view:focus,.sv-content-stack .sv-scene-view:focus{border:2px solid rgb(191,236.9057591623,255)}.sv-content-only .sv-scene-view:focus:not(:focus-visible),.sv-content-stack .sv-scene-view:focus:not(:focus-visible){border:none;outline:0}.sv-content-only .sv-scene-view:focus-visible,.sv-content-stack .sv-scene-view:focus-visible{border:2px solid rgb(191,236.9057591623,255)}.sv-reader-container{overflow-y:auto}.sv-content-stack .sv-reader-container{position:absolute;left:0;right:0;top:0;bottom:0;box-sizing:border-box;margin-top:52px}.sv-content-stack .sv-reader-view{pointer-events:auto;display:flex;justify-content:center}.sv-content-stack .sv-reader-view .sv-left{flex:0 0 52px}.sv-content-stack .sv-reader-view .sv-article{flex:0 2 720px;background-color:rgba(27,34,38,.5);padding-bottom:35px}.sv-content-stack .sv-reader-view .sv-right{flex:0 3 16px;background-color:rgba(27,34,38,.5)}.sv-content-split{display:flex}.sv-content-split .sv-reader-container{position:absolute;left:0;right:0;top:0;bottom:0;box-sizing:border-box;margin-top:52px}.sv-content-split .sv-scene-view{flex:1 1 60%}.sv-content-split .sv-reader-view{pointer-events:auto;flex:1 1 40%;padding:0 20px}.sv-content-split .sv-reader-view .sv-left{flex:0 0 52px}.sv-content-split .sv-reader-view .sv-article{flex:0 2 720px;background-color:rgba(27,34,38,.5);padding-bottom:35px;padding-right:16px}.sv-content-split .sv-reader-view .sv-right{flex:0 3 16px;background-color:rgba(27,34,38,.5)}.sv-article{position:relative;padding:5px 8px 0 16px;user-select:text;-moz-user-select:text;-webkit-user-select:text}.sv-content-overlay .error-msg{position:absolute;text-align:center;top:50%;left:50%;transform:translate(-50%, -50%);color:red;background-color:silver;padding:8px}.ff-viewport-overlay{font-size:1em}.sv-scene-view{position:absolute;left:0;right:0;top:0;bottom:0;box-sizing:border-box;overflow:hidden}.sv-scene-view.sv-blur{filter:brightness(60%) blur(5px);transition:filter .5s}.sv-annotation{box-sizing:border-box;position:absolute;z-index:1;user-select:none;-moz-user-select:none;-webkit-user-select:none}.sv-annotation a:link,.sv-annotation a:visited,.sv-annotation a:hover,.sv-annotation a:active{color:#0089bf}.sv-annotation img{max-height:120px;max-width:100%}.sv-annotation .sv-img-credit{font-size:x-small}.sv-annotation:has(:focus-visible){opacity:1 !important}.sv-annotation-img{max-width:100%}.sv-circle-annotation{display:flex}.sv-circle-annotation.sv-expanded{z-index:2;width:16%;min-width:180px;max-width:280px}.sv-circle-annotation .sv-marker{background-color:rgba(0,0,0,.65);border-radius:50%;text-align:center;height:18px;aspect-ratio:1/1;border-style:solid;border-width:1px;cursor:pointer;font-size:.9em;color:#fff;-webkit-tap-highlight-color:rgba(0,0,0,0)}.sv-circle-annotation .sv-marker:focus-visible{outline:none;background-color:rgba(31,36,38,.8);box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-circle-annotation .sv-annotation-body{padding:4px 8px;background-color:rgba(0,0,0,.7);border-radius:4px;margin:0px 1px;width:100%}.sv-circle-annotation .sv-annotation-body:has(:focus-visible){outline:none;background-color:rgba(31,36,38,.8);box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-circle-annotation .sv-annotation-body .sv-title{padding:0 0 2px 0;font-weight:bold}.sv-circle-annotation .sv-annotation-body p{font-family:"Segoe UI","HelveticaNeue","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:400;font-size:.88em;line-height:1.35;color:#c8c8c8;margin:.5em 0}.sv-circle-annotation .sv-annotation-body .ff-button{background:rgba(0,0,0,.01)}.sv-circle-annotation .sv-annotation-body .ff-button:hover{text-decoration:underline}.sv-circle-annotation .sv-annotation-body .sv-content{overflow:hidden;overflow-wrap:break-word}.sv-pin-annotation{padding:0 4px;background-color:rgba(0,0,0,.5);color:#c8c8c8;transform:translate(-50%, -100%)}.sv-scale-annotation{opacity:0;transition:opacity .3s ease-in;position:absolute;color:#000;background-color:#fff;font-weight:bold;border-radius:20px;padding-left:4px;padding-right:4px}.sv-scale-annotation.sv-show{opacity:1}.sv-standard-annotation,.sv-extended-annotation{max-width:20%;min-width:min-content;padding:0 4px;background-color:rgba(0,0,0,.5);color:#c8c8c8;pointer-events:auto;overflow-wrap:normal}.sv-standard-annotation:has(:focus-visible),.sv-extended-annotation:has(:focus-visible){outline:none;background-color:rgba(31,36,38,.8);box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-standard-annotation.sv-expanded,.sv-extended-annotation.sv-expanded{width:20%;min-width:180px;background-color:rgba(0,0,0,.8);z-index:2}.sv-standard-annotation.sv-short,.sv-extended-annotation.sv-short{width:unset;min-width:min-content}.sv-standard-annotation.sv-q0,.sv-extended-annotation.sv-q0{transform:translate(0, -100%);border-bottom-style:solid;border-bottom-width:1px;text-align:left}.sv-standard-annotation.sv-q1,.sv-extended-annotation.sv-q1{transform:translate(-100%, -100%);border-bottom-style:solid;border-bottom-width:1px;text-align:right}.sv-standard-annotation.sv-q2,.sv-extended-annotation.sv-q2{transform:translate(-100%, 0);border-top-style:solid;border-top-width:1px;text-align:right}.sv-standard-annotation.sv-q3,.sv-extended-annotation.sv-q3{transform:translate(0, 0);border-top-style:solid;border-top-width:1px;text-align:left}.sv-standard-annotation.sv-static-width,.sv-extended-annotation.sv-static-width{width:fit-content}.sv-standard-annotation .sv-title,.sv-extended-annotation .sv-title{padding:1px 0 2px 0;font-weight:bold;-webkit-tap-highlight-color:rgba(0,0,0,0)}.sv-standard-annotation .sv-title:focus-visible,.sv-extended-annotation .sv-title:focus-visible{outline:none}.sv-standard-annotation .sv-content,.sv-extended-annotation .sv-content{padding:2px 0;height:0;overflow:hidden;overflow-wrap:break-word;transition:height .2s}.sv-standard-annotation p,.sv-extended-annotation p{font-family:"Segoe UI","HelveticaNeue","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:400;font-size:.88em;line-height:1.35;color:#c8c8c8;margin:.5em 0}.sv-standard-annotation .ff-button,.sv-extended-annotation .ff-button{background:rgba(0,0,0,.01)}.sv-standard-annotation .ff-button .ff-icon,.sv-extended-annotation .ff-button .ff-icon{fill:#a0a0a0}.sv-standard-annotation .ff-button:hover,.sv-extended-annotation .ff-button:hover{text-decoration:underline}.sv-extended-annotation .sv-title{cursor:pointer}.sv-standard-annotation{pointer-events:none}.sv-standard-annotation.sv-enable-events{pointer-events:auto;cursor:pointer}.sv-annotation-overlay{padding:7px;pointer-events:auto;background-color:rgba(54,61,64,.6);max-width:min(80%, 800px);min-width:50%;max-height:90%;overflow-y:auto;cursor:auto}.sv-annotation-overlay .sv-annotation-body .ff-button{background:rgba(0,0,0,.01)}.sv-annotation-overlay .sv-annotation-body .ff-button:hover{text-decoration:underline}.sv-ar-prompt{flex:1 1 auto;display:flex;flex-direction:column;align-items:center;text-align:center;border-radius:20px;margin:30% 0 0 0;overflow:hidden;background-color:rgba(54,61,64,.6)}.sv-ar-prompt .sv-content{flex:1;width:100%;margin:10px 10px;text-align:center;-webkit-user-select:none;-ms-user-select:none;user-select:none}.sv-ar-prompt .sv-content .sv-ar-icon{height:10em}.sv-ar-menu{display:flex;position:absolute;bottom:0px;flex-direction:row;margin:0 0 6px 6px}.sv-ar-menu>.ff-button{box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);width:38px;height:38px;margin:0 6px 2px 0;background-color:rgba(74,82,87,.5);border-radius:20px;font-size:17px;transition:all .15s;pointer-events:auto}.sv-ar-menu>.ff-button:hover,.sv-ar-menu>.ff-button:focus{outline:none;background-color:rgba(74,82,87,.5);fill:#c8c8c8}.sv-ar-menu>.ff-button[selected]{background-color:#0089bf;color:#f0f0f0}.sv-ar-menu>.ff-button[selected]>.ff-icon{filter:drop-shadow(1px 1px 6px rgb(0, 100.4188481675, 140));fill:#c8c8c8}.sv-ar-menu>.ff-button[selected]:hover,.sv-ar-menu>.ff-button[selected]:focus{background-color:rgb(0,166.264921466,231.8)}.sv-ar-code{position:relative;width:420px;max-width:85%;max-height:90%;padding:8px;background:#343434;box-shadow:0 0 20px rgba(0,0,0,.35);pointer-events:auto}.sv-ar-code .ff-title{margin:.5em 0 1em 0}.sv-ar-code .ff-title .ff-icon{height:2em;width:2em;padding:2px;border-radius:20px;background-color:rgba(74,82,87,.5)}.sv-ar-code img{height:250px;margin:auto}.sv-chrome-view{font-family:"Segoe UI","HelveticaNeue","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:400;font-size:.85em;line-height:1.35;color:#c8c8c8;position:absolute;left:0;right:0;top:0;bottom:0;box-sizing:border-box;overflow:hidden;display:flex;flex-direction:column;background:linear-gradient(to bottom, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.15) 10%, transparent 25%);z-index:3}.sv-chrome-view .ff-button{flex:0 1 auto;box-sizing:border-box}.sv-chrome-view .ff-button:focus{outline:none;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-chrome-view .ff-button:focus:not(:focus-visible){outline:0;box-shadow:0 0}.sv-chrome-view .ff-button:focus-visible{outline:none;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-chrome-view .ff-button:hover{outline:none}.sv-chrome-view .ff-button:hover>.ff-icon{fill:#c8c8c8}.sv-chrome-view .ff-button[selected]{background-color:#0089bf}.sv-chrome-view .ff-button[selected][disabled]{background-color:rgb(77.5,77.5,77.5)}.sv-chrome-view .ff-button[selected]>.ff-icon{filter:drop-shadow(1px 1px 6px rgb(0, 100.4188481675, 140));fill:#c8c8c8}.sv-chrome-header{display:flex;align-items:flex-start;height:100%;position:relative}.sv-chrome-header .sv-top-bar{flex:1 1 auto;display:flex;align-items:flex-start;height:40px;margin:9px 9px 0 0;overflow:hidden}.sv-chrome-header .sv-main-title{flex:1 1 auto;margin:6px 8px;font-family:"Hind Siliguri",sans-serif;font-weight:normal;font-size:1.412em;white-space:pre;color:#e8e8e8;user-select:none;-moz-user-select:none;-webkit-user-select:none}.sv-chrome-header .sv-main-title span{color:rgba(0,0,0,0)}.sv-chrome-footer{display:block;position:absolute;bottom:0;right:0}.sv-chrome-footer .sv-bottom-bar{flex:1 1 auto;display:flex;align-items:flex-end;text-align:right;overflow:hidden}.sv-chrome-footer .sv-bottom-bar>.ff-button{margin:6px 6px 6px 5px;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);width:38px;height:38px;background-color:rgba(31,36,38,.8);border-radius:20px;font-size:17px;transition:all .15s;pointer-events:auto}.sv-chrome-footer .sv-bottom-bar>.ff-button .ff-text{color:#a0a0a0}.sv-chrome-footer .sv-bottom-bar>.ff-button:focus{outline:none;background-color:rgba(31,36,38,.8);box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-chrome-footer .sv-bottom-bar>.ff-button:focus:not(:focus-visible){outline:0;box-shadow:0 0}.sv-chrome-footer .sv-bottom-bar>.ff-button:focus-visible{outline:none;background-color:rgba(31,36,38,.8);box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-chrome-footer .sv-bottom-bar>.ff-button:hover{background-color:rgba(74,82,87,.5);fill:#c8c8c8}.sv-chrome-footer .sv-bottom-bar>.ff-button:hover>.ff-text{color:#c8c8c8}.sv-chrome-footer .sv-bottom-bar>.ff-button[selected]{background-color:#0089bf;color:#f0f0f0}.sv-chrome-footer .sv-bottom-bar>.ff-button[selected]>.ff-icon{filter:drop-shadow(1px 1px 6px rgb(0, 100.4188481675, 140));fill:#c8c8c8}.sv-chrome-footer .sv-bottom-bar>.ff-button[selected]:hover,.sv-chrome-footer .sv-bottom-bar>.ff-button[selected]:focus{background-color:rgb(0,166.264921466,231.8)}.sv-chrome-footer .sv-text-icon{font-family:"Hind Siliguri",sans-serif;font-weight:bold;line-height:25px}.sv-main-menu-wrapper{position:relative;height:100%;min-width:50px}.sv-main-menu{display:flex;flex-direction:column;padding:6px 9px 6px 6px;height:100%;overflow-y:auto;overflow-x:hidden;pointer-events:auto;position:absolute;box-sizing:border-box;overscroll-behavior-y:contain}.sv-main-menu>.ff-button{margin:2px 0;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);width:38px;height:38px;background-color:rgba(31,36,38,.8);border-radius:20px;font-size:17px;transition:all .15s;pointer-events:auto}.sv-main-menu>.ff-button .ff-text{color:#a0a0a0}.sv-main-menu>.ff-button:focus{outline:none;background-color:rgba(31,36,38,.8);box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-main-menu>.ff-button:focus:not(:focus-visible){outline:0;box-shadow:0 0}.sv-main-menu>.ff-button:focus-visible{outline:none;background-color:rgba(31,36,38,.8);box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-main-menu>.ff-button:hover{background-color:rgba(74,82,87,.5);fill:#c8c8c8}.sv-main-menu>.ff-button:hover>.ff-text{color:#c8c8c8}.sv-main-menu>.ff-button[selected]{background-color:#0089bf;color:#f0f0f0}.sv-main-menu>.ff-button[selected]>.ff-icon{filter:drop-shadow(1px 1px 6px rgb(0, 100.4188481675, 140));fill:#c8c8c8}.sv-main-menu>.ff-button[selected]:hover,.sv-main-menu>.ff-button[selected]:focus{background-color:rgb(0,166.264921466,231.8)}.sv-share-menu{position:relative;width:450px;max-width:85%;padding:8px;background:#343434;box-shadow:0 0 20px rgba(0,0,0,.35);pointer-events:auto}.sv-share-menu .ff-title{margin:.5em 0 1em 0}.sv-share-menu .ff-button{flex:0 0 auto}.sv-share-menu .ff-text-edit{height:6.5em}.sv-share-menu .sv-share-buttons .ff-button{width:48px;height:48px;border-radius:48px;margin:0 1em 1em 0;padding:0}.sv-share-menu .sv-share-buttons .ff-button .ff-icon{height:30px;fill:#f0f0f0}.sv-share-menu .sv-share-button-twitter{background-color:#00aced}.sv-share-menu .sv-share-button-twitter:focus{outline:none;background-color:#00aced;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-share-menu .sv-share-button-twitter:focus:not(:focus-visible){outline:0;box-shadow:0 0}.sv-share-menu .sv-share-button-twitter:focus-visible{outline:none;background:#00aced;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-share-menu .sv-share-button-twitter:hover{background-color:rgb(33,194.1139240506,255)}.sv-share-menu .sv-share-button-facebook{background-color:#3c5a99}.sv-share-menu .sv-share-button-facebook:focus{outline:none;background-color:#3c5a99;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-share-menu .sv-share-button-facebook:focus:not(:focus-visible){outline:0;box-shadow:0 0}.sv-share-menu .sv-share-button-facebook:focus-visible{outline:none;background:#3c5a99;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-share-menu .sv-share-button-facebook:hover{background-color:rgb(78.2957746479,112.9436619718,185.7042253521)}.sv-share-menu .sv-share-button-linkedin{background-color:#0077b5}.sv-share-menu .sv-share-button-linkedin:focus{outline:none;background-color:#0077b5;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-share-menu .sv-share-button-linkedin:focus:not(:focus-visible){outline:0;box-shadow:0 0}.sv-share-menu .sv-share-button-linkedin:focus-visible{outline:none;background:#0077b5;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-share-menu .sv-share-button-linkedin:hover{background-color:rgb(0,152.5303867403,232)}.sv-share-menu .sv-share-button-email{background-color:#d28842}.sv-share-menu .sv-share-button-email:focus{outline:none;background-color:#d28842;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-share-menu .sv-share-button-email:focus:not(:focus-visible){outline:0;box-shadow:0 0}.sv-share-menu .sv-share-button-email:focus-visible{outline:none;background:#d28842;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-share-menu .sv-share-button-email:hover{background-color:hsl(29.1666666667,61.5384615385%,64.1176470588%)}.sv-document-overlay{position:absolute;left:52px;top:52px;right:6px;bottom:0;pointer-events:auto}.sv-tour-menu .sv-article,.sv-reader-view .sv-article{position:relative}.sv-tour-menu .sv-article .sv-nav-button,.sv-reader-view .sv-article .sv-nav-button{float:right;margin:1em .5em;padding:2px}.sv-tour-menu .sv-article .sv-nav-button .ff-icon,.sv-reader-view .sv-article .sv-nav-button .ff-icon{height:1.5em}.sv-tour-menu .sv-entry,.sv-reader-view .sv-entry{position:relative;cursor:pointer;padding:5px 0 5px 15px;margin:2px 2px 16px 2px;max-width:960px;background-color:rgba(27,34,38,.5)}.sv-tour-menu .sv-entry:hover,.sv-reader-view .sv-entry:hover{background-color:rgba(51,59,64,.5)}.sv-tour-menu .sv-entry .sv-titlebar,.sv-reader-view .sv-entry .sv-titlebar{display:flex}.sv-tour-menu .sv-entry .ff-icon,.sv-reader-view .sv-entry .ff-icon{margin:auto 10px auto auto;height:1.5em;border-radius:60px;border-style:solid;box-shadow:0 0 2px #a0a0a0;padding:.6em .6em}.sv-option-menu{position:relative;width:225px;max-width:85%;height:200px;max-height:85%;padding:8px;background:#343434;box-shadow:0 0 20px rgba(0,0,0,.35);pointer-events:auto}.sv-option-menu .ff-title{padding:.3em 0 .3em .3em}.sv-option-menu .ff-header{padding:.3em 0 .3em .3em;background:rgba(31,36,38,.8)}.sv-option-menu .ff-button{flex:0 0 auto}.sv-option-menu .sv-scroll-offset{top:50px}.sv-option-menu .sv-centered{justify-content:center;padding:.3em 0 .3em .3em}.sv-option-menu .sv-entry{position:relative;cursor:pointer;padding:5px 0 5px 15px;margin-bottom:2px;max-width:960px;background-color:rgba(27,34,38,.5);user-select:none;-moz-user-select:none;-webkit-user-select:none}.sv-option-menu .sv-entry:focus{outline:2px solid rgb(191,236.9057591623,255);outline-offset:-2px;background-color:rgba(27,34,38,.5)}.sv-option-menu .sv-entry:focus:not(:focus-visible){outline:0}.sv-option-menu .sv-entry:focus-visible{outline:2px solid rgb(191,236.9057591623,255);outline-offset:-2px;background-color:rgba(27,34,38,.5)}.sv-option-menu .sv-entry:hover{background-color:rgba(51,59,64,.5);fill:#c8c8c8}.sv-option-menu .sv-entry[selected]{background-color:#0089bf;color:#f0f0f0}.sv-option-menu .sv-entry[selected]:hover,.sv-option-menu .sv-entry[selected]:focus{background-color:rgb(0,166.264921466,231.8)}.sv-main-help{position:relative;width:90%;height:90%;padding:8px;background:#343434;pointer-events:auto}.sv-main-help .sv-help-section{display:flex;text-align:center;width:33%;min-width:180px;max-height:90%;flex-direction:column;justify-content:center;margin-top:20px;margin-bottom:20px}.sv-main-help .sv-help-short{min-width:100px}.sv-main-help .sv-help-row{display:flex;flex-wrap:wrap;height:90%;justify-content:center;overflow:auto}.sv-main-help .sv-help-text{padding:5px 5px 0px 5px;display:flex;align-items:center;justify-content:center}.sv-main-help .sv-help-region{height:100%;display:flex;flex-direction:column}.sv-main-help .ff-icon{height:2rem}.sv-main-help .sv-commands{flex:0 0 auto;display:flex;flex-wrap:wrap;padding:2px}.sv-main-help .sv-commands .ff-button{width:50%;min-width:100px}.sv-bottom-bar-container{position:relative;display:flex;justify-content:center;transition:transform .3s ease-out,opacity .15s ease-out;z-index:1}.sv-bottom-bar-container.sv-transition{transform:translateY(40px);opacity:0}.sv-bottom-bar-container .ff-button{transition:all .15s}.sv-blue-bar{flex:0 1 960px;display:flex;flex-direction:column;background-color:rgba(5,7,8,.85);border-left:1px solid rgba(0,137,191,.5);border-right:1px solid rgba(0,137,191,.5);margin:0 -1px 0 -1px;min-width:0px;pointer-events:auto;user-select:none;-moz-user-select:none;-webkit-user-select:none}.sv-blue-bar .sv-group{display:flex;flex-direction:column}.sv-blue-bar .sv-section{position:relative;display:flex;flex-direction:row;border-top:1px solid rgba(0,137,191,.5)}.sv-blue-bar .sv-section-lead,.sv-blue-bar .sv-section-trail{flex:0 0 auto;padding:6px;width:38px}.sv-blue-bar .sv-section-lead:hover,.sv-blue-bar .sv-section-trail:hover{background-color:rgba(74,82,87,.5)}.sv-blue-bar .sv-section-lead{border-right:1px solid rgba(0,137,191,.5)}.sv-blue-bar .sv-section-trail{border-left:1px solid rgba(0,137,191,.5)}.sv-blue-bar .sv-transparent-button{flex:0 1 auto;padding:6px;border-radius:2px}.sv-blue-bar .sv-transparent-button .ff-text{margin:1px 2px}.sv-blue-bar .sv-transparent-button .ff-icon{height:22px;margin:1px 2px}.sv-blue-bar .sv-centered{justify-content:center;padding:.3em 0 .3em .3em}.sv-tour-navigator{color:#c8c8c8}.sv-tour-navigator .sv-content{flex:1;margin:2px 8px;text-align:center}.sv-tour-navigator .sv-title{font-size:1.1em}@keyframes ticker{100%{transform:translateX(var(--x-offset))}}.sv-tour-navigator .sv-text{font-size:.9em}.sv-text-scroll{animation:ticker 1s linear 1;text-overflow:clip}.sv-target-navigator .sv-content{flex:1;margin:2px 8px;text-align:center}.sv-target-navigator .sv-title{font-size:1.1em}.sv-tag-cloud .sv-tag-buttons{flex:1 1 auto;display:flex;flex-wrap:wrap;justify-content:center;margin:4px}.sv-tag-cloud .sv-tag-button{flex:0 1 auto;margin:3px 3px;padding:2px 4px;background-color:rgba(31,36,38,.8);border-radius:3px;font-size:.88em}.sv-tag-cloud .sv-tag-button:hover{background-color:rgba(74,82,87,.5)}.sv-tag-cloud .sv-tag-button[selected]{background-color:#0089bf}.sv-tag-cloud .sv-tag-button .ff-text{margin:1px 2px}.sv-tag-cloud .sv-tag-button .ff-icon{height:22px;margin:1px 2px}.sv-property[disabled],.sv-property[aria-disabled=true]{filter:brightness(0.6)}.sv-property .ff-input{min-width:auto;width:0;margin:0;padding:2px}.sv-property .ff-input,.sv-property select{text-align:right;background-image:none;appearance:auto}.sv-property .ff-input:focus,.sv-property select:focus{text-align:left}.sv-property.sv-property-color{position:relative;display:block}.sv-property.sv-property-color>.sv-property-field{display:flex}.sv-property.sv-property-color>.sv-property-field .ff-button{min-width:23px;border-radius:2px;margin:2px}.sv-property.sv-property-color .ff-color-edit{position:absolute;width:200px;height:180px;right:0px;top:-188px;background:rgb(39.25,39.25,39.25);padding:8px;border-radius:2px}.sv-property.sv-property-number .sv-property-field{position:relative;touch-action:none;display:inline-flex}.sv-property.sv-property-number .sv-property-field .ff-bar{background:rgb(39.25,39.25,39.25);position:absolute;inset:0;margin:0;width:0;box-sizing:border-box;border:2px solid rgb(26.5,26.5,26.5)}.sv-property.sv-property-number .sv-property-field .ff-input,.sv-property.sv-property-number .sv-property-field .ff-unit{position:relative;touch-action:none}.sv-property.sv-property-number .sv-property-field .ff-bar,.sv-property.sv-property-number .sv-property-field .ff-unit{pointer-events:none;user-select:none}.sv-property.sv-property-slider{flex:0 2 180px}.sv-property.sv-property-slider .ff-linear-slider{height:6px;margin:12px 2px;padding-right:16px;border-radius:2px;background-color:rgb(77.5,77.5,77.5)}.sv-property.sv-property-slider .ff-linear-slider .ff-knob{width:16px;height:26px;margin:-10px 0 0 0;border-radius:2px;background-color:#0089bf;box-shadow:0 0 6px #000}.sv-property.sv-property-options .sv-options-buttons{display:flex;flex-wrap:wrap;justify-content:center;padding:2px 0;gap:2px}.sv-property.sv-property-options .sv-options-buttons .ff-button.ff-control{flex:0 1 auto}.sv-tool-bar{color:#c8c8c8;pointer-events:auto}.sv-tool-bar .sv-tool-buttons{flex:1 1 auto;display:flex;margin:4px;overflow-x:auto}.sv-tool-bar .sv-tool-buttons .sv-tool-button:first-child{margin-left:auto}.sv-tool-bar .sv-tool-buttons .sv-tool-button:last-child{margin-right:auto}.sv-tool-bar .sv-tool-button{flex:0 1 auto;margin:2px;padding:1px 2px;border-radius:3px;font-size:.882em}.sv-tool-bar .sv-tool-button .ff-text{margin:1px 2px}.sv-tool-bar .sv-tool-button .ff-icon{height:22px;margin:1px 2px}.sv-tool-bar-container{position:relative;bottom:0px;width:100%}.sv-tool-controls{flex:1 1 auto;display:flex;justify-content:center;align-items:center;font-size:.882em}.sv-tool-controls .sv-property{flex:0 1 auto;align-self:start;display:flex;flex-direction:column;margin:4px}.sv-tool-controls .sv-property label{height:1.25em}.sv-tool-controls .sv-property.sv-nogap{margin:4px 0 !important}.sv-tool-controls .sv-property.sv-property-slider{flex:0 2 180px}.sv-tool-controls .sv-options{display:flex}.sv-tool-controls .ff-label{margin:2px}.sv-tool-controls .ff-string{flex:0 1 auto;height:26px;margin:2px;font-size:1.34em}.sv-tool-controls .ff-button{height:26px;margin:2px;padding:0 4px;background:#343434;border-radius:2px}.sv-tool-controls .ff-button:focus{outline:none;background:#343434;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-tool-controls .ff-button:focus:not(:focus-visible){outline:0;box-shadow:0 0}.sv-tool-controls .ff-button:focus-visible{outline:none;background:#343434;box-shadow:0 0 3pt 2pt rgb(191,236.9057591623,255)}.sv-tool-controls .ff-button:hover{background-color:#676767;fill:#c8c8c8}.sv-view-tool-view .sv-options,.sv-render-tool-view .sv-options,.sv-light-tool-view .sv-options{flex-wrap:wrap}.sv-tape-tool-view .sv-tool-controls,.sv-slice-tool-view .sv-tool-controls,.sv-environment-tool-view .sv-tool-controls{flex-wrap:wrap}.sv-action-prompt{height:30px;width:30px;fill:#fff}.sv-caption-view{position:absolute;bottom:10%;z-index:2;font-size:1.5rem;justify-content:center;display:flex;width:100%}.sv-caption-box{position:relative;text-align:center;background-color:rgba(0,0,0,.85);max-width:85%}.sv-splash{padding:7px;pointer-events:auto;background-color:rgba(54,61,64,.6);max-width:min(80%, 800px);min-width:50%;max-height:90%;overflow-y:auto}.sv-splash>:focus-visible{outline:none;box-shadow:0 0}.sv-audio-view{display:flex;align-items:center;flex:1 1 auto;max-width:100%;min-width:110px;height:30px;background-color:#f0f0f0;border-radius:15px;color:#000;cursor:auto}.sv-audio-view>.ff-button{width:30px;height:30px;border-radius:15px;flex:0 1 auto;padding:0px;margin-right:3px;background-color:#f0f0f0;-webkit-tap-highlight-color:rgba(0,0,0,0)}.sv-audio-view>.ff-button .ff-icon{height:1.5em;margin:5px;fill:#000}.sv-audio-view>.ff-button:focus{background-color:#f0f0f0}.sv-audio-view>.ff-button:hover{background-color:rgb(163.5,163.5,163.5)}.sv-audio-view>.ff-button:hover>.ff-icon{fill:#000}.sv-audio-view .sv-timer{font-size:small;display:flex}.sv-audio-view input{width:100%;margin-left:3px;margin-right:3px}.sv-narrate-player{position:absolute;pointer-events:auto;width:200px;max-width:75%;margin:auto auto;left:0;right:0;z-index:4;padding-top:6px}',t.appendChild(e);const i=this.application.system;t.appendChild(new tt(i)),t.appendChild(new Ht(i));const n=document.createElement("div");n.setAttribute("id",l.Ay.stackId),t.appendChild(n),l.Ay.shadowRootNode=t;const s=document.createElement("div");s.classList.add("sr-only"),s.setAttribute("id","sr-intro"),s.setAttribute("aria-live","polite"),t.appendChild(s)}connected(){this.fullscreen.fullscreenElement=this,this.viewer.rootElement=this,this.arManager.shadowRoot=this.shadowRoot}disconnected(){super.disconnected(),this.fullscreen.fullscreenElement=null,this.viewer.rootElement=null,window.VoyagerStory||(this.application.dispose(),this.application=null)}attributeChangedCallback(t,e,i){const n=this.application;if(super.attributeChangedCallback(t,e,i),n&&"root"===t){const t=this.getAttribute("root");t.length>0&&(n.props.root=t,n.reloadDocument(),this.connected())}else!n||"document"!==t&&"iiif-content"!==t?n&&"controls"===t&&n.enableNavigation(i):(n.props.document=this.getAttribute(t),n.reloadDocument(),this.connected())}onFocus(){this.shadowRoot.getElementById("sr-intro").innerText="The Voyager web application allows you to view and interact with a 3D model from the Smithsonian collection. Use the tab key to move through interactive elements, enter or spacebar keys to activate, and the escape key to exit menus."}toggleAnnotations(){this.application&&this.application.toggleAnnotations()}toggleReader(){this.application&&this.application.toggleReader()}toggleTours(){this.application&&this.application.toggleTours()}toggleTools(){this.application&&this.application.toggleTools()}toggleMeasurement(){this.application&&this.application.toggleMeasurement()}enableAR(){this.application&&this.application.enableAR()}getArticles(){if(this.application){return this.application.getArticles()}}getAnnotations(){if(this.application){return this.application.getAnnotations()}}getCameraOrbit(t){if(this.application){return this.application.getCameraOrbit(t||null)}}setCameraOrbit(t,e){this.application&&this.application.setCameraOrbit(t,e)}getCameraOffset(t){if(this.application){return this.application.getCameraOffset(t||null)}}setCameraOffset(t,e,i){this.application&&this.application.setCameraOffset(t,e,i)}setBackgroundColor(t,e){this.application&&this.application.setBackgroundColor(t,e||null)}setBackgroundStyle(t){this.application&&this.application.setBackgroundStyle(t)}setActiveAnnotation(t){this.application&&this.viewer.ins.activeAnnotation.setValue(t)}setActiveArticle(t){this.application&&this.application.setActiveArticle(t)}setTourStep(t,e,i){this.application&&this.application.setTourStep(t,e,void 0===i||i)}getTours(){if(this.application)return this.application.getTours()}setLanguage(t){this.application&&this.application.setLanguage(t)}getLanguages(){if(this.application)return this.application.getLanguages()}getActiveLanguage(){if(this.application)return this.application.getActiveLanguage()}resetViewer(){this.application&&this.application.resetViewer()}getTags(){if(this.application){return this.viewer.outs.tagCloud.value}}setActiveTags(t){if(this.application){this.viewer.ins.activeTags.setValue(t)}}};$t=qt([(0,o.EM)("voyager-explorer")],$t);const Wt=$t},9733:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>p,gK:()=>d.gK});var n=i(3331);const s=[function(t){return t},function(t,e){for(let i=0,n=e.length;i<n;++i)e[i]=t[i];return e}],r=[function(t){return!!t},function(t,e){for(let i=0,n=e.length;i<n;++i)e[i]=!!t[i];return e}],o=[function(t){return String(t)},function(t,e){for(let i=0,n=e.length;i<n;++i)e[i]=String(t[i]);return e}],a=[function(t,e){throw new Error(`illegal value conversion from ${typeof t} to ${typeof e}`)},function(t,e,i){throw new Error(`illegal array conversion from ${typeof t[0]} to ${typeof e[0]}`)}],l={number:{number:s,boolean:r,string:o,object:a},boolean:{number:[function(t){return t?1:0},function(t,e){for(let i=0,n=e.length;i<n;++i)e[i]=t[i]?1:0;return e}],boolean:s,string:o,object:a},string:{number:[function(t){return parseFloat(t)||0},function(t,e){for(let i=0,n=e.length;i<n;++i)e[i]=parseFloat(t[i])||0;return e}],boolean:r,string:s,object:a},object:{number:a,boolean:r,string:o,object:s}},c={number:{number:!0,boolean:!0,string:!0,object:!1},boolean:{number:!0,boolean:!0,string:!0,object:!1},string:{number:!0,boolean:!0,string:!0,object:!1},object:{number:!1,boolean:!0,string:!0,object:!0}},h=[[function(t,e,i){return i(t,e)},function(t,e,i){return e[0]=i(t),e},function(t,e,i){return e[1]=i(t),e},function(t,e,i){return e[2]=i(t),e},function(t,e,i){return e[3]=i(t),e}],[function(t,e,i){return i(t[0])},function(t,e,i){return e[0]=i(t[0]),e},function(t,e,i){return e[1]=i(t[0]),e},function(t,e,i){return e[2]=i(t[0]),e},function(t,e,i){return e[3]=i(t[0]),e}],[function(t,e,i){return i(t[1])},function(t,e,i){return e[0]=i(t[1]),e},function(t,e,i){return e[1]=i(t[1]),e},function(t,e,i){return e[2]=i(t[1]),e},function(t,e,i){return e[3]=i(t[1]),e}],[function(t,e,i){return i(t[2])},function(t,e,i){return e[0]=i(t[2]),e},function(t,e,i){return e[1]=i(t[2]),e},function(t,e,i){return e[2]=i(t[2]),e},function(t,e,i){return e[3]=i(t[2]),e}],[function(t,e,i){return i(t[3])},function(t,e,i){return e[0]=i(t[3]),e},function(t,e,i){return e[1]=i(t[3]),e},function(t,e,i){return e[2]=i(t[3]),e},function(t,e,i){return e[3]=i(t[3]),e}]];class u{constructor(t,e,i,n){if(1===t.elementCount&&i>=0)throw new Error("non-array source property; can't link to element");if(1===e.elementCount&&n>=0)throw new Error("non-array destination property; can't link to element");this.source=t,this.destination=e,this.sourceIndex=i,this.destinationIndex=n;const s=void 0===i?-1:i,r=void 0===n?-1:n,o=t.elementCount>1&&s<0&&r<0;this.fnConvert=function(t,e,i){const n=i?1:0;return l[t][e][n]}(t.type,e.type,o);const a=function(t,e,i){return-1===t&&-1===e?i:t<=3&&e<=3?h[t+1][e+1]:function(i,n,s){return n[e]=s(i[t]),n}}(s,r,this.fnConvert);var c,u,d;this.fnCopy=(c=t.isMulti(),u=e.isMulti(),d=a,!1===c?!1===u?d:function(t,e,i){for(let i=0,n=e.length;i<n;++i)e[i]=d(t,e[i]);return e}:!1===u?function(t,e,i){return t.length>0&&(e=d(t[0],e)),e}:function(t,e,i){for(let i=0,n=t.length,s=e.length;i<s;++i)e[i]=d(t[i%n],e[i]);return e})}push(){this.destination.setValue(this.fnCopy(this.source.value,this.destination.value,this.fnConvert))}}var d=i(0);class p extends n.A{constructor(t,e,i){if(super(),this.addEvents("value","link","change","dispose"),!e||void 0===e.preset)throw new Error("missing schema/preset");const n=e.preset,s=Array.isArray(n);this.type=typeof(s?n[0]:n),this.schema=e,this.custom=i||!1,this.elementCount=s?n.length:1,this.inLinks=[],this.outLinks=[],this._group=null,this._key="",this._path=t,this.value=null,this.reset(),this.changed=!e.event}get group(){return this._group}get key(){return this._key}get path(){return this._path}set path(t){this._path=t,this.emit({type:"change",what:"path",property:this})}get name(){return this._path.split(".").pop()}dispose(){this.unlink(),this._group&&this._group.removeProperty(this),this.emit({type:"dispose",property:this})}setValue(t,e,i){this.value=t,e||(this.changed=!0,this.isInput()&&(this._group.linkable.changed=!0)),i||this.emit("value",t);const n=this.outLinks;for(let t=0,e=n.length;t<e;++t)n[t].push()}setOption(t,e,i){if(!this.schema.options)throw new Error("not an 'option' type");const n=this.schema.options.indexOf(t);n>=0&&this.setValue(n,e,i)}copyValue(t,e){Array.isArray(t)&&(t=t.slice()),this.setValue(t,e)}set(t){t||(this.changed=!0,this.isInput()&&(this._group.linkable.changed=!0)),this.emit("value",this.value);const e=this.outLinks;for(let t=0,i=e.length;t<i;++t)e[t].push()}cloneValue(){const t=this.value;return Array.isArray(t)?t.slice():t}getValidatedValue(t){const e=this.value;if(this.isArray()){t=t||[];for(let i=0,n=e.length;i<n;++i)t[i]=this.validateValue(e[i]);return t}return this.validateValue(e)}linkTo(t,e,i){t.linkFrom(this,e,i)}linkFrom(t,e,i){if(!this.canLinkFrom(t,e,i))throw new Error(`can't link from '${t.path}' to '${this.path}'`);const n=new u(t,this,e,i);t.addOutLink(n),this.addInLink(n)}unlinkTo(t,e,i){t.unlinkFrom(this,e,i)}unlinkFrom(t,e,i){const n=this.inLinks.find(n=>n.source===t&&n.sourceIndex===e&&n.destinationIndex===i);return!!n&&(t.removeOutLink(n),this.removeInLink(n),!0)}unlink(){this.inLinks.slice().forEach(t=>{t.source.removeOutLink(t),this.removeInLink(t)});if(this.outLinks.slice().forEach(t=>{this.removeOutLink(t),t.destination.removeInLink(t)}),0!==this.inLinks.length||0!==this.outLinks.length)throw new Error("fatal: leftover links")}addInLink(t){if(t.destination!==this)throw new Error("input link's destination must equal this");this.inLinks.push(t),this.requestSort(),this.emit({type:"link",add:!0,remove:!1,link:t})}addOutLink(t){if(t.source!==this)throw new Error("output link's source must equal this");this.outLinks.push(t),this.requestSort(),t.push()}removeInLink(t){const e=this.inLinks.indexOf(t);if(e<0)throw new Error("input link not found");this.inLinks.splice(e,1),this.requestSort(),0===this.inLinks.length&&"object"===this.type&&this.reset(),this.emit({type:"link",add:!1,remove:!0,link:t})}removeOutLink(t){const e=this.outLinks.indexOf(t);if(e<0)throw new Error("output link not found");this.outLinks.splice(e,1),this.requestSort()}canLinkTo(t,e,i){return t.canLinkFrom(this,e,i)}canLinkFrom(t,e,i){if(this.isOutput())return!1;const n=e>=0,s=i>=0;if(!t.isArray()&&n)throw new Error("non-array source property; can't link to element");if(!this.isArray()&&s)throw new Error("non-array destination property; can't link to element");const r=t.isArray()&&!n;return r===(this.isArray()&&!s)&&((!r||t.elementCount===this.elementCount)&&(!("object"===t.type&&"object"===this.type&&!function(t,e){if(!t||!e)return!1;let i=t.prototype;for(;i;){if(i===e.prototype)return!0;i=i.prototype}return!1}(t.schema.objectType,this.schema.objectType))&&(o=t.type,a=this.type,c[o][a])));var o,a}reset(){let t;if(this.isMulti()){let e=this.value;e?e.length=1:t=e=[],e[0]=this.clonePreset()}else t=this.clonePreset();this.setValue(t)}setMultiChannelCount(t){if(!this.isMulti())throw new Error("can't set multi channel count on non-multi property");const e=this.value,i=e.length;e.length=t;for(let n=i;n<t;++n)e[n]=this.clonePreset();this.changed=!0}requestSort(){this._group&&this._group.linkable&&this._group.linkable.requestSort()}setOptions(t){if(!this.schema.options)throw new Error(`property type mismatch, can't set options on '${this.path}'`);this.schema.options=t.slice(),this.emit({type:"change",what:"options",property:this})}getOptionText(){const t=this.schema.options;if("number"===this.type&&t){const e=Math.trunc(this.value);return t[e<0||e>=t.length?0:e]||""}}isInput(){return this._group&&this._group===this._group.linkable.ins}isOutput(){return this._group&&this._group===this._group.linkable.outs}isArray(){return Array.isArray(this.schema.preset)}isMulti(){return!!this.schema.multi}isDefault(){const t=this.schema.multi?this.value[0]:this.value,e=this.schema.preset,i=Array.isArray(t)?t.length:-1;if(i!==(Array.isArray(e)?e.length:-1))return!1;if(i>=0){for(let n=0;n<i;++n)if(t[n]!==e[n])return!1;return!0}return t===e}hasLinks(){return this.inLinks.length>0||this.outLinks.length>0}hasInLinks(t){const e=this.inLinks;if(!(t>=0))return e.length>0;for(let i=0,n=e.length;i<n;++i)if(e[i].destinationIndex===t)return!0;return!1}hasMainInLinks(){const t=this.inLinks;for(let e=0,i=t.length;e<i;++e)if(!(t[e].destinationIndex>=0))return!0;return!1}hasOutLinks(t){const e=this.outLinks;if(!(t>=0))return e.length>0;for(let i=0,n=e.length;i<n;++i)if(e[i].sourceIndex===t)return!0;return!1}inLinkCount(){return this.inLinks.length}outLinkCount(){return this.outLinks.length}toJSON(){let t=this.custom?{path:this.path,schema:Object.assign({},this.schema)}:null;return this.isOutput()||this.hasMainInLinks()||this.isDefault()||"object"===this.type||(t=t||{},t.value=this.value),this.outLinks.length>0&&(t=t||{},t.links=this.outLinks.map(t=>{const e={id:t.destination._group.linkable.id,key:t.destination.key};return t.sourceIndex>=0&&(e.srcIndex=t.sourceIndex),t.destinationIndex>=0&&(e.dstIndex=t.destinationIndex),e})),t}fromJSON(t,e){void 0!==t.value&&(this.value=t.value),void 0!==t.links&&t.links.forEach(t=>{e[t.id].ins[t.key].linkFrom(this,t.srcIndex,t.dstIndex)})}toString(){const t=this.schema,e=t.event?"event":t.options?"enum":this.type;return`${this.path} [${e}]`}dump(t=""){console.log(t+`Property '${this.path}', key: ${this.key}, value: ${this.value}`)}validateValue(t){const e=this.schema;if(e.enum){const i=Math.trunc(t);return e.enum[i]?i:0}if(e.options){const i=Math.trunc(t);return i<0||i>=e.options.length?0:i}return"number"===this.type?(t=e.min?Math.max(e.min,t):t,t=e.max?Math.min(e.max,t):t):t}clonePreset(){const t=this.schema.preset;return Array.isArray(t)?t.slice():t}}},9820:(t,e,i)=>{var n=i(6788),s=1/0;t.exports=function(t){return(null==t?0:t.length)?n(t,s):[]}},9851:(t,e,i)=>{"use strict";var n=i(6763),s=i(4019),r=function(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};let o=class extends s.A{constructor(){super(...arguments),this.type="string",this.property=null,this.name="",this.onChange=t=>{const e=t.target.value;this.property.setValue(e)}}firstConnected(){super.firstConnected(),this.classList.add("sv-property-string")}update(t){if(!this.property)throw new Error("missing property attribute");if("string"!==this.property.type)throw new Error(`not a string property: '${this.property.path}'`);if(t.has("property")){const e=t.get("property");e&&e.off("value",this.onUpdate,this),this.property&&this.property.on("value",this.onUpdate,this)}super.update(t)}render(){const t=this.property,e=this.name||t.name,i=t.value;return n.qy`${e?n.qy`<label class="ff-label ff-off">${e}</label>`:null}
            <input ?disabled=${"true"===this.ariaDisabled} type="text" class="sv-property-field ff-input"
                .value=${i} 
                @change=${this.onChange}
                @focus=${t=>{t.target.select()}}}
                @keypress=${t=>{"Enter"===t.key&&t.target.blur()}}
            >
        `}};r([(0,n.MZ)({attribute:!1})],o.prototype,"property",void 0),r([(0,n.MZ)({type:String})],o.prototype,"name",void 0),o=r([(0,n.EM)("sv-property-string")],o)},9909:(t,e,i)=>{"use strict";i.d(e,{A:()=>A});var n=i(3423),s=i(8313),r=i(6679),o=i(9616),a=i(4640),l=i(9521),c=i(2652),h=i(3350),u=i(4085),d=i(1721);const p=new a.Pq0,f=new a.Pq0,g=new a.PTz,m=new a.kn4;class A extends n.Ay{constructor(){super(...arguments),this._clock=new a.zD7,this._mixer=null,this._activeClips=[],this._direction={},this._initialOffset={},this._animGroups={},this._animQueue=[],this.ins=this.addInputs(A.ins)}get setup(){return this.getGraphComponent(d.A)}get viewer(){return this.getGraphComponent(c.A)}create(){super.create(),this._mixer=new a.Iw4(null),this._mixer.addEventListener("finished",t=>{const e=this._activeClips.findIndex(e=>e.clip===t.action);e>-1&&this._activeClips.splice(e,1)}),this.graph.components.on(o.A,this.onModelComponent,this),this.graph.components.on(u.A,this.onSnapshotsComponent,this),this.system.on("pointer-up",this.onPointerUp,this),this.viewer.ins.activeAnnotation.on("value",this.onAnnotationActivate,this)}dispose(){this.viewer.ins.activeAnnotation.off("value",this.onAnnotationActivate,this),this.system.off("pointer-up",this.onPointerUp,this),this.graph.components.off(u.A,this.onSnapshotsComponent,this),this.graph.components.off(o.A,this.onModelComponent,this),super.dispose()}update(){const{ins:t,outs:e}=this;return t.reset.changed&&(this._mixer.stopAllAction(),Object.keys(this._direction).forEach(t=>delete this._direction[t]),this._activeClips.length=0),!0}stopAction(t){if(t.type==r.mB[r.mB.PlayAnimation]){const e=this._activeClips.findIndex(e=>e.id===t.id);e>-1&&(this._activeClips[e].clip.stop(),this._activeClips.splice(e,1))}}onPointerUp(t){if(t.isPrimary&&!t.isDragging&&!this.setup.tape.ins.enabled.value&&t.component&&t.component.is(o.A)){if(t.originalEvent.composedPath().slice(0,5).some(t=>t instanceof l.sf))return;const e=t.component.node.getComponent(s.A,!0);if(e){const i=e.actions.items.filter(t=>t.trigger==r.Ui[r.Ui.OnClick]);i.length>0&&i.forEach(e=>{e.type==r.mB[r.mB.PlayAudio]?this.setup.audio.play(e.audioId):e.type==r.mB[r.mB.PlayAnimation]&&this.playAnimation(t.component,e)})}}}tick(){const t=this._clock.getDelta();return this._activeClips.length>0&&(this._mixer.update(t),!0)}onModelComponent(t){const e=t.object;t.add?e.on("model-load",t=>this.onModelLoad(t,e),this):t.remove&&e.off("model-load",t=>this.onModelLoad(t,e),this)}onSnapshotsComponent(t){const e=t.object;t.add?e.outs.end.on("value",this.onTransitionEnd,this):t.remove&&e.outs.end.off("value",this.onTransitionEnd,this)}onModelLoad(t,e){const i=e.node.getComponent(s.A,!0);if(i){const t=i.actions.items.filter(t=>t.trigger==r.Ui[r.Ui.OnLoad]);t.length>0&&t.forEach(t=>{this.playAnimation(e,t)})}}onAnnotationActivate(){const t=this.viewer.ins.activeAnnotation.value;this.getGraphComponents(s.A).forEach(e=>{const i=e.actions.items.filter(e=>t.length>0&&e.annotationId==t);i.length>0&&i.forEach(i=>{if(i.type==r.mB[r.mB.PlayAnimation]){const n=e.node.getComponent(o.A);n.getComponent(h.A).getAnnotationById(t).data.viewId?this._animQueue.push({model:n,action:i}):this.playAnimation(n,i)}})})}onTransitionEnd(){for(;this._animQueue.length>0;){const t=this._animQueue.pop();this.playAnimation(t.model,t.action)}}playAnimation(t,e){const i=t.object3D.children[0].children[0],n=t.object3D,s=t.node.getComponent(h.A).object3D;s.parent.name!==i.name&&(s.parent.add((new a.B69).add((new a.B69).add(s))),s.parent.name=i.name,s.parent.parent.matrixAutoUpdate=!1,this._initialOffset[i.id]=(new a.kn4).copy(i.matrix),this._animGroups[i.id]=new a.P5j(i,s.parent)),i.matrixAutoUpdate=!0,n.matrix.decompose(p,g,f),p.multiplyScalar(1/f.x),f.setScalar(1),s.matrix.compose(p,g,f).invert(),s.matrix.multiply(m.copy(this._initialOffset[i.id]).invert()),s.parent.parent.matrix.copy(n.matrix),s.parent.parent.matrixWorldNeedsUpdate=!0;const o=this._mixer.clipAction(a.tz3.findByName(i.animations,e.animation),this._animGroups[i.id]);if(o&&!o.isRunning()){if(o.reset(),e.style==r.nf[r.nf.PingPong]){const t=o.getClip().name;o.clampWhenFinished=!0,Object.keys(this._direction).includes(t)?(this._direction[t]*=-1,o.timeScale=this._direction[t],o.time=o.timeScale>0?0:o.getClip().duration):this._direction[t]=1}else o.time=0,o.timeScale=1,o.clampWhenFinished=!1;e.style==r.nf[r.nf.Loop]?o.setLoop(a.aMy,1/0):o.setLoop(a.G3T,1),o.play(),!this._activeClips.some(t=>t.id===e.id)&&this._activeClips.push({id:e.id,clip:o})}}fromData(){}toData(){return null}}A.typeName="CVActionManager",A.text="Actions",A.icon="",A.isSystemSingleton=!0,A.ins={reset:n.gK.Event("Actions.Reset")}},9929:(t,e)=>{"use strict";var i,n,s,r,o,a,l,c,h,u;e.LX=e.T5=e.C0=e.bB=e.es=e.S3=e.nS=void 0,function(t){t.BOOKMARKING="oa:bookmarking",t.CLASSIFYING="oa:classifying",t.COMMENTING="oa:commenting",t.DESCRIBING="oa:describing",t.EDITING="oa:editing",t.HIGHLIGHTING="oa:highlighting",t.IDENTIFYING="oa:identifying",t.LINKING="oa:linking",t.MODERATING="oa:moderating",t.PAINTING="sc:painting",t.QUESTIONING="oa:questioning",t.REPLYING="oa:replying",t.TAGGING="oa:tagging",t.TRANSCRIBING="oad:transcribing"}(i||(i={})),function(t){t.AUTO_ADVANCE="auto-advance",t.CONTINUOUS="continuous",t.FACING_PAGES="facing-pages",t.HIDDEN="hidden",t.INDIVIDUALS="individuals",t.MULTI_PART="multi-part",t.NO_NAV="no-nav",t.NON_PAGED="non-paged",t.PAGED="paged",t.REPEAT="repeat",t.SEQUENCE="sequence",t.THUMBNAIL_NAV="thumbnail-nav",t.TOGETHER="together",t.UNORDERED="unordered"}(n||(e.nS=n={})),function(t){t.CANVAS="canvas",t.CHOICE="choice",t.OA_CHOICE="oa:choice",t.CONTENT_AS_TEXT="contentastext",t.DATASET="dataset",t.DOCUMENT="document",t.IMAGE="image",t.MODEL="model",t.MOVING_IMAGE="movingimage",t.PDF="pdf",t.PHYSICAL_OBJECT="physicalobject",t.SOUND="sound",t.TEXT="text",t.TEXTUALBODY="textualbody",t.VIDEO="video"}(s||(e.S3=s={})),function(t){t.ANNOTATION="annotation",t.CANVAS="canvas",t.COLLECTION="collection",t.MANIFEST="manifest",t.RANGE="range",t.SEQUENCE="sequence"}(r||(e.es=r={})),function(t){t.AUDIO_MP4="audio/mp4",t.CORTO="application/corto",t.DICOM="application/dicom",t.DRACO="application/draco",t.EPUB="application/epub+zip",t.GIRDER="image/vnd.kitware.girder",t.GLB="model/gltf-binary",t.GLTF="model/gltf+json",t.IIIF_PRESENTATION_2='application/ld+json;profile="http://iiif.io/api/presentation/2/context.json"',t.IIIF_PRESENTATION_3='application/ld+json;profile="http://iiif.io/api/presentation/3/context.json"',t.JPG="image/jpeg",t.M3U8="application/vnd.apple.mpegurl",t.MP3="audio/mp3",t.MPEG="audio/mpeg",t.MPEG_DASH="application/dash+xml",t.OBJ="model/obj",t.OPF="application/oebps-package+xml",t.PDF="application/pdf",t.PLY="application/ply",t.THREEJS="application/vnd.threejs+json",t.USDZ="model/vnd.usd+zip",t.VIDEO_MP4="video/mp4",t.WAV="audio/wav",t.WEBM="video/webm"}(o||(o={})),function(t){t.DOC="application/msword",t.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",t.ODT="application/vnd.oasis.opendocument.text",t.PDF="application/pdf"}(a||(a={})),function(t){t.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",t.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",t.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",t.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",t.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",t.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",t.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",t.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",t.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",t.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",t.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",t.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",t.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",t.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",t.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",t.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",t.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",t.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",t.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",t.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",t.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",t.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",t.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",t.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",t.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",t.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",t.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",t.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",t.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",t.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",t.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",t.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",t.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",t.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",t.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",t.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",t.SEARCH_0="http://iiif.io/api/search/0/search",t.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",t.SEARCH_1="http://iiif.io/api/search/1/search",t.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",t.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",t.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",t.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",t.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",t.DOWNLOAD_EXTENSIONS="http://universalviewer.io/download-extensions-profile",t.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",t.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(l||(e.bB=l={})),function(t){t.IMAGE_SERVICE_2="ImageService2",t.IMAGE_SERVICE_3="ImageService3"}(c||(e.C0=c={})),function(t){t.BOTTOM_TO_TOP="bottom-to-top",t.LEFT_TO_RIGHT="left-to-right",t.RIGHT_TO_LEFT="right-to-left",t.TOP_TO_BOTTOM="top-to-bottom"}(h||(e.T5=h={})),function(t){t.CONTINUOUS="continuous",t.INDIVIDUALS="individuals",t.NON_PAGED="non-paged",t.PAGED="paged",t.TOP="top"}(u||(e.LX=u={}))},9979:(t,e,i)=>{"use strict";i.d(e,{BdL:()=>B,JeP:()=>ze,fCn:()=>a,zkh:()=>l});var n=i(4640);function s(){let t=null,e=!1,i=null,n=null;function s(e,r){i(e,r),n=t.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==i&&(n=t.requestAnimationFrame(s),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(t){i=t},setContext:function(e){t=e}}}function r(t){const e=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)},remove:function(i){i.isInterleavedBufferAttribute&&(i=i.data);const n=e.get(i);n&&(t.deleteBuffer(n.buffer),e.delete(i))},update:function(i,n){if(i.isInterleavedBufferAttribute&&(i=i.data),i.isGLBufferAttribute){const t=e.get(i);return void((!t||t.version<i.version)&&e.set(i,{buffer:i.buffer,type:i.type,bytesPerElement:i.elementSize,version:i.version}))}const s=e.get(i);if(void 0===s)e.set(i,function(e,i){const n=e.array,s=e.usage,r=n.byteLength,o=t.createBuffer();let a;if(t.bindBuffer(i,o),t.bufferData(i,n,s),e.onUploadCallback(),n instanceof Float32Array)a=t.FLOAT;else if(n instanceof Uint16Array)a=e.isFloat16BufferAttribute?t.HALF_FLOAT:t.UNSIGNED_SHORT;else if(n instanceof Int16Array)a=t.SHORT;else if(n instanceof Uint32Array)a=t.UNSIGNED_INT;else if(n instanceof Int32Array)a=t.INT;else if(n instanceof Int8Array)a=t.BYTE;else if(n instanceof Uint8Array)a=t.UNSIGNED_BYTE;else{if(!(n instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+n);a=t.UNSIGNED_BYTE}return{buffer:o,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version,size:r}}(i,n));else if(s.version<i.version){if(s.size!==i.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(e,i,n){const s=i.array,r=i.updateRanges;if(t.bindBuffer(n,e),0===r.length)t.bufferSubData(n,0,s);else{r.sort((t,e)=>t.start-e.start);let e=0;for(let t=1;t<r.length;t++){const i=r[e],n=r[t];n.start<=i.start+i.count+1?i.count=Math.max(i.count,n.start+n.count-i.start):(++e,r[e]=n)}r.length=e+1;for(let e=0,i=r.length;e<i;e++){const i=r[e];t.bufferSubData(n,i.start*s.BYTES_PER_ELEMENT,s,i.start,i.count)}i.clearUpdateRanges()}i.onUploadCallback()}(s.buffer,i,n),s.version=i.version}}}}const o={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},a={common:{diffuse:{value:new n.Q1f(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new n.dwI},alphaMap:{value:null},alphaMapTransform:{value:new n.dwI},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new n.dwI}},envmap:{envMap:{value:null},envMapRotation:{value:new n.dwI},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new n.dwI}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new n.dwI}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new n.dwI},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new n.dwI},normalScale:{value:new n.I9Y(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new n.dwI},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new n.dwI}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new n.dwI}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new n.dwI}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new n.Q1f(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new n.Q1f(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new n.dwI},alphaTest:{value:0},uvTransform:{value:new n.dwI}},sprite:{diffuse:{value:new n.Q1f(16777215)},opacity:{value:1},center:{value:new n.I9Y(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new n.dwI},alphaMap:{value:null},alphaMapTransform:{value:new n.dwI},alphaTest:{value:0}}},l={basic:{uniforms:(0,n.Iit)([a.common,a.specularmap,a.envmap,a.aomap,a.lightmap,a.fog]),vertexShader:o.meshbasic_vert,fragmentShader:o.meshbasic_frag},lambert:{uniforms:(0,n.Iit)([a.common,a.specularmap,a.envmap,a.aomap,a.lightmap,a.emissivemap,a.bumpmap,a.normalmap,a.displacementmap,a.fog,a.lights,{emissive:{value:new n.Q1f(0)}}]),vertexShader:o.meshlambert_vert,fragmentShader:o.meshlambert_frag},phong:{uniforms:(0,n.Iit)([a.common,a.specularmap,a.envmap,a.aomap,a.lightmap,a.emissivemap,a.bumpmap,a.normalmap,a.displacementmap,a.fog,a.lights,{emissive:{value:new n.Q1f(0)},specular:{value:new n.Q1f(1118481)},shininess:{value:30}}]),vertexShader:o.meshphong_vert,fragmentShader:o.meshphong_frag},standard:{uniforms:(0,n.Iit)([a.common,a.envmap,a.aomap,a.lightmap,a.emissivemap,a.bumpmap,a.normalmap,a.displacementmap,a.roughnessmap,a.metalnessmap,a.fog,a.lights,{emissive:{value:new n.Q1f(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:o.meshphysical_vert,fragmentShader:o.meshphysical_frag},toon:{uniforms:(0,n.Iit)([a.common,a.aomap,a.lightmap,a.emissivemap,a.bumpmap,a.normalmap,a.displacementmap,a.gradientmap,a.fog,a.lights,{emissive:{value:new n.Q1f(0)}}]),vertexShader:o.meshtoon_vert,fragmentShader:o.meshtoon_frag},matcap:{uniforms:(0,n.Iit)([a.common,a.bumpmap,a.normalmap,a.displacementmap,a.fog,{matcap:{value:null}}]),vertexShader:o.meshmatcap_vert,fragmentShader:o.meshmatcap_frag},points:{uniforms:(0,n.Iit)([a.points,a.fog]),vertexShader:o.points_vert,fragmentShader:o.points_frag},dashed:{uniforms:(0,n.Iit)([a.common,a.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:o.linedashed_vert,fragmentShader:o.linedashed_frag},depth:{uniforms:(0,n.Iit)([a.common,a.displacementmap]),vertexShader:o.depth_vert,fragmentShader:o.depth_frag},normal:{uniforms:(0,n.Iit)([a.common,a.bumpmap,a.normalmap,a.displacementmap,{opacity:{value:1}}]),vertexShader:o.meshnormal_vert,fragmentShader:o.meshnormal_frag},sprite:{uniforms:(0,n.Iit)([a.sprite,a.fog]),vertexShader:o.sprite_vert,fragmentShader:o.sprite_frag},background:{uniforms:{uvTransform:{value:new n.dwI},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:o.background_vert,fragmentShader:o.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new n.dwI}},vertexShader:o.backgroundCube_vert,fragmentShader:o.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:o.cube_vert,fragmentShader:o.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:o.equirect_vert,fragmentShader:o.equirect_frag},distanceRGBA:{uniforms:(0,n.Iit)([a.common,a.displacementmap,{referencePosition:{value:new n.Pq0},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:o.distanceRGBA_vert,fragmentShader:o.distanceRGBA_frag},shadow:{uniforms:(0,n.Iit)([a.lights,a.fog,{color:{value:new n.Q1f(0)},opacity:{value:1}}]),vertexShader:o.shadow_vert,fragmentShader:o.shadow_frag}};l.physical={uniforms:(0,n.Iit)([l.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new n.dwI},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new n.dwI},clearcoatNormalScale:{value:new n.I9Y(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new n.dwI},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new n.dwI},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new n.dwI},sheen:{value:0},sheenColor:{value:new n.Q1f(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new n.dwI},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new n.dwI},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new n.dwI},transmissionSamplerSize:{value:new n.I9Y},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new n.dwI},attenuationDistance:{value:0},attenuationColor:{value:new n.Q1f(0)},specularColor:{value:new n.Q1f(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new n.dwI},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new n.dwI},anisotropyVector:{value:new n.I9Y},anisotropyMap:{value:null},anisotropyMapTransform:{value:new n.dwI}}]),vertexShader:o.meshphysical_vert,fragmentShader:o.meshphysical_frag};const c={r:0,b:0,g:0},h=new n.O9p,u=new n.kn4;function d(t,e,i,s,r,o,a){const d=new n.Q1f(0);let p,f,g=!0===o?0:1,m=null,A=0,v=null;function y(t){let n=!0===t.isScene?t.background:null;if(n&&n.isTexture){n=(t.backgroundBlurriness>0?i:e).get(n)}return n}function b(e,i){e.getRGB(c,(0,n._Ut)(t)),s.buffers.color.setClear(c.r,c.g,c.b,i,a)}return{getClearColor:function(){return d},setClearColor:function(t,e=1){d.set(t),g=e,b(d,g)},getClearAlpha:function(){return g},setClearAlpha:function(t){g=t,b(d,g)},render:function(e){let i=!1;const n=y(e);null===n?b(d,g):n&&n.isColor&&(b(n,1),i=!0);const r=t.xr.getEnvironmentBlendMode();"additive"===r?s.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===r&&s.buffers.color.setClear(0,0,0,0,a),(t.autoClear||i)&&(s.buffers.depth.setTest(!0),s.buffers.depth.setMask(!0),s.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))},addToRenderList:function(e,i){const s=y(i);s&&(s.isCubeTexture||s.mapping===n.Om)?(void 0===f&&(f=new n.eaF(new n.iNn(1,1,1),new n.BKk({name:"BackgroundCubeMaterial",uniforms:(0,n.lxW)(l.backgroundCube.uniforms),vertexShader:l.backgroundCube.vertexShader,fragmentShader:l.backgroundCube.fragmentShader,side:n.hsX,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(f)),h.copy(i.backgroundRotation),h.x*=-1,h.y*=-1,h.z*=-1,s.isCubeTexture&&!1===s.isRenderTargetTexture&&(h.y*=-1,h.z*=-1),f.material.uniforms.envMap.value=s,f.material.uniforms.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,f.material.uniforms.backgroundBlurriness.value=i.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=i.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(u.makeRotationFromEuler(h)),f.material.toneMapped=n.ppV.getTransfer(s.colorSpace)!==n.KLL,m===s&&A===s.version&&v===t.toneMapping||(f.material.needsUpdate=!0,m=s,A=s.version,v=t.toneMapping),f.layers.enableAll(),e.unshift(f,f.geometry,f.material,0,0,null)):s&&s.isTexture&&(void 0===p&&(p=new n.eaF(new n.bdM(2,2),new n.BKk({name:"BackgroundMaterial",uniforms:(0,n.lxW)(l.background.uniforms),vertexShader:l.background.vertexShader,fragmentShader:l.background.fragmentShader,side:n.hB5,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(p)),p.material.uniforms.t2D.value=s,p.material.uniforms.backgroundIntensity.value=i.backgroundIntensity,p.material.toneMapped=n.ppV.getTransfer(s.colorSpace)!==n.KLL,!0===s.matrixAutoUpdate&&s.updateMatrix(),p.material.uniforms.uvTransform.value.copy(s.matrix),m===s&&A===s.version&&v===t.toneMapping||(p.material.needsUpdate=!0,m=s,A=s.version,v=t.toneMapping),p.layers.enableAll(),e.unshift(p,p.geometry,p.material,0,0,null))},dispose:function(){void 0!==f&&(f.geometry.dispose(),f.material.dispose(),f=void 0),void 0!==p&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}}}function p(t,e){const i=t.getParameter(t.MAX_VERTEX_ATTRIBS),s={},r=h(null);let o=r,a=!1;function l(e){return t.bindVertexArray(e)}function c(e){return t.deleteVertexArray(e)}function h(t){const e=[],n=[],s=[];for(let t=0;t<i;t++)e[t]=0,n[t]=0,s[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:s,object:t,attributes:{},index:null}}function u(){const t=o.newAttributes;for(let e=0,i=t.length;e<i;e++)t[e]=0}function d(t){p(t,0)}function p(e,i){const n=o.newAttributes,s=o.enabledAttributes,r=o.attributeDivisors;n[e]=1,0===s[e]&&(t.enableVertexAttribArray(e),s[e]=1),r[e]!==i&&(t.vertexAttribDivisor(e,i),r[e]=i)}function f(){const e=o.newAttributes,i=o.enabledAttributes;for(let n=0,s=i.length;n<s;n++)i[n]!==e[n]&&(t.disableVertexAttribArray(n),i[n]=0)}function g(e,i,n,s,r,o,a){!0===a?t.vertexAttribIPointer(e,i,n,r,o):t.vertexAttribPointer(e,i,n,s,r,o)}function m(){A(),a=!0,o!==r&&(o=r,l(o.object))}function A(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function(i,r,c,m,A){let v=!1;const y=function(e,i,n){const r=!0===n.wireframe;let o=s[e.id];void 0===o&&(o={},s[e.id]=o);let a=o[i.id];void 0===a&&(a={},o[i.id]=a);let l=a[r];void 0===l&&(l=h(t.createVertexArray()),a[r]=l);return l}(m,c,r);o!==y&&(o=y,l(o.object)),v=function(t,e,i,n){const s=o.attributes,r=e.attributes;let a=0;const l=i.getAttributes();for(const e in l){if(l[e].location>=0){const i=s[e];let n=r[e];if(void 0===n&&("instanceMatrix"===e&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(n=t.instanceColor)),void 0===i)return!0;if(i.attribute!==n)return!0;if(n&&i.data!==n.data)return!0;a++}}return o.attributesNum!==a||o.index!==n}(i,m,c,A),v&&function(t,e,i,n){const s={},r=e.attributes;let a=0;const l=i.getAttributes();for(const e in l){if(l[e].location>=0){let i=r[e];void 0===i&&("instanceMatrix"===e&&t.instanceMatrix&&(i=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(i=t.instanceColor));const n={};n.attribute=i,i&&i.data&&(n.data=i.data),s[e]=n,a++}}o.attributes=s,o.attributesNum=a,o.index=n}(i,m,c,A),null!==A&&e.update(A,t.ELEMENT_ARRAY_BUFFER),(v||a)&&(a=!1,function(i,s,r,o){u();const a=o.attributes,l=r.getAttributes(),c=s.defaultAttributeValues;for(const s in l){const r=l[s];if(r.location>=0){let l=a[s];if(void 0===l&&("instanceMatrix"===s&&i.instanceMatrix&&(l=i.instanceMatrix),"instanceColor"===s&&i.instanceColor&&(l=i.instanceColor)),void 0!==l){const s=l.normalized,a=l.itemSize,c=e.get(l);if(void 0===c)continue;const h=c.buffer,u=c.type,f=c.bytesPerElement,m=u===t.INT||u===t.UNSIGNED_INT||l.gpuType===n.Yuy;if(l.isInterleavedBufferAttribute){const e=l.data,n=e.stride,c=l.offset;if(e.isInstancedInterleavedBuffer){for(let t=0;t<r.locationSize;t++)p(r.location+t,e.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=e.meshPerAttribute*e.count)}else for(let t=0;t<r.locationSize;t++)d(r.location+t);t.bindBuffer(t.ARRAY_BUFFER,h);for(let t=0;t<r.locationSize;t++)g(r.location+t,a/r.locationSize,u,s,n*f,(c+a/r.locationSize*t)*f,m)}else{if(l.isInstancedBufferAttribute){for(let t=0;t<r.locationSize;t++)p(r.location+t,l.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=l.meshPerAttribute*l.count)}else for(let t=0;t<r.locationSize;t++)d(r.location+t);t.bindBuffer(t.ARRAY_BUFFER,h);for(let t=0;t<r.locationSize;t++)g(r.location+t,a/r.locationSize,u,s,a*f,a/r.locationSize*t*f,m)}}else if(void 0!==c){const e=c[s];if(void 0!==e)switch(e.length){case 2:t.vertexAttrib2fv(r.location,e);break;case 3:t.vertexAttrib3fv(r.location,e);break;case 4:t.vertexAttrib4fv(r.location,e);break;default:t.vertexAttrib1fv(r.location,e)}}}}f()}(i,r,c,m),null!==A&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(A).buffer))},reset:m,resetDefaultState:A,dispose:function(){m();for(const t in s){const e=s[t];for(const t in e){const i=e[t];for(const t in i)c(i[t].object),delete i[t];delete e[t]}delete s[t]}},releaseStatesOfGeometry:function(t){if(void 0===s[t.id])return;const e=s[t.id];for(const t in e){const i=e[t];for(const t in i)c(i[t].object),delete i[t];delete e[t]}delete s[t.id]},releaseStatesOfProgram:function(t){for(const e in s){const i=s[e];if(void 0===i[t.id])continue;const n=i[t.id];for(const t in n)c(n[t].object),delete n[t];delete i[t.id]}},initAttributes:u,enableAttribute:d,disableUnusedAttributes:f}}function f(t,e,i){let n;function s(e,s,r){0!==r&&(t.drawArraysInstanced(n,e,s,r),i.update(s,n,r))}this.setMode=function(t){n=t},this.render=function(e,s){t.drawArrays(n,e,s),i.update(s,n,1)},this.renderInstances=s,this.renderMultiDraw=function(t,s,r){if(0===r)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,t,0,s,0,r);let o=0;for(let t=0;t<r;t++)o+=s[t];i.update(o,n,1)},this.renderMultiDrawInstances=function(t,r,o,a){if(0===o)return;const l=e.get("WEBGL_multi_draw");if(null===l)for(let e=0;e<t.length;e++)s(t[e],r[e],a[e]);else{l.multiDrawArraysInstancedWEBGL(n,t,0,r,0,a,0,o);let e=0;for(let t=0;t<o;t++)e+=r[t]*a[t];i.update(e,n,1)}}}function g(t,e,i,s){let r;function o(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let a=void 0!==i.precision?i.precision:"highp";const l=o(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=!0===i.logarithmicDepthBuffer,h=!0===i.reverseDepthBuffer&&e.has("EXT_clip_control"),u=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),d=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const i=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:o,textureFormatReadable:function(e){return e===n.GWd||s.convert(e)===t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(i){const r=i===n.ix0&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(i!==n.OUM&&s.convert(i)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&i!==n.RQf&&!r)},precision:a,logarithmicDepthBuffer:c,reverseDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:t.getParameter(t.MAX_TEXTURE_SIZE),maxCubemapSize:t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:t.getParameter(t.MAX_VERTEX_ATTRIBS),maxVertexUniforms:t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:t.getParameter(t.MAX_VARYING_VECTORS),maxFragmentUniforms:t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:d>0,maxSamples:t.getParameter(t.MAX_SAMPLES)}}function m(t){const e=this;let i=null,s=0,r=!1,o=!1;const a=new n.Zcv,l=new n.dwI,c={value:null,needsUpdate:!1};function h(t,i,n,s){const r=null!==t?t.length:0;let o=null;if(0!==r){if(o=c.value,!0!==s||null===o){const e=n+4*r,s=i.matrixWorldInverse;l.getNormalMatrix(s),(null===o||o.length<e)&&(o=new Float32Array(e));for(let e=0,i=n;e!==r;++e,i+=4)a.copy(t[e]).applyMatrix4(s,l),a.normal.toArray(o,i),o[i+3]=a.constant}c.value=o,c.needsUpdate=!0}return e.numPlanes=r,e.numIntersection=0,o}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e){const i=0!==t.length||e||0!==s||r;return r=e,s=t.length,i},this.beginShadows=function(){o=!0,h(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(t,e){i=h(t,e,0)},this.setState=function(n,a,l){const u=n.clippingPlanes,d=n.clipIntersection,p=n.clipShadows,f=t.get(n);if(!r||null===u||0===u.length||o&&!p)o?h(null):function(){c.value!==i&&(c.value=i,c.needsUpdate=s>0);e.numPlanes=s,e.numIntersection=0}();else{const t=o?0:s,e=4*t;let n=f.clippingState||null;c.value=n,n=h(u,a,e,l);for(let t=0;t!==e;++t)n[t]=i[t];f.clippingState=n,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function A(t){let e=new WeakMap;function i(t,e){return e===n.wfO?t.mapping=n.hy7:e===n.uV5&&(t.mapping=n.xFO),t}function s(t){const i=t.target;i.removeEventListener("dispose",s);const n=e.get(i);void 0!==n&&(e.delete(i),n.dispose())}return{get:function(r){if(r&&r.isTexture){const o=r.mapping;if(o===n.wfO||o===n.uV5){if(e.has(r)){return i(e.get(r).texture,r.mapping)}{const o=r.image;if(o&&o.height>0){const a=new n.o6l(o.height);return a.fromEquirectangularTexture(t,r),e.set(r,a),r.addEventListener("dispose",s),i(a.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}const v=[.125,.215,.35,.446,.526,.582],y=20,b=new n.qUd,_=new n.Q1f;let x=null,w=0,E=0,C=!1;const S=(1+Math.sqrt(5))/2,I=1/S,M=[new n.Pq0(-S,I,0),new n.Pq0(S,I,0),new n.Pq0(-I,0,S),new n.Pq0(I,0,S),new n.Pq0(0,S,-I),new n.Pq0(0,S,I),new n.Pq0(-1,1,-1),new n.Pq0(1,1,-1),new n.Pq0(-1,1,1),new n.Pq0(1,1,1)],T=new n.Pq0;class B{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,i=.1,n=100,s={}){const{size:r=256,position:o=T}=s;x=this._renderer.getRenderTarget(),w=this._renderer.getActiveCubeFace(),E=this._renderer.getActiveMipmapLevel(),C=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(r);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(t,i,n,a,o),e>0&&this._blur(a,0,0,e),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=D(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=L(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(x,w,E),this._renderer.xr.enabled=C,t.scissorTest=!1,P(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===n.hy7||t.mapping===n.xFO?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),x=this._renderer.getRenderTarget(),w=this._renderer.getActiveCubeFace(),E=this._renderer.getActiveMipmapLevel(),C=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=e||this._allocateTargets();return this._textureToCubeUV(t,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,i={magFilter:n.k6q,minFilter:n.k6q,generateMipmaps:!1,type:n.ix0,format:n.GWd,colorSpace:n.Zr2,depthBuffer:!1},s=R(t,e,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=R(t,e,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],i=[],s=[];let r=t;const o=t-4+1+v.length;for(let a=0;a<o;a++){const o=Math.pow(2,r);i.push(o);let l=1/o;a>t-4?l=v[a-t+4-1]:0===a&&(l=0),s.push(l);const c=1/(o-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],p=6,f=6,g=3,m=2,A=1,y=new Float32Array(g*f*p),b=new Float32Array(m*f*p),_=new Float32Array(A*f*p);for(let t=0;t<p;t++){const e=t%3*2/3-1,i=t>2?0:-1,n=[e,i,0,e+2/3,i,0,e+2/3,i+1,0,e,i,0,e+2/3,i+1,0,e,i+1,0];y.set(n,g*f*t),b.set(d,m*f*t);const s=[t,t,t,t,t,t];_.set(s,A*f*t)}const x=new n.LoY;x.setAttribute("position",new n.THS(y,g)),x.setAttribute("uv",new n.THS(b,m)),x.setAttribute("faceIndex",new n.THS(_,A)),e.push(x),r>4&&r--}return{lodPlanes:e,sizeLods:i,sigmas:s}}(s)),this._blurMaterial=function(t,e,i){const s=new Float32Array(y),r=new n.Pq0(0,1,0),o=new n.BKk({name:"SphericalGaussianBlur",defines:{n:y,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:s},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:N(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:n.XIg,depthTest:!1,depthWrite:!1});return o}(s,t,e)}return s}_compileMaterial(t){const e=new n.eaF(this._lodPlanes[0],t);this._renderer.compile(e,b)}_sceneToCubeUV(t,e,i,s,r){const o=new n.ubm(90,1,e,i),a=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],c=this._renderer,h=c.autoClear,u=c.toneMapping;c.getClearColor(_),c.toneMapping=n.y_p,c.autoClear=!1;const d=new n.V9B({name:"PMREM.Background",side:n.hsX,depthWrite:!1,depthTest:!1}),p=new n.eaF(new n.iNn,d);let f=!1;const g=t.background;g?g.isColor&&(d.color.copy(g),t.background=null,f=!0):(d.color.copy(_),f=!0);for(let e=0;e<6;e++){const i=e%3;0===i?(o.up.set(0,a[e],0),o.position.set(r.x,r.y,r.z),o.lookAt(r.x+l[e],r.y,r.z)):1===i?(o.up.set(0,0,a[e]),o.position.set(r.x,r.y,r.z),o.lookAt(r.x,r.y+l[e],r.z)):(o.up.set(0,a[e],0),o.position.set(r.x,r.y,r.z),o.lookAt(r.x,r.y,r.z+l[e]));const n=this._cubeSize;P(s,i*n,e>2?n:0,n,n),c.setRenderTarget(s),f&&c.render(p,o),c.render(t,o)}p.geometry.dispose(),p.material.dispose(),c.toneMapping=u,c.autoClear=h,t.background=g}_textureToCubeUV(t,e){const i=this._renderer,s=t.mapping===n.hy7||t.mapping===n.xFO;s?(null===this._cubemapMaterial&&(this._cubemapMaterial=D()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=L());const r=s?this._cubemapMaterial:this._equirectMaterial,o=new n.eaF(this._lodPlanes[0],r);r.uniforms.envMap.value=t;const a=this._cubeSize;P(e,0,0,3*a,2*a),i.setRenderTarget(e),i.render(o,b)}_applyPMREM(t){const e=this._renderer,i=e.autoClear;e.autoClear=!1;const n=this._lodPlanes.length;for(let e=1;e<n;e++){const i=Math.sqrt(this._sigmas[e]*this._sigmas[e]-this._sigmas[e-1]*this._sigmas[e-1]),s=M[(n-e-1)%M.length];this._blur(t,e-1,e,i,s)}e.autoClear=i}_blur(t,e,i,n,s){const r=this._pingPongRenderTarget;this._halfBlur(t,r,e,i,n,"latitudinal",s),this._halfBlur(r,t,i,i,n,"longitudinal",s)}_halfBlur(t,e,i,s,r,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new n.eaF(this._lodPlanes[s],c),u=c.uniforms,d=this._sizeLods[i]-1,p=isFinite(r)?Math.PI/(2*d):2*Math.PI/39,f=r/p,g=isFinite(r)?1+Math.floor(3*f):y;g>y&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const m=[];let A=0;for(let t=0;t<y;++t){const e=t/f,i=Math.exp(-e*e/2);m.push(i),0===t?A+=i:t<g&&(A+=2*i)}for(let t=0;t<m.length;t++)m[t]=m[t]/A;u.envMap.value=t.texture,u.samples.value=g,u.weights.value=m,u.latitudinal.value="latitudinal"===o,a&&(u.poleAxis.value=a);const{_lodMax:v}=this;u.dTheta.value=p,u.mipInt.value=v-i;const _=this._sizeLods[s];P(e,3*_*(s>v-4?s-v+4:0),4*(this._cubeSize-_),3*_,2*_),l.setRenderTarget(e),l.render(h,b)}}function R(t,e,i){const s=new n.nWS(t,e,i);return s.texture.mapping=n.Om,s.texture.name="PMREM.cubeUv",s.scissorTest=!0,s}function P(t,e,i,n,s){t.viewport.set(e,i,n,s),t.scissor.set(e,i,n,s)}function L(){return new n.BKk({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:N(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:n.XIg,depthTest:!1,depthWrite:!1})}function D(){return new n.BKk({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:N(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:n.XIg,depthTest:!1,depthWrite:!1})}function N(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function O(t){let e=new WeakMap,i=null;function s(t){const i=t.target;i.removeEventListener("dispose",s);const n=e.get(i);void 0!==n&&(e.delete(i),n.dispose())}return{get:function(r){if(r&&r.isTexture){const o=r.mapping,a=o===n.wfO||o===n.uV5,l=o===n.hy7||o===n.xFO;if(a||l){let n=e.get(r);const o=void 0!==n?n.texture.pmremVersion:0;if(r.isRenderTargetTexture&&r.pmremVersion!==o)return null===i&&(i=new B(t)),n=a?i.fromEquirectangular(r,n):i.fromCubemap(r,n),n.texture.pmremVersion=r.pmremVersion,e.set(r,n),n.texture;if(void 0!==n)return n.texture;{const o=r.image;return a&&o&&o.height>0||l&&o&&function(t){let e=0;const i=6;for(let n=0;n<i;n++)void 0!==t[n]&&e++;return e===i}(o)?(null===i&&(i=new B(t)),n=a?i.fromEquirectangular(r):i.fromCubemap(r),n.texture.pmremVersion=r.pmremVersion,e.set(r,n),r.addEventListener("dispose",s),n.texture):null}}}return r},dispose:function(){e=new WeakMap,null!==i&&(i.dispose(),i=null)}}}function k(t){const e={};function i(i){if(void 0!==e[i])return e[i];let n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(i)}return e[i]=n,n}return{has:function(t){return null!==i(t)},init:function(){i("EXT_color_buffer_float"),i("WEBGL_clip_cull_distance"),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture"),i("WEBGL_render_shared_exponent")},get:function(t){const e=i(t);return null===e&&(0,n.mcG)("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function U(t,e,i,s){const r={},o=new WeakMap;function a(t){const n=t.target;null!==n.index&&e.remove(n.index);for(const t in n.attributes)e.remove(n.attributes[t]);n.removeEventListener("dispose",a),delete r[n.id];const l=o.get(n);l&&(e.remove(l),o.delete(n)),s.releaseStatesOfGeometry(n),!0===n.isInstancedBufferGeometry&&delete n._maxInstanceCount,i.memory.geometries--}function l(t){const i=[],s=t.index,r=t.attributes.position;let a=0;if(null!==s){const t=s.array;a=s.version;for(let e=0,n=t.length;e<n;e+=3){const n=t[e+0],s=t[e+1],r=t[e+2];i.push(n,s,s,r,r,n)}}else{if(void 0===r)return;{const t=r.array;a=r.version;for(let e=0,n=t.length/3-1;e<n;e+=3){const t=e+0,n=e+1,s=e+2;i.push(t,n,n,s,s,t)}}}const l=new((0,n.AQS)(i)?n.MW4:n.A$4)(i,1);l.version=a;const c=o.get(t);c&&e.remove(c),o.set(t,l)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener("dispose",a),r[e.id]=!0,i.memory.geometries++),e},update:function(i){const n=i.attributes;for(const i in n)e.update(n[i],t.ARRAY_BUFFER)},getWireframeAttribute:function(t){const e=o.get(t);if(e){const i=t.index;null!==i&&e.version<i.version&&l(t)}else l(t);return o.get(t)}}}function F(t,e,i){let n,s,r;function o(e,o,a){0!==a&&(t.drawElementsInstanced(n,o,s,e*r,a),i.update(o,n,a))}this.setMode=function(t){n=t},this.setIndex=function(t){s=t.type,r=t.bytesPerElement},this.render=function(e,o){t.drawElements(n,o,s,e*r),i.update(o,n,1)},this.renderInstances=o,this.renderMultiDraw=function(t,r,o){if(0===o)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,r,0,s,t,0,o);let a=0;for(let t=0;t<o;t++)a+=r[t];i.update(a,n,1)},this.renderMultiDrawInstances=function(t,a,l,c){if(0===l)return;const h=e.get("WEBGL_multi_draw");if(null===h)for(let e=0;e<t.length;e++)o(t[e]/r,a[e],c[e]);else{h.multiDrawElementsInstancedWEBGL(n,a,0,s,t,0,c,0,l);let e=0;for(let t=0;t<l;t++)e+=a[t]*c[t];i.update(e,n,1)}}}function z(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(i,n,s){switch(e.calls++,n){case t.TRIANGLES:e.triangles+=s*(i/3);break;case t.LINES:e.lines+=s*(i/2);break;case t.LINE_STRIP:e.lines+=s*(i-1);break;case t.LINE_LOOP:e.lines+=s*i;break;case t.POINTS:e.points+=s*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function V(t,e,i){const s=new WeakMap,r=new n.IUQ;return{update:function(o,a,l){const c=o.morphTargetInfluences,h=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,u=void 0!==h?h.length:0;let d=s.get(a);if(void 0===d||d.count!==u){void 0!==d&&d.texture.dispose();const p=void 0!==a.morphAttributes.position,f=void 0!==a.morphAttributes.normal,g=void 0!==a.morphAttributes.color,m=a.morphAttributes.position||[],A=a.morphAttributes.normal||[],v=a.morphAttributes.color||[];let y=0;!0===p&&(y=1),!0===f&&(y=2),!0===g&&(y=3);let b=a.attributes.position.count*y,_=1;b>e.maxTextureSize&&(_=Math.ceil(b/e.maxTextureSize),b=e.maxTextureSize);const x=new Float32Array(b*_*4*u),w=new n.rFo(x,b,_,u);w.type=n.RQf,w.needsUpdate=!0;const E=4*y;for(let S=0;S<u;S++){const I=m[S],M=A[S],T=v[S],B=b*_*4*S;for(let R=0;R<I.count;R++){const P=R*E;!0===p&&(r.fromBufferAttribute(I,R),x[B+P+0]=r.x,x[B+P+1]=r.y,x[B+P+2]=r.z,x[B+P+3]=0),!0===f&&(r.fromBufferAttribute(M,R),x[B+P+4]=r.x,x[B+P+5]=r.y,x[B+P+6]=r.z,x[B+P+7]=0),!0===g&&(r.fromBufferAttribute(T,R),x[B+P+8]=r.x,x[B+P+9]=r.y,x[B+P+10]=r.z,x[B+P+11]=4===T.itemSize?r.w:1)}}function C(){w.dispose(),s.delete(a),a.removeEventListener("dispose",C)}d={count:u,texture:w,size:new n.I9Y(b,_)},s.set(a,d),a.addEventListener("dispose",C)}if(!0===o.isInstancedMesh&&null!==o.morphTexture)l.getUniforms().setValue(t,"morphTexture",o.morphTexture,i);else{let L=0;for(let N=0;N<c.length;N++)L+=c[N];const D=a.morphTargetsRelative?1:1-L;l.getUniforms().setValue(t,"morphTargetBaseInfluence",D),l.getUniforms().setValue(t,"morphTargetInfluences",c)}l.getUniforms().setValue(t,"morphTargetsTexture",d.texture,i),l.getUniforms().setValue(t,"morphTargetsTextureSize",d.size)}}}function Q(t,e,i,n){let s=new WeakMap;function r(t){const e=t.target;e.removeEventListener("dispose",r),i.remove(e.instanceMatrix),null!==e.instanceColor&&i.remove(e.instanceColor)}return{update:function(o){const a=n.render.frame,l=o.geometry,c=e.get(o,l);if(s.get(c)!==a&&(e.update(c),s.set(c,a)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",r)&&o.addEventListener("dispose",r),s.get(o)!==a&&(i.update(o.instanceMatrix,t.ARRAY_BUFFER),null!==o.instanceColor&&i.update(o.instanceColor,t.ARRAY_BUFFER),s.set(o,a))),o.isSkinnedMesh){const t=o.skeleton;s.get(t)!==a&&(t.update(),s.set(t,a))}return c},dispose:function(){s=new WeakMap}}}const j=new n.gPd,G=new n.VCu(1,1),H=new n.rFo,q=new n.dYF,$=new n.b4q,W=[],K=[],X=new Float32Array(16),Y=new Float32Array(9),J=new Float32Array(4);function Z(t,e,i){const n=t[0];if(n<=0||n>0)return t;const s=e*i;let r=W[s];if(void 0===r&&(r=new Float32Array(s),W[s]=r),0!==e){n.toArray(r,0);for(let n=1,s=0;n!==e;++n)s+=i,t[n].toArray(r,s)}return r}function tt(t,e){if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function et(t,e){for(let i=0,n=e.length;i<n;i++)t[i]=e[i]}function it(t,e){let i=K[e];void 0===i&&(i=new Int32Array(e),K[e]=i);for(let n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function nt(t,e){const i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function st(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(tt(i,e))return;t.uniform2fv(this.addr,e),et(i,e)}}function rt(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(void 0!==e.r)i[0]===e.r&&i[1]===e.g&&i[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(tt(i,e))return;t.uniform3fv(this.addr,e),et(i,e)}}function ot(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(tt(i,e))return;t.uniform4fv(this.addr,e),et(i,e)}}function at(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(tt(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),et(i,e)}else{if(tt(i,n))return;J.set(n),t.uniformMatrix2fv(this.addr,!1,J),et(i,n)}}function lt(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(tt(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),et(i,e)}else{if(tt(i,n))return;Y.set(n),t.uniformMatrix3fv(this.addr,!1,Y),et(i,n)}}function ct(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(tt(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),et(i,e)}else{if(tt(i,n))return;X.set(n),t.uniformMatrix4fv(this.addr,!1,X),et(i,n)}}function ht(t,e){const i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function ut(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y||(t.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(tt(i,e))return;t.uniform2iv(this.addr,e),et(i,e)}}function dt(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(tt(i,e))return;t.uniform3iv(this.addr,e),et(i,e)}}function pt(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(tt(i,e))return;t.uniform4iv(this.addr,e),et(i,e)}}function ft(t,e){const i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function gt(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y||(t.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(tt(i,e))return;t.uniform2uiv(this.addr,e),et(i,e)}}function mt(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(tt(i,e))return;t.uniform3uiv(this.addr,e),et(i,e)}}function At(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(tt(i,e))return;t.uniform4uiv(this.addr,e),et(i,e)}}function vt(t,e,i){const s=this.cache,r=i.allocateTextureUnit();let o;s[0]!==r&&(t.uniform1i(this.addr,r),s[0]=r),this.type===t.SAMPLER_2D_SHADOW?(G.compareFunction=n.TiK,o=G):o=j,i.setTexture2D(e||o,r)}function yt(t,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(t.uniform1i(this.addr,s),n[0]=s),i.setTexture3D(e||q,s)}function bt(t,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(t.uniform1i(this.addr,s),n[0]=s),i.setTextureCube(e||$,s)}function _t(t,e,i){const n=this.cache,s=i.allocateTextureUnit();n[0]!==s&&(t.uniform1i(this.addr,s),n[0]=s),i.setTexture2DArray(e||H,s)}function xt(t,e){t.uniform1fv(this.addr,e)}function wt(t,e){const i=Z(e,this.size,2);t.uniform2fv(this.addr,i)}function Et(t,e){const i=Z(e,this.size,3);t.uniform3fv(this.addr,i)}function Ct(t,e){const i=Z(e,this.size,4);t.uniform4fv(this.addr,i)}function St(t,e){const i=Z(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function It(t,e){const i=Z(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function Mt(t,e){const i=Z(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function Tt(t,e){t.uniform1iv(this.addr,e)}function Bt(t,e){t.uniform2iv(this.addr,e)}function Rt(t,e){t.uniform3iv(this.addr,e)}function Pt(t,e){t.uniform4iv(this.addr,e)}function Lt(t,e){t.uniform1uiv(this.addr,e)}function Dt(t,e){t.uniform2uiv(this.addr,e)}function Nt(t,e){t.uniform3uiv(this.addr,e)}function Ot(t,e){t.uniform4uiv(this.addr,e)}function kt(t,e,i){const n=this.cache,s=e.length,r=it(i,s);tt(n,r)||(t.uniform1iv(this.addr,r),et(n,r));for(let t=0;t!==s;++t)i.setTexture2D(e[t]||j,r[t])}function Ut(t,e,i){const n=this.cache,s=e.length,r=it(i,s);tt(n,r)||(t.uniform1iv(this.addr,r),et(n,r));for(let t=0;t!==s;++t)i.setTexture3D(e[t]||q,r[t])}function Ft(t,e,i){const n=this.cache,s=e.length,r=it(i,s);tt(n,r)||(t.uniform1iv(this.addr,r),et(n,r));for(let t=0;t!==s;++t)i.setTextureCube(e[t]||$,r[t])}function zt(t,e,i){const n=this.cache,s=e.length,r=it(i,s);tt(n,r)||(t.uniform1iv(this.addr,r),et(n,r));for(let t=0;t!==s;++t)i.setTexture2DArray(e[t]||H,r[t])}class Vt{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.type=e.type,this.setValue=function(t){switch(t){case 5126:return nt;case 35664:return st;case 35665:return rt;case 35666:return ot;case 35674:return at;case 35675:return lt;case 35676:return ct;case 5124:case 35670:return ht;case 35667:case 35671:return ut;case 35668:case 35672:return dt;case 35669:case 35673:return pt;case 5125:return ft;case 36294:return gt;case 36295:return mt;case 36296:return At;case 35678:case 36198:case 36298:case 36306:case 35682:return vt;case 35679:case 36299:case 36307:return yt;case 35680:case 36300:case 36308:case 36293:return bt;case 36289:case 36303:case 36311:case 36292:return _t}}(e.type)}}class Qt{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.type=e.type,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return xt;case 35664:return wt;case 35665:return Et;case 35666:return Ct;case 35674:return St;case 35675:return It;case 35676:return Mt;case 5124:case 35670:return Tt;case 35667:case 35671:return Bt;case 35668:case 35672:return Rt;case 35669:case 35673:return Pt;case 5125:return Lt;case 36294:return Dt;case 36295:return Nt;case 36296:return Ot;case 35678:case 36198:case 36298:case 36306:case 35682:return kt;case 35679:case 36299:case 36307:return Ut;case 35680:case 36300:case 36308:case 36293:return Ft;case 36289:case 36303:case 36311:case 36292:return zt}}(e.type)}}class jt{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,i){const n=this.seq;for(let s=0,r=n.length;s!==r;++s){const r=n[s];r.setValue(t,e[r.id],i)}}}const Gt=/(\w+)(\])?(\[|\.)?/g;function Ht(t,e){t.seq.push(e),t.map[e.id]=e}function qt(t,e,i){const n=t.name,s=n.length;for(Gt.lastIndex=0;;){const r=Gt.exec(n),o=Gt.lastIndex;let a=r[1];const l="]"===r[2],c=r[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===s){Ht(i,void 0===c?new Vt(a,t,e):new Qt(a,t,e));break}{let t=i.map[a];void 0===t&&(t=new jt(a),Ht(i,t)),i=t}}}class $t{constructor(t,e){this.seq=[],this.map={};const i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<i;++n){const i=t.getActiveUniform(e,n);qt(i,t.getUniformLocation(e,i.name),this)}}setValue(t,e,i,n){const s=this.map[e];void 0!==s&&s.setValue(t,i,n)}setOptional(t,e,i){const n=e[i];void 0!==n&&this.setValue(t,i,n)}static upload(t,e,i,n){for(let s=0,r=e.length;s!==r;++s){const r=e[s],o=i[r.id];!1!==o.needsUpdate&&r.setValue(t,o.value,n)}}static seqWithValue(t,e){const i=[];for(let n=0,s=t.length;n!==s;++n){const s=t[n];s.id in e&&i.push(s)}return i}}function Wt(t,e,i){const n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}let Kt=0;const Xt=new n.dwI;function Yt(t,e,i){const n=t.getShaderParameter(e,t.COMPILE_STATUS),s=t.getShaderInfoLog(e).trim();if(n&&""===s)return"";const r=/ERROR: 0:(\d+)/.exec(s);if(r){const n=parseInt(r[1]);return i.toUpperCase()+"\n\n"+s+"\n\n"+function(t,e){const i=t.split("\n"),n=[],s=Math.max(e-6,0),r=Math.min(e+6,i.length);for(let t=s;t<r;t++){const s=t+1;n.push(`${s===e?">":" "} ${s}: ${i[t]}`)}return n.join("\n")}(t.getShaderSource(e),n)}return s}function Jt(t,e){const i=function(t){n.ppV._getMatrix(Xt,n.ppV.workingColorSpace,t);const e=`mat3( ${Xt.elements.map(t=>t.toFixed(4))} )`;switch(n.ppV.getTransfer(t)){case n.VxR:return[e,"LinearTransferOETF"];case n.KLL:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}(e);return[`vec4 ${t}( vec4 value ) {`,`\treturn ${i[1]}( vec4( value.rgb * ${i[0]}, value.a ) );`,"}"].join("\n")}function Zt(t,e){let i;switch(e){case n.kyO:i="Linear";break;case n.Mjd:i="Reinhard";break;case n.nNL:i="Cineon";break;case n.FV:i="ACESFilmic";break;case n.LAk:i="AgX";break;case n.aJ8:i="Neutral";break;case n.g7M:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}const te=new n.Pq0;function ee(){n.ppV.getLuminanceCoefficients(te);return["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${te.x.toFixed(4)}, ${te.y.toFixed(4)}, ${te.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")}function ie(t){return""!==t}function ne(t,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function se(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const re=/^[ \t]*#include +<([\w\d./]+)>/gm;function oe(t){return t.replace(re,le)}const ae=new Map;function le(t,e){let i=o[e];if(void 0===i){const t=ae.get(e);if(void 0===t)throw new Error("Can not resolve #include <"+e+">");i=o[t],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,t)}return oe(i)}const ce=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function he(t){return t.replace(ce,ue)}function ue(t,e,i,n){let s="";for(let t=parseInt(e);t<parseInt(i);t++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return s}function de(t){let e=`precision ${t.precision} float;\n\tprecision ${t.precision} int;\n\tprecision ${t.precision} sampler2D;\n\tprecision ${t.precision} samplerCube;\n\tprecision ${t.precision} sampler3D;\n\tprecision ${t.precision} sampler2DArray;\n\tprecision ${t.precision} sampler2DShadow;\n\tprecision ${t.precision} samplerCubeShadow;\n\tprecision ${t.precision} sampler2DArrayShadow;\n\tprecision ${t.precision} isampler2D;\n\tprecision ${t.precision} isampler3D;\n\tprecision ${t.precision} isamplerCube;\n\tprecision ${t.precision} isampler2DArray;\n\tprecision ${t.precision} usampler2D;\n\tprecision ${t.precision} usampler3D;\n\tprecision ${t.precision} usamplerCube;\n\tprecision ${t.precision} usampler2DArray;\n\t`;return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function pe(t,e,i,s){const r=t.getContext(),a=i.defines;let l=i.vertexShader,c=i.fragmentShader;const h=function(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===n.QP0?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===n.Wk7?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===n.RyA&&(e="SHADOWMAP_TYPE_VSM"),e}(i),u=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case n.hy7:case n.xFO:e="ENVMAP_TYPE_CUBE";break;case n.Om:e="ENVMAP_TYPE_CUBE_UV"}return e}(i),d=function(t){let e="ENVMAP_MODE_REFLECTION";t.envMap&&t.envMapMode===n.xFO&&(e="ENVMAP_MODE_REFRACTION");return e}(i),p=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case n.caT:e="ENVMAP_BLENDING_MULTIPLY";break;case n.KRh:e="ENVMAP_BLENDING_MIX";break;case n.XrR:e="ENVMAP_BLENDING_ADD"}return e}(i),f=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),112)),texelHeight:n,maxMip:i}}(i),g=function(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(ie).join("\n")}(i),m=function(t){const e=[];for(const i in t){const n=t[i];!1!==n&&e.push("#define "+i+" "+n)}return e.join("\n")}(a),A=r.createProgram();let v,y,b=i.glslVersion?"#version "+i.glslVersion+"\n":"";i.isRawShaderMaterial?(v=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m].filter(ie).join("\n"),v.length>0&&(v+="\n"),y=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m].filter(ie).join("\n"),y.length>0&&(y+="\n")):(v=[de(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m,i.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",i.batching?"#define USE_BATCHING":"",i.batchingColor?"#define USE_BATCHING_COLOR":"",i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.instancingMorph?"#define USE_INSTANCING_MORPH":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+d:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&!1===i.flatShading?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.morphColors?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+h:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ie).join("\n"),y=[de(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.envMap?"#define "+d:"",i.envMap?"#define "+p:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.dispersion?"#define USE_DISPERSION":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&!1===i.flatShading?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor||i.batchingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+h:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==n.y_p?"#define TONE_MAPPING":"",i.toneMapping!==n.y_p?o.tonemapping_pars_fragment:"",i.toneMapping!==n.y_p?Zt("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",o.colorspace_pars_fragment,Jt("linearToOutputTexel",i.outputColorSpace),ee(),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(ie).join("\n")),l=oe(l),l=ne(l,i),l=se(l,i),c=oe(c),c=ne(c,i),c=se(c,i),l=he(l),c=he(c),!0!==i.isRawShaderMaterial&&(b="#version 300 es\n",v=[g,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+v,y=["#define varying in",i.glslVersion===n.Wdf?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===n.Wdf?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const _=b+v+l,x=b+y+c,w=Wt(r,r.VERTEX_SHADER,_),E=Wt(r,r.FRAGMENT_SHADER,x);function C(e){if(t.debug.checkShaderErrors){const i=r.getProgramInfoLog(A).trim(),n=r.getShaderInfoLog(w).trim(),s=r.getShaderInfoLog(E).trim();let o=!0,a=!0;if(!1===r.getProgramParameter(A,r.LINK_STATUS))if(o=!1,"function"==typeof t.debug.onShaderError)t.debug.onShaderError(r,A,w,E);else{const t=Yt(r,w,"vertex"),n=Yt(r,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(A,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+e.name+"\nMaterial Type: "+e.type+"\n\nProgram Info Log: "+i+"\n"+t+"\n"+n)}else""!==i?console.warn("THREE.WebGLProgram: Program Info Log:",i):""!==n&&""!==s||(a=!1);a&&(e.diagnostics={runnable:o,programLog:i,vertexShader:{log:n,prefix:v},fragmentShader:{log:s,prefix:y}})}r.deleteShader(w),r.deleteShader(E),S=new $t(r,A),I=function(t,e){const i={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const n=t.getActiveAttrib(e,s),r=n.name;let o=1;n.type===t.FLOAT_MAT2&&(o=2),n.type===t.FLOAT_MAT3&&(o=3),n.type===t.FLOAT_MAT4&&(o=4),i[r]={type:n.type,location:t.getAttribLocation(e,r),locationSize:o}}return i}(r,A)}let S,I;r.attachShader(A,w),r.attachShader(A,E),void 0!==i.index0AttributeName?r.bindAttribLocation(A,0,i.index0AttributeName):!0===i.morphTargets&&r.bindAttribLocation(A,0,"position"),r.linkProgram(A),this.getUniforms=function(){return void 0===S&&C(this),S},this.getAttributes=function(){return void 0===I&&C(this),I};let M=!1===i.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===M&&(M=r.getProgramParameter(A,37297)),M},this.destroy=function(){s.releaseStatesOfProgram(this),r.deleteProgram(A),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=Kt++,this.cacheKey=e,this.usedTimes=1,this.program=A,this.vertexShader=w,this.fragmentShader=E,this}let fe=0;class ge{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,i=t.fragmentShader,n=this._getShaderStage(e),s=this._getShaderStage(i),r=this._getShaderCacheForMaterial(t);return!1===r.has(n)&&(r.add(n),n.usedTimes++),!1===r.has(s)&&(r.add(s),s.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const t of e)t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let i=e.get(t);return void 0===i&&(i=new Set,e.set(t,i)),i}_getShaderStage(t){const e=this.shaderCache;let i=e.get(t);return void 0===i&&(i=new me(t),e.set(t,i)),i}}class me{constructor(t){this.id=fe++,this.code=t,this.usedTimes=0}}function Ae(t,e,i,s,r,o,a){const c=new n.zgK,h=new ge,u=new Set,d=[],p=r.logarithmicDepthBuffer,f=r.vertexTextures;let g=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function A(t){return u.add(t),0===t?"uv":`uv${t}`}return{getParameters:function(o,c,d,v,y){const b=v.fog,_=y.geometry,x=o.isMeshStandardMaterial?v.environment:null,w=(o.isMeshStandardMaterial?i:e).get(o.envMap||x),E=w&&w.mapping===n.Om?w.image.height:null,C=m[o.type];null!==o.precision&&(g=r.getMaxPrecision(o.precision),g!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",g,"instead."));const S=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,I=void 0!==S?S.length:0;let M,T,B,R,P=0;if(void 0!==_.morphAttributes.position&&(P=1),void 0!==_.morphAttributes.normal&&(P=2),void 0!==_.morphAttributes.color&&(P=3),C){const t=l[C];M=t.vertexShader,T=t.fragmentShader}else M=o.vertexShader,T=o.fragmentShader,h.update(o),B=h.getVertexShaderID(o),R=h.getFragmentShaderID(o);const L=t.getRenderTarget(),D=t.state.buffers.depth.getReversed(),N=!0===y.isInstancedMesh,O=!0===y.isBatchedMesh,k=!!o.map,U=!!o.matcap,F=!!w,z=!!o.aoMap,V=!!o.lightMap,Q=!!o.bumpMap,j=!!o.normalMap,G=!!o.displacementMap,H=!!o.emissiveMap,q=!!o.metalnessMap,$=!!o.roughnessMap,W=o.anisotropy>0,K=o.clearcoat>0,X=o.dispersion>0,Y=o.iridescence>0,J=o.sheen>0,Z=o.transmission>0,tt=W&&!!o.anisotropyMap,et=K&&!!o.clearcoatMap,it=K&&!!o.clearcoatNormalMap,nt=K&&!!o.clearcoatRoughnessMap,st=Y&&!!o.iridescenceMap,rt=Y&&!!o.iridescenceThicknessMap,ot=J&&!!o.sheenColorMap,at=J&&!!o.sheenRoughnessMap,lt=!!o.specularMap,ct=!!o.specularColorMap,ht=!!o.specularIntensityMap,ut=Z&&!!o.transmissionMap,dt=Z&&!!o.thicknessMap,pt=!!o.gradientMap,ft=!!o.alphaMap,gt=o.alphaTest>0,mt=!!o.alphaHash,At=!!o.extensions;let vt=n.y_p;o.toneMapped&&(null!==L&&!0!==L.isXRRenderTarget||(vt=t.toneMapping));const yt={shaderID:C,shaderType:o.type,shaderName:o.name,vertexShader:M,fragmentShader:T,defines:o.defines,customVertexShaderID:B,customFragmentShaderID:R,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:g,batching:O,batchingColor:O&&null!==y._colorsTexture,instancing:N,instancingColor:N&&null!==y.instanceColor,instancingMorph:N&&null!==y.morphTexture,supportsVertexTextures:f,outputColorSpace:null===L?t.outputColorSpace:!0===L.isXRRenderTarget?L.texture.colorSpace:n.Zr2,alphaToCoverage:!!o.alphaToCoverage,map:k,matcap:U,envMap:F,envMapMode:F&&w.mapping,envMapCubeUVHeight:E,aoMap:z,lightMap:V,bumpMap:Q,normalMap:j,displacementMap:f&&G,emissiveMap:H,normalMapObjectSpace:j&&o.normalMapType===n.vyJ,normalMapTangentSpace:j&&o.normalMapType===n.bI3,metalnessMap:q,roughnessMap:$,anisotropy:W,anisotropyMap:tt,clearcoat:K,clearcoatMap:et,clearcoatNormalMap:it,clearcoatRoughnessMap:nt,dispersion:X,iridescence:Y,iridescenceMap:st,iridescenceThicknessMap:rt,sheen:J,sheenColorMap:ot,sheenRoughnessMap:at,specularMap:lt,specularColorMap:ct,specularIntensityMap:ht,transmission:Z,transmissionMap:ut,thicknessMap:dt,gradientMap:pt,opaque:!1===o.transparent&&o.blending===n.NTi&&!1===o.alphaToCoverage,alphaMap:ft,alphaTest:gt,alphaHash:mt,combine:o.combine,mapUv:k&&A(o.map.channel),aoMapUv:z&&A(o.aoMap.channel),lightMapUv:V&&A(o.lightMap.channel),bumpMapUv:Q&&A(o.bumpMap.channel),normalMapUv:j&&A(o.normalMap.channel),displacementMapUv:G&&A(o.displacementMap.channel),emissiveMapUv:H&&A(o.emissiveMap.channel),metalnessMapUv:q&&A(o.metalnessMap.channel),roughnessMapUv:$&&A(o.roughnessMap.channel),anisotropyMapUv:tt&&A(o.anisotropyMap.channel),clearcoatMapUv:et&&A(o.clearcoatMap.channel),clearcoatNormalMapUv:it&&A(o.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:nt&&A(o.clearcoatRoughnessMap.channel),iridescenceMapUv:st&&A(o.iridescenceMap.channel),iridescenceThicknessMapUv:rt&&A(o.iridescenceThicknessMap.channel),sheenColorMapUv:ot&&A(o.sheenColorMap.channel),sheenRoughnessMapUv:at&&A(o.sheenRoughnessMap.channel),specularMapUv:lt&&A(o.specularMap.channel),specularColorMapUv:ct&&A(o.specularColorMap.channel),specularIntensityMapUv:ht&&A(o.specularIntensityMap.channel),transmissionMapUv:ut&&A(o.transmissionMap.channel),thicknessMapUv:dt&&A(o.thicknessMap.channel),alphaMapUv:ft&&A(o.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(j||W),vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,pointsUvs:!0===y.isPoints&&!!_.attributes.uv&&(k||ft),fog:!!b,useFog:!0===o.fog,fogExp2:!!b&&b.isFogExp2,flatShading:!0===o.flatShading,sizeAttenuation:!0===o.sizeAttenuation,logarithmicDepthBuffer:p,reverseDepthBuffer:D,skinning:!0===y.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:I,morphTextureStride:P,numDirLights:c.directional.length,numPointLights:c.point.length,numSpotLights:c.spot.length,numSpotLightMaps:c.spotLightMap.length,numRectAreaLights:c.rectArea.length,numHemiLights:c.hemi.length,numDirLightShadows:c.directionalShadowMap.length,numPointLightShadows:c.pointShadowMap.length,numSpotLightShadows:c.spotShadowMap.length,numSpotLightShadowsWithMaps:c.numSpotLightShadowsWithMaps,numLightProbes:c.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:o.dithering,shadowMapEnabled:t.shadowMap.enabled&&d.length>0,shadowMapType:t.shadowMap.type,toneMapping:vt,decodeVideoTexture:k&&!0===o.map.isVideoTexture&&n.ppV.getTransfer(o.map.colorSpace)===n.KLL,decodeVideoTextureEmissive:H&&!0===o.emissiveMap.isVideoTexture&&n.ppV.getTransfer(o.emissiveMap.colorSpace)===n.KLL,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===n.$EB,flipSided:o.side===n.hsX,useDepthPacking:o.depthPacking>=0,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionClipCullDistance:At&&!0===o.extensions.clipCullDistance&&s.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(At&&!0===o.extensions.multiDraw||O)&&s.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:s.has("KHR_parallel_shader_compile"),customProgramCacheKey:o.customProgramCacheKey()};return yt.vertexUv1s=u.has(1),yt.vertexUv2s=u.has(2),yt.vertexUv3s=u.has(3),u.clear(),yt},getProgramCacheKey:function(e){const i=[];if(e.shaderID?i.push(e.shaderID):(i.push(e.customVertexShaderID),i.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)i.push(t),i.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputColorSpace),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.mapUv),t.push(e.alphaMapUv),t.push(e.lightMapUv),t.push(e.aoMapUv),t.push(e.bumpMapUv),t.push(e.normalMapUv),t.push(e.displacementMapUv),t.push(e.emissiveMapUv),t.push(e.metalnessMapUv),t.push(e.roughnessMapUv),t.push(e.anisotropyMapUv),t.push(e.clearcoatMapUv),t.push(e.clearcoatNormalMapUv),t.push(e.clearcoatRoughnessMapUv),t.push(e.iridescenceMapUv),t.push(e.iridescenceThicknessMapUv),t.push(e.sheenColorMapUv),t.push(e.sheenRoughnessMapUv),t.push(e.specularMapUv),t.push(e.specularColorMapUv),t.push(e.specularIntensityMapUv),t.push(e.transmissionMapUv),t.push(e.thicknessMapUv),t.push(e.combine),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.numLightProbes),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(i,e),function(t,e){c.disableAll(),e.supportsVertexTextures&&c.enable(0);e.instancing&&c.enable(1);e.instancingColor&&c.enable(2);e.instancingMorph&&c.enable(3);e.matcap&&c.enable(4);e.envMap&&c.enable(5);e.normalMapObjectSpace&&c.enable(6);e.normalMapTangentSpace&&c.enable(7);e.clearcoat&&c.enable(8);e.iridescence&&c.enable(9);e.alphaTest&&c.enable(10);e.vertexColors&&c.enable(11);e.vertexAlphas&&c.enable(12);e.vertexUv1s&&c.enable(13);e.vertexUv2s&&c.enable(14);e.vertexUv3s&&c.enable(15);e.vertexTangents&&c.enable(16);e.anisotropy&&c.enable(17);e.alphaHash&&c.enable(18);e.batching&&c.enable(19);e.dispersion&&c.enable(20);e.batchingColor&&c.enable(21);t.push(c.mask),c.disableAll(),e.fog&&c.enable(0);e.useFog&&c.enable(1);e.flatShading&&c.enable(2);e.logarithmicDepthBuffer&&c.enable(3);e.reverseDepthBuffer&&c.enable(4);e.skinning&&c.enable(5);e.morphTargets&&c.enable(6);e.morphNormals&&c.enable(7);e.morphColors&&c.enable(8);e.premultipliedAlpha&&c.enable(9);e.shadowMapEnabled&&c.enable(10);e.doubleSided&&c.enable(11);e.flipSided&&c.enable(12);e.useDepthPacking&&c.enable(13);e.dithering&&c.enable(14);e.transmission&&c.enable(15);e.sheen&&c.enable(16);e.opaque&&c.enable(17);e.pointsUvs&&c.enable(18);e.decodeVideoTexture&&c.enable(19);e.decodeVideoTextureEmissive&&c.enable(20);e.alphaToCoverage&&c.enable(21);t.push(c.mask)}(i,e),i.push(t.outputColorSpace)),i.push(e.customProgramCacheKey),i.join()},getUniforms:function(t){const e=m[t.type];let i;if(e){const t=l[e];i=n.LlO.clone(t.uniforms)}else i=t.uniforms;return i},acquireProgram:function(e,i){let n;for(let t=0,e=d.length;t<e;t++){const e=d[t];if(e.cacheKey===i){n=e,++n.usedTimes;break}}return void 0===n&&(n=new pe(t,i,e,o),d.push(n)),n},releaseProgram:function(t){if(0===--t.usedTimes){const e=d.indexOf(t);d[e]=d[d.length-1],d.pop(),t.destroy()}},releaseShaderCache:function(t){h.remove(t)},programs:d,dispose:function(){h.dispose()}}}function ve(){let t=new WeakMap;return{has:function(e){return t.has(e)},get:function(e){let i=t.get(e);return void 0===i&&(i={},t.set(e,i)),i},remove:function(e){t.delete(e)},update:function(e,i,n){t.get(e)[i]=n},dispose:function(){t=new WeakMap}}}function ye(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function be(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function _e(){const t=[];let e=0;const i=[],n=[],s=[];function r(i,n,s,r,o,a){let l=t[e];return void 0===l?(l={id:i.id,object:i,geometry:n,material:s,groupOrder:r,renderOrder:i.renderOrder,z:o,group:a},t[e]=l):(l.id=i.id,l.object=i,l.geometry=n,l.material=s,l.groupOrder=r,l.renderOrder=i.renderOrder,l.z=o,l.group=a),e++,l}return{opaque:i,transmissive:n,transparent:s,init:function(){e=0,i.length=0,n.length=0,s.length=0},push:function(t,e,o,a,l,c){const h=r(t,e,o,a,l,c);o.transmission>0?n.push(h):!0===o.transparent?s.push(h):i.push(h)},unshift:function(t,e,o,a,l,c){const h=r(t,e,o,a,l,c);o.transmission>0?n.unshift(h):!0===o.transparent?s.unshift(h):i.unshift(h)},finish:function(){for(let i=e,n=t.length;i<n;i++){const e=t[i];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){i.length>1&&i.sort(t||ye),n.length>1&&n.sort(e||be),s.length>1&&s.sort(e||be)}}}function xe(){let t=new WeakMap;return{get:function(e,i){const n=t.get(e);let s;return void 0===n?(s=new _e,t.set(e,[s])):i>=n.length?(s=new _e,n.push(s)):s=n[i],s},dispose:function(){t=new WeakMap}}}function we(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new n.Pq0,color:new n.Q1f};break;case"SpotLight":i={position:new n.Pq0,direction:new n.Pq0,color:new n.Q1f,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new n.Pq0,color:new n.Q1f,distance:0,decay:0};break;case"HemisphereLight":i={direction:new n.Pq0,skyColor:new n.Q1f,groundColor:new n.Q1f};break;case"RectAreaLight":i={color:new n.Q1f,position:new n.Pq0,halfWidth:new n.Pq0,halfHeight:new n.Pq0}}return t[e.id]=i,i}}}let Ee=0;function Ce(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Se(t){const e=new we,i=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let i;switch(e.type){case"DirectionalLight":case"SpotLight":i={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new n.I9Y};break;case"PointLight":i={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new n.I9Y,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=i,i}}}(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let t=0;t<9;t++)s.probe.push(new n.Pq0);const r=new n.Pq0,o=new n.kn4,l=new n.kn4;return{setup:function(n){let r=0,o=0,l=0;for(let t=0;t<9;t++)s.probe[t].set(0,0,0);let c=0,h=0,u=0,d=0,p=0,f=0,g=0,m=0,A=0,v=0,y=0;n.sort(Ce);for(let t=0,a=n.length;t<a;t++){const a=n[t],b=a.color,_=a.intensity,x=a.distance,w=a.shadow&&a.shadow.map?a.shadow.map.texture:null;if(a.isAmbientLight)r+=b.r*_,o+=b.g*_,l+=b.b*_;else if(a.isLightProbe){for(let t=0;t<9;t++)s.probe[t].addScaledVector(a.sh.coefficients[t],_);y++}else if(a.isDirectionalLight){const t=e.get(a);if(t.color.copy(a.color).multiplyScalar(a.intensity),a.castShadow){const t=a.shadow,e=i.get(a);e.shadowIntensity=t.intensity,e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,s.directionalShadow[c]=e,s.directionalShadowMap[c]=w,s.directionalShadowMatrix[c]=a.shadow.matrix,f++}s.directional[c]=t,c++}else if(a.isSpotLight){const t=e.get(a);t.position.setFromMatrixPosition(a.matrixWorld),t.color.copy(b).multiplyScalar(_),t.distance=x,t.coneCos=Math.cos(a.angle),t.penumbraCos=Math.cos(a.angle*(1-a.penumbra)),t.decay=a.decay,s.spot[u]=t;const n=a.shadow;if(a.map&&(s.spotLightMap[A]=a.map,A++,n.updateMatrices(a),a.castShadow&&v++),s.spotLightMatrix[u]=n.matrix,a.castShadow){const t=i.get(a);t.shadowIntensity=n.intensity,t.shadowBias=n.bias,t.shadowNormalBias=n.normalBias,t.shadowRadius=n.radius,t.shadowMapSize=n.mapSize,s.spotShadow[u]=t,s.spotShadowMap[u]=w,m++}u++}else if(a.isRectAreaLight){const t=e.get(a);t.color.copy(b).multiplyScalar(_),t.halfWidth.set(.5*a.width,0,0),t.halfHeight.set(0,.5*a.height,0),s.rectArea[d]=t,d++}else if(a.isPointLight){const t=e.get(a);if(t.color.copy(a.color).multiplyScalar(a.intensity),t.distance=a.distance,t.decay=a.decay,a.castShadow){const t=a.shadow,e=i.get(a);e.shadowIntensity=t.intensity,e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,e.shadowCameraNear=t.camera.near,e.shadowCameraFar=t.camera.far,s.pointShadow[h]=e,s.pointShadowMap[h]=w,s.pointShadowMatrix[h]=a.shadow.matrix,g++}s.point[h]=t,h++}else if(a.isHemisphereLight){const t=e.get(a);t.skyColor.copy(a.color).multiplyScalar(_),t.groundColor.copy(a.groundColor).multiplyScalar(_),s.hemi[p]=t,p++}}d>0&&(!0===t.has("OES_texture_float_linear")?(s.rectAreaLTC1=a.LTC_FLOAT_1,s.rectAreaLTC2=a.LTC_FLOAT_2):(s.rectAreaLTC1=a.LTC_HALF_1,s.rectAreaLTC2=a.LTC_HALF_2)),s.ambient[0]=r,s.ambient[1]=o,s.ambient[2]=l;const b=s.hash;b.directionalLength===c&&b.pointLength===h&&b.spotLength===u&&b.rectAreaLength===d&&b.hemiLength===p&&b.numDirectionalShadows===f&&b.numPointShadows===g&&b.numSpotShadows===m&&b.numSpotMaps===A&&b.numLightProbes===y||(s.directional.length=c,s.spot.length=u,s.rectArea.length=d,s.point.length=h,s.hemi.length=p,s.directionalShadow.length=f,s.directionalShadowMap.length=f,s.pointShadow.length=g,s.pointShadowMap.length=g,s.spotShadow.length=m,s.spotShadowMap.length=m,s.directionalShadowMatrix.length=f,s.pointShadowMatrix.length=g,s.spotLightMatrix.length=m+A-v,s.spotLightMap.length=A,s.numSpotLightShadowsWithMaps=v,s.numLightProbes=y,b.directionalLength=c,b.pointLength=h,b.spotLength=u,b.rectAreaLength=d,b.hemiLength=p,b.numDirectionalShadows=f,b.numPointShadows=g,b.numSpotShadows=m,b.numSpotMaps=A,b.numLightProbes=y,s.version=Ee++)},setupView:function(t,e){let i=0,n=0,a=0,c=0,h=0;const u=e.matrixWorldInverse;for(let e=0,d=t.length;e<d;e++){const d=t[e];if(d.isDirectionalLight){const t=s.directional[i];t.direction.setFromMatrixPosition(d.matrixWorld),r.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(r),t.direction.transformDirection(u),i++}else if(d.isSpotLight){const t=s.spot[a];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),t.direction.setFromMatrixPosition(d.matrixWorld),r.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(r),t.direction.transformDirection(u),a++}else if(d.isRectAreaLight){const t=s.rectArea[c];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),l.identity(),o.copy(d.matrixWorld),o.premultiply(u),l.extractRotation(o),t.halfWidth.set(.5*d.width,0,0),t.halfHeight.set(0,.5*d.height,0),t.halfWidth.applyMatrix4(l),t.halfHeight.applyMatrix4(l),c++}else if(d.isPointLight){const t=s.point[n];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),n++}else if(d.isHemisphereLight){const t=s.hemi[h];t.direction.setFromMatrixPosition(d.matrixWorld),t.direction.transformDirection(u),h++}}},state:s}}function Ie(t){const e=new Se(t),i=[],n=[];const s={lightsArray:i,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function(t){s.camera=t,i.length=0,n.length=0},state:s,setupLights:function(){e.setup(i)},setupLightsView:function(t){e.setupView(i,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){n.push(t)}}}function Me(t){let e=new WeakMap;return{get:function(i,n=0){const s=e.get(i);let r;return void 0===s?(r=new Ie(t),e.set(i,[r])):n>=s.length?(r=new Ie(t),s.push(r)):r=s[n],r},dispose:function(){e=new WeakMap}}}function Te(t,e,i){let s=new n.PPD;const r=new n.I9Y,o=new n.I9Y,a=new n.IUQ,l=new n.CSG({depthPacking:n.N5j}),c=new n.aVO,h={},u=i.maxTextureSize,d={[n.hB5]:n.hsX,[n.hsX]:n.hB5,[n.$EB]:n.$EB},p=new n.BKk({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new n.I9Y},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=p.clone();f.defines.HORIZONTAL_PASS=1;const g=new n.LoY;g.setAttribute("position",new n.THS(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new n.eaF(g,p),A=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=n.QP0;let v=this.type;function y(i,s){const o=e.update(m);p.defines.VSM_SAMPLES!==i.blurSamples&&(p.defines.VSM_SAMPLES=i.blurSamples,f.defines.VSM_SAMPLES=i.blurSamples,p.needsUpdate=!0,f.needsUpdate=!0),null===i.mapPass&&(i.mapPass=new n.nWS(r.x,r.y)),p.uniforms.shadow_pass.value=i.map.texture,p.uniforms.resolution.value=i.mapSize,p.uniforms.radius.value=i.radius,t.setRenderTarget(i.mapPass),t.clear(),t.renderBufferDirect(s,null,o,p,m,null),f.uniforms.shadow_pass.value=i.mapPass.texture,f.uniforms.resolution.value=i.mapSize,f.uniforms.radius.value=i.radius,t.setRenderTarget(i.map),t.clear(),t.renderBufferDirect(s,null,o,f,m,null)}function b(e,i,s,r){let o=null;const a=!0===s.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(void 0!==a)o=a;else if(o=!0===s.isPointLight?c:l,t.localClippingEnabled&&!0===i.clipShadows&&Array.isArray(i.clippingPlanes)&&0!==i.clippingPlanes.length||i.displacementMap&&0!==i.displacementScale||i.alphaMap&&i.alphaTest>0||i.map&&i.alphaTest>0||!0===i.alphaToCoverage){const t=o.uuid,e=i.uuid;let n=h[t];void 0===n&&(n={},h[t]=n);let s=n[e];void 0===s&&(s=o.clone(),n[e]=s,i.addEventListener("dispose",x)),o=s}if(o.visible=i.visible,o.wireframe=i.wireframe,r===n.RyA?o.side=null!==i.shadowSide?i.shadowSide:i.side:o.side=null!==i.shadowSide?i.shadowSide:d[i.side],o.alphaMap=i.alphaMap,o.alphaTest=!0===i.alphaToCoverage?.5:i.alphaTest,o.map=i.map,o.clipShadows=i.clipShadows,o.clippingPlanes=i.clippingPlanes,o.clipIntersection=i.clipIntersection,o.displacementMap=i.displacementMap,o.displacementScale=i.displacementScale,o.displacementBias=i.displacementBias,o.wireframeLinewidth=i.wireframeLinewidth,o.linewidth=i.linewidth,!0===s.isPointLight&&!0===o.isMeshDistanceMaterial){t.properties.get(o).light=s}return o}function _(i,r,o,a,l){if(!1===i.visible)return;if(i.layers.test(r.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&l===n.RyA)&&(!i.frustumCulled||s.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,i.matrixWorld);const n=e.update(i),s=i.material;if(Array.isArray(s)){const e=n.groups;for(let c=0,h=e.length;c<h;c++){const h=e[c],u=s[h.materialIndex];if(u&&u.visible){const e=b(i,u,a,l);i.onBeforeShadow(t,i,r,o,n,e,h),t.renderBufferDirect(o,null,n,e,i,h),i.onAfterShadow(t,i,r,o,n,e,h)}}}else if(s.visible){const e=b(i,s,a,l);i.onBeforeShadow(t,i,r,o,n,e,null),t.renderBufferDirect(o,null,n,e,i,null),i.onAfterShadow(t,i,r,o,n,e,null)}}const c=i.children;for(let t=0,e=c.length;t<e;t++)_(c[t],r,o,a,l)}function x(t){t.target.removeEventListener("dispose",x);for(const e in h){const i=h[e],n=t.target.uuid;if(n in i){i[n].dispose(),delete i[n]}}}this.render=function(e,i,l){if(!1===A.enabled)return;if(!1===A.autoUpdate&&!1===A.needsUpdate)return;if(0===e.length)return;const c=t.getRenderTarget(),h=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),p=t.state;p.setBlending(n.XIg),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);const f=v!==n.RyA&&this.type===n.RyA,g=v===n.RyA&&this.type!==n.RyA;for(let c=0,h=e.length;c<h;c++){const h=e[c],d=h.shadow;if(void 0===d){console.warn("THREE.WebGLShadowMap:",h,"has no shadow.");continue}if(!1===d.autoUpdate&&!1===d.needsUpdate)continue;r.copy(d.mapSize);const m=d.getFrameExtents();if(r.multiply(m),o.copy(d.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(o.x=Math.floor(u/m.x),r.x=o.x*m.x,d.mapSize.x=o.x),r.y>u&&(o.y=Math.floor(u/m.y),r.y=o.y*m.y,d.mapSize.y=o.y)),null===d.map||!0===f||!0===g){const t=this.type!==n.RyA?{minFilter:n.hxR,magFilter:n.hxR}:{};null!==d.map&&d.map.dispose(),d.map=new n.nWS(r.x,r.y,t),d.map.texture.name=h.name+".shadowMap",d.camera.updateProjectionMatrix()}t.setRenderTarget(d.map),t.clear();const A=d.getViewportCount();for(let t=0;t<A;t++){const e=d.getViewport(t);a.set(o.x*e.x,o.y*e.y,o.x*e.z,o.y*e.w),p.viewport(a),d.updateMatrices(h,t),s=d.getFrustum(),_(i,l,d.camera,h,this.type)}!0!==d.isPointLightShadow&&this.type===n.RyA&&y(d,l),d.needsUpdate=!1}v=this.type,A.needsUpdate=!1,t.setRenderTarget(c,h,d)}}const Be={[n.eHc]:n.lGu,[n.brA]:n.K52,[n.U3G]:n.bw0,[n.xSv]:n.Gwm,[n.lGu]:n.eHc,[n.K52]:n.brA,[n.bw0]:n.U3G,[n.Gwm]:n.xSv};function Re(t,e){const i=new function(){let e=!1;const i=new n.IUQ;let s=null;const r=new n.IUQ(0,0,0,0);return{setMask:function(i){s===i||e||(t.colorMask(i,i,i,i),s=i)},setLocked:function(t){e=t},setClear:function(e,n,s,o,a){!0===a&&(e*=o,n*=o,s*=o),i.set(e,n,s,o),!1===r.equals(i)&&(t.clearColor(e,n,s,o),r.copy(i))},reset:function(){e=!1,s=null,r.set(-1,0,0,0)}}},s=new function(){let i=!1,s=!1,r=null,o=null,a=null;return{setReversed:function(t){if(s!==t){const i=e.get("EXT_clip_control");t?i.clipControlEXT(i.LOWER_LEFT_EXT,i.ZERO_TO_ONE_EXT):i.clipControlEXT(i.LOWER_LEFT_EXT,i.NEGATIVE_ONE_TO_ONE_EXT),s=t;const n=a;a=null,this.setClear(n)}},getReversed:function(){return s},setTest:function(e){e?V(t.DEPTH_TEST):Q(t.DEPTH_TEST)},setMask:function(e){r===e||i||(t.depthMask(e),r=e)},setFunc:function(e){if(s&&(e=Be[e]),o!==e){switch(e){case n.eHc:t.depthFunc(t.NEVER);break;case n.lGu:t.depthFunc(t.ALWAYS);break;case n.brA:t.depthFunc(t.LESS);break;case n.xSv:t.depthFunc(t.LEQUAL);break;case n.U3G:t.depthFunc(t.EQUAL);break;case n.Gwm:t.depthFunc(t.GEQUAL);break;case n.K52:t.depthFunc(t.GREATER);break;case n.bw0:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}o=e}},setLocked:function(t){i=t},setClear:function(e){a!==e&&(s&&(e=1-e),t.clearDepth(e),a=e)},reset:function(){i=!1,r=null,o=null,a=null,s=!1}}},r=new function(){let e=!1,i=null,n=null,s=null,r=null,o=null,a=null,l=null,c=null;return{setTest:function(i){e||(i?V(t.STENCIL_TEST):Q(t.STENCIL_TEST))},setMask:function(n){i===n||e||(t.stencilMask(n),i=n)},setFunc:function(e,i,o){n===e&&s===i&&r===o||(t.stencilFunc(e,i,o),n=e,s=i,r=o)},setOp:function(e,i,n){o===e&&a===i&&l===n||(t.stencilOp(e,i,n),o=e,a=i,l=n)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,i=null,n=null,s=null,r=null,o=null,a=null,l=null,c=null}}},o=new WeakMap,a=new WeakMap;let l={},c={},h=new WeakMap,u=[],d=null,p=!1,f=null,g=null,m=null,A=null,v=null,y=null,b=null,_=new n.Q1f(0,0,0),x=0,w=!1,E=null,C=null,S=null,I=null,M=null;const T=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let B=!1,R=0;const P=t.getParameter(t.VERSION);-1!==P.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(P)[1]),B=R>=1):-1!==P.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(P)[1]),B=R>=2);let L=null,D={};const N=t.getParameter(t.SCISSOR_BOX),O=t.getParameter(t.VIEWPORT),k=(new n.IUQ).fromArray(N),U=(new n.IUQ).fromArray(O);function F(e,i,n,s){const r=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let o=0;o<n;o++)e===t.TEXTURE_3D||e===t.TEXTURE_2D_ARRAY?t.texImage3D(i,0,t.RGBA,1,1,s,0,t.RGBA,t.UNSIGNED_BYTE,r):t.texImage2D(i+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);return o}const z={};function V(e){!0!==l[e]&&(t.enable(e),l[e]=!0)}function Q(e){!1!==l[e]&&(t.disable(e),l[e]=!1)}z[t.TEXTURE_2D]=F(t.TEXTURE_2D,t.TEXTURE_2D,1),z[t.TEXTURE_CUBE_MAP]=F(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),z[t.TEXTURE_2D_ARRAY]=F(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),z[t.TEXTURE_3D]=F(t.TEXTURE_3D,t.TEXTURE_3D,1,1),i.setClear(0,0,0,1),s.setClear(1),r.setClear(0),V(t.DEPTH_TEST),s.setFunc(n.xSv),q(!1),$(n.Vb5),V(t.CULL_FACE),H(n.XIg);const j={[n.gO9]:t.FUNC_ADD,[n.FXf]:t.FUNC_SUBTRACT,[n.nST]:t.FUNC_REVERSE_SUBTRACT};j[n.znC]=t.MIN,j[n.$ei]=t.MAX;const G={[n.ojh]:t.ZERO,[n.qad]:t.ONE,[n.f4X]:t.SRC_COLOR,[n.ie2]:t.SRC_ALPHA,[n.hgQ]:t.SRC_ALPHA_SATURATE,[n.wn6]:t.DST_COLOR,[n.hdd]:t.DST_ALPHA,[n.LiQ]:t.ONE_MINUS_SRC_COLOR,[n.OuU]:t.ONE_MINUS_SRC_ALPHA,[n.aEY]:t.ONE_MINUS_DST_COLOR,[n.Nt7]:t.ONE_MINUS_DST_ALPHA,[n.RrE]:t.CONSTANT_COLOR,[n.$Yl]:t.ONE_MINUS_CONSTANT_COLOR,[n.e0p]:t.CONSTANT_ALPHA,[n.ov9]:t.ONE_MINUS_CONSTANT_ALPHA};function H(e,i,s,r,o,a,l,c,h,u){if(e!==n.XIg){if(!1===p&&(V(t.BLEND),p=!0),e===n.bCz)o=o||i,a=a||s,l=l||r,i===g&&o===v||(t.blendEquationSeparate(j[i],j[o]),g=i,v=o),s===m&&r===A&&a===y&&l===b||(t.blendFuncSeparate(G[s],G[r],G[a],G[l]),m=s,A=r,y=a,b=l),!1!==c.equals(_)&&h===x||(t.blendColor(c.r,c.g,c.b,h),_.copy(c),x=h),f=e,w=!1;else if(e!==f||u!==w){if(g===n.gO9&&v===n.gO9||(t.blendEquation(t.FUNC_ADD),g=n.gO9,v=n.gO9),u)switch(e){case n.NTi:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case n.EZo:t.blendFunc(t.ONE,t.ONE);break;case n.Kwu:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case n.EdD:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case n.NTi:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case n.EZo:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case n.Kwu:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case n.EdD:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}m=null,A=null,y=null,b=null,_.set(0,0,0),x=0,f=e,w=u}}else!0===p&&(Q(t.BLEND),p=!1)}function q(e){E!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),E=e)}function $(e){e!==n.WNZ?(V(t.CULL_FACE),e!==C&&(e===n.Vb5?t.cullFace(t.BACK):e===n.Jnc?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Q(t.CULL_FACE),C=e}function W(e,i,n){e?(V(t.POLYGON_OFFSET_FILL),I===i&&M===n||(t.polygonOffset(i,n),I=i,M=n)):Q(t.POLYGON_OFFSET_FILL)}return{buffers:{color:i,depth:s,stencil:r},enable:V,disable:Q,bindFramebuffer:function(e,i){return c[e]!==i&&(t.bindFramebuffer(e,i),c[e]=i,e===t.DRAW_FRAMEBUFFER&&(c[t.FRAMEBUFFER]=i),e===t.FRAMEBUFFER&&(c[t.DRAW_FRAMEBUFFER]=i),!0)},drawBuffers:function(e,i){let n=u,s=!1;if(e){n=h.get(i),void 0===n&&(n=[],h.set(i,n));const r=e.textures;if(n.length!==r.length||n[0]!==t.COLOR_ATTACHMENT0){for(let e=0,i=r.length;e<i;e++)n[e]=t.COLOR_ATTACHMENT0+e;n.length=r.length,s=!0}}else n[0]!==t.BACK&&(n[0]=t.BACK,s=!0);s&&t.drawBuffers(n)},useProgram:function(e){return d!==e&&(t.useProgram(e),d=e,!0)},setBlending:H,setMaterial:function(e,o){e.side===n.$EB?Q(t.CULL_FACE):V(t.CULL_FACE);let a=e.side===n.hsX;o&&(a=!a),q(a),e.blending===n.NTi&&!1===e.transparent?H(n.XIg):H(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.blendColor,e.blendAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),i.setMask(e.colorWrite);const l=e.stencilWrite;r.setTest(l),l&&(r.setMask(e.stencilWriteMask),r.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),r.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),W(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?V(t.SAMPLE_ALPHA_TO_COVERAGE):Q(t.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:q,setCullFace:$,setLineWidth:function(e){e!==S&&(B&&t.lineWidth(e),S=e)},setPolygonOffset:W,setScissorTest:function(e){e?V(t.SCISSOR_TEST):Q(t.SCISSOR_TEST)},activeTexture:function(e){void 0===e&&(e=t.TEXTURE0+T-1),L!==e&&(t.activeTexture(e),L=e)},bindTexture:function(e,i,n){void 0===n&&(n=null===L?t.TEXTURE0+T-1:L);let s=D[n];void 0===s&&(s={type:void 0,texture:void 0},D[n]=s),s.type===e&&s.texture===i||(L!==n&&(t.activeTexture(n),L=n),t.bindTexture(e,i||z[e]),s.type=e,s.texture=i)},unbindTexture:function(){const e=D[L];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{t.compressedTexImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(e,i){let n=a.get(i);void 0===n&&(n=new WeakMap,a.set(i,n));let s=n.get(e);void 0===s&&(s=t.getUniformBlockIndex(i,e.name),n.set(e,s))},uniformBlockBinding:function(e,i){const n=a.get(i).get(e);o.get(i)!==n&&(t.uniformBlockBinding(i,n,e.__bindingPointIndex),o.set(i,n))},texStorage2D:function(){try{t.texStorage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{t.texStorage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{t.texSubImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{t.texSubImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{t.compressedTexSubImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===k.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),k.copy(e))},viewport:function(e){!1===U.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),U.copy(e))},reset:function(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),s.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),l={},L=null,D={},c={},h=new WeakMap,u=[],d=null,p=!1,f=null,g=null,m=null,A=null,v=null,y=null,b=null,_=new n.Q1f(0,0,0),x=0,w=!1,E=null,C=null,S=null,I=null,M=null,k.set(0,0,t.canvas.width,t.canvas.height),U.set(0,0,t.canvas.width,t.canvas.height),i.reset(),s.reset(),r.reset()}}}function Pe(t,e,i,s,r,o,a){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),h=new n.I9Y,u=new WeakMap;let d;const p=new WeakMap;let f=!1;try{f="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function g(t,e){return f?new OffscreenCanvas(t,e):(0,n.qq$)("canvas")}function m(t,e,i){let n=1;const s=G(t);if((s.width>i||s.height>i)&&(n=i/Math.max(s.width,s.height)),n<1){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&t instanceof VideoFrame){const i=Math.floor(n*s.width),r=Math.floor(n*s.height);void 0===d&&(d=g(i,r));const o=e?g(i,r):d;o.width=i,o.height=r;return o.getContext("2d").drawImage(t,0,0,i,r),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+s.width+"x"+s.height+") to ("+i+"x"+r+")."),o}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+s.width+"x"+s.height+")."),t}return t}function A(t){return t.generateMipmaps}function v(e){t.generateMipmap(e)}function y(e){return e.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:e.isWebGL3DRenderTarget?t.TEXTURE_3D:e.isWebGLArrayRenderTarget||e.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function b(i,s,r,o,a=!1){if(null!==i){if(void 0!==t[i])return t[i];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+i+"'")}let l=s;if(s===t.RED&&(r===t.FLOAT&&(l=t.R32F),r===t.HALF_FLOAT&&(l=t.R16F),r===t.UNSIGNED_BYTE&&(l=t.R8)),s===t.RED_INTEGER&&(r===t.UNSIGNED_BYTE&&(l=t.R8UI),r===t.UNSIGNED_SHORT&&(l=t.R16UI),r===t.UNSIGNED_INT&&(l=t.R32UI),r===t.BYTE&&(l=t.R8I),r===t.SHORT&&(l=t.R16I),r===t.INT&&(l=t.R32I)),s===t.RG&&(r===t.FLOAT&&(l=t.RG32F),r===t.HALF_FLOAT&&(l=t.RG16F),r===t.UNSIGNED_BYTE&&(l=t.RG8)),s===t.RG_INTEGER&&(r===t.UNSIGNED_BYTE&&(l=t.RG8UI),r===t.UNSIGNED_SHORT&&(l=t.RG16UI),r===t.UNSIGNED_INT&&(l=t.RG32UI),r===t.BYTE&&(l=t.RG8I),r===t.SHORT&&(l=t.RG16I),r===t.INT&&(l=t.RG32I)),s===t.RGB_INTEGER&&(r===t.UNSIGNED_BYTE&&(l=t.RGB8UI),r===t.UNSIGNED_SHORT&&(l=t.RGB16UI),r===t.UNSIGNED_INT&&(l=t.RGB32UI),r===t.BYTE&&(l=t.RGB8I),r===t.SHORT&&(l=t.RGB16I),r===t.INT&&(l=t.RGB32I)),s===t.RGBA_INTEGER&&(r===t.UNSIGNED_BYTE&&(l=t.RGBA8UI),r===t.UNSIGNED_SHORT&&(l=t.RGBA16UI),r===t.UNSIGNED_INT&&(l=t.RGBA32UI),r===t.BYTE&&(l=t.RGBA8I),r===t.SHORT&&(l=t.RGBA16I),r===t.INT&&(l=t.RGBA32I)),s===t.RGB&&r===t.UNSIGNED_INT_5_9_9_9_REV&&(l=t.RGB9_E5),s===t.RGBA){const e=a?n.VxR:n.ppV.getTransfer(o);r===t.FLOAT&&(l=t.RGBA32F),r===t.HALF_FLOAT&&(l=t.RGBA16F),r===t.UNSIGNED_BYTE&&(l=e===n.KLL?t.SRGB8_ALPHA8:t.RGBA8),r===t.UNSIGNED_SHORT_4_4_4_4&&(l=t.RGBA4),r===t.UNSIGNED_SHORT_5_5_5_1&&(l=t.RGB5_A1)}return l!==t.R16F&&l!==t.R32F&&l!==t.RG16F&&l!==t.RG32F&&l!==t.RGBA16F&&l!==t.RGBA32F||e.get("EXT_color_buffer_float"),l}function _(e,i){let s;return e?null===i||i===n.bkx||i===n.V3x?s=t.DEPTH24_STENCIL8:i===n.RQf?s=t.DEPTH32F_STENCIL8:i===n.cHt&&(s=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===i||i===n.bkx||i===n.V3x?s=t.DEPTH_COMPONENT24:i===n.RQf?s=t.DEPTH_COMPONENT32F:i===n.cHt&&(s=t.DEPTH_COMPONENT16),s}function x(t,e){return!0===A(t)||t.isFramebufferTexture&&t.minFilter!==n.hxR&&t.minFilter!==n.k6q?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function w(t){const e=t.target;e.removeEventListener("dispose",w),function(t){const e=s.get(t);if(void 0===e.__webglInit)return;const i=t.source,n=p.get(i);if(n){const s=n[e.__cacheKey];s.usedTimes--,0===s.usedTimes&&C(t),0===Object.keys(n).length&&p.delete(i)}s.remove(t)}(e),e.isVideoTexture&&u.delete(e)}function E(e){const i=e.target;i.removeEventListener("dispose",E),function(e){const i=s.get(e);e.depthTexture&&(e.depthTexture.dispose(),s.remove(e.depthTexture));if(e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++){if(Array.isArray(i.__webglFramebuffer[e]))for(let n=0;n<i.__webglFramebuffer[e].length;n++)t.deleteFramebuffer(i.__webglFramebuffer[e][n]);else t.deleteFramebuffer(i.__webglFramebuffer[e]);i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[e])}else{if(Array.isArray(i.__webglFramebuffer))for(let e=0;e<i.__webglFramebuffer.length;e++)t.deleteFramebuffer(i.__webglFramebuffer[e]);else t.deleteFramebuffer(i.__webglFramebuffer);if(i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&t.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(let e=0;e<i.__webglColorRenderbuffer.length;e++)i.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(i.__webglColorRenderbuffer[e]);i.__webglDepthRenderbuffer&&t.deleteRenderbuffer(i.__webglDepthRenderbuffer)}const n=e.textures;for(let e=0,i=n.length;e<i;e++){const i=s.get(n[e]);i.__webglTexture&&(t.deleteTexture(i.__webglTexture),a.memory.textures--),s.remove(n[e])}s.remove(e)}(i)}function C(e){const i=s.get(e);t.deleteTexture(i.__webglTexture);const n=e.source;delete p.get(n)[i.__cacheKey],a.memory.textures--}let S=0;function I(e,n){const r=s.get(e);if(e.isVideoTexture&&function(t){const e=a.render.frame;u.get(t)!==e&&(u.set(t,e),t.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&r.__version!==e.version){const t=e.image;if(null===t)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==t.complete)return void D(r,e,n);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.bindTexture(t.TEXTURE_2D,r.__webglTexture,t.TEXTURE0+n)}const M={[n.GJx]:t.REPEAT,[n.ghU]:t.CLAMP_TO_EDGE,[n.kTW]:t.MIRRORED_REPEAT},T={[n.hxR]:t.NEAREST,[n.pHI]:t.NEAREST_MIPMAP_NEAREST,[n.Cfg]:t.NEAREST_MIPMAP_LINEAR,[n.k6q]:t.LINEAR,[n.kRr]:t.LINEAR_MIPMAP_NEAREST,[n.$_I]:t.LINEAR_MIPMAP_LINEAR},B={[n.amv]:t.NEVER,[n.FFZ]:t.ALWAYS,[n.vim]:t.LESS,[n.TiK]:t.LEQUAL,[n.kO0]:t.EQUAL,[n.gWB]:t.GEQUAL,[n.eoi]:t.GREATER,[n.jzd]:t.NOTEQUAL};function R(i,o){if(o.type!==n.RQf||!1!==e.has("OES_texture_float_linear")||o.magFilter!==n.k6q&&o.magFilter!==n.kRr&&o.magFilter!==n.Cfg&&o.magFilter!==n.$_I&&o.minFilter!==n.k6q&&o.minFilter!==n.kRr&&o.minFilter!==n.Cfg&&o.minFilter!==n.$_I||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(i,t.TEXTURE_WRAP_S,M[o.wrapS]),t.texParameteri(i,t.TEXTURE_WRAP_T,M[o.wrapT]),i!==t.TEXTURE_3D&&i!==t.TEXTURE_2D_ARRAY||t.texParameteri(i,t.TEXTURE_WRAP_R,M[o.wrapR]),t.texParameteri(i,t.TEXTURE_MAG_FILTER,T[o.magFilter]),t.texParameteri(i,t.TEXTURE_MIN_FILTER,T[o.minFilter]),o.compareFunction&&(t.texParameteri(i,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(i,t.TEXTURE_COMPARE_FUNC,B[o.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(o.magFilter===n.hxR)return;if(o.minFilter!==n.Cfg&&o.minFilter!==n.$_I)return;if(o.type===n.RQf&&!1===e.has("OES_texture_float_linear"))return;if(o.anisotropy>1||s.get(o).__currentAnisotropy){const n=e.get("EXT_texture_filter_anisotropic");t.texParameterf(i,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),s.get(o).__currentAnisotropy=o.anisotropy}}}function P(e,i){let n=!1;void 0===e.__webglInit&&(e.__webglInit=!0,i.addEventListener("dispose",w));const s=i.source;let r=p.get(s);void 0===r&&(r={},p.set(s,r));const o=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.wrapR||0),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.colorSpace),e.join()}(i);if(o!==e.__cacheKey){void 0===r[o]&&(r[o]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,n=!0),r[o].usedTimes++;const s=r[e.__cacheKey];void 0!==s&&(r[e.__cacheKey].usedTimes--,0===s.usedTimes&&C(i)),e.__cacheKey=o,e.__webglTexture=r[o].texture}return n}function L(t,e,i){return Math.floor(Math.floor(t/i)/e)}function D(e,a,l){let c=t.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(c=t.TEXTURE_2D_ARRAY),a.isData3DTexture&&(c=t.TEXTURE_3D);const h=P(e,a),u=a.source;i.bindTexture(c,e.__webglTexture,t.TEXTURE0+l);const d=s.get(u);if(u.version!==d.__version||!0===h){i.activeTexture(t.TEXTURE0+l);const e=n.ppV.getPrimaries(n.ppV.workingColorSpace),s=a.colorSpace===n.jf0?null:n.ppV.getPrimaries(a.colorSpace),p=a.colorSpace===n.jf0||e===s?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,p);let f=m(a.image,!1,r.maxTextureSize);f=j(a,f);const g=o.convert(a.format,a.colorSpace),y=o.convert(a.type);let w,E=b(a.internalFormat,g,y,a.colorSpace,a.isVideoTexture);R(c,a);const C=a.mipmaps,S=!0!==a.isVideoTexture,I=void 0===d.__version||!0===h,M=u.dataReady,T=x(a,f);if(a.isDepthTexture)E=_(a.format===n.dcC,a.type),I&&(S?i.texStorage2D(t.TEXTURE_2D,1,E,f.width,f.height):i.texImage2D(t.TEXTURE_2D,0,E,f.width,f.height,0,g,y,null));else if(a.isDataTexture)if(C.length>0){S&&I&&i.texStorage2D(t.TEXTURE_2D,T,E,C[0].width,C[0].height);for(let e=0,n=C.length;e<n;e++)w=C[e],S?M&&i.texSubImage2D(t.TEXTURE_2D,e,0,0,w.width,w.height,g,y,w.data):i.texImage2D(t.TEXTURE_2D,e,E,w.width,w.height,0,g,y,w.data);a.generateMipmaps=!1}else S?(I&&i.texStorage2D(t.TEXTURE_2D,T,E,f.width,f.height),M&&function(e,n,s,r){const o=e.updateRanges;if(0===o.length)i.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,s,r,n.data);else{o.sort((t,e)=>t.start-e.start);let a=0;for(let t=1;t<o.length;t++){const e=o[a],i=o[t],s=e.start+e.count,r=L(i.start,n.width,4),l=L(e.start,n.width,4);i.start<=s+1&&r===l&&L(i.start+i.count-1,n.width,4)===r?e.count=Math.max(e.count,i.start+i.count-e.start):(++a,o[a]=i)}o.length=a+1;const l=t.getParameter(t.UNPACK_ROW_LENGTH),c=t.getParameter(t.UNPACK_SKIP_PIXELS),h=t.getParameter(t.UNPACK_SKIP_ROWS);t.pixelStorei(t.UNPACK_ROW_LENGTH,n.width);for(let e=0,a=o.length;e<a;e++){const a=o[e],l=Math.floor(a.start/4),c=Math.ceil(a.count/4),h=l%n.width,u=Math.floor(l/n.width),d=c,p=1;t.pixelStorei(t.UNPACK_SKIP_PIXELS,h),t.pixelStorei(t.UNPACK_SKIP_ROWS,u),i.texSubImage2D(t.TEXTURE_2D,0,h,u,d,p,s,r,n.data)}e.clearUpdateRanges(),t.pixelStorei(t.UNPACK_ROW_LENGTH,l),t.pixelStorei(t.UNPACK_SKIP_PIXELS,c),t.pixelStorei(t.UNPACK_SKIP_ROWS,h)}}(a,f,g,y)):i.texImage2D(t.TEXTURE_2D,0,E,f.width,f.height,0,g,y,f.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){S&&I&&i.texStorage3D(t.TEXTURE_2D_ARRAY,T,E,C[0].width,C[0].height,f.depth);for(let e=0,s=C.length;e<s;e++)if(w=C[e],a.format!==n.GWd)if(null!==g)if(S){if(M)if(a.layerUpdates.size>0){const s=(0,n.Nex)(w.width,w.height,a.format,a.type);for(const n of a.layerUpdates){const r=w.data.subarray(n*s/w.data.BYTES_PER_ELEMENT,(n+1)*s/w.data.BYTES_PER_ELEMENT);i.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,n,w.width,w.height,1,g,r)}a.clearLayerUpdates()}else i.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,w.width,w.height,f.depth,g,w.data)}else i.compressedTexImage3D(t.TEXTURE_2D_ARRAY,e,E,w.width,w.height,f.depth,0,w.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else S?M&&i.texSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,w.width,w.height,f.depth,g,y,w.data):i.texImage3D(t.TEXTURE_2D_ARRAY,e,E,w.width,w.height,f.depth,0,g,y,w.data)}else{S&&I&&i.texStorage2D(t.TEXTURE_2D,T,E,C[0].width,C[0].height);for(let e=0,s=C.length;e<s;e++)w=C[e],a.format!==n.GWd?null!==g?S?M&&i.compressedTexSubImage2D(t.TEXTURE_2D,e,0,0,w.width,w.height,g,w.data):i.compressedTexImage2D(t.TEXTURE_2D,e,E,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):S?M&&i.texSubImage2D(t.TEXTURE_2D,e,0,0,w.width,w.height,g,y,w.data):i.texImage2D(t.TEXTURE_2D,e,E,w.width,w.height,0,g,y,w.data)}else if(a.isDataArrayTexture)if(S){if(I&&i.texStorage3D(t.TEXTURE_2D_ARRAY,T,E,f.width,f.height,f.depth),M)if(a.layerUpdates.size>0){const e=(0,n.Nex)(f.width,f.height,a.format,a.type);for(const n of a.layerUpdates){const s=f.data.subarray(n*e/f.data.BYTES_PER_ELEMENT,(n+1)*e/f.data.BYTES_PER_ELEMENT);i.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,n,f.width,f.height,1,g,y,s)}a.clearLayerUpdates()}else i.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,g,y,f.data)}else i.texImage3D(t.TEXTURE_2D_ARRAY,0,E,f.width,f.height,f.depth,0,g,y,f.data);else if(a.isData3DTexture)S?(I&&i.texStorage3D(t.TEXTURE_3D,T,E,f.width,f.height,f.depth),M&&i.texSubImage3D(t.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,g,y,f.data)):i.texImage3D(t.TEXTURE_3D,0,E,f.width,f.height,f.depth,0,g,y,f.data);else if(a.isFramebufferTexture){if(I)if(S)i.texStorage2D(t.TEXTURE_2D,T,E,f.width,f.height);else{let e=f.width,n=f.height;for(let s=0;s<T;s++)i.texImage2D(t.TEXTURE_2D,s,E,e,n,0,g,y,null),e>>=1,n>>=1}}else if(C.length>0){if(S&&I){const e=G(C[0]);i.texStorage2D(t.TEXTURE_2D,T,E,e.width,e.height)}for(let e=0,n=C.length;e<n;e++)w=C[e],S?M&&i.texSubImage2D(t.TEXTURE_2D,e,0,0,g,y,w):i.texImage2D(t.TEXTURE_2D,e,E,g,y,w);a.generateMipmaps=!1}else if(S){if(I){const e=G(f);i.texStorage2D(t.TEXTURE_2D,T,E,e.width,e.height)}M&&i.texSubImage2D(t.TEXTURE_2D,0,0,0,g,y,f)}else i.texImage2D(t.TEXTURE_2D,0,E,g,y,f);A(a)&&v(c),d.__version=u.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}function N(e,n,r,a,c,h){const u=o.convert(r.format,r.colorSpace),d=o.convert(r.type),p=b(r.internalFormat,u,d,r.colorSpace),f=s.get(n),g=s.get(r);if(g.__renderTarget=n,!f.__hasExternalTextures){const e=Math.max(1,n.width>>h),s=Math.max(1,n.height>>h);c===t.TEXTURE_3D||c===t.TEXTURE_2D_ARRAY?i.texImage3D(c,h,p,e,s,n.depth,0,u,d,null):i.texImage2D(c,h,p,e,s,0,u,d,null)}i.bindFramebuffer(t.FRAMEBUFFER,e),Q(n)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,a,c,g.__webglTexture,0,V(n)):(c===t.TEXTURE_2D||c>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,a,c,g.__webglTexture,h),i.bindFramebuffer(t.FRAMEBUFFER,null)}function O(e,i,n){if(t.bindRenderbuffer(t.RENDERBUFFER,e),i.depthBuffer){const s=i.depthTexture,r=s&&s.isDepthTexture?s.type:null,o=_(i.stencilBuffer,r),a=i.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,c=V(i);Q(i)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,c,o,i.width,i.height):n?t.renderbufferStorageMultisample(t.RENDERBUFFER,c,o,i.width,i.height):t.renderbufferStorage(t.RENDERBUFFER,o,i.width,i.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,a,t.RENDERBUFFER,e)}else{const e=i.textures;for(let s=0;s<e.length;s++){const r=e[s],a=o.convert(r.format,r.colorSpace),c=o.convert(r.type),h=b(r.internalFormat,a,c,r.colorSpace),u=V(i);n&&!1===Q(i)?t.renderbufferStorageMultisample(t.RENDERBUFFER,u,h,i.width,i.height):Q(i)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,u,h,i.width,i.height):t.renderbufferStorage(t.RENDERBUFFER,h,i.width,i.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function k(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(t.FRAMEBUFFER,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const o=s.get(r.depthTexture);o.__renderTarget=r,o.__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),I(r.depthTexture,0);const a=o.__webglTexture,c=V(r);if(r.depthTexture.format===n.zdS)Q(r)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,a,0,c):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,a,0);else{if(r.depthTexture.format!==n.dcC)throw new Error("Unknown depthTexture format");Q(r)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,a,0,c):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,a,0)}}function U(e){const n=s.get(e),r=!0===e.isWebGLCubeRenderTarget;if(n.__boundDepthTexture!==e.depthTexture){const t=e.depthTexture;if(n.__depthDisposeCallback&&n.__depthDisposeCallback(),t){const e=()=>{delete n.__boundDepthTexture,delete n.__depthDisposeCallback,t.removeEventListener("dispose",e)};t.addEventListener("dispose",e),n.__depthDisposeCallback=e}n.__boundDepthTexture=t}if(e.depthTexture&&!n.__autoAllocateDepthBuffer){if(r)throw new Error("target.depthTexture not supported in Cube render targets");const t=e.texture.mipmaps;t&&t.length>0?k(n.__webglFramebuffer[0],e):k(n.__webglFramebuffer,e)}else if(r){n.__webglDepthbuffer=[];for(let s=0;s<6;s++)if(i.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer[s]),void 0===n.__webglDepthbuffer[s])n.__webglDepthbuffer[s]=t.createRenderbuffer(),O(n.__webglDepthbuffer[s],e,!1);else{const i=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,r=n.__webglDepthbuffer[s];t.bindRenderbuffer(t.RENDERBUFFER,r),t.framebufferRenderbuffer(t.FRAMEBUFFER,i,t.RENDERBUFFER,r)}}else{const s=e.texture.mipmaps;if(s&&s.length>0?i.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer[0]):i.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer),void 0===n.__webglDepthbuffer)n.__webglDepthbuffer=t.createRenderbuffer(),O(n.__webglDepthbuffer,e,!1);else{const i=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,s=n.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,s),t.framebufferRenderbuffer(t.FRAMEBUFFER,i,t.RENDERBUFFER,s)}}i.bindFramebuffer(t.FRAMEBUFFER,null)}const F=[],z=[];function V(t){return Math.min(r.maxSamples,t.samples)}function Q(t){const i=s.get(t);return t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==i.__useRenderToTexture}function j(t,e){const i=t.colorSpace,s=t.format,r=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||i!==n.Zr2&&i!==n.jf0&&(n.ppV.getTransfer(i)===n.KLL?s===n.GWd&&r===n.OUM||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",i)),e}function G(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?(h.width=t.naturalWidth||t.width,h.height=t.naturalHeight||t.height):"undefined"!=typeof VideoFrame&&t instanceof VideoFrame?(h.width=t.displayWidth,h.height=t.displayHeight):(h.width=t.width,h.height=t.height),h}this.allocateTextureUnit=function(){const t=S;return t>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+r.maxTextures),S+=1,t},this.resetTextureUnits=function(){S=0},this.setTexture2D=I,this.setTexture2DArray=function(e,n){const r=s.get(e);e.version>0&&r.__version!==e.version?D(r,e,n):i.bindTexture(t.TEXTURE_2D_ARRAY,r.__webglTexture,t.TEXTURE0+n)},this.setTexture3D=function(e,n){const r=s.get(e);e.version>0&&r.__version!==e.version?D(r,e,n):i.bindTexture(t.TEXTURE_3D,r.__webglTexture,t.TEXTURE0+n)},this.setTextureCube=function(e,a){const l=s.get(e);e.version>0&&l.__version!==e.version?function(e,a,l){if(6!==a.image.length)return;const c=P(e,a),h=a.source;i.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture,t.TEXTURE0+l);const u=s.get(h);if(h.version!==u.__version||!0===c){i.activeTexture(t.TEXTURE0+l);const e=n.ppV.getPrimaries(n.ppV.workingColorSpace),s=a.colorSpace===n.jf0?null:n.ppV.getPrimaries(a.colorSpace),d=a.colorSpace===n.jf0||e===s?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);const p=a.isCompressedTexture||a.image[0].isCompressedTexture,f=a.image[0]&&a.image[0].isDataTexture,g=[];for(let t=0;t<6;t++)g[t]=p||f?f?a.image[t].image:a.image[t]:m(a.image[t],!0,r.maxCubemapSize),g[t]=j(a,g[t]);const y=g[0],_=o.convert(a.format,a.colorSpace),w=o.convert(a.type),E=b(a.internalFormat,_,w,a.colorSpace),C=!0!==a.isVideoTexture,S=void 0===u.__version||!0===c,I=h.dataReady;let M,T=x(a,y);if(R(t.TEXTURE_CUBE_MAP,a),p){C&&S&&i.texStorage2D(t.TEXTURE_CUBE_MAP,T,E,y.width,y.height);for(let e=0;e<6;e++){M=g[e].mipmaps;for(let s=0;s<M.length;s++){const r=M[s];a.format!==n.GWd?null!==_?C?I&&i.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,s,0,0,r.width,r.height,_,r.data):i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,s,E,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):C?I&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,s,0,0,r.width,r.height,_,w,r.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,s,E,r.width,r.height,0,_,w,r.data)}}}else{if(M=a.mipmaps,C&&S){M.length>0&&T++;const e=G(g[0]);i.texStorage2D(t.TEXTURE_CUBE_MAP,T,E,e.width,e.height)}for(let e=0;e<6;e++)if(f){C?I&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,g[e].width,g[e].height,_,w,g[e].data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,E,g[e].width,g[e].height,0,_,w,g[e].data);for(let n=0;n<M.length;n++){const s=M[n].image[e].image;C?I&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,0,0,s.width,s.height,_,w,s.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,E,s.width,s.height,0,_,w,s.data)}}else{C?I&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,_,w,g[e]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,E,_,w,g[e]);for(let n=0;n<M.length;n++){const s=M[n];C?I&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,0,0,_,w,s.image[e]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,E,_,w,s.image[e])}}}A(a)&&v(t.TEXTURE_CUBE_MAP),u.__version=h.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}(l,e,a):i.bindTexture(t.TEXTURE_CUBE_MAP,l.__webglTexture,t.TEXTURE0+a)},this.rebindTextures=function(e,i,n){const r=s.get(e);void 0!==i&&N(r.__webglFramebuffer,e,e.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),void 0!==n&&U(e)},this.setupRenderTarget=function(e){const n=e.texture,r=s.get(e),l=s.get(n);e.addEventListener("dispose",E);const c=e.textures,h=!0===e.isWebGLCubeRenderTarget,u=c.length>1;if(u||(void 0===l.__webglTexture&&(l.__webglTexture=t.createTexture()),l.__version=n.version,a.memory.textures++),h){r.__webglFramebuffer=[];for(let e=0;e<6;e++)if(n.mipmaps&&n.mipmaps.length>0){r.__webglFramebuffer[e]=[];for(let i=0;i<n.mipmaps.length;i++)r.__webglFramebuffer[e][i]=t.createFramebuffer()}else r.__webglFramebuffer[e]=t.createFramebuffer()}else{if(n.mipmaps&&n.mipmaps.length>0){r.__webglFramebuffer=[];for(let e=0;e<n.mipmaps.length;e++)r.__webglFramebuffer[e]=t.createFramebuffer()}else r.__webglFramebuffer=t.createFramebuffer();if(u)for(let e=0,i=c.length;e<i;e++){const i=s.get(c[e]);void 0===i.__webglTexture&&(i.__webglTexture=t.createTexture(),a.memory.textures++)}if(e.samples>0&&!1===Q(e)){r.__webglMultisampledFramebuffer=t.createFramebuffer(),r.__webglColorRenderbuffer=[],i.bindFramebuffer(t.FRAMEBUFFER,r.__webglMultisampledFramebuffer);for(let i=0;i<c.length;i++){const n=c[i];r.__webglColorRenderbuffer[i]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.__webglColorRenderbuffer[i]);const s=o.convert(n.format,n.colorSpace),a=o.convert(n.type),l=b(n.internalFormat,s,a,n.colorSpace,!0===e.isXRRenderTarget),h=V(e);t.renderbufferStorageMultisample(t.RENDERBUFFER,h,l,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+i,t.RENDERBUFFER,r.__webglColorRenderbuffer[i])}t.bindRenderbuffer(t.RENDERBUFFER,null),e.depthBuffer&&(r.__webglDepthRenderbuffer=t.createRenderbuffer(),O(r.__webglDepthRenderbuffer,e,!0)),i.bindFramebuffer(t.FRAMEBUFFER,null)}}if(h){i.bindTexture(t.TEXTURE_CUBE_MAP,l.__webglTexture),R(t.TEXTURE_CUBE_MAP,n);for(let i=0;i<6;i++)if(n.mipmaps&&n.mipmaps.length>0)for(let s=0;s<n.mipmaps.length;s++)N(r.__webglFramebuffer[i][s],e,n,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+i,s);else N(r.__webglFramebuffer[i],e,n,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0);A(n)&&v(t.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(u){for(let n=0,o=c.length;n<o;n++){const o=c[n],a=s.get(o);i.bindTexture(t.TEXTURE_2D,a.__webglTexture),R(t.TEXTURE_2D,o),N(r.__webglFramebuffer,e,o,t.COLOR_ATTACHMENT0+n,t.TEXTURE_2D,0),A(o)&&v(t.TEXTURE_2D)}i.unbindTexture()}else{let s=t.TEXTURE_2D;if((e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(s=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),i.bindTexture(s,l.__webglTexture),R(s,n),n.mipmaps&&n.mipmaps.length>0)for(let i=0;i<n.mipmaps.length;i++)N(r.__webglFramebuffer[i],e,n,t.COLOR_ATTACHMENT0,s,i);else N(r.__webglFramebuffer,e,n,t.COLOR_ATTACHMENT0,s,0);A(n)&&v(s),i.unbindTexture()}e.depthBuffer&&U(e)},this.updateRenderTargetMipmap=function(t){const e=t.textures;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(A(r)){const e=y(t),n=s.get(r).__webglTexture;i.bindTexture(e,n),v(e),i.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(e.samples>0)if(!1===Q(e)){const n=e.textures,r=e.width,o=e.height;let a=t.COLOR_BUFFER_BIT;const l=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,h=s.get(e),u=n.length>1;if(u)for(let e=0;e<n.length;e++)i.bindFramebuffer(t.FRAMEBUFFER,h.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),i.bindFramebuffer(t.FRAMEBUFFER,h.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);i.bindFramebuffer(t.READ_FRAMEBUFFER,h.__webglMultisampledFramebuffer);const d=e.texture.mipmaps;d&&d.length>0?i.bindFramebuffer(t.DRAW_FRAMEBUFFER,h.__webglFramebuffer[0]):i.bindFramebuffer(t.DRAW_FRAMEBUFFER,h.__webglFramebuffer);for(let i=0;i<n.length;i++){if(e.resolveDepthBuffer&&(e.depthBuffer&&(a|=t.DEPTH_BUFFER_BIT),e.stencilBuffer&&e.resolveStencilBuffer&&(a|=t.STENCIL_BUFFER_BIT)),u){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,h.__webglColorRenderbuffer[i]);const e=s.get(n[i]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}t.blitFramebuffer(0,0,r,o,0,0,r,o,a,t.NEAREST),!0===c&&(F.length=0,z.length=0,F.push(t.COLOR_ATTACHMENT0+i),e.depthBuffer&&!1===e.resolveDepthBuffer&&(F.push(l),z.push(l),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,z)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,F))}if(i.bindFramebuffer(t.READ_FRAMEBUFFER,null),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),u)for(let e=0;e<n.length;e++){i.bindFramebuffer(t.FRAMEBUFFER,h.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,h.__webglColorRenderbuffer[e]);const r=s.get(n[e]).__webglTexture;i.bindFramebuffer(t.FRAMEBUFFER,h.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,r,0)}i.bindFramebuffer(t.DRAW_FRAMEBUFFER,h.__webglMultisampledFramebuffer)}else if(e.depthBuffer&&!1===e.resolveDepthBuffer&&c){const i=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[i])}},this.setupDepthRenderbuffer=U,this.setupFrameBufferTexture=N,this.useMultisampledRTT=Q}function Le(t,e){return{convert:function(i,s=n.jf0){let r;const o=n.ppV.getTransfer(s);if(i===n.OUM)return t.UNSIGNED_BYTE;if(i===n.Wew)return t.UNSIGNED_SHORT_4_4_4_4;if(i===n.gJ2)return t.UNSIGNED_SHORT_5_5_5_1;if(i===n.Dmk)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===n.tJf)return t.BYTE;if(i===n.fBL)return t.SHORT;if(i===n.cHt)return t.UNSIGNED_SHORT;if(i===n.Yuy)return t.INT;if(i===n.bkx)return t.UNSIGNED_INT;if(i===n.RQf)return t.FLOAT;if(i===n.ix0)return t.HALF_FLOAT;if(i===n.wrO)return t.ALPHA;if(i===n.HIg)return t.RGB;if(i===n.GWd)return t.RGBA;if(i===n.zdS)return t.DEPTH_COMPONENT;if(i===n.dcC)return t.DEPTH_STENCIL;if(i===n.VT0)return t.RED;if(i===n.ZQM)return t.RED_INTEGER;if(i===n.paN)return t.RG;if(i===n.TkQ)return t.RG_INTEGER;if(i===n.c90)return t.RGBA_INTEGER;if(i===n.IE4||i===n.Nz6||i===n.jR7||i===n.BXX)if(o===n.KLL){if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(i===n.IE4)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===n.Nz6)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===n.jR7)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===n.BXX)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=e.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(i===n.IE4)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===n.Nz6)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===n.jR7)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===n.BXX)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(i===n.k6Q||i===n.kTp||i===n.HXV||i===n.pBf){if(r=e.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(i===n.k6Q)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===n.kTp)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===n.HXV)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===n.pBf)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===n.CVz||i===n.Riy||i===n.KDk){if(r=e.get("WEBGL_compressed_texture_etc"),null===r)return null;if(i===n.CVz||i===n.Riy)return o===n.KLL?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(i===n.KDk)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(i===n.qa3||i===n.B_h||i===n.czI||i===n.rSH||i===n.Qrf||i===n.psI||i===n.a5J||i===n._QJ||i===n.uB5||i===n.lyL||i===n.bC7||i===n.y3Z||i===n.ojs||i===n.S$4){if(r=e.get("WEBGL_compressed_texture_astc"),null===r)return null;if(i===n.qa3)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===n.B_h)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===n.czI)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===n.rSH)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===n.Qrf)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===n.psI)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===n.a5J)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===n._QJ)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===n.uB5)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===n.lyL)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===n.bC7)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===n.y3Z)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===n.ojs)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===n.S$4)return o===n.KLL?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===n.Fn||i===n.H23||i===n.W9U){if(r=e.get("EXT_texture_compression_bptc"),null===r)return null;if(i===n.Fn)return o===n.KLL?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===n.H23)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===n.W9U)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(i===n.Kef||i===n.XG_||i===n.HO_||i===n.CWW){if(r=e.get("EXT_texture_compression_rgtc"),null===r)return null;if(i===n.Fn)return r.COMPRESSED_RED_RGTC1_EXT;if(i===n.XG_)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===n.HO_)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===n.CWW)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===n.V3x?t.UNSIGNED_INT_24_8:void 0!==t[i]?t[i]:null}}}class De{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(t,e,i){if(null===this.texture){const s=new n.gPd;t.properties.get(s).__webglTexture=e.texture,e.depthNear===i.depthNear&&e.depthFar===i.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=s}}getMesh(t){if(null!==this.texture&&null===this.mesh){const e=t.cameras[0].viewport,i=new n.BKk({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:e.z},depthHeight:{value:e.w}}});this.mesh=new n.eaF(new n.bdM(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Ne extends n.Qev{constructor(t,e){super();const i=this;let r=null,o=1,a=null,l="local-floor",c=1,h=null,u=null,d=null,p=null,f=null,g=null;const m=new De,A=e.getContextAttributes();let v=null,y=null;const b=[],_=[],x=new n.I9Y;let w=null;const E=new n.ubm;E.viewport=new n.IUQ;const C=new n.ubm;C.viewport=new n.IUQ;const S=[E,C],I=new n.nZQ;let M=null,T=null;function B(t){const e=_.indexOf(t.inputSource);if(-1===e)return;const i=b[e];void 0!==i&&(i.update(t.inputSource,t.frame,h||a),i.dispatchEvent({type:t.type,data:t.inputSource}))}function R(){r.removeEventListener("select",B),r.removeEventListener("selectstart",B),r.removeEventListener("selectend",B),r.removeEventListener("squeeze",B),r.removeEventListener("squeezestart",B),r.removeEventListener("squeezeend",B),r.removeEventListener("end",R),r.removeEventListener("inputsourceschange",P);for(let t=0;t<b.length;t++){const e=_[t];null!==e&&(_[t]=null,b[t].disconnect(e))}M=null,T=null,m.reset(),t.setRenderTarget(v),f=null,p=null,d=null,r=null,y=null,k.stop(),i.isPresenting=!1,t.setPixelRatio(w),t.setSize(x.width,x.height,!1),i.dispatchEvent({type:"sessionend"})}function P(t){for(let e=0;e<t.removed.length;e++){const i=t.removed[e],n=_.indexOf(i);n>=0&&(_[n]=null,b[n].disconnect(i))}for(let e=0;e<t.added.length;e++){const i=t.added[e];let n=_.indexOf(i);if(-1===n){for(let t=0;t<b.length;t++){if(t>=_.length){_.push(i),n=t;break}if(null===_[t]){_[t]=i,n=t;break}}if(-1===n)break}const s=b[n];s&&s.connect(i)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=b[t];return void 0===e&&(e=new n.R3r,b[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=b[t];return void 0===e&&(e=new n.R3r,b[t]=e),e.getGripSpace()},this.getHand=function(t){let e=b[t];return void 0===e&&(e=new n.R3r,b[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){o=t,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){l=t,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||a},this.setReferenceSpace=function(t){h=t},this.getBaseLayer=function(){return null!==p?p:f},this.getBinding=function(){return d},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=async function(s){if(r=s,null!==r){v=t.getRenderTarget(),r.addEventListener("select",B),r.addEventListener("selectstart",B),r.addEventListener("selectend",B),r.addEventListener("squeeze",B),r.addEventListener("squeezestart",B),r.addEventListener("squeezeend",B),r.addEventListener("end",R),r.addEventListener("inputsourceschange",P),!0!==A.xrCompatible&&await e.makeXRCompatible(),w=t.getPixelRatio(),t.getSize(x);if("undefined"!=typeof XRWebGLBinding&&"createProjectionLayer"in XRWebGLBinding.prototype){let i=null,s=null,a=null;A.depth&&(a=A.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,i=A.stencil?n.dcC:n.zdS,s=A.stencil?n.V3x:n.bkx);const l={colorFormat:e.RGBA8,depthFormat:a,scaleFactor:o};d=new XRWebGLBinding(r,e),p=d.createProjectionLayer(l),r.updateRenderState({layers:[p]}),t.setPixelRatio(1),t.setSize(p.textureWidth,p.textureHeight,!1),y=new n.nWS(p.textureWidth,p.textureHeight,{format:n.GWd,type:n.OUM,depthTexture:new n.VCu(p.textureWidth,p.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,i),stencilBuffer:A.stencil,colorSpace:t.outputColorSpace,samples:A.antialias?4:0,resolveDepthBuffer:!1===p.ignoreDepthValues,resolveStencilBuffer:!1===p.ignoreDepthValues})}else{const i={antialias:A.antialias,alpha:!0,depth:A.depth,stencil:A.stencil,framebufferScaleFactor:o};f=new XRWebGLLayer(r,e,i),r.updateRenderState({baseLayer:f}),t.setPixelRatio(1),t.setSize(f.framebufferWidth,f.framebufferHeight,!1),y=new n.nWS(f.framebufferWidth,f.framebufferHeight,{format:n.GWd,type:n.OUM,colorSpace:t.outputColorSpace,stencilBuffer:A.stencil,resolveDepthBuffer:!1===f.ignoreDepthValues,resolveStencilBuffer:!1===f.ignoreDepthValues})}y.isXRRenderTarget=!0,this.setFoveation(c),h=null,a=await r.requestReferenceSpace(l),k.setContext(r),k.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};const L=new n.Pq0,D=new n.Pq0;function N(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===r)return;let e=t.near,i=t.far;null!==m.texture&&(m.depthNear>0&&(e=m.depthNear),m.depthFar>0&&(i=m.depthFar)),I.near=C.near=E.near=e,I.far=C.far=E.far=i,M===I.near&&T===I.far||(r.updateRenderState({depthNear:I.near,depthFar:I.far}),M=I.near,T=I.far),E.layers.mask=2|t.layers.mask,C.layers.mask=4|t.layers.mask,I.layers.mask=E.layers.mask|C.layers.mask;const s=t.parent,o=I.cameras;N(I,s);for(let t=0;t<o.length;t++)N(o[t],s);2===o.length?function(t,e,i){L.setFromMatrixPosition(e.matrixWorld),D.setFromMatrixPosition(i.matrixWorld);const n=L.distanceTo(D),s=e.projectionMatrix.elements,r=i.projectionMatrix.elements,o=s[14]/(s[10]-1),a=s[14]/(s[10]+1),l=(s[9]+1)/s[5],c=(s[9]-1)/s[5],h=(s[8]-1)/s[0],u=(r[8]+1)/r[0],d=o*h,p=o*u,f=n/(-h+u),g=f*-h;if(e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(g),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert(),-1===s[10])t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const e=o+f,i=a+f,s=d-g,r=p+(n-g),h=l*a/i*e,u=c*a/i*e;t.projectionMatrix.makePerspective(s,r,h,u,e,i),t.projectionMatrixInverse.copy(t.projectionMatrix).invert()}}(I,E,C):I.projectionMatrix.copy(E.projectionMatrix),function(t,e,i){null===i?t.matrix.copy(e.matrixWorld):(t.matrix.copy(i.matrixWorld),t.matrix.invert(),t.matrix.multiply(e.matrixWorld));t.matrix.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(!0),t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse),t.isPerspectiveCamera&&(t.fov=2*n.a55*Math.atan(1/t.projectionMatrix.elements[5]),t.zoom=1)}(t,I,s)},this.getCamera=function(){return I},this.getFoveation=function(){if(null!==p||null!==f)return c},this.setFoveation=function(t){c=t,null!==p&&(p.fixedFoveation=t),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=t)},this.hasDepthSensing=function(){return null!==m.texture},this.getDepthSensingMesh=function(){return m.getMesh(I)};let O=null;const k=new s;k.setAnimationLoop(function(e,s){if(u=s.getViewerPose(h||a),g=s,null!==u){const e=u.views;null!==f&&(t.setRenderTargetFramebuffer(y,f.framebuffer),t.setRenderTarget(y));let i=!1;e.length!==I.cameras.length&&(I.cameras.length=0,i=!0);for(let s=0;s<e.length;s++){const r=e[s];let o=null;if(null!==f)o=f.getViewport(r);else{const e=d.getViewSubImage(p,r);o=e.viewport,0===s&&(t.setRenderTargetTextures(y,e.colorTexture,e.depthStencilTexture),t.setRenderTarget(y))}let a=S[s];void 0===a&&(a=new n.ubm,a.layers.enable(s),a.viewport=new n.IUQ,S[s]=a),a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(r.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(o.x,o.y,o.width,o.height),0===s&&(I.matrix.copy(a.matrix),I.matrix.decompose(I.position,I.quaternion,I.scale)),!0===i&&I.cameras.push(a)}const s=r.enabledFeatures;if(s&&s.includes("depth-sensing")&&"gpu-optimized"==r.depthUsage&&d){const i=d.getDepthInformation(e[0]);i&&i.isValid&&i.texture&&m.init(t,i,r.renderState)}}for(let t=0;t<b.length;t++){const e=_[t],i=b[t];null!==e&&void 0!==i&&i.update(e,s,h||a)}O&&O(e,s),s.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:s}),g=null}),this.setAnimationLoop=function(t){O=t},this.dispose=function(){}}}const Oe=new n.O9p,ke=new n.kn4;function Ue(t,e){function i(t,e){!0===t.matrixAutoUpdate&&t.updateMatrix(),e.value.copy(t.matrix)}function s(t,s){t.opacity.value=s.opacity,s.color&&t.diffuse.value.copy(s.color),s.emissive&&t.emissive.value.copy(s.emissive).multiplyScalar(s.emissiveIntensity),s.map&&(t.map.value=s.map,i(s.map,t.mapTransform)),s.alphaMap&&(t.alphaMap.value=s.alphaMap,i(s.alphaMap,t.alphaMapTransform)),s.bumpMap&&(t.bumpMap.value=s.bumpMap,i(s.bumpMap,t.bumpMapTransform),t.bumpScale.value=s.bumpScale,s.side===n.hsX&&(t.bumpScale.value*=-1)),s.normalMap&&(t.normalMap.value=s.normalMap,i(s.normalMap,t.normalMapTransform),t.normalScale.value.copy(s.normalScale),s.side===n.hsX&&t.normalScale.value.negate()),s.displacementMap&&(t.displacementMap.value=s.displacementMap,i(s.displacementMap,t.displacementMapTransform),t.displacementScale.value=s.displacementScale,t.displacementBias.value=s.displacementBias),s.emissiveMap&&(t.emissiveMap.value=s.emissiveMap,i(s.emissiveMap,t.emissiveMapTransform)),s.specularMap&&(t.specularMap.value=s.specularMap,i(s.specularMap,t.specularMapTransform)),s.alphaTest>0&&(t.alphaTest.value=s.alphaTest);const r=e.get(s),o=r.envMap,a=r.envMapRotation;o&&(t.envMap.value=o,Oe.copy(a),Oe.x*=-1,Oe.y*=-1,Oe.z*=-1,o.isCubeTexture&&!1===o.isRenderTargetTexture&&(Oe.y*=-1,Oe.z*=-1),t.envMapRotation.value.setFromMatrix4(ke.makeRotationFromEuler(Oe)),t.flipEnvMap.value=o.isCubeTexture&&!1===o.isRenderTargetTexture?-1:1,t.reflectivity.value=s.reflectivity,t.ior.value=s.ior,t.refractionRatio.value=s.refractionRatio),s.lightMap&&(t.lightMap.value=s.lightMap,t.lightMapIntensity.value=s.lightMapIntensity,i(s.lightMap,t.lightMapTransform)),s.aoMap&&(t.aoMap.value=s.aoMap,t.aoMapIntensity.value=s.aoMapIntensity,i(s.aoMap,t.aoMapTransform))}return{refreshFogUniforms:function(e,i){i.color.getRGB(e.fogColor.value,(0,n._Ut)(t)),i.isFog?(e.fogNear.value=i.near,e.fogFar.value=i.far):i.isFogExp2&&(e.fogDensity.value=i.density)},refreshMaterialUniforms:function(t,r,o,a,l){r.isMeshBasicMaterial||r.isMeshLambertMaterial?s(t,r):r.isMeshToonMaterial?(s(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,r)):r.isMeshPhongMaterial?(s(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,r)):r.isMeshStandardMaterial?(s(t,r),function(t,e){t.metalness.value=e.metalness,e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap,i(e.metalnessMap,t.metalnessMapTransform));t.roughness.value=e.roughness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap,i(e.roughnessMap,t.roughnessMapTransform));e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}(t,r),r.isMeshPhysicalMaterial&&function(t,e,s){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap,i(e.sheenColorMap,t.sheenColorMapTransform)),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap,i(e.sheenRoughnessMap,t.sheenRoughnessMapTransform)));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap,i(e.clearcoatMap,t.clearcoatMapTransform)),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap,i(e.clearcoatRoughnessMap,t.clearcoatRoughnessMapTransform)),e.clearcoatNormalMap&&(t.clearcoatNormalMap.value=e.clearcoatNormalMap,i(e.clearcoatNormalMap,t.clearcoatNormalMapTransform),t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),e.side===n.hsX&&t.clearcoatNormalScale.value.negate()));e.dispersion>0&&(t.dispersion.value=e.dispersion);e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap,i(e.iridescenceMap,t.iridescenceMapTransform)),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap,i(e.iridescenceThicknessMap,t.iridescenceThicknessMapTransform)));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=s.texture,t.transmissionSamplerSize.value.set(s.width,s.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap,i(e.transmissionMap,t.transmissionMapTransform)),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap,i(e.thicknessMap,t.thicknessMapTransform)),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));e.anisotropy>0&&(t.anisotropyVector.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation)),e.anisotropyMap&&(t.anisotropyMap.value=e.anisotropyMap,i(e.anisotropyMap,t.anisotropyMapTransform)));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap,i(e.specularColorMap,t.specularColorMapTransform));e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap,i(e.specularIntensityMap,t.specularIntensityMapTransform))}(t,r,l)):r.isMeshMatcapMaterial?(s(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,r)):r.isMeshDepthMaterial?s(t,r):r.isMeshDistanceMaterial?(s(t,r),function(t,i){const n=e.get(i).light;t.referencePosition.value.setFromMatrixPosition(n.matrixWorld),t.nearDistance.value=n.shadow.camera.near,t.farDistance.value=n.shadow.camera.far}(t,r)):r.isMeshNormalMaterial?s(t,r):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,e.map&&(t.map.value=e.map,i(e.map,t.mapTransform))}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,n,s){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*s,e.map&&(t.map.value=e.map,i(e.map,t.uvTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,i(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,r,o,a):r.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map,i(e.map,t.mapTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,i(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Fe(t,e,i,n){let s={},r={},o=[];const a=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(t,e,i,n){const s=t.value,r=e+"_"+i;if(void 0===n[r])return n[r]="number"==typeof s||"boolean"==typeof s?s:s.clone(),!0;{const t=n[r];if("number"==typeof s||"boolean"==typeof s){if(t!==s)return n[r]=s,!0}else if(!1===t.equals(s))return t.copy(s),!0}return!1}function c(t){const e={boundary:0,storage:0};return"number"==typeof t||"boolean"==typeof t?(e.boundary=4,e.storage=4):t.isVector2?(e.boundary=8,e.storage=8):t.isVector3||t.isColor?(e.boundary=16,e.storage=12):t.isVector4?(e.boundary=16,e.storage=16):t.isMatrix3?(e.boundary=48,e.storage=48):t.isMatrix4?(e.boundary=64,e.storage=64):t.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",t),e}function h(e){const i=e.target;i.removeEventListener("dispose",h);const n=o.indexOf(i.__bindingPointIndex);o.splice(n,1),t.deleteBuffer(s[i.id]),delete s[i.id],delete r[i.id]}return{bind:function(t,e){const i=e.program;n.uniformBlockBinding(t,i)},update:function(i,u){let d=s[i.id];void 0===d&&(!function(t){const e=t.uniforms;let i=0;const n=16;for(let t=0,s=e.length;t<s;t++){const s=Array.isArray(e[t])?e[t]:[e[t]];for(let t=0,e=s.length;t<e;t++){const e=s[t],r=Array.isArray(e.value)?e.value:[e.value];for(let t=0,s=r.length;t<s;t++){const s=c(r[t]),o=i%n,a=o%s.boundary,l=o+a;i+=a,0!==l&&n-l<s.storage&&(i+=n-l),e.__data=new Float32Array(s.storage/Float32Array.BYTES_PER_ELEMENT),e.__offset=i,i+=s.storage}}}const s=i%n;s>0&&(i+=n-s);t.__size=i,t.__cache={}}(i),d=function(e){const i=function(){for(let t=0;t<a;t++)if(-1===o.indexOf(t))return o.push(t),t;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();e.__bindingPointIndex=i;const n=t.createBuffer(),s=e.__size,r=e.usage;return t.bindBuffer(t.UNIFORM_BUFFER,n),t.bufferData(t.UNIFORM_BUFFER,s,r),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,i,n),n}(i),s[i.id]=d,i.addEventListener("dispose",h));const p=u.program;n.updateUBOMapping(i,p);const f=e.render.frame;r[i.id]!==f&&(!function(e){const i=s[e.id],n=e.uniforms,r=e.__cache;t.bindBuffer(t.UNIFORM_BUFFER,i);for(let e=0,i=n.length;e<i;e++){const i=Array.isArray(n[e])?n[e]:[n[e]];for(let n=0,s=i.length;n<s;n++){const s=i[n];if(!0===l(s,e,n,r)){const e=s.__offset,i=Array.isArray(s.value)?s.value:[s.value];let n=0;for(let r=0;r<i.length;r++){const o=i[r],a=c(o);"number"==typeof o||"boolean"==typeof o?(s.__data[0]=o,t.bufferSubData(t.UNIFORM_BUFFER,e+n,s.__data)):o.isMatrix3?(s.__data[0]=o.elements[0],s.__data[1]=o.elements[1],s.__data[2]=o.elements[2],s.__data[3]=0,s.__data[4]=o.elements[3],s.__data[5]=o.elements[4],s.__data[6]=o.elements[5],s.__data[7]=0,s.__data[8]=o.elements[6],s.__data[9]=o.elements[7],s.__data[10]=o.elements[8],s.__data[11]=0):(o.toArray(s.__data,n),n+=a.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,e,s.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}(i),r[i.id]=f)},dispose:function(){for(const e in s)t.deleteBuffer(s[e]);o=[],s={},r={}}}}class ze{constructor(t={}){const{canvas:e=(0,n.lPF)(),context:i=null,depth:o=!0,stencil:a=!1,alpha:l=!1,antialias:c=!1,premultipliedAlpha:h=!0,preserveDrawingBuffer:u=!1,powerPreference:v="default",failIfMajorPerformanceCaveat:y=!1,reverseDepthBuffer:b=!1}=t;let _;if(this.isWebGLRenderer=!0,null!==i){if("undefined"!=typeof WebGLRenderingContext&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");_=i.getContextAttributes().alpha}else _=l;const x=new Uint32Array(4),w=new Int32Array(4);let E=null,C=null;const S=[],I=[];this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=n.y_p,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const M=this;let T=!1;this._outputColorSpace=n.er$;let B=0,R=0,P=null,L=-1,D=null;const N=new n.IUQ,j=new n.IUQ;let G=null;const H=new n.Q1f(0);let q=0,$=e.width,W=e.height,K=1,X=null,Y=null;const J=new n.IUQ(0,0,$,W),Z=new n.IUQ(0,0,$,W);let tt=!1;const et=new n.PPD;let it=!1,nt=!1;const st=new n.kn4,rt=new n.kn4,ot=new n.Pq0,at=new n.IUQ,lt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ct=!1;function ht(){return null===P?K:1}let ut,dt,pt,ft,gt,mt,At,vt,yt,bt,_t,xt,wt,Et,Ct,St,It,Mt,Tt,Bt,Rt,Pt,Lt,Dt,Nt=i;function Ot(t,i){return e.getContext(t,i)}try{const t={alpha:!0,depth:o,stencil:a,antialias:c,premultipliedAlpha:h,preserveDrawingBuffer:u,powerPreference:v,failIfMajorPerformanceCaveat:y};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${n.sPf}`),e.addEventListener("webglcontextlost",Ft,!1),e.addEventListener("webglcontextrestored",zt,!1),e.addEventListener("webglcontextcreationerror",Vt,!1),null===Nt){const e="webgl2";if(Nt=Ot(e,t),null===Nt)throw Ot(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function kt(){ut=new k(Nt),ut.init(),Pt=new Le(Nt,ut),dt=new g(Nt,ut,t,Pt),pt=new Re(Nt,ut),dt.reverseDepthBuffer&&b&&pt.buffers.depth.setReversed(!0),ft=new z(Nt),gt=new ve,mt=new Pe(Nt,ut,pt,gt,dt,Pt,ft),At=new A(M),vt=new O(M),yt=new r(Nt),Lt=new p(Nt,yt),bt=new U(Nt,yt,ft,Lt),_t=new Q(Nt,bt,yt,ft),Tt=new V(Nt,dt,mt),St=new m(gt),xt=new Ae(M,At,vt,ut,dt,Lt,St),wt=new Ue(M,gt),Et=new xe,Ct=new Me(ut),Mt=new d(M,At,vt,pt,_t,_,h),It=new Te(M,_t,dt),Dt=new Fe(Nt,ft,dt,pt),Bt=new f(Nt,ut,ft),Rt=new F(Nt,ut,ft),ft.programs=xt.programs,M.capabilities=dt,M.extensions=ut,M.properties=gt,M.renderLists=Et,M.shadowMap=It,M.state=pt,M.info=ft}kt();const Ut=new Ne(M,Nt);function Ft(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function zt(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;const t=ft.autoReset,e=It.enabled,i=It.autoUpdate,n=It.needsUpdate,s=It.type;kt(),ft.autoReset=t,It.enabled=e,It.autoUpdate=i,It.needsUpdate=n,It.type=s}function Vt(t){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",t.statusMessage)}function Qt(t){const e=t.target;e.removeEventListener("dispose",Qt),function(t){(function(t){const e=gt.get(t).programs;void 0!==e&&(e.forEach(function(t){xt.releaseProgram(t)}),t.isShaderMaterial&&xt.releaseShaderCache(t))})(t),gt.remove(t)}(e)}function jt(t,e,i){!0===t.transparent&&t.side===n.$EB&&!1===t.forceSinglePass?(t.side=n.hsX,t.needsUpdate=!0,te(t,e,i),t.side=n.hB5,t.needsUpdate=!0,te(t,e,i),t.side=n.$EB):te(t,e,i)}this.xr=Ut,this.getContext=function(){return Nt},this.getContextAttributes=function(){return Nt.getContextAttributes()},this.forceContextLoss=function(){const t=ut.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=ut.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return K},this.setPixelRatio=function(t){void 0!==t&&(K=t,this.setSize($,W,!1))},this.getSize=function(t){return t.set($,W)},this.setSize=function(t,i,n=!0){Ut.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):($=t,W=i,e.width=Math.floor(t*K),e.height=Math.floor(i*K),!0===n&&(e.style.width=t+"px",e.style.height=i+"px"),this.setViewport(0,0,t,i))},this.getDrawingBufferSize=function(t){return t.set($*K,W*K).floor()},this.setDrawingBufferSize=function(t,i,n){$=t,W=i,K=n,e.width=Math.floor(t*n),e.height=Math.floor(i*n),this.setViewport(0,0,t,i)},this.getCurrentViewport=function(t){return t.copy(N)},this.getViewport=function(t){return t.copy(J)},this.setViewport=function(t,e,i,n){t.isVector4?J.set(t.x,t.y,t.z,t.w):J.set(t,e,i,n),pt.viewport(N.copy(J).multiplyScalar(K).round())},this.getScissor=function(t){return t.copy(Z)},this.setScissor=function(t,e,i,n){t.isVector4?Z.set(t.x,t.y,t.z,t.w):Z.set(t,e,i,n),pt.scissor(j.copy(Z).multiplyScalar(K).round())},this.getScissorTest=function(){return tt},this.setScissorTest=function(t){pt.setScissorTest(tt=t)},this.setOpaqueSort=function(t){X=t},this.setTransparentSort=function(t){Y=t},this.getClearColor=function(t){return t.copy(Mt.getClearColor())},this.setClearColor=function(){Mt.setClearColor(...arguments)},this.getClearAlpha=function(){return Mt.getClearAlpha()},this.setClearAlpha=function(){Mt.setClearAlpha(...arguments)},this.clear=function(t=!0,e=!0,i=!0){let s=0;if(t){let t=!1;if(null!==P){const e=P.texture.format;t=e===n.c90||e===n.TkQ||e===n.ZQM}if(t){const t=P.texture.type,e=t===n.OUM||t===n.bkx||t===n.cHt||t===n.V3x||t===n.Wew||t===n.gJ2,i=Mt.getClearColor(),s=Mt.getClearAlpha(),r=i.r,o=i.g,a=i.b;e?(x[0]=r,x[1]=o,x[2]=a,x[3]=s,Nt.clearBufferuiv(Nt.COLOR,0,x)):(w[0]=r,w[1]=o,w[2]=a,w[3]=s,Nt.clearBufferiv(Nt.COLOR,0,w))}else s|=Nt.COLOR_BUFFER_BIT}e&&(s|=Nt.DEPTH_BUFFER_BIT),i&&(s|=Nt.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Nt.clear(s)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Ft,!1),e.removeEventListener("webglcontextrestored",zt,!1),e.removeEventListener("webglcontextcreationerror",Vt,!1),Mt.dispose(),Et.dispose(),Ct.dispose(),gt.dispose(),At.dispose(),vt.dispose(),_t.dispose(),Lt.dispose(),Dt.dispose(),xt.dispose(),Ut.dispose(),Ut.removeEventListener("sessionstart",Ht),Ut.removeEventListener("sessionend",qt),Wt.stop()},this.renderBufferDirect=function(t,e,i,s,r,o){null===e&&(e=lt);const a=r.isMesh&&r.matrixWorld.determinant()<0,l=function(t,e,i,s,r){!0!==e.isScene&&(e=lt);mt.resetTextureUnits();const o=e.fog,a=s.isMeshStandardMaterial?e.environment:null,l=null===P?M.outputColorSpace:!0===P.isXRRenderTarget?P.texture.colorSpace:n.Zr2,c=(s.isMeshStandardMaterial?vt:At).get(s.envMap||a),h=!0===s.vertexColors&&!!i.attributes.color&&4===i.attributes.color.itemSize,u=!!i.attributes.tangent&&(!!s.normalMap||s.anisotropy>0),d=!!i.morphAttributes.position,p=!!i.morphAttributes.normal,f=!!i.morphAttributes.color;let g=n.y_p;s.toneMapped&&(null!==P&&!0!==P.isXRRenderTarget||(g=M.toneMapping));const m=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,A=void 0!==m?m.length:0,v=gt.get(s),y=C.state.lights;if(!0===it&&(!0===nt||t!==D)){const e=t===D&&s.id===L;St.setState(s,t,e)}let b=!1;s.version===v.__version?v.needsLights&&v.lightsStateVersion!==y.state.version||v.outputColorSpace!==l||r.isBatchedMesh&&!1===v.batching?b=!0:r.isBatchedMesh||!0!==v.batching?r.isBatchedMesh&&!0===v.batchingColor&&null===r.colorTexture||r.isBatchedMesh&&!1===v.batchingColor&&null!==r.colorTexture||r.isInstancedMesh&&!1===v.instancing?b=!0:r.isInstancedMesh||!0!==v.instancing?r.isSkinnedMesh&&!1===v.skinning?b=!0:r.isSkinnedMesh||!0!==v.skinning?r.isInstancedMesh&&!0===v.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===v.instancingColor&&null!==r.instanceColor||r.isInstancedMesh&&!0===v.instancingMorph&&null===r.morphTexture||r.isInstancedMesh&&!1===v.instancingMorph&&null!==r.morphTexture||v.envMap!==c||!0===s.fog&&v.fog!==o?b=!0:void 0===v.numClippingPlanes||v.numClippingPlanes===St.numPlanes&&v.numIntersection===St.numIntersection?(v.vertexAlphas!==h||v.vertexTangents!==u||v.morphTargets!==d||v.morphNormals!==p||v.morphColors!==f||v.toneMapping!==g||v.morphTargetsCount!==A)&&(b=!0):b=!0:b=!0:b=!0:b=!0:(b=!0,v.__version=s.version);let _=v.currentProgram;!0===b&&(_=te(s,e,r));let x=!1,w=!1,E=!1;const S=_.getUniforms(),I=v.uniforms;pt.useProgram(_.program)&&(x=!0,w=!0,E=!0);s.id!==L&&(L=s.id,w=!0);if(x||D!==t){pt.buffers.depth.getReversed()?(st.copy(t.projectionMatrix),(0,n.xiE)(st),(0,n.Mmk)(st),S.setValue(Nt,"projectionMatrix",st)):S.setValue(Nt,"projectionMatrix",t.projectionMatrix),S.setValue(Nt,"viewMatrix",t.matrixWorldInverse);const e=S.map.cameraPosition;void 0!==e&&e.setValue(Nt,ot.setFromMatrixPosition(t.matrixWorld)),dt.logarithmicDepthBuffer&&S.setValue(Nt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),(s.isMeshPhongMaterial||s.isMeshToonMaterial||s.isMeshLambertMaterial||s.isMeshBasicMaterial||s.isMeshStandardMaterial||s.isShaderMaterial)&&S.setValue(Nt,"isOrthographic",!0===t.isOrthographicCamera),D!==t&&(D=t,w=!0,E=!0)}if(r.isSkinnedMesh){S.setOptional(Nt,r,"bindMatrix"),S.setOptional(Nt,r,"bindMatrixInverse");const t=r.skeleton;t&&(null===t.boneTexture&&t.computeBoneTexture(),S.setValue(Nt,"boneTexture",t.boneTexture,mt))}r.isBatchedMesh&&(S.setOptional(Nt,r,"batchingTexture"),S.setValue(Nt,"batchingTexture",r._matricesTexture,mt),S.setOptional(Nt,r,"batchingIdTexture"),S.setValue(Nt,"batchingIdTexture",r._indirectTexture,mt),S.setOptional(Nt,r,"batchingColorTexture"),null!==r._colorsTexture&&S.setValue(Nt,"batchingColorTexture",r._colorsTexture,mt));const T=i.morphAttributes;void 0===T.position&&void 0===T.normal&&void 0===T.color||Tt.update(r,i,_);(w||v.receiveShadow!==r.receiveShadow)&&(v.receiveShadow=r.receiveShadow,S.setValue(Nt,"receiveShadow",r.receiveShadow));s.isMeshGouraudMaterial&&null!==s.envMap&&(I.envMap.value=c,I.flipEnvMap.value=c.isCubeTexture&&!1===c.isRenderTargetTexture?-1:1);s.isMeshStandardMaterial&&null===s.envMap&&null!==e.environment&&(I.envMapIntensity.value=e.environmentIntensity);w&&(S.setValue(Nt,"toneMappingExposure",M.toneMappingExposure),v.needsLights&&(R=E,(B=I).ambientLightColor.needsUpdate=R,B.lightProbe.needsUpdate=R,B.directionalLights.needsUpdate=R,B.directionalLightShadows.needsUpdate=R,B.pointLights.needsUpdate=R,B.pointLightShadows.needsUpdate=R,B.spotLights.needsUpdate=R,B.spotLightShadows.needsUpdate=R,B.rectAreaLights.needsUpdate=R,B.hemisphereLights.needsUpdate=R),o&&!0===s.fog&&wt.refreshFogUniforms(I,o),wt.refreshMaterialUniforms(I,s,K,W,C.state.transmissionRenderTarget[t.id]),$t.upload(Nt,ee(v),I,mt));var B,R;s.isShaderMaterial&&!0===s.uniformsNeedUpdate&&($t.upload(Nt,ee(v),I,mt),s.uniformsNeedUpdate=!1);s.isSpriteMaterial&&S.setValue(Nt,"center",r.center);if(S.setValue(Nt,"modelViewMatrix",r.modelViewMatrix),S.setValue(Nt,"normalMatrix",r.normalMatrix),S.setValue(Nt,"modelMatrix",r.matrixWorld),s.isShaderMaterial||s.isRawShaderMaterial){const t=s.uniformsGroups;for(let e=0,i=t.length;e<i;e++){const i=t[e];Dt.update(i,_),Dt.bind(i,_)}}return _}(t,e,i,s,r);pt.setMaterial(s,a);let c=i.index,h=1;if(!0===s.wireframe){if(c=bt.getWireframeAttribute(i),void 0===c)return;h=2}const u=i.drawRange,d=i.attributes.position;let p=u.start*h,f=(u.start+u.count)*h;null!==o&&(p=Math.max(p,o.start*h),f=Math.min(f,(o.start+o.count)*h)),null!==c?(p=Math.max(p,0),f=Math.min(f,c.count)):null!=d&&(p=Math.max(p,0),f=Math.min(f,d.count));const g=f-p;if(g<0||g===1/0)return;let m;Lt.setup(r,s,l,i,c);let A=Bt;if(null!==c&&(m=yt.get(c),A=Rt,A.setIndex(m)),r.isMesh)!0===s.wireframe?(pt.setLineWidth(s.wireframeLinewidth*ht()),A.setMode(Nt.LINES)):A.setMode(Nt.TRIANGLES);else if(r.isLine){let t=s.linewidth;void 0===t&&(t=1),pt.setLineWidth(t*ht()),r.isLineSegments?A.setMode(Nt.LINES):r.isLineLoop?A.setMode(Nt.LINE_LOOP):A.setMode(Nt.LINE_STRIP)}else r.isPoints?A.setMode(Nt.POINTS):r.isSprite&&A.setMode(Nt.TRIANGLES);if(r.isBatchedMesh)if(null!==r._multiDrawInstances)(0,n.mcG)("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),A.renderMultiDrawInstances(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount,r._multiDrawInstances);else if(ut.get("WEBGL_multi_draw"))A.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else{const t=r._multiDrawStarts,e=r._multiDrawCounts,i=r._multiDrawCount,n=c?yt.get(c).bytesPerElement:1,o=gt.get(s).currentProgram.getUniforms();for(let s=0;s<i;s++)o.setValue(Nt,"_gl_DrawID",s),A.render(t[s]/n,e[s])}else if(r.isInstancedMesh)A.renderInstances(p,g,r.count);else if(i.isInstancedBufferGeometry){const t=void 0!==i._maxInstanceCount?i._maxInstanceCount:1/0,e=Math.min(i.instanceCount,t);A.renderInstances(p,g,e)}else A.render(p,g)},this.compile=function(t,e,i=null){null===i&&(i=t),C=Ct.get(i),C.init(e),I.push(C),i.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(C.pushLight(t),t.castShadow&&C.pushShadow(t))}),t!==i&&t.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(C.pushLight(t),t.castShadow&&C.pushShadow(t))}),C.setupLights();const n=new Set;return t.traverse(function(t){if(!(t.isMesh||t.isPoints||t.isLine||t.isSprite))return;const e=t.material;if(e)if(Array.isArray(e))for(let s=0;s<e.length;s++){const r=e[s];jt(r,i,t),n.add(r)}else jt(e,i,t),n.add(e)}),C=I.pop(),n},this.compileAsync=function(t,e,i=null){const n=this.compile(t,e,i);return new Promise(e=>{function i(){n.forEach(function(t){gt.get(t).currentProgram.isReady()&&n.delete(t)}),0!==n.size?setTimeout(i,10):e(t)}null!==ut.get("KHR_parallel_shader_compile")?i():setTimeout(i,10)})};let Gt=null;function Ht(){Wt.stop()}function qt(){Wt.start()}const Wt=new s;function Kt(t,e,i,n){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)i=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)C.pushLight(t),t.castShadow&&C.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||et.intersectsSprite(t)){n&&at.setFromMatrixPosition(t.matrixWorld).applyMatrix4(rt);const e=_t.update(t),s=t.material;s.visible&&E.push(t,e,s,i,at.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||et.intersectsObject(t))){const e=_t.update(t),s=t.material;if(n&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),at.copy(t.boundingSphere.center)):(null===e.boundingSphere&&e.computeBoundingSphere(),at.copy(e.boundingSphere.center)),at.applyMatrix4(t.matrixWorld).applyMatrix4(rt)),Array.isArray(s)){const n=e.groups;for(let r=0,o=n.length;r<o;r++){const o=n[r],a=s[o.materialIndex];a&&a.visible&&E.push(t,e,a,i,at.z,o)}}else s.visible&&E.push(t,e,s,i,at.z,null)}const s=t.children;for(let t=0,r=s.length;t<r;t++)Kt(s[t],e,i,n)}function Xt(t,e,i,n){const s=t.opaque,r=t.transmissive,o=t.transparent;C.setupLightsView(i),!0===it&&St.setGlobalState(M.clippingPlanes,i),n&&pt.viewport(N.copy(n)),s.length>0&&Jt(s,e,i),r.length>0&&Jt(r,e,i),o.length>0&&Jt(o,e,i),pt.buffers.depth.setTest(!0),pt.buffers.depth.setMask(!0),pt.buffers.color.setMask(!0),pt.setPolygonOffset(!1)}function Yt(t,e,i,s){if(null!==(!0===i.isScene?i.overrideMaterial:null))return;void 0===C.state.transmissionRenderTarget[s.id]&&(C.state.transmissionRenderTarget[s.id]=new n.nWS(1,1,{generateMipmaps:!0,type:ut.has("EXT_color_buffer_half_float")||ut.has("EXT_color_buffer_float")?n.ix0:n.OUM,minFilter:n.$_I,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:n.ppV.workingColorSpace}));const r=C.state.transmissionRenderTarget[s.id],o=s.viewport||N;r.setSize(o.z*M.transmissionResolutionScale,o.w*M.transmissionResolutionScale);const l=M.getRenderTarget();M.setRenderTarget(r),M.getClearColor(H),q=M.getClearAlpha(),q<1&&M.setClearColor(16777215,.5),M.clear(),ct&&Mt.render(i);const c=M.toneMapping;M.toneMapping=n.y_p;const h=s.viewport;if(void 0!==s.viewport&&(s.viewport=void 0),C.setupLightsView(s),!0===it&&St.setGlobalState(M.clippingPlanes,s),Jt(t,i,s),mt.updateMultisampleRenderTarget(r),mt.updateRenderTargetMipmap(r),!1===ut.has("WEBGL_multisampled_render_to_texture")){let t=!1;for(let r=0,o=e.length;r<o;r++){const o=e[r],a=o.object,l=o.geometry,c=o.material,h=o.group;if(c.side===n.$EB&&a.layers.test(s.layers)){const e=c.side;c.side=n.hsX,c.needsUpdate=!0,Zt(a,i,s,l,c,h),c.side=e,c.needsUpdate=!0,t=!0}}!0===t&&(mt.updateMultisampleRenderTarget(r),mt.updateRenderTargetMipmap(r))}M.setRenderTarget(l),M.setClearColor(H,q),void 0!==h&&(s.viewport=h),M.toneMapping=c}function Jt(t,e,i){const n=!0===e.isScene?e.overrideMaterial:null;for(let s=0,r=t.length;s<r;s++){const r=t[s],o=r.object,a=r.geometry,l=r.group;let c=r.material;!0===c.allowOverride&&null!==n&&(c=n),o.layers.test(i.layers)&&Zt(o,e,i,a,c,l)}}function Zt(t,e,i,s,r,o){t.onBeforeRender(M,e,i,s,r,o),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),r.onBeforeRender(M,e,i,s,t,o),!0===r.transparent&&r.side===n.$EB&&!1===r.forceSinglePass?(r.side=n.hsX,r.needsUpdate=!0,M.renderBufferDirect(i,e,s,r,t,o),r.side=n.hB5,r.needsUpdate=!0,M.renderBufferDirect(i,e,s,r,t,o),r.side=n.$EB):M.renderBufferDirect(i,e,s,r,t,o),t.onAfterRender(M,e,i,s,r,o)}function te(t,e,i){!0!==e.isScene&&(e=lt);const n=gt.get(t),s=C.state.lights,r=C.state.shadowsArray,o=s.state.version,a=xt.getParameters(t,s.state,r,e,i),l=xt.getProgramCacheKey(a);let c=n.programs;n.environment=t.isMeshStandardMaterial?e.environment:null,n.fog=e.fog,n.envMap=(t.isMeshStandardMaterial?vt:At).get(t.envMap||n.environment),n.envMapRotation=null!==n.environment&&null===t.envMap?e.environmentRotation:t.envMapRotation,void 0===c&&(t.addEventListener("dispose",Qt),c=new Map,n.programs=c);let h=c.get(l);if(void 0!==h){if(n.currentProgram===h&&n.lightsStateVersion===o)return ie(t,a),h}else a.uniforms=xt.getUniforms(t),t.onBeforeCompile(a,M),h=xt.acquireProgram(a,l),c.set(l,h),n.uniforms=a.uniforms;const u=n.uniforms;return(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(u.clippingPlanes=St.uniform),ie(t,a),n.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),n.lightsStateVersion=o,n.needsLights&&(u.ambientLightColor.value=s.state.ambient,u.lightProbe.value=s.state.probe,u.directionalLights.value=s.state.directional,u.directionalLightShadows.value=s.state.directionalShadow,u.spotLights.value=s.state.spot,u.spotLightShadows.value=s.state.spotShadow,u.rectAreaLights.value=s.state.rectArea,u.ltc_1.value=s.state.rectAreaLTC1,u.ltc_2.value=s.state.rectAreaLTC2,u.pointLights.value=s.state.point,u.pointLightShadows.value=s.state.pointShadow,u.hemisphereLights.value=s.state.hemi,u.directionalShadowMap.value=s.state.directionalShadowMap,u.directionalShadowMatrix.value=s.state.directionalShadowMatrix,u.spotShadowMap.value=s.state.spotShadowMap,u.spotLightMatrix.value=s.state.spotLightMatrix,u.spotLightMap.value=s.state.spotLightMap,u.pointShadowMap.value=s.state.pointShadowMap,u.pointShadowMatrix.value=s.state.pointShadowMatrix),n.currentProgram=h,n.uniformsList=null,h}function ee(t){if(null===t.uniformsList){const e=t.currentProgram.getUniforms();t.uniformsList=$t.seqWithValue(e.seq,t.uniforms)}return t.uniformsList}function ie(t,e){const i=gt.get(t);i.outputColorSpace=e.outputColorSpace,i.batching=e.batching,i.batchingColor=e.batchingColor,i.instancing=e.instancing,i.instancingColor=e.instancingColor,i.instancingMorph=e.instancingMorph,i.skinning=e.skinning,i.morphTargets=e.morphTargets,i.morphNormals=e.morphNormals,i.morphColors=e.morphColors,i.morphTargetsCount=e.morphTargetsCount,i.numClippingPlanes=e.numClippingPlanes,i.numIntersection=e.numClipIntersection,i.vertexAlphas=e.vertexAlphas,i.vertexTangents=e.vertexTangents,i.toneMapping=e.toneMapping}Wt.setAnimationLoop(function(t){Gt&&Gt(t)}),"undefined"!=typeof self&&Wt.setContext(self),this.setAnimationLoop=function(t){Gt=t,Ut.setAnimationLoop(t),null===t?Wt.stop():Wt.start()},Ut.addEventListener("sessionstart",Ht),Ut.addEventListener("sessionend",qt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===T)return;if(!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===Ut.enabled&&!0===Ut.isPresenting&&(!0===Ut.cameraAutoUpdate&&Ut.updateCamera(e),e=Ut.getCamera()),!0===t.isScene&&t.onBeforeRender(M,t,e,P),C=Ct.get(t,I.length),C.init(e),I.push(C),rt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),et.setFromProjectionMatrix(rt),nt=this.localClippingEnabled,it=St.init(this.clippingPlanes,nt),E=Et.get(t,S.length),E.init(),S.push(E),!0===Ut.enabled&&!0===Ut.isPresenting){const t=M.xr.getDepthSensingMesh();null!==t&&Kt(t,e,-1/0,M.sortObjects)}Kt(t,e,0,M.sortObjects),E.finish(),!0===M.sortObjects&&E.sort(X,Y),ct=!1===Ut.enabled||!1===Ut.isPresenting||!1===Ut.hasDepthSensing(),ct&&Mt.addToRenderList(E,t),this.info.render.frame++,!0===it&&St.beginShadows();const i=C.state.shadowsArray;It.render(i,t,e),!0===it&&St.endShadows(),!0===this.info.autoReset&&this.info.reset();const n=E.opaque,s=E.transmissive;if(C.setupLights(),e.isArrayCamera){const i=e.cameras;if(s.length>0)for(let e=0,r=i.length;e<r;e++){Yt(n,s,t,i[e])}ct&&Mt.render(t);for(let e=0,n=i.length;e<n;e++){const n=i[e];Xt(E,t,n,n.viewport)}}else s.length>0&&Yt(n,s,t,e),ct&&Mt.render(t),Xt(E,t,e);null!==P&&0===R&&(mt.updateMultisampleRenderTarget(P),mt.updateRenderTargetMipmap(P)),!0===t.isScene&&t.onAfterRender(M,t,e),Lt.resetDefaultState(),L=-1,D=null,I.pop(),I.length>0?(C=I[I.length-1],!0===it&&St.setGlobalState(M.clippingPlanes,C.state.camera)):C=null,S.pop(),E=S.length>0?S[S.length-1]:null},this.getActiveCubeFace=function(){return B},this.getActiveMipmapLevel=function(){return R},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(t,e,i){const n=gt.get(t);n.__autoAllocateDepthBuffer=!1===t.resolveDepthBuffer,!1===n.__autoAllocateDepthBuffer&&(n.__useRenderToTexture=!1),gt.get(t.texture).__webglTexture=e,gt.get(t.depthTexture).__webglTexture=n.__autoAllocateDepthBuffer?void 0:i,n.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(t,e){const i=gt.get(t);i.__webglFramebuffer=e,i.__useDefaultFramebuffer=void 0===e};const ne=Nt.createFramebuffer();this.setRenderTarget=function(t,e=0,i=0){P=t,B=e,R=i;let n=!0,s=null,r=!1,o=!1;if(t){const a=gt.get(t);if(void 0!==a.__useDefaultFramebuffer)pt.bindFramebuffer(Nt.FRAMEBUFFER,null),n=!1;else if(void 0===a.__webglFramebuffer)mt.setupRenderTarget(t);else if(a.__hasExternalTextures)mt.rebindTextures(t,gt.get(t.texture).__webglTexture,gt.get(t.depthTexture).__webglTexture);else if(t.depthBuffer){const e=t.depthTexture;if(a.__boundDepthTexture!==e){if(null!==e&&gt.has(e)&&(t.width!==e.image.width||t.height!==e.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");mt.setupDepthRenderbuffer(t)}}const l=t.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);const c=gt.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(s=Array.isArray(c[e])?c[e][i]:c[e],r=!0):s=t.samples>0&&!1===mt.useMultisampledRTT(t)?gt.get(t).__webglMultisampledFramebuffer:Array.isArray(c)?c[i]:c,N.copy(t.viewport),j.copy(t.scissor),G=t.scissorTest}else N.copy(J).multiplyScalar(K).floor(),j.copy(Z).multiplyScalar(K).floor(),G=tt;0!==i&&(s=ne);if(pt.bindFramebuffer(Nt.FRAMEBUFFER,s)&&n&&pt.drawBuffers(t,s),pt.viewport(N),pt.scissor(j),pt.setScissorTest(G),r){const n=gt.get(t.texture);Nt.framebufferTexture2D(Nt.FRAMEBUFFER,Nt.COLOR_ATTACHMENT0,Nt.TEXTURE_CUBE_MAP_POSITIVE_X+e,n.__webglTexture,i)}else if(o){const n=gt.get(t.texture),s=e;Nt.framebufferTextureLayer(Nt.FRAMEBUFFER,Nt.COLOR_ATTACHMENT0,n.__webglTexture,i,s)}else if(null!==t&&0!==i){const e=gt.get(t.texture);Nt.framebufferTexture2D(Nt.FRAMEBUFFER,Nt.COLOR_ATTACHMENT0,Nt.TEXTURE_2D,e.__webglTexture,i)}L=-1},this.readRenderTargetPixels=function(t,e,i,n,s,r,o,a=0){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=gt.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(l=l[o]),l){pt.bindFramebuffer(Nt.FRAMEBUFFER,l);try{const o=t.textures[a],l=o.format,c=o.type;if(!dt.textureFormatReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!dt.textureTypeReadable(c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-n&&i>=0&&i<=t.height-s&&(t.textures.length>1&&Nt.readBuffer(Nt.COLOR_ATTACHMENT0+a),Nt.readPixels(e,i,n,s,Pt.convert(l),Pt.convert(c),r))}finally{const t=null!==P?gt.get(P).__webglFramebuffer:null;pt.bindFramebuffer(Nt.FRAMEBUFFER,t)}}},this.readRenderTargetPixelsAsync=async function(t,e,i,s,r,o,a,l=0){if(!t||!t.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let c=gt.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(c=c[a]),c){if(e>=0&&e<=t.width-s&&i>=0&&i<=t.height-r){pt.bindFramebuffer(Nt.FRAMEBUFFER,c);const a=t.textures[l],h=a.format,u=a.type;if(!dt.textureFormatReadable(h))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!dt.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const d=Nt.createBuffer();Nt.bindBuffer(Nt.PIXEL_PACK_BUFFER,d),Nt.bufferData(Nt.PIXEL_PACK_BUFFER,o.byteLength,Nt.STREAM_READ),t.textures.length>1&&Nt.readBuffer(Nt.COLOR_ATTACHMENT0+l),Nt.readPixels(e,i,s,r,Pt.convert(h),Pt.convert(u),0);const p=null!==P?gt.get(P).__webglFramebuffer:null;pt.bindFramebuffer(Nt.FRAMEBUFFER,p);const f=Nt.fenceSync(Nt.SYNC_GPU_COMMANDS_COMPLETE,0);return Nt.flush(),await(0,n.jej)(Nt,f,4),Nt.bindBuffer(Nt.PIXEL_PACK_BUFFER,d),Nt.getBufferSubData(Nt.PIXEL_PACK_BUFFER,0,o),Nt.deleteBuffer(d),Nt.deleteSync(f),o}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(t,e=null,i=0){const n=Math.pow(2,-i),s=Math.floor(t.image.width*n),r=Math.floor(t.image.height*n),o=null!==e?e.x:0,a=null!==e?e.y:0;mt.setTexture2D(t,0),Nt.copyTexSubImage2D(Nt.TEXTURE_2D,i,0,0,o,a,s,r),pt.unbindTexture()};const se=Nt.createFramebuffer(),re=Nt.createFramebuffer();this.copyTextureToTexture=function(t,e,i=null,s=null,r=0,o=null){let a,l,c,h,u,d,p,f,g;null===o&&(0!==r?((0,n.mcG)("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),o=r,r=0):o=0);const m=t.isCompressedTexture?t.mipmaps[o]:t.image;if(null!==i)a=i.max.x-i.min.x,l=i.max.y-i.min.y,c=i.isBox3?i.max.z-i.min.z:1,h=i.min.x,u=i.min.y,d=i.isBox3?i.min.z:0;else{const e=Math.pow(2,-r);a=Math.floor(m.width*e),l=Math.floor(m.height*e),c=t.isDataArrayTexture?m.depth:t.isData3DTexture?Math.floor(m.depth*e):1,h=0,u=0,d=0}null!==s?(p=s.x,f=s.y,g=s.z):(p=0,f=0,g=0);const A=Pt.convert(e.format),v=Pt.convert(e.type);let y;e.isData3DTexture?(mt.setTexture3D(e,0),y=Nt.TEXTURE_3D):e.isDataArrayTexture||e.isCompressedArrayTexture?(mt.setTexture2DArray(e,0),y=Nt.TEXTURE_2D_ARRAY):(mt.setTexture2D(e,0),y=Nt.TEXTURE_2D),Nt.pixelStorei(Nt.UNPACK_FLIP_Y_WEBGL,e.flipY),Nt.pixelStorei(Nt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),Nt.pixelStorei(Nt.UNPACK_ALIGNMENT,e.unpackAlignment);const b=Nt.getParameter(Nt.UNPACK_ROW_LENGTH),_=Nt.getParameter(Nt.UNPACK_IMAGE_HEIGHT),x=Nt.getParameter(Nt.UNPACK_SKIP_PIXELS),w=Nt.getParameter(Nt.UNPACK_SKIP_ROWS),E=Nt.getParameter(Nt.UNPACK_SKIP_IMAGES);Nt.pixelStorei(Nt.UNPACK_ROW_LENGTH,m.width),Nt.pixelStorei(Nt.UNPACK_IMAGE_HEIGHT,m.height),Nt.pixelStorei(Nt.UNPACK_SKIP_PIXELS,h),Nt.pixelStorei(Nt.UNPACK_SKIP_ROWS,u),Nt.pixelStorei(Nt.UNPACK_SKIP_IMAGES,d);const C=t.isDataArrayTexture||t.isData3DTexture,S=e.isDataArrayTexture||e.isData3DTexture;if(t.isDepthTexture){const i=gt.get(t),n=gt.get(e),s=gt.get(i.__renderTarget),m=gt.get(n.__renderTarget);pt.bindFramebuffer(Nt.READ_FRAMEBUFFER,s.__webglFramebuffer),pt.bindFramebuffer(Nt.DRAW_FRAMEBUFFER,m.__webglFramebuffer);for(let i=0;i<c;i++)C&&(Nt.framebufferTextureLayer(Nt.READ_FRAMEBUFFER,Nt.COLOR_ATTACHMENT0,gt.get(t).__webglTexture,r,d+i),Nt.framebufferTextureLayer(Nt.DRAW_FRAMEBUFFER,Nt.COLOR_ATTACHMENT0,gt.get(e).__webglTexture,o,g+i)),Nt.blitFramebuffer(h,u,a,l,p,f,a,l,Nt.DEPTH_BUFFER_BIT,Nt.NEAREST);pt.bindFramebuffer(Nt.READ_FRAMEBUFFER,null),pt.bindFramebuffer(Nt.DRAW_FRAMEBUFFER,null)}else if(0!==r||t.isRenderTargetTexture||gt.has(t)){const i=gt.get(t),n=gt.get(e);pt.bindFramebuffer(Nt.READ_FRAMEBUFFER,se),pt.bindFramebuffer(Nt.DRAW_FRAMEBUFFER,re);for(let t=0;t<c;t++)C?Nt.framebufferTextureLayer(Nt.READ_FRAMEBUFFER,Nt.COLOR_ATTACHMENT0,i.__webglTexture,r,d+t):Nt.framebufferTexture2D(Nt.READ_FRAMEBUFFER,Nt.COLOR_ATTACHMENT0,Nt.TEXTURE_2D,i.__webglTexture,r),S?Nt.framebufferTextureLayer(Nt.DRAW_FRAMEBUFFER,Nt.COLOR_ATTACHMENT0,n.__webglTexture,o,g+t):Nt.framebufferTexture2D(Nt.DRAW_FRAMEBUFFER,Nt.COLOR_ATTACHMENT0,Nt.TEXTURE_2D,n.__webglTexture,o),0!==r?Nt.blitFramebuffer(h,u,a,l,p,f,a,l,Nt.COLOR_BUFFER_BIT,Nt.NEAREST):S?Nt.copyTexSubImage3D(y,o,p,f,g+t,h,u,a,l):Nt.copyTexSubImage2D(y,o,p,f,h,u,a,l);pt.bindFramebuffer(Nt.READ_FRAMEBUFFER,null),pt.bindFramebuffer(Nt.DRAW_FRAMEBUFFER,null)}else S?t.isDataTexture||t.isData3DTexture?Nt.texSubImage3D(y,o,p,f,g,a,l,c,A,v,m.data):e.isCompressedArrayTexture?Nt.compressedTexSubImage3D(y,o,p,f,g,a,l,c,A,m.data):Nt.texSubImage3D(y,o,p,f,g,a,l,c,A,v,m):t.isDataTexture?Nt.texSubImage2D(Nt.TEXTURE_2D,o,p,f,a,l,A,v,m.data):t.isCompressedTexture?Nt.compressedTexSubImage2D(Nt.TEXTURE_2D,o,p,f,m.width,m.height,A,m.data):Nt.texSubImage2D(Nt.TEXTURE_2D,o,p,f,a,l,A,v,m);Nt.pixelStorei(Nt.UNPACK_ROW_LENGTH,b),Nt.pixelStorei(Nt.UNPACK_IMAGE_HEIGHT,_),Nt.pixelStorei(Nt.UNPACK_SKIP_PIXELS,x),Nt.pixelStorei(Nt.UNPACK_SKIP_ROWS,w),Nt.pixelStorei(Nt.UNPACK_SKIP_IMAGES,E),0===o&&e.generateMipmaps&&Nt.generateMipmap(y),pt.unbindTexture()},this.copyTextureToTexture3D=function(t,e,i=null,s=null,r=0){return(0,n.mcG)('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(t,e,i,s,r)},this.initRenderTarget=function(t){void 0===gt.get(t).__webglFramebuffer&&mt.setupRenderTarget(t)},this.initTexture=function(t){t.isCubeTexture?mt.setTextureCube(t,0):t.isData3DTexture?mt.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?mt.setTexture2DArray(t,0):mt.setTexture2D(t,0),pt.unbindTexture()},this.resetState=function(){B=0,R=0,P=null,pt.reset(),Lt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return n.TdN}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const e=this.getContext();e.drawingBufferColorSpace=n.ppV._getDrawingBufferColorSpace(t),e.unpackColorSpace=n.ppV._getUnpackColorSpace()}}}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,i),r.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};i(9683)})();